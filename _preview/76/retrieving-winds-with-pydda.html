<!DOCTYPE html><html lang="en" class="light" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>PyDDA tutorial - ERAD 2024</title><meta property="og:title" content="PyDDA tutorial - ERAD 2024"/><meta name="generator" content="mystmd"/><meta name="keywords" content=""/><meta name="image" content="/erad2024/_preview/76/build/5e2d147096249dc3a37da495168a9e9e.png"/><meta property="og:image" content="/erad2024/_preview/76/build/5e2d147096249dc3a37da495168a9e9e.png"/><link rel="icon" href="/favicon.ico"/><link rel="stylesheet" href="/erad2024/_preview/76/build/_assets/app-IVMJSATM.css"/><link rel="stylesheet" href="/erad2024/_preview/76/build/_assets/thebe-core-C4ZDKLDU.css"/><link rel="stylesheet" href="/myst-theme.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="block px-2 py-1 text-black underline">Skip to article content</a></div><div class="bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 fixed w-screen top-0 z-30 h-[60px]"><nav class="flex items-center justify-between flex-wrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center"><div class="block xl:hidden"><button class="flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="2rem" height="2rem" class="m-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 013.75 6h16.5a.75.75 0 010 1.5H3.75A.75.75 0 013 6.75zM3 12a.75.75 0 01.75-.75h16.5a.75.75 0 010 1.5H3.75A.75.75 0 013 12zm0 5.25a.75.75 0 01.75-.75h16.5a.75.75 0 010 1.5H3.75a.75.75 0 01-.75-.75z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/erad2024/_preview/76/"><div class="p-1 mr-3"><img src="/erad2024/_preview/76/build/erad_white_backgroun-e338dec3af6d3f9e4b0338b5544e669d.png" class="h-9 dark:hidden" height="2.25rem"/><img src="/erad2024/_preview/76/build/erad_white_backgroun-e338dec3af6d3f9e4b0338b5544e669d.png" class="hidden h-9 dark:block" height="2.25rem"/></div><span class="text-md sm:text-xl tracking-tight sm:mr-5 sr-only">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"><div class="relative inline-block mx-2 grow-0"><a href="https://www.erad2024.it" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center w-full mx-2 py-1 text-md font-medium dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75">Conference Home</a></div><div class="relative inline-block mx-2 grow-0"><a href="https://openradarscience.org" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center w-full mx-2 py-1 text-md font-medium dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75">Open Radar Community</a></div></div><div class="flex-grow block"></div><button class="theme rounded-full border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-8 h-8 mx-3" title="Change theme to dark mode." aria-label="Change theme to dark mode."><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="h-full w-full p-0.5"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z"></path></svg></button><div class="block sm:hidden"><div class="relative" data-headlessui-state=""><div><button class="flex text-sm bg-transparent rounded-full focus:outline-none" id="headlessui-menu-button-:Rciop:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Open Menu</span><div class="flex items-center text-stone-200 hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="2rem" height="2rem" class="p-1"><path fill-rule="evenodd" d="M10.5 6a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zm0 6a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zm0 6a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0z" clip-rule="evenodd"></path></svg></div></button></div></div></div><div class="hidden sm:block"><a href="https://binder.projectpythia.org/v2/gh/openradar/erad2024/main?labpath=notebooks" target="_blank" rel="noopener noreferrer" class="inline-block px-4 py-2 mx-1 mt-0 leading-none border rounded text-md border-stone-700 dark:border-white text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 hover:bg-neutral-100">Launch Environment</a></div></div></nav></div><div class="fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden z-10" style="top:60px"><div class="pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><nav aria-label="Table of Contents" class="flex-grow overflow-y-auto transition-opacity mt-6 pb-3 ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="w-full px-1 dark:text-white"><a title="ERAD 2024" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="/erad2024/_preview/76/">ERAD 2024</a><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Preamble" class="block break-words rounded py-2 grow cursor-pointer">Preamble</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R2d8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R2d8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Data Access" class="block break-words rounded py-2 grow cursor-pointer">Data Access</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R3d8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R3d8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Radar Software Foundations" class="block break-words rounded py-2 grow cursor-pointer">Radar Software Foundations</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R4d8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R4d8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Notebook Environment" class="block break-words rounded py-2 grow cursor-pointer">Notebook Environment</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R5d8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R5d8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Retrieving winds with PyDDA" class="block break-words rounded py-2 grow cursor-pointer">Retrieving winds with PyDDA</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R6d8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R6d8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div></div></nav><div class="flex-none py-4 transition-all duration-700 translate-y-6 opacity-0"><a class="flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><article class="article content article-grid grid-gap" style="margin-top:60px"><main class="article-grid subgrid-gap col-screen"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="pt-5 mb-8"><div class="flex items-center h-6 mt-3 mb-5 text-sm font-light"><div class="flex-grow"></div><a href="https://opensource.org/licenses/Apache-2.0" target="_blank" rel="noopener noreferrer" title="Content License: Apache License 2.0 (Apache-2.0)" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="mx-1 inline-block opacity-60 hover:opacity-100 hover:text-[#599F46]"><path d="M13.2 15.6c1.4-.5 2.1-1.6 2.1-3.3S13.8 8.9 12 8.9c-1.9 0-3.3 1.6-3.3 3.3 0 1.8.8 3 2.2 3.4l-2.3 5.9c-3.1-.8-6.3-4.6-6.3-9.3 0-5.5 4.3-10 9.7-10s9.8 4.5 9.8 10c0 4.7-3.1 8.5-6.3 9.3l-2.3-5.9z"></path></svg></a><a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="noopener noreferrer" class="opacity-50 hover:opacity-100 text-inherit hover:text-inherit" aria-label="Code License: Creative Commons Attribution 4.0 International (CC-BY-4.0)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mx-1"><title>Code License: Creative Commons Attribution 4.0 International (CC-BY-4.0)</title><path d="M12 2.2c2.7 0 5 1 7 2.9.9.9 1.6 2 2.1 3.1.5 1.2.7 2.4.7 3.8 0 1.3-.2 2.6-.7 3.8-.5 1.2-1.2 2.2-2.1 3.1-1 .9-2 1.7-3.2 2.2-1.2.5-2.5.7-3.7.7s-2.6-.3-3.8-.8c-1.2-.5-2.2-1.2-3.2-2.1s-1.6-2-2.1-3.2-.8-2.4-.8-3.7c0-1.3.2-2.5.7-3.7S4.2 6 5.1 5.1C7 3.2 9.3 2.2 12 2.2zM12 4c-2.2 0-4.1.8-5.6 2.3C5.6 7.1 5 8 4.6 9c-.4 1-.6 2-.6 3s.2 2.1.6 3c.4 1 1 1.8 1.8 2.6S8 19 9 19.4c1 .4 2 .6 3 .6s2.1-.2 3-.6c1-.4 1.9-1 2.7-1.8 1.5-1.5 2.3-3.3 2.3-5.6 0-1.1-.2-2.1-.6-3.1-.4-1-1-1.8-1.7-2.6C16.1 4.8 14.2 4 12 4zm-.1 6.4l-1.3.7c-.1-.3-.3-.5-.5-.6-.2-.1-.4-.2-.6-.2-.9 0-1.3.6-1.3 1.7 0 .5.1.9.3 1.3.2.3.5.5 1 .5.6 0 1-.3 1.2-.8l1.2.6c-.3.5-.6.9-1.1 1.1-.5.3-1 .4-1.5.4-.9 0-1.6-.3-2.1-.8-.5-.6-.8-1.3-.8-2.3 0-.9.3-1.7.8-2.2.6-.6 1.3-.8 2.1-.8 1.2 0 2.1.4 2.6 1.4zm5.6 0l-1.3.7c-.1-.3-.3-.5-.5-.6-.2-.1-.4-.2-.6-.2-.9 0-1.3.6-1.3 1.7 0 .5.1.9.3 1.3.2.3.5.5 1 .5.6 0 1-.3 1.2-.8l1.2.6c-.3.5-.6.9-1.1 1.1-.4.2-.9.3-1.4.3-.9 0-1.6-.3-2.1-.8s-.8-1.3-.8-2.2c0-.9.3-1.7.8-2.2.5-.5 1.2-.8 2-.8 1.2 0 2.1.4 2.6 1.4z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1"><title>Credit must be given to the creator</title><path d="M12 2.2c2.7 0 5 .9 6.9 2.8 1.9 1.9 2.8 4.2 2.8 6.9s-.9 5-2.8 6.8c-2 1.9-4.3 2.9-7 2.9-2.6 0-4.9-1-6.9-2.9-1.8-1.7-2.8-4-2.8-6.7s1-5 2.9-6.9C7 3.2 9.3 2.2 12 2.2zM12 4c-2.2 0-4.1.8-5.6 2.3C4.8 8 4 9.9 4 12c0 2.2.8 4 2.4 5.6C8 19.2 9.8 20 12 20c2.2 0 4.1-.8 5.7-2.4 1.5-1.5 2.3-3.3 2.3-5.6 0-2.2-.8-4.1-2.3-5.7C16.1 4.8 14.2 4 12 4zm2.6 5.6v4h-1.1v4.7h-3v-4.7H9.4v-4c0-.2.1-.3.2-.4.1-.2.2-.2.4-.2h4c.2 0 .3.1.4.2.2.1.2.2.2.4zm-4-2.5c0-.9.5-1.4 1.4-1.4s1.4.5 1.4 1.4c0 .9-.5 1.4-1.4 1.4s-1.4-.5-1.4-1.4z"></path></svg></a><a href="https://en.wikipedia.org/wiki/Open_access" target="_blank" rel="noopener noreferrer" title="Open Access" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="mr-1 inline-block opacity-60 hover:opacity-100 hover:text-[#E18435]"><path d="M17.1 12.6h-2V7.5c0-1.7-1.4-3.1-3-3.1-.8 0-1.6.3-2.2.9-.6.5-.9 1.3-.9 2.2v.7H7v-.7c0-1.4.5-2.7 1.5-3.7s2.2-1.5 3.6-1.5 2.6.5 3.6 1.5 1.5 2.3 1.5 3.7v5.1z"></path><path d="M12 21.8c-.8 0-1.6-.2-2.3-.5-.7-.3-1.4-.8-1.9-1.3-.6-.6-1-1.2-1.3-2-.3-.8-.5-1.6-.5-2.4s.2-1.6.5-2.4c.3-.7.7-1.4 1.3-2s1.2-1 1.9-1.3c.7-.3 1.5-.5 2.3-.5.8 0 1.6.2 2.3.5.7.3 1.4.8 1.9 1.3.6.6 1 1.2 1.3 2 .3.8.5 1.6.5 2.4s-.2 1.6-.5 2.4c-.3.7-.7 1.4-1.3 2-.6.6-1.2 1-1.9 1.3-.7.3-1.5.5-2.3.5zm0-10.3c-2.2 0-4 1.8-4 4.1s1.8 4.1 4 4.1 4-1.8 4-4.1-1.8-4.1-4-4.1z"></path><circle cx="12" cy="15.6" r="1.7"></circle></svg></a><a href="https://github.com/openradar/erad2024" title="GitHub Repository: openradar/erad2024" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a><div class="inline-block mr-1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block"><path d="M20.2 1.7c0 .8-.5 1.4-1.3 1.5-.8 0-1.4-.5-1.5-1.3 0-.8.5-1.4 1.3-1.5.8-.1 1.5.5 1.5 1.3zM12 17.9c-3.7 0-7-1.3-8.7-3.3 1.8 4.8 7.1 7.3 11.9 5.5 2.5-.9 4.5-2.9 5.5-5.5-1.7 2-4.9 3.3-8.7 3.3zM12 5.1c3.7 0 7 1.3 8.7 3.3-1.8-4.8-7.1-7.3-11.9-5.5-2.5.9-4.5 2.9-5.5 5.5 1.7-2 5-3.3 8.7-3.3zM6.9 21.8c.1 1-.7 1.8-1.7 1.9-1 .1-1.8-.7-1.9-1.7 0-1 .7-1.8 1.7-1.9 1-.1 1.8.7 1.9 1.7zM3.7 4.6c-.6 0-1-.4-1-1s.4-1 1-1 1 .4 1 1c0 .5-.4 1-1 1z"></path></svg></div><div class="relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="relative ml-2 -mr-1" id="headlessui-menu-button-:Rd4fop:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem"><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="mb-0">PyDDA tutorial</h1><header class="mt-4 not-prose"><div><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rhkfop:" data-state="closed">Alfonso Ladino</button><a class="ml-1" href="https://orcid.org/0000-0001-8081-7827" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rikfop:" data-state="closed">Anna del Moral Méndez</button><a class="ml-1" href="https://orcid.org/0000-0002-5015-840X" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rjkfop:" data-state="closed">Brenda Javornik</button></span><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rkkfop:" data-state="closed">Daniel Michelson</button><a class="ml-1" href="https://orcid.org/0000-0003-3222-9881" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rlkfop:" data-state="closed">Daniel Wolfensberger</button></span><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rmkfop:" data-state="closed">Gionata Ghiggi</button><a class="ml-1" href="https://orcid.org/0000-0002-0818-0865" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rnkfop:" data-state="closed">Jen DeHart</button><a class="ml-1" href="https://orcid.org/0000-0001-8536-4927" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rokfop:" data-state="closed">Jordi Figueras i Ventura</button><a class="ml-1" href="https://orcid.org/0000-0002-4949-422X" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rpkfop:" data-state="closed">Julian Giles</button><a class="ml-1" href="https://orcid.org/0000-0001-8134-008X" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rqkfop:" data-state="closed">Kai Mühlbauer</button><a class="ml-1" href="https://orcid.org/0000-0001-6599-1034" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rrkfop:" data-state="closed">Maxwell Grover</button><a class="ml-1" href="https://orcid.org/0000-0002-0370-8974" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rskfop:" data-state="closed">Mike Dixon</button><a class="ml-1" href="https://orcid.org/0000-0002-9597-9113" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rtkfop:" data-state="closed">Robert Jackson</button><a class="ml-1" href="https://orcid.org/0000-0003-2518-1234" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rukfop:" data-state="closed">Scott Collis</button><a class="ml-1" href="https://orcid.org/0000-0002-2303-687X" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span><span class="font-semibold text-sm inline-block"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rvkfop:" data-state="closed">Ting-Yu Cha</button><a class="ml-1" href="https://orcid.org/0000-0002-6292-8483" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span></div></header></div><div class="block my-10 lg:sticky lg:top-0 lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:93px"><nav></nav></div><div class="sticky top-[60px] flex justify-end w-full z-20 pointer-events-none"><div class="flex p-1 m-1 space-x-1 border rounded-full shadow pointer-events-auto border-stone-300 bg-white/80 dark:bg-stone-900/80 backdrop-blur"><div class="rounded"><button class="flex text-center rounded-full cursor-pointer text-stone-800 dark:text-white hover:opacity-100 opacity-60" aria-label="start compute environment"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="inline-block w-6 h-6 align-top"><title>enable compute</title><path stroke-linecap="round" stroke-linejoin="round" d="M5.636 5.636a9 9 0 1012.728 0M12 3v9"></path></svg></button></div></div></div><div id="skip-to-article"></div><div id="KNqvhDpJSW" class="relative group/block article-grid subgrid-gap col-screen"><img id="Z4ryd0XqXm" style="margin:0 auto" src="/erad2024/_preview/76/build/5e2d147096249dc3a37da495168a9e9e.png" alt="PyDDA logo" data-canonical-url="https://openradarscience.org/PyDDA/_images/logo.png"/><p>PyDDA is an open source Python package for retrieving winds using Multiple Doppler analyses. It uses the 3D variational technique for retrieving winds from multiple Doppler radars. It uses Py-ART Grid Objects as inputs. Therefore, preprocessed and gridded data are needed for PyDDA to run.</p><h2 id="id-3d-variational-technique" class="relative group"><span class="heading-text">3D variational technique</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-3d-variational-technique" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>PyDDA uses a 3D variational technique to retrieve the 3D wind field. We will leave students that are interested in more information about these technqiues two references to read at the end of this notebook. A basic introduction to 3D variational analysis is given here.</p><p>PyDDA minimizes a cost function <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi></mrow><annotation encoding="application/x-tex">J</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span></span></span></span></span> that corresponds to various penalties including:</p><p><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>J</mi><mi>m</mi></msub><mo>=</mo><mi mathvariant="normal">∇</mi><mo>⋅</mo><mi>V</mi></mrow><annotation encoding="application/x-tex">J_{m} = \nabla \cdot V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0962em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">∇</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span></span> which corresponds to the mass continuity equation.</p><p><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>J</mi><mi>o</mi></msub><mo>=</mo></mrow><annotation encoding="application/x-tex">J_{o} = </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0962em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span></span></span></span></span> RMSE between radar winds and analysis winds.</p><p><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>J</mi><mi>b</mi></msub><mo>=</mo></mrow><annotation encoding="application/x-tex">J_{b} = </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0962em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span></span></span></span></span> RMSE between sounding winds and analysis winds.</p><p><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>J</mi><mi>s</mi></msub><mo>=</mo><msup><mi mathvariant="normal">∇</mi><mn>2</mn></msup><mi>V</mi></mrow><annotation encoding="application/x-tex">J_{s} = \nabla^2 V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0962em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span></span> which corresponds to the smoothness of wind field to eliminate high-frequency noise that can result from numerical instability.</p><p>The cost function to be minimized is a weighted sum of the various cost functions in PyDDA and are represented in Equation (1):</p><p>$J = c_{m}J_{m} + c_{o}J_{o} + c_{b}J_{b} + c_{s}J_{s} + ...$ (1)</p><h3 id="references" class="relative group"><span class="heading-text">References</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#references" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="RcFhEw7TWo" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="imports" class="relative group"><span class="heading-text">Imports</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#imports" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Let’s import the necessary libraries. For now, we’ll need PyART, glob, matplotlib, and PyDDA.</p></div><div id="o59xtiQOM6" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">import glob

import pyart
import matplotlib.pyplot as plt
import pydda
import warnings
import numpy as np
import pandas as pd
import fsspec
import cartopy.crs as ccrs

warnings.filterwarnings(&quot;ignore&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="cFapGrkRe9zYJlwaQ1pqz" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>
## You are using the Python ARM Radar Toolkit (Py-ART), an open source
## library for working with weather radar data. Py-ART is partly
## supported by the U.S. Department of Energy as part of the Atmospheric
## Radiation Measurement (ARM) Climate Research Facility, an Office of
## Science user facility.
##
## If you use this software to prepare a publication, please cite:
##
##     JJ Helmus and SM Collis, JORS 2016, doi: 10.5334/jors.119

</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Downloading file &#x27;example_grid_radar0.nc&#x27; from &#x27;https://github.com/rcjackson/pydda-sample-data/raw/main/pydda-sample-data/example_grid_radar0.nc&#x27; to &#x27;/home/jovyan/.cache/pydda&#x27;.
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Downloading file &#x27;example_grid_radar1.nc&#x27; from &#x27;https://github.com/rcjackson/pydda-sample-data/raw/main/pydda-sample-data/example_grid_radar1.nc&#x27; to &#x27;/home/jovyan/.cache/pydda&#x27;.
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Downloading file &#x27;test_sounding.cdf&#x27; from &#x27;https://github.com/rcjackson/pydda-sample-data/raw/main/pydda-sample-data/test_sounding.cdf&#x27; to &#x27;/home/jovyan/.cache/pydda&#x27;.
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Downloading file &#x27;test_era_interim.nc&#x27; from &#x27;https://github.com/rcjackson/pydda-sample-data/raw/main/pydda-sample-data/test_era_interim.nc&#x27; to &#x27;/home/jovyan/.cache/pydda&#x27;.
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Welcome to PyDDA 2.0.0
If you are using PyDDA in your publications, please cite:
Jackson et al. (2020) Journal of Open Research Science
Detecting Jax...
Jax engine enabled!
Detecting TensorFlow...
TensorFlow detected. Checking for tensorflow-probability...
TensorFlow-probability detected. TensorFlow engine enabled!
</span></code></pre></div></div></div><div id="aX1OCvTdrN" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="case-study" class="relative group"><span class="heading-text">Case study</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#case-study" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>We will examine the same case study over Italy that has been used for this entire short course. For this case in May 2024, we had weak convective cells in the region of</p><p>For this case, we had coverage of the storm from two radars, a MeteoSwiss C-band radar near Monte Lema, CH and an X-band radar from ARPA Lombardia located about 50 km away in Milano, IT.</p></div><div id="N4bb5XVtDc" class="relative group/block article-grid subgrid-gap col-screen"><h3 id="c-band-radar" class="relative group"><span class="heading-text">C-band Radar</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#c-band-radar" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>We need to load and preprocess the C-band radar data first. In order to do so, we first need to load the MeteoSwiss C-band radar file.</p></div><div id="UAuyfvliQ3" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Set the URL and path for the cloud
URL = &quot;https://js2.jetstream-cloud.org:8001/&quot;
path = f&quot;pythia/radar/erad2024&quot;


fs = fsspec.filesystem(&quot;s3&quot;, anon=True, client_kwargs=dict(endpoint_url=URL))

fs.glob(f&quot;{path}/*&quot;)

files = fs.glob(&quot;pythia/radar/erad2024/dda_data/*&quot;)
local_files = [
    fsspec.open_local(
        f&quot;simplecache::{URL}{i}&quot;, s3={&quot;anon&quot;: True}, filecache={&quot;cache_storage&quot;: &quot;.&quot;}
    )
    for i in files
]

radar = pyart.io.read(local_files[1])</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="qIlm9liN7RHVD-b2NAdwy" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="BBNabZHHDd" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">radar.info()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="SXJLJ-_kmlrcG0_VRCxv1" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>altitude:
	data: &lt;ndarray of type: float32 and shape: (1,)&gt;
	long_name: Altitude
	units: meters
	standard_name: Altitude
	positive: up
altitude_agl: None
antenna_transition: None
azimuth:
	data: &lt;ndarray of type: float32 and shape: (7200,)&gt;
	long_name: azimuth_angle_from_true_north
	units: degrees
	standard_name: beam_azimuth_angle
	axis: radial_azimuth_coordinate
	comment: Azimuth of antenna relative to true north
elevation:
	data: &lt;ndarray of type: float32 and shape: (7200,)&gt;
	long_name: elevation_angle_from_horizontal_plane
	units: degrees
	standard_name: beam_elevation_angle
	axis: radial_elevation_coordinate
	comment: Elevation of antenna relative to the horizontal plane
fields:
	reflectivity:
		data: &lt;ndarray of type: float64 and shape: (7200, 492)&gt;
		_FillValue: -9999.0
		long_name: Horizontal Reflectivity
		units: dBZ
		standard_name: horizontal_reflectivity
		coordinates: elevation azimuth range
	signal_to_noise_ratio:
		data: &lt;ndarray of type: float64 and shape: (7200, 492)&gt;
		_FillValue: -9999.0
		long_name: Signal to noise ratio
		units: dB
		standard_name: signal_to_noise_ratio
		coordinates: elevation azimuth range
	reflectivity_vv:
		data: &lt;ndarray of type: float64 and shape: (7200, 492)&gt;
		_FillValue: -9999.0
		long_name: Vertical Reflectivity
		units: dBZ
		standard_name: vertical_reflectivity
		coordinates: elevation azimuth range
	differential_reflectivity:
		data: &lt;ndarray of type: float64 and shape: (7200, 492)&gt;
		_FillValue: -9999.0
		long_name: Differential reflectivity
		units: dB
		standard_name: differential_reflectivity
		coordinates: elevation azimuth range
	uncorrected_cross_correlation_ratio:
		data: &lt;ndarray of type: float64 and shape: (7200, 492)&gt;
		_FillValue: -9999.0
		long_name: Uncorrected copolar correlation coefficient (RHOHV)
		units: -
		standard_name: copolar_correlation_coefficient
		coordinates: elevation azimuth range
	uncorrected_differential_phase:
		data: &lt;ndarray of type: float64 and shape: (7200, 492)&gt;
		_FillValue: -9999.0
		long_name: Uncorrected differential propagation phase
		units: deg
		standard_name: differential_phase
		coordinates: elevation azimuth range
	velocity:
		data: &lt;ndarray of type: float64 and shape: (7200, 492)&gt;
		_FillValue: -9999.0
		long_name: Mean Doppler velocity
		units: m/s
		standard_name: mean_Doppler_velocity
		coordinates: elevation azimuth range
	spectrum_width:
		data: &lt;ndarray of type: float64 and shape: (7200, 492)&gt;
		_FillValue: -9999.0
		long_name: Doppler spectrum width
		units: m/s
		standard_name: Doppler_spectrum_width
		coordinates: elevation azimuth range
	reflectivity_hh_clut:
		data: &lt;ndarray of type: float64 and shape: (7200, 492)&gt;
		_FillValue: -9999.0
	corrected_velocity:
		data: &lt;ndarray of type: float64 and shape: (7200, 492)&gt;
		_FillValue: -9999.0
		long_name: Corrected mean doppler velocity
		units: meters_per_second
		standard_name: corrected_radial_velocity_of_scatterers_away_from_instrument
		coordinates: elevation azimuth range
		valid_min: -24.75
		valid_max: 24.75
fixed_angle:
	data: &lt;ndarray of type: float32 and shape: (20,)&gt;
	long_name: Target angle for sweep
	units: degrees
	standard_name: target_fixed_angle
instrument_parameters:
	frequency:
		data: &lt;ndarray of type: float32 and shape: (1,)&gt;
		long_name: Radiation frequency
		units: s-1
		meta_group: instrument_parameters
	pulse_width:
		data: &lt;ndarray of type: float32 and shape: (7200,)&gt;
		long_name: Pulse width
		units: seconds
		comments: Pulse width
		meta_group: instrument_parameters
	nyquist_velocity:
		data: &lt;ndarray of type: float32 and shape: (7200,)&gt;
		long_name: Nyquist velocity
		units: m/s
		comments: Unambiguous velocity
		meta_group: instrument_parameters
	radar_beam_width_h:
		data: &lt;ndarray of type: float32 and shape: (1,)&gt;
		long_name: Antenna beam width H polarization
		units: degrees
		meta_group: radar_parameters
	radar_beam_width_v:
		data: &lt;ndarray of type: float32 and shape: (1,)&gt;
		long_name: Antenna beam width V polarization
		units: degrees
		meta_group: radar_parameters
latitude:
	data: &lt;ndarray of type: float32 and shape: (1,)&gt;
	long_name: Latitude
	units: degrees_north
	standard_name: Latitude
longitude:
	data: &lt;ndarray of type: float32 and shape: (1,)&gt;
	long_name: Longitude
	units: degrees_east
	standard_name: Longitude
nsweeps: 20
ngates: 492
nrays: 7200
radar_calibration: None
range:
	data: &lt;ndarray of type: float32 and shape: (492,)&gt;
	long_name: range_to_measurement_volume
	units: meters
	standard_name: projection_range_coordinate
	axis: radial_range_coordinate
	spacing_is_constant: true
	comment: Coordinate variable for range. Range to center of each bin.
scan_rate: None
scan_type: ppi
sweep_end_ray_index:
	data: &lt;ndarray of type: int32 and shape: (20,)&gt;
	long_name: Index of last ray in sweep, 0-based
	units: count
sweep_mode:
	data: &lt;ndarray of type: |S1 and shape: (20, 32)&gt;
	long_name: Sweep mode
	units: unitless
	standard_name: sweep_mode
	comment: Options are: &quot;sector&quot;, &quot;coplane&quot;, &quot;rhi&quot;, &quot;vertical_pointing&quot;, &quot;idle&quot;, &quot;azimuth_surveillance&quot;, &quot;elevation_surveillance&quot;, &quot;sunscan&quot;, &quot;pointing&quot;, &quot;manual_ppi&quot;, &quot;manual_rhi&quot;
sweep_number:
	data: &lt;ndarray of type: int64 and shape: (20,)&gt;
	long_name: Sweep number
	units: count
	standard_name: sweep_number
sweep_start_ray_index:
	data: &lt;ndarray of type: int32 and shape: (20,)&gt;
	long_name: Index of first ray in sweep, 0-based
	units: count
target_scan_rate: None
time:
	data: &lt;ndarray of type: float64 and shape: (7200,)&gt;
	long_name: time_in_seconds_since_volume_start
	units: seconds since 1970-01-01T00:00:00Z
	standard_name: time
	calendar: gregorian
	comment: Coordinate variable for time. Time at the center of each ray, in fractional seconds since the global variable time_coverage_start
metadata:
	Conventions: CF/Radial instrument_parameters
	version: 1.3
	title: 
	institution: 
	references: 
	source: 
	comment: 
	instrument_name: L
	field_names: reflectivity, signal_to_noise_ratio, reflectivity_vv, differential_reflectivity, uncorrected_cross_correlation_ratio, uncorrected_differential_phase, velocity, spectrum_width, reflectivity_hh_clut
	history: 
	volume_number: 0
	platform_type: fixed
	instrument_type: radar
	primary_axis: axis_z
</span></code></pre></div></div></div><div id="L0yGaEQtPp" class="relative group/block article-grid subgrid-gap col-screen"><h3 id="dealiasing" class="relative group"><span class="heading-text">Dealiasing</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#dealiasing" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>The next step is to dealias the radar data. We will follow the steps that were shown eariler in this course to dealias the radar data. Dealiasing is covered in detail in the <a target="_blank" href="https://projectpythia.org/radar-cookbook/notebooks/foundations/pyart-corrections.html" rel="noreferrer">Radar Cookbook</a>.</p></div><div id="wtpDs5ARz2" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">nyquist = radar.instrument_parameters[&quot;nyquist_velocity&quot;][&quot;data&quot;][0]
vel_dealias = pyart.correct.dealias_region_based(
    radar,
    vel_field=&quot;velocity&quot;,
    nyquist_vel=nyquist,
    centered=True,
)
radar.add_field(&quot;corrected_velocity&quot;, vel_dealias, replace_existing=True)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="psA6JhEOK7uaHS7Zmof1Y" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="yLLYtWISGK" class="relative group/block article-grid subgrid-gap col-screen"><p>Plot the data to make sure dealiasing succeeded.</p></div><div id="syndApYARq" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">display = pyart.graph.RadarDisplay(radar)
display.plot(&quot;reflectivity&quot;, vmin=-20, vmax=70, cmap=&quot;pyart_ChaseSpectral&quot;, sweep=0)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="sQiNpP61XZK8JvE9MUuAs" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/76/build/71c61a2e5e9269248c9fea6850f46800.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="gyMBeXIKlK" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">display = pyart.graph.RadarDisplay(radar)
display.plot(&quot;corrected_velocity&quot;, vmin=-30, vmax=30, cmap=&quot;twilight_shifted&quot;, sweep=0)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="OHSGzKu3tiJWC8-R7hjcu" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/76/build/7d3f182e14091fe346164628134a6ce1.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="ekqP9U203S" class="relative group/block article-grid subgrid-gap col-screen"><p>Some regions did not dealias correctly, like in the region around (-100 km, -100 km) where gate-to-gate shear exceeds the Nyquist interval in the absence of . The region-based algorithm is very sensitive to speckles that are present in the above image. Let’s despeckle the above radar data to remove some artifacts.</p></div><div id="VbYe5rEba2" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">gatefilter = pyart.filters.GateFilter(radar)
gatefilter.exclude_above(&quot;spectrum_width&quot;, 7)
# gatefilter.exclude_below(&#x27;cross_correlation_ratio&#x27;, 0.8)
gatefilter = pyart.correct.despeckle_field(
    radar, &quot;reflectivity&quot;, gatefilter=gatefilter, size=36
)
display = pyart.graph.RadarDisplay(radar)
display.plot(
    &quot;reflectivity&quot;,
    vmin=-20,
    vmax=70,
    gatefilter=gatefilter,
    cmap=&quot;pyart_ChaseSpectral&quot;,
    sweep=0,
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="YqMYX0cGCUa9BQnpQIjtG" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/76/build/dc4f75bac0607032af2cea9fa5783dbd.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="YxH3nWxkJ2" class="relative group/block article-grid subgrid-gap col-screen"><p>Let’s also tweak the settings of the region based dealiasing. Currently, the dealiasing will attempt to dealias regions that are separated by 100 masked gates in the radial. We will disable this feature by setting <code>skip_between_rays</code> to 0 so that all dealiasing across filtered gates along the azimuth is disabled.</p></div><div id="f49HV2RShO" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">nyquist = radar.instrument_parameters[&quot;nyquist_velocity&quot;][&quot;data&quot;][0]
vel_dealias = pyart.correct.dealias_region_based(
    radar,
    vel_field=&quot;velocity&quot;,
    nyquist_vel=nyquist,
    gatefilter=gatefilter,
    centered=True,
    skip_between_rays=0,
)
radar.add_field(&quot;corrected_velocity&quot;, vel_dealias, replace_existing=True)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="dlXckSXBT0LhQ41NriWDb" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="CKVRaF1mIg" class="relative group/block article-grid subgrid-gap col-screen"><p>Let’s plot all of the sweeps to make sure dealiasing worked correctly.
A good indicator of checking this is to check if there are discontinuities in the radial velocities between sweeps on the order of the Nyquist velocity. If there are such discontinuties, further tweaking of the parameters or grounding the retrieval to a sounding may be needed. Using these parameters, the above example radar data is properly dealiased.</p></div><div id="ncEDcWElJN" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">display = pyart.graph.RadarDisplay(radar)
fig, ax = plt.subplots(4, 5, figsize=(15, 10))
for i in range(radar.nsweeps):
    display.plot(
        &quot;corrected_velocity&quot;,
        vmin=-30,
        vmax=30,
        cmap=&quot;twilight_shifted&quot;,
        sweep=i,
        colorbar_label=&quot;m/s&quot;,
        ax=ax[int(i / 5), i % 5],
    )
    ax[int(i / 5), i % 5].set_title(&quot;%2.1f deg&quot; % radar.fixed_angle[&quot;data&quot;][i])
    ax[int(i / 5), i % 5].set_xlabel(&quot;X [km]&quot;)
    ax[int(i / 5), i % 5].set_ylabel(&quot;Y [km]&quot;)
fig.tight_layout()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="_9W_l6PtEQyI5aQHJM3e6" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/76/build/a9d44befbc6e4da81bf2235c1039556c.png" alt="&lt;Figure size 1500x1000 with 40 Axes&gt;"/></div></div><div id="Xa5DffmFuo" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">pyart.io.write_cfradial(&quot;MonteLema.20240522.151606_dealiased.nc&quot;, radar)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="s7SHyDuN6QmfAjN37FKw9" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="bx9kt4t0i8" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="gridding" class="relative group"><span class="heading-text">Gridding</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#gridding" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>PyDDA requires data to be gridded to Cartesian coordinates in order to retrieve the 3D wind fields. Therefore, we will use Py-ART’s <em>grid_from_radars</em> function in order to do the gridding. You usually want to have a grid resolution such that your features of interest are covered by four grid points. In this case, we’re at 1 km horizontal and 0.5 km vertical resolution. For more information on gridding with Py-ART, see the <a target="_blank" href="https://projectpythia.org/radar-cookbook/notebooks/foundations/pyart-gridding.html" rel="noreferrer">Radar Cookbook</a>.</p></div><div id="RPkwiusIwr" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">grid_limits = ((0.0, 15000.0), (-100_000.0, 100_000.0), (-100_000.0, 100_000.0))
grid_shape = (31, 201, 201)
radar.fields[&quot;corrected_velocity&quot;][&quot;data&quot;] = np.ma.masked_where(
    gatefilter.gate_excluded, radar.fields[&quot;corrected_velocity&quot;][&quot;data&quot;]
)
radar.fields[&quot;reflectivity&quot;][&quot;data&quot;] = np.ma.masked_where(
    gatefilter.gate_excluded, radar.fields[&quot;reflectivity&quot;][&quot;data&quot;]
)

cband_grid = pyart.map.grid_from_radars(
    [radar], grid_limits=grid_limits, grid_shape=grid_shape
)
cband_ds = cband_grid.to_xarray()
cband_ds</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="-o-V6-dLWaGxDTYK_vE2A" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="eHUEJbaRxG" class="relative group/block article-grid subgrid-gap col-screen"><p>Let’s make sure the grid looks good!</p></div><div id="uKJGbd4Lsl" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">cband_ds.isel(z=1).reflectivity.plot(
    x=&quot;lon&quot;, y=&quot;lat&quot;, vmin=-20, vmax=70, cmap=&quot;pyart_ChaseSpectral&quot;
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="BCuQVKnXTvHY0i82cfrL6" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/76/build/16d82f0cd8b5f5e60e09614f40a91e7a.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="PEJmsLCHtX" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">cband_ds.isel(y=35).reflectivity.plot(
    x=&quot;x&quot;, y=&quot;z&quot;, vmin=-20, vmax=70, cmap=&quot;pyart_ChaseSpectral&quot;
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="KG_P3jDvY5Bianj9lwKXi" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/76/build/bd20eb53f8febff010a7af65383c7046.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="lPk5cMXnUI" class="relative group/block article-grid subgrid-gap col-screen"><h3 id="x-band-data" class="relative group"><span class="heading-text">X-band Data</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#x-band-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Next, we need to load the X-band radar data from the archive.</p></div><div id="wm7xeJdgkr" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">radar_xband = pyart.io.read(local_files[0])</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="GFv7SCXQQoDjT_jarF7eB" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="J85t7901fH" class="relative group/block article-grid subgrid-gap col-screen"><p>Read a single file, the one closes to the UAH volume scan used before</p></div><div id="xwkdBcDEpG" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">radar.info()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="BoYyc1DwzjyT-AoO6eABU" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>altitude:
	data: &lt;ndarray of type: float32 and shape: (1,)&gt;
	long_name: Altitude
	units: meters
	standard_name: Altitude
	positive: up
altitude_agl: None
antenna_transition: None
azimuth:
	data: &lt;ndarray of type: float32 and shape: (7200,)&gt;
	long_name: azimuth_angle_from_true_north
	units: degrees
	standard_name: beam_azimuth_angle
	axis: radial_azimuth_coordinate
	comment: Azimuth of antenna relative to true north
elevation:
	data: &lt;ndarray of type: float32 and shape: (7200,)&gt;
	long_name: elevation_angle_from_horizontal_plane
	units: degrees
	standard_name: beam_elevation_angle
	axis: radial_elevation_coordinate
	comment: Elevation of antenna relative to the horizontal plane
fields:
	reflectivity:
		data: &lt;ndarray of type: float64 and shape: (7200, 492)&gt;
		_FillValue: -9999.0
		long_name: Horizontal Reflectivity
		units: dBZ
		standard_name: horizontal_reflectivity
		coordinates: elevation azimuth range
	signal_to_noise_ratio:
		data: &lt;ndarray of type: float64 and shape: (7200, 492)&gt;
		_FillValue: -9999.0
		long_name: Signal to noise ratio
		units: dB
		standard_name: signal_to_noise_ratio
		coordinates: elevation azimuth range
	reflectivity_vv:
		data: &lt;ndarray of type: float64 and shape: (7200, 492)&gt;
		_FillValue: -9999.0
		long_name: Vertical Reflectivity
		units: dBZ
		standard_name: vertical_reflectivity
		coordinates: elevation azimuth range
	differential_reflectivity:
		data: &lt;ndarray of type: float64 and shape: (7200, 492)&gt;
		_FillValue: -9999.0
		long_name: Differential reflectivity
		units: dB
		standard_name: differential_reflectivity
		coordinates: elevation azimuth range
	uncorrected_cross_correlation_ratio:
		data: &lt;ndarray of type: float64 and shape: (7200, 492)&gt;
		_FillValue: -9999.0
		long_name: Uncorrected copolar correlation coefficient (RHOHV)
		units: -
		standard_name: copolar_correlation_coefficient
		coordinates: elevation azimuth range
	uncorrected_differential_phase:
		data: &lt;ndarray of type: float64 and shape: (7200, 492)&gt;
		_FillValue: -9999.0
		long_name: Uncorrected differential propagation phase
		units: deg
		standard_name: differential_phase
		coordinates: elevation azimuth range
	velocity:
		data: &lt;ndarray of type: float64 and shape: (7200, 492)&gt;
		_FillValue: -9999.0
		long_name: Mean Doppler velocity
		units: m/s
		standard_name: mean_Doppler_velocity
		coordinates: elevation azimuth range
	spectrum_width:
		data: &lt;ndarray of type: float64 and shape: (7200, 492)&gt;
		_FillValue: -9999.0
		long_name: Doppler spectrum width
		units: m/s
		standard_name: Doppler_spectrum_width
		coordinates: elevation azimuth range
	reflectivity_hh_clut:
		data: &lt;ndarray of type: float64 and shape: (7200, 492)&gt;
		_FillValue: -9999.0
	corrected_velocity:
		data: &lt;ndarray of type: float64 and shape: (7200, 492)&gt;
		units: meters_per_second
		standard_name: corrected_radial_velocity_of_scatterers_away_from_instrument
		long_name: Corrected mean doppler velocity
		coordinates: elevation azimuth range
		_FillValue: -9999.0
		valid_min: -24.75
		valid_max: 24.75
fixed_angle:
	data: &lt;ndarray of type: float32 and shape: (20,)&gt;
	long_name: Target angle for sweep
	units: degrees
	standard_name: target_fixed_angle
instrument_parameters:
	frequency:
		data: &lt;ndarray of type: float32 and shape: (1,)&gt;
		long_name: Radiation frequency
		units: s-1
		meta_group: instrument_parameters
	pulse_width:
		data: &lt;ndarray of type: float32 and shape: (7200,)&gt;
		long_name: Pulse width
		units: seconds
		comments: Pulse width
		meta_group: instrument_parameters
	nyquist_velocity:
		data: &lt;ndarray of type: float32 and shape: (7200,)&gt;
		long_name: Nyquist velocity
		units: m/s
		comments: Unambiguous velocity
		meta_group: instrument_parameters
	radar_beam_width_h:
		data: &lt;ndarray of type: float32 and shape: (1,)&gt;
		long_name: Antenna beam width H polarization
		units: degrees
		meta_group: radar_parameters
	radar_beam_width_v:
		data: &lt;ndarray of type: float32 and shape: (1,)&gt;
		long_name: Antenna beam width V polarization
		units: degrees
		meta_group: radar_parameters
latitude:
	data: &lt;ndarray of type: float32 and shape: (1,)&gt;
	long_name: Latitude
	units: degrees_north
	standard_name: Latitude
longitude:
	data: &lt;ndarray of type: float32 and shape: (1,)&gt;
	long_name: Longitude
	units: degrees_east
	standard_name: Longitude
nsweeps: 20
ngates: 492
nrays: 7200
radar_calibration: None
range:
	data: &lt;ndarray of type: float32 and shape: (492,)&gt;
	long_name: range_to_measurement_volume
	units: meters
	standard_name: projection_range_coordinate
	axis: radial_range_coordinate
	spacing_is_constant: true
	comment: Coordinate variable for range. Range to center of each bin.
scan_rate: None
scan_type: ppi
sweep_end_ray_index:
	data: &lt;ndarray of type: int32 and shape: (20,)&gt;
	long_name: Index of last ray in sweep, 0-based
	units: count
sweep_mode:
	data: &lt;ndarray of type: |S1 and shape: (20, 32)&gt;
	long_name: Sweep mode
	units: unitless
	standard_name: sweep_mode
	comment: Options are: &quot;sector&quot;, &quot;coplane&quot;, &quot;rhi&quot;, &quot;vertical_pointing&quot;, &quot;idle&quot;, &quot;azimuth_surveillance&quot;, &quot;elevation_surveillance&quot;, &quot;sunscan&quot;, &quot;pointing&quot;, &quot;manual_ppi&quot;, &quot;manual_rhi&quot;
sweep_number:
	data: &lt;ndarray of type: int64 and shape: (20,)&gt;
	long_name: Sweep number
	units: count
	standard_name: sweep_number
sweep_start_ray_index:
	data: &lt;ndarray of type: int32 and shape: (20,)&gt;
	long_name: Index of first ray in sweep, 0-based
	units: count
target_scan_rate: None
time:
	data: &lt;ndarray of type: float64 and shape: (7200,)&gt;
	long_name: time_in_seconds_since_volume_start
	units: seconds since 1970-01-01T00:00:00Z
	standard_name: time
	calendar: gregorian
	comment: Coordinate variable for time. Time at the center of each ray, in fractional seconds since the global variable time_coverage_start
metadata:
	Conventions: CF/Radial instrument_parameters
	version: 1.3
	title: 
	institution: 
	references: 
	source: 
	comment: 
	instrument_name: L
	field_names: reflectivity, signal_to_noise_ratio, reflectivity_vv, differential_reflectivity, uncorrected_cross_correlation_ratio, uncorrected_differential_phase, velocity, spectrum_width, reflectivity_hh_clut
	history: 
	volume_number: 0
	platform_type: fixed
	instrument_type: radar
	primary_axis: axis_z
</span></code></pre></div></div></div><div id="yLewDagKnu" class="relative group/block article-grid subgrid-gap col-screen"><p>Visualize the data to make sure we have the correct scan.</p></div><div id="r1inMU3oHo" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">display = pyart.graph.RadarDisplay(radar_xband)
display.plot(&quot;DBZ&quot;, vmin=0, vmax=70, cmap=&quot;pyart_ChaseSpectral&quot;, sweep=0)
plt.ylim(-100, 100)
plt.xlim(-100, 100)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="GmDV8Umk93ze6wNxNB6NH" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>(-100.0, 100.0)</span></code></div><img src="/erad2024/_preview/76/build/7a27aaeae2b42e92588def1cc6ea427e.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="wypLbz9rgK" class="relative group/block article-grid subgrid-gap col-screen"><p>The X-band radar data also need to be dealiased. We will still need to filter out the noise in the above radar data.</p></div><div id="vqvDXsy3mc" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Use the C-band radar lat/lon as the center for the grid

gatefilter = pyart.filters.GateFilter(radar_xband)
gatefilter.exclude_above(&quot;WIDTH&quot;, 7)
gatefilter.exclude_below(&quot;RHOHV&quot;, 0.8)
gatefilter = pyart.correct.despeckle_field(
    radar_xband, &quot;DBZ&quot;, gatefilter=gatefilter, size=100
)
vel_dealias = pyart.correct.dealias_region_based(
    radar_xband,
    vel_field=&quot;VEL&quot;,
    nyquist_vel=nyquist,
    centered=True,
    skip_between_rays=0,
    skip_along_ray=0,
    interval_splits=3,
)
radar_xband.add_field(&quot;corrected_velocity&quot;, vel_dealias, replace_existing=True)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="5ZCfordU0v6cTa11-O445" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="A8QyItkNRK" class="relative group/block article-grid subgrid-gap col-screen"><p>Let’s view the sweeps to make sure that dealiasing is working correctly.</p></div><div id="iYUYls2ll2" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">display = pyart.graph.RadarDisplay(radar_xband)
fig, ax = plt.subplots(2, 4, figsize=(15, 5))
for i in range(radar_xband.nsweeps):
    display.plot(
        &quot;corrected_velocity&quot;,
        vmin=-30,
        vmax=30,
        cmap=&quot;twilight_shifted&quot;,
        sweep=i,
        colorbar_label=&quot;m/s&quot;,
        ax=ax[int(i / 4), i % 4],
    )
    ax[int(i / 4), i % 4].set_title(&quot;%2.1f deg&quot; % radar.fixed_angle[&quot;data&quot;][i])
    ax[int(i / 4), i % 4].set_xlabel(&quot;X [km]&quot;)
    ax[int(i / 4), i % 4].set_ylabel(&quot;Y [km]&quot;)
fig.tight_layout()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Qr4DvUplTISCzr4NHaszs" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/76/build/c867742301938de9c1622d827b5fd1dd.png" alt="&lt;Figure size 1500x500 with 16 Axes&gt;"/></div></div><div id="aw1AFRFGSX" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">pyart.io.write_cfradial(&quot;ARPA_Lombardia.20240522.151546_dealiased.nc&quot;, radar_xband)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="R1nNeTgagO_mLsIXeqzfz" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="epGkoGe6MJ" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">grid_lat = radar.latitude[&quot;data&quot;][0]
grid_lon = radar.longitude[&quot;data&quot;][0]
xband_grid = pyart.map.grid_from_radars(
    [radar_xband],
    grid_limits=grid_limits,
    grid_shape=grid_shape,
    grid_origin=(grid_lat, grid_lon),
)

# Convert to xarray and remove the time dimension
xband_ds = xband_grid.to_xarray().squeeze()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="izOJtWtkBRBss7O1O6WEK" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="A3VOvSpO60" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="visualize-the-grids" class="relative group"><span class="heading-text">Visualize the grids</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#visualize-the-grids" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Let’s see what our output data looks like!</p></div><div id="GTN7nbh4kC" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">xband_ds.DBZ.isel(z=1).plot(x=&quot;lon&quot;, y=&quot;lat&quot;, cmap=&quot;Spectral_r&quot;, vmin=-20, vmax=50)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="jXl-iunZeyNNCZw5x8sTA" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/76/build/be75193a1f6fdfb7dee25570ecf77b09.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="uKA8X70j6j" class="relative group/block article-grid subgrid-gap col-screen"><p>Velocities look good!</p></div><div id="bbGGvpLZrs" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">xband_ds.corrected_velocity.isel(z=4).plot(
    x=&quot;lon&quot;, y=&quot;lat&quot;, cmap=&quot;twilight_shifted&quot;, vmin=-30, vmax=30
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="INum0KOCioXjJgWjwTLgn" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/76/build/078f482f9210b00e1063bae9d62ebf52.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="cShrF0AJPC" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">xband_ds.corrected_velocity.isel(y=55).plot(
    x=&quot;x&quot;, y=&quot;z&quot;, cmap=&quot;twilight_shifted&quot;, vmin=-20, vmax=20
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="gfaG32g4f6DqmT1VzcIQ-" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/76/build/c7a0b4afb85d614eb56c256b3428b821.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="YVmSI9Fshu" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="pydda-initialization" class="relative group"><span class="heading-text">PyDDA initialization</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#pydda-initialization" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>The 3DVAR wind retrieval first requires an initial guess at the wind field in order to start the cost function minimization process. PyDDA has support for using WRF and sounding data as an initial guess of the wind field as well as constant wind fields.</p><table><tbody><tr><th class="">Initalization functions in <strong>pydda.initialization</strong> module:</th><th class="">Functionality</th></tr><tr><td class="">make_constant_wind_field(Grid[, wind, vel_field])</td><td class="">This function makes a constant wind field given a wind vector</td></tr><tr><td class="">make_wind_field_from_profile(Grid, profile)</td><td class="">This function makes a 3D wind field from a sounding.</td></tr><tr><td class="">make_background_from_wrf(Grid, file_path, ...)</td><td class="">This function makes an initalization field based off of the u and w from a WRF run.</td></tr><tr><td class="">make_initialization_from_era_interim(Grid[, ...])</td><td class="">This function will read ERA Interim in NetCDF format and add it to the Py-ART grid specified by Grid.</td></tr></tbody></table><p>For this example, using a zero initialization field is sufficient to create an accurate representation of the wind field. Depending on your radar set up, you may need to adjust the input initial wind field to avoid artifacts at the edges of the multi-Doppler lobes.</p></div><div id="TuTiRMxjsc" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">cband_ds = pydda.io.read_from_pyart_grid(cband_grid)
xband_ds = pydda.io.read_from_pyart_grid(xband_grid)
cband_ds = pydda.initialization.make_constant_wind_field(
    cband_ds, (0.0, 0.0, 0.0), &quot;velocity&quot;
)
xband_ds[&quot;reflectivity&quot;] = xband_ds[&quot;DBZ&quot;]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="kmMDHlNsuRK1eMBfe1yQk" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="HtAlGvY6NO" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="pydda-wind-retrieval" class="relative group"><span class="heading-text">PyDDA wind retrieval</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#pydda-wind-retrieval" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>The core wind retrieval function in PyDDA is done using <strong>retrieval.get_dd_wind_field</strong>. It has many potential keyword inputs that the user can enter. In this example, we are specifying:</p><table><tbody><tr><th class="">Input to <strong>pydda.initialization</strong> module:</th><th class="">Meaning</th><th class="">Value</th></tr><tr><td class="">Grids</td><td class="">The input grids to analyze.</td><td class="">[uah_grid, nexrad_grid]</td></tr><tr><td class="">u_init</td><td class="">Initial guess of <em>u</em> field.</td><td class="">u_init</td></tr><tr><td class="">v_init</td><td class="">Initial guess of <em>u</em> field.</td><td class="">v_init</td></tr><tr><td class="">w_init</td><td class="">Initial guess of <em>u</em> field.</td><td class="">w_init</td></tr><tr><td class="">Co</td><td class="">Weight for cost function related to radar observations</td><td class="">1.0</td></tr><tr><td class="">Cm</td><td class="">Weight of cost function related to mass continuity equation</td><td class="">256.0</td></tr><tr><td class="">Cx</td><td class="">Weight of cost function for smoothess in the <em>x</em>-direction</td><td class="">1e-3</td></tr><tr><td class="">Cy</td><td class="">Weight of cost function for smoothess in the <em>y</em>-direction</td><td class="">1e-3</td></tr><tr><td class="">Cz</td><td class="">Weight of cost function for smoothess in the <em>z</em>-direction</td><td class="">1e-3</td></tr><tr><td class="">Cb</td><td class="">Weight of cost function for sounding (background) constraint</td><td class="">0</td></tr><tr><td class="">frz</td><td class="">The freezing level in meters. This is to tell PyDDA where to use ice particle fall speeds in the wind retrieval verus liquid.</td><td class="">5000.</td></tr><tr><td class="">filter_window</td><td class="">The window to apply the low pass filter on</td><td class="">5</td></tr><tr><td class="">mask_outside_opt</td><td class="">Mask all winds outside the Dual Doppler lobes</td><td class="">True</td></tr><tr><td class="">vel_name</td><td class="">The name of the velocity field in the radar data</td><td class="">‘corrected_velocity’</td></tr><tr><td class="">wind_tol</td><td class="">Stop optimization when the change in wind speeds between iterations is less than this value</td><td class=""></td></tr><tr><td class="">engine</td><td class="">PyDDA supports three backends for optimization: SciPy, JAX, and TensorFlow.</td><td class="">“scipy”</td></tr></tbody></table></div><div id="aFz6xE70lV" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">grids, params = pydda.retrieval.get_dd_wind_field(
    [cband_ds, xband_ds],
    Co=1,
    Cm=1024.0,
    Cx=1e-2,
    Cy=1e-2,
    Cz=1e-2,
    frz=5000.0,
    mask_outside_opt=True,
    upper_bc=1,
    vel_name=&quot;corrected_velocity&quot;,
    wind_tol=0.5,
    engine=&quot;scipy&quot;,
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="8vOj_h5LUikrrxNk8Mxlc" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>False
Calculating weights for radars 0 and 1
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Calculating weights for radars 1 and 0
Calculating weights for models...
Starting solver 
rmsVR = 4.581783784636946
Total points: 230030
The max of w_init is 0.0
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Total number of model points: 0
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
      0|225018.1796|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The gradient of the cost functions is 4.950675247614054
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
     10|  34.4083| 392.7000|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  16.9523
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Max change in w: 16.085
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The gradient of the cost functions is 0.6383715029246938
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
     20|   5.5491| 153.1899|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  13.4433
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Max change in w: 8.973
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The gradient of the cost functions is 0.6723123436679119
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
     30|   7.8224|  73.2793|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  14.9393
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Max change in w: 6.432
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The gradient of the cost functions is 0.582234285230258
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
     40|   7.3156|  57.5159|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  27.5207
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Max change in w: 6.491
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The gradient of the cost functions is 0.67846610972528
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
     50|   0.7408|  59.7204|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  32.4783
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The gradient of the cost functions is 0.30557291330146774
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
     60|   0.8089|  59.5485|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  32.1450
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The gradient of the cost functions is 0.30631472916262437
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
     70|   0.6816|  59.6884|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  33.0122
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The gradient of the cost functions is 0.30220215717698357
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
     80|   0.6993|  59.6325|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  32.8112
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The gradient of the cost functions is 0.2917681362090366
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
     90|   0.6757|  59.6542|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  33.1916
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The gradient of the cost functions is 0.2786782822470347
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
    100|   0.6440|  59.6514|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  33.7041
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The gradient of the cost functions is 0.2747334654695774
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
    110|   0.6382|  59.6543|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  33.9057
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The gradient of the cost functions is 1.0853226344610831
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
    120|   0.7693|  59.9989|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  37.4743
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Max change in w: 2.157
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The gradient of the cost functions is 0.2642855661530291
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
    130|   0.6523|  59.5959|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  35.5306
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The gradient of the cost functions is 0.2774927128972392
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
    140|   0.6649|  59.5624|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  36.3377
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The gradient of the cost functions is 0.25866632663912736
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
    150|   0.6552|  59.5546|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  36.1585
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The gradient of the cost functions is 0.26001276377032473
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
    160|   0.6707|  59.5210|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  36.9809
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The gradient of the cost functions is 0.2565228871631343
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
    170|   0.6690|  59.5196|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  37.0096
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The gradient of the cost functions is 0.256205445180571
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
    180|   0.6720|  59.5080|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  37.3294
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The gradient of the cost functions is 0.25450229363720805
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
    190|   0.6737|  59.5032|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  37.8427
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The gradient of the cost functions is 0.25435811988533746
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
    200|   0.6732|  59.4985|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  37.9252
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The gradient of the cost functions is 0.2528037367461622
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
    210|   0.6724|  59.4972|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  38.4874
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The gradient of the cost functions is 2.04331424012824
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
    220|   0.8126|  60.4458|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  42.4441
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The gradient of the cost functions is 0.2505531691485409
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
    230|   0.6688|  59.4925|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  38.4192
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Max change in w: 1.818
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The gradient of the cost functions is 0.2507347447809678
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
    240|  19.5743| 141.9802|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  89.3783
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The gradient of the cost functions is 0.24758103808464288
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
    250|   0.6621|  59.4905|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  38.8797
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The gradient of the cost functions is 0.24739519570110888
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
    260|   0.6613|  59.4911|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  38.9386
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The gradient of the cost functions is 0.24751217301828826
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
    270|   0.6592|  59.4892|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  39.1910
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The gradient of the cost functions is 4.291183664026434
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
    280|   1.2372|  60.5478|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  43.6677
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The gradient of the cost functions is 0.24638003909051479
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
    290|   0.6547|  59.4918|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  39.4391
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The gradient of the cost functions is 8.167839990431528
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
    300|   1.9076|  60.1367|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  43.3397
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The gradient of the cost functions is 0.4170924416185285
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
    310|   0.5864|  60.6746|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  44.1338
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The gradient of the cost functions is 0.24767287768719704
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
    320|   0.6517|  59.4861|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  39.8488
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The gradient of the cost functions is 0.24318754831199724
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
    330|   0.6012|  59.3620|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  39.8844
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Max change in w: 1.631
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The gradient of the cost functions is 0.4176164198347478
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
    340|   2.4095|  56.1453|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  42.3272
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The gradient of the cost functions is 0.4478134154295641
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
    350|   2.4223|  56.1240|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  42.2716
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The gradient of the cost functions is 0.29808338367150805
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
    360|   1.1264|  56.0815|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  42.4743
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The gradient of the cost functions is 0.2967212994946185
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
    370|   0.6689|  56.1071|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  43.2161
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The gradient of the cost functions is 0.2957556197546136
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
    380|   0.6716|  56.1042|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  43.1960
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The gradient of the cost functions is 0.2962155183804333
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
    390|   0.6717|  56.1040|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  43.1947
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The gradient of the cost functions is 0.20295191276306826
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
    400|   0.4706|  56.1542|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  43.4186
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The gradient of the cost functions is 0.20142559345196445
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
    410|   0.4704|  56.1540|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  43.4177
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Max change in w: 2.186
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The gradient of the cost functions is 0.269276801222094
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
    420|   0.4185|  56.1840|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  43.5425
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The gradient of the cost functions is 0.16413083971733644
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
    430|   0.4238|  56.1677|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  43.4769
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The gradient of the cost functions is 0.1634871368702149
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
    440|   0.4236|  56.1683|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  43.4792
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The gradient of the cost functions is 0.1641308436351384
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
    450|   0.4238|  56.1677|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  43.4769
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Applying low pass filter to wind field...
Done! Time = 359.2
</span></code></pre></div></div></div><div id="WpxiMeimNQ" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="visualize-the-results" class="relative group"><span class="heading-text">Visualize the results</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#visualize-the-results" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Let’s visualize the results. There are two ways in which this data can be visualized. One way is by using PyDDA’s visualization routines. You can also use xarray to visualize the output grids.</p></div><div id="Rh0PD7tskf" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">ds = grids[0]
ds</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Ywm-pPhtIR2R_dw-vTFWZ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="KCZv576zN9" class="relative group/block article-grid subgrid-gap col-screen"><p>If you are not able to get the above example to run on your laptop, pre-generated grid files are available <a target="_blank" href="https://drive.google.com/drive/folders/1LmfJeiYHcC_NGWuNAW7gAPMUNp7Z4UZq?usp=sharing" rel="noreferrer">here</a>.</p></div><div id="PkxY7UKRIk" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">ds.reflectivity.sel(z=2000, method=&quot;nearest&quot;).plot(
    cmap=&quot;pyart_ChaseSpectral&quot;, vmin=-10, vmax=60
)
ds.isel(time=0).sel(z=2000, method=&quot;nearest&quot;).w.plot.contour(
    x=&quot;x&quot;, y=&quot;y&quot;, levels=np.arange(1, 5, 1)
)
plt.xlim([-50000, 25000])
plt.ylim([-100000, -25000])</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="opWkL2YlNCfYfcEAjyQRO" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>(-100000.0, -25000.0)</span></code></div><img src="/erad2024/_preview/76/build/f366d7db622f92af636520eb6cd1584c.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="LhRHcmA9JW" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="saving-the-grids" class="relative group"><span class="heading-text">Saving the grids</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#saving-the-grids" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="ptf5mZlqLO" class="relative group/block article-grid subgrid-gap col-screen"><p>We can save the grids using either <em>xarray</em>’s or Py-ART’s functionality. To save the output grids,  use <em>pyart.io.write_grid</em> (PyART) functions. For example:</p></div><div id="inDrGsOucL" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Keep these lines if we can&#x27;t update PyDDA in time for ERAD
grids[0].attrs[&quot;radar_name&quot;] = &quot;C-band&quot;
del grids[0][&quot;time&quot;].attrs[&quot;units&quot;]
grids[1].attrs[&quot;radar_name&quot;] = &quot;X-band&quot;
del grids[1][&quot;time&quot;].attrs[&quot;units&quot;]

grids[0].to_netcdf(&quot;output_grid_Cband.nc&quot;)
grids[1].to_netcdf(&quot;output_grid_Xband.nc&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="25IK3TrLacgPoS0sPXq8v" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="wvcC3HnyMd" class="relative group/block article-grid subgrid-gap col-screen"><p>In order to load the grids again, we can just use PyART’s <em>pyart.io.read_grid</em> procedure.</p></div><div id="JKUr4wx20f" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># For live demos, load these since retrieval takes about 7 minutes
grids = [
    pydda.io.read_grid(&quot;output_grid_Cband.nc&quot;),
    pydda.io.read_grid(&quot;output_grid_Xband.nc&quot;),
]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="FNnGfuKYKFM3R4h6Gut66" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="kDSvNAjPYL" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="pydda-visualization-routines" class="relative group"><span class="heading-text">PyDDA visualization routines</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#pydda-visualization-routines" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>PyDDA’s visualization routines support the native PyART grids that are output by PyDDA. These routines have an advantage over xarray’s plotting routines for adjusting your barb and quiver size by specifying their using parameters that are in scales of kilometers. This makes it easier to plot barb and quiver plots compared to using xarray’s functionality.</p><p>For example, the documentation for <em>pydda.vis.plot_horiz_xsection_quiver</em> is given below.</p></div><div id="MFE1JMQZSV" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">?pydda.vis.plot_horiz_xsection_quiver</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="cfukGKKrqxlbWVpDTxwkO" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="HgSr4N9wgp" class="relative group/block article-grid subgrid-gap col-screen"><p>PyDDA has the following visualization routines for your sets of grids:</p><table><tbody><tr><th class="">Procedure</th><th class="">Description</th></tr><tr><td class="">plot_horiz_xsection_barbs(Grids[, ax, ...])</td><td class="">Horizontal cross section of winds from wind fields generated by PyDDA using barbs.</td></tr><tr><td class="">plot_xz_xsection_barbs(Grids[, ax, ...])</td><td class="">Cross section of winds from wind fields generated by PyDDA in the X-Z plane using barbs.</td></tr><tr><td class="">plot_yz_xsection_barbs(Grids[, ax, ...])</td><td class="">Cross section of winds from wind fields generated by PyDDA in the Y-Z plane using barbs.</td></tr><tr><td class="">plot_horiz_xsection_barbs_map(Grids[, ax, ...])</td><td class="">Horizontal cross section of winds from wind fields generated by PyDDA onto a geographical map using barbs.</td></tr><tr><td class="">plot_horiz_xsection_streamlines(Grids[, ax, ...])</td><td class="">Horizontal cross section of winds from wind fields generated by PyDDA using streamlines.</td></tr><tr><td class="">plot_xz_xsection_streamlines(Grids[, ax, ...])</td><td class="">Cross section of winds from wind fields generated by PyDDA in the X-Z plane using streamlines.</td></tr><tr><td class="">plot_yz_xsection_streamlines(Grids[, ax, ...])</td><td class="">Cross section of winds from wind fields generated by PyDDA in the Y-Z plane using streamlines.</td></tr><tr><td class="">plot_horiz_xsection_streamlines_map(Grids[, ...])</td><td class="">Horizontal cross section of winds from wind fields generated by PyDDA using streamlines.</td></tr><tr><td class="">plot_horiz_xsection_quiver(Grids[, ax, ...])</td><td class="">Horizontal cross section of winds from wind fields generated by PyDDA using quivers.</td></tr><tr><td class="">plot_xz_xsection_quiver(Grids[, ax, ...])</td><td class="">Cross section of winds from wind fields generated by PyDDA in the X-Z plane using quivers.</td></tr><tr><td class="">plot_yz_xsection_quiver(Grids[, ax, ...])</td><td class="">Cross section of winds from wind fields generated by PyDDA in the Y-Z plane using quivers.</td></tr><tr><td class="">plot_horiz_xsection_quiver_map(Grids[, ax, ...])</td><td class="">Horizontal cross section of winds from wind fields generated by PyDDA using quivers onto a geographical map.</td></tr></tbody></table></div><div id="hEan7OBZOj" class="relative group/block article-grid subgrid-gap col-screen"><p>Let’s show a quiver plot of this storm!</p><p>We have specified the quivers to be 4 km apart and moved the key to the bottom right with the specific length indicating 20 m/s winds. Let’s look at the 3 km level.</p></div><div id="bvRVRsUHrk" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">fig, ax = plt.subplots(1, 1, figsize=(6, 6))
pydda.vis.plot_horiz_xsection_quiver(
    grids,
    quiver_spacing_x_km=2.5,
    quiver_spacing_y_km=2.5,
    quiver_width=0.005,
    vmax=60,
    quiverkey_len=10.0,
    w_vel_contours=np.arange(1, 5, 1),
    level=4,
    cmap=&quot;pyart_ChaseSpectral&quot;,
    ax=ax,
    quiverkey_loc=&quot;bottom_right&quot;,
)
plt.xlim([-75, 25])
plt.ylim([-100, -25])</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="tXk-QiwK-NFpAv4ckGQtr" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>(-100.0, -25.0)</span></code></div><img src="/erad2024/_preview/76/build/fb5e3fe9fd4f09a2abf11c2eb08d0e7c.png" alt="&lt;Figure size 600x600 with 2 Axes&gt;"/></div></div><div id="CTt131JGPl" class="relative group/block article-grid subgrid-gap col-screen"><p>We can zoom in and modify the plot using standard matplotlib functions on the axis handle.</p><p>It is much easier to see updrafts being placed just to the outside of the strongest precipitation, with potential new growth in the north of the domain with updraft velocities &gt; 7 m/s. The precipitation is downwind of the updraft as we would expect.</p><p>Updrafts are right tilted due to the horizontal wind shear. The horizontal wind shear also causes the most intense precipitation to be downshear of the updraft. This therefore shows us that we have a good quality wind retrieval below about 5 km in altitude.</p></div><div id="a1rk6eC1CB" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">fig, ax = plt.subplots(1, 1, figsize=(6, 4))
pydda.vis.plot_xz_xsection_quiver(
    grids,
    quiver_spacing_x_km=2.0,
    quiver_spacing_z_km=1.0,
    quiver_width=0.005,
    quiverkey_len=10.0,
    w_vel_contours=np.arange(1, 5, 1),
    level=37,
    cmap=&quot;pyart_ChaseSpectral&quot;,
    ax=ax,
    quiverkey_loc=&quot;top_right&quot;,
)
ax.set_xlim([-75, -25])
ax.set_ylim([0, 13])</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="iwVSp8SwFZyea1coblALJ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>(0.0, 13.0)</span></code></div><img src="/erad2024/_preview/76/build/a3f47bd1f643896910bcbc8364b1338e.png" alt="&lt;Figure size 600x400 with 2 Axes&gt;"/></div></div><div id="DQLJjsyDGe" class="relative group/block article-grid subgrid-gap col-screen"><p>Let’s view a horizontal cross section with barbs!</p></div><div id="qwdKmRSq7Z" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">fig, ax = plt.subplots(1, 1, figsize=(6, 6))
pydda.vis.plot_horiz_xsection_barbs(
    grids,
    barb_spacing_x_km=6.0,
    barb_spacing_y_km=6.0,
    w_vel_contours=np.arange(1, 10, 1),
    level=6,
    cmap=&quot;pyart_ChaseSpectral&quot;,
    ax=ax,
)
# ax.set_xlim([-60, 0])
# ax.set_ylim([0, 70])</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="0ZnbYDyzRDd_t8BuC4_hM" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&lt;Axes: title={&#x27;center&#x27;: &#x27;PyDDA retreived winds @4.626 km&#x27;}, xlabel=&#x27;X [km]&#x27;, ylabel=&#x27;Y [km]&#x27;&gt;</span></code></div><img src="/erad2024/_preview/76/build/21583c340e74b2904553c5e09ceabb34.png" alt="&lt;Figure size 600x600 with 2 Axes&gt;"/></div></div><div id="VWWCB7Y33r" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">cband_ds[&quot;time&quot;][0].dt.year.values</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="7JIr3yaFasRQbo5oXSGbB" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>array(2024)</span></code></div></div></div><div></div><div class="flex pt-10 mb-10 space-x-4"><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/erad2024/_preview/76/environment"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="text-xs text-gray-500 dark:text-gray-400">Notebook Environment</div>Environment overview</div></div></a></div></main></article><script>((o,u)=>{if(!window.history.state||!window.history.state.key){let f=Math.random().toString(32).slice(2);window.history.replaceState({key:f},"")}try{let d=JSON.parse(sessionStorage.getItem(o)||"{}")[u||window.history.state.key];typeof d=="number"&&window.scrollTo(0,d)}catch(f){console.error(f),sessionStorage.removeItem(o)}})("positions", null)</script><link rel="modulepreload" href="/erad2024/_preview/76/build/entry.client-K6EYMIDZ.js"/><link rel="modulepreload" href="/erad2024/_preview/76/build/_shared/chunk-FBLNPC3V.js"/><link rel="modulepreload" href="/erad2024/_preview/76/build/_shared/chunk-XJN3BT5Q.js"/><link rel="modulepreload" href="/erad2024/_preview/76/build/_shared/chunk-2NH4LW52.js"/><link rel="modulepreload" href="/erad2024/_preview/76/build/_shared/chunk-RE6LVKIZ.js"/><link rel="modulepreload" href="/erad2024/_preview/76/build/_shared/chunk-YAIQ7LUU.js"/><link rel="modulepreload" href="/erad2024/_preview/76/build/_shared/chunk-HTHE5KDW.js"/><link rel="modulepreload" href="/erad2024/_preview/76/build/_shared/chunk-AAPZCWUN.js"/><link rel="modulepreload" href="/erad2024/_preview/76/build/_shared/chunk-QB27XQSF.js"/><link rel="modulepreload" href="/erad2024/_preview/76/build/_shared/chunk-JOLZ6LZB.js"/><link rel="modulepreload" href="/erad2024/_preview/76/build/_shared/chunk-MITWS4PZ.js"/><link rel="modulepreload" href="/erad2024/_preview/76/build/_shared/chunk-J6FHCSRC.js"/><link rel="modulepreload" href="/erad2024/_preview/76/build/_shared/chunk-EEG6LHX7.js"/><link rel="modulepreload" href="/erad2024/_preview/76/build/_shared/chunk-TEYZXLTV.js"/><link rel="modulepreload" href="/erad2024/_preview/76/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/erad2024/_preview/76/build/root-ZSMPVWLZ.js"/><link rel="modulepreload" href="/erad2024/_preview/76/build/_shared/chunk-OCW4QGPJ.js"/><link rel="modulepreload" href="/erad2024/_preview/76/build/routes/$-OW6NTZY2.js"/><script>window.__remixContext = {"url":"/retrieving-winds-with-pydda","state":{"loaderData":{"root":{"theme":"light","config":{"options":{"favicon":"/erad2024/_preview/76/build/favicon-acfb93087d4a89beb8ca4e581a280aa3.ico","logo":"/erad2024/_preview/76/build/erad_white_backgroun-e338dec3af6d3f9e4b0338b5544e669d.png","logo_dark":"/erad2024/_preview/76/build/erad_white_backgroun-e338dec3af6d3f9e4b0338b5544e669d.png"},"myst":"1.3.4","nav":[{"title":"Conference Home","url":"https://www.erad2024.it"},{"title":"Open Radar Community","url":"https://openradarscience.org"}],"actions":[{"title":"Launch Environment","url":"https://binder.projectpythia.org/v2/gh/openradar/erad2024/main?labpath=notebooks","internal":false,"static":false}],"projects":[{"open_access":true,"license":{"content":{"id":"Apache-2.0","name":"Apache License 2.0","osi":true,"free":true,"url":"https://opensource.org/licenses/Apache-2.0"},"code":{"id":"CC-BY-4.0","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true,"url":"https://creativecommons.org/licenses/by/4.0/"}},"abbreviations":{"ARM":"Atmospheric Radiation Measurement","NCAR":"National Center for Atmospheric Research"},"title":"ERAD 2024","authors":[{"nameParsed":{"literal":"Alfonso Ladino","given":"Alfonso","family":"Ladino"},"name":"Alfonso Ladino","orcid":"0000-0001-8081-7827","github":"aladinor","id":"contributors-myst-generated-uid-0"},{"nameParsed":{"literal":"Anna del Moral Méndez","given":"Anna","non_dropping_particle":"del","family":"Moral Méndez"},"name":"Anna del Moral Méndez","orcid":"0000-0002-5015-840X","id":"contributors-myst-generated-uid-1"},{"nameParsed":{"literal":"Brenda Javornik","given":"Brenda","family":"Javornik"},"name":"Brenda Javornik","github":"leavesntwigs","id":"contributors-myst-generated-uid-2"},{"nameParsed":{"literal":"Daniel Michelson","given":"Daniel","family":"Michelson"},"name":"Daniel Michelson","orcid":"0000-0003-3222-9881","github":"DanielMichelson","id":"contributors-myst-generated-uid-3"},{"nameParsed":{"literal":"Daniel Wolfensberger","given":"Daniel","family":"Wolfensberger"},"name":"Daniel Wolfensberger","github":"wolfidan","id":"contributors-myst-generated-uid-4"},{"nameParsed":{"literal":"Gionata Ghiggi","given":"Gionata","family":"Ghiggi"},"name":"Gionata Ghiggi","orcid":"0000-0002-0818-0865","github":"ghiggi","id":"contributors-myst-generated-uid-5"},{"nameParsed":{"literal":"Jen DeHart","given":"Jen","family":"DeHart"},"name":"Jen DeHart","orcid":"0000-0001-8536-4927","github":"jcdehart","id":"contributors-myst-generated-uid-6"},{"nameParsed":{"literal":"Jordi Figueras i Ventura","given":"Jordi Figueras","non_dropping_particle":"i","family":"Ventura"},"name":"Jordi Figueras i Ventura","orcid":"0000-0002-4949-422X","github":"jfigui","id":"contributors-myst-generated-uid-7"},{"nameParsed":{"literal":"Julian Giles","given":"Julian","family":"Giles"},"name":"Julian Giles","orcid":"0000-0001-8134-008X","github":"JulianGiles","id":"contributors-myst-generated-uid-8"},{"nameParsed":{"literal":"Kai Mühlbauer","given":"Kai","family":"Mühlbauer"},"name":"Kai Mühlbauer","orcid":"0000-0001-6599-1034","github":"kmuehlbauer","id":"contributors-myst-generated-uid-9"},{"nameParsed":{"literal":"Maxwell Grover","given":"Maxwell","family":"Grover"},"name":"Maxwell Grover","orcid":"0000-0002-0370-8974","github":"mgrover1","id":"contributors-myst-generated-uid-10"},{"nameParsed":{"literal":"Mike Dixon","given":"Mike","family":"Dixon"},"name":"Mike Dixon","orcid":"0000-0002-9597-9113","github":"mike-dixon","id":"contributors-myst-generated-uid-11"},{"nameParsed":{"literal":"Robert Jackson","given":"Robert","family":"Jackson"},"name":"Robert Jackson","orcid":"0000-0003-2518-1234","github":"rcjackson","id":"contributors-myst-generated-uid-12"},{"nameParsed":{"literal":"Scott Collis","given":"Scott","family":"Collis"},"name":"Scott Collis","orcid":"0000-0002-2303-687X","github":"scollis","id":"contributors-myst-generated-uid-13"},{"nameParsed":{"literal":"Ting-Yu Cha","given":"Ting-Yu","family":"Cha"},"name":"Ting-Yu Cha","orcid":"0000-0002-6292-8483","github":"tingyucha","id":"contributors-myst-generated-uid-14"}],"github":"https://github.com/openradar/erad2024","copyright":"2024","references":{"foundations":{"url":"https://projectpythia-mystmd.github.io/pythia-foundations"},"xarray":{"url":"https://docs.xarray.dev/en/stable"},"matplotlib":{"url":"https://matplotlib.org/stable"}},"thebe":{"binder":{"url":"https://binder.projectpythia.org/","provider":"github","repo":"openradar/erad2024","ref":"HEAD"}},"toc":[{"file":"README.md"},{"children":[{"file":"notebooks/how-to-cite.md"}],"title":"Preamble"},{"children":[{"file":"notebooks/data-access/intro-data-access.ipynb"}],"title":"Data Access"},{"children":[{"children":[{"file":"notebooks/xradar-pyart/xradar-basics.ipynb"}],"title":"XRadar"},{"children":[{"file":"notebooks/xradar-pyart/pyart-basics.ipynb"},{"file":"notebooks/wradlib/wradlib_clutter_beamblockage.ipynb"}],"title":"Py-ART and wradlib"},{"children":[{"pattern":"notebooks/baltrad/baltrad_short_course/*.ipynb"},{"pattern":"notebooks/baltrad/pyart2baltrad/*.ipynb"},{"file":"notebooks/baltrad/baltrad2wradlib/baltrad2wradlib.ipynb"}],"title":"BALTRAD"},{"children":[{"file":"notebooks/lrose/lrose-introduction.ipynb"}],"title":"LROSE"}],"title":"Radar Software Foundations"},{"children":[{"file":"notebooks/environment"}],"title":"Notebook Environment"},{"children":[{"file":"notebooks/Retrieving_winds_with_pydda.ipynb"}],"title":"Retrieving winds with PyDDA"}],"thumbnail":"/erad2024/_preview/76/build/0885e6292c6be2fd643fbc952d479a01.jpeg","exports":[],"bibliography":[],"index":"readme","pages":[{"level":1,"title":"Preamble"},{"slug":"how-to-cite","title":"How to Cite This Cookbook","description":"","date":"","thumbnail":"/erad2024/_preview/76/build/72a08caa5cbe5f9cce5999dbd1a81dfd.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Data Access"},{"slug":"intro-data-access","title":"Data Access Instructions","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Radar Software Foundations"},{"level":2,"title":"XRadar"},{"slug":"xradar-basics","title":"Xradar Basics","description":"","date":"","thumbnail":"/erad2024/_preview/76/build/xradar_logo-2a95fed8155191180f39cb57899abfeb.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"Py-ART and wradlib"},{"slug":"pyart-basics","title":"Py-ART Basics with Xradar","description":"","date":"","thumbnail":"/erad2024/_preview/76/build/arm_logo-b9b29a4a15afe87ea7324a177f3a080f.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"wradlib-clutter-beamblockage","title":"clutter and beamblockage","description":"","date":"","thumbnail":"/erad2024/_preview/76/build/wradlib_logo.svg-582403ae472ffe2fa62d74e3aaf0d55c.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"BALTRAD"},{"slug":"baltrad-io","title":"I/O model","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad-qc","title":"Quality Control","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad-drqc","title":"Quality Control using DR","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad-parallel-processing","title":"Parallel processing","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad-compositing","title":"Compositing","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad-pyart-rain-rate-example","title":"Rain Rate retrieval with Py-ART","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"pyart-baltrad-dealias-example","title":"Doppler Velocity Dealiasing with Py-ART","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad2wradlib","title":"Attenuation correction comparison with wradlib","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"LROSE"},{"slug":"lrose-introduction","title":"LROSE Echo and Wind Retrieval Tutorial","description":"","date":"","thumbnail":"/erad2024/_preview/76/build/8ad65774263f4fd7856f5554d1df1971.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"Notebook Environment"},{"slug":"environment","title":"Environment overview","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Retrieving winds with PyDDA"},{"slug":"retrieving-winds-with-pydda","title":"PyDDA tutorial","description":"","date":"","thumbnail":"/erad2024/_preview/76/build/5e2d147096249dc3a37da495168a9e9e.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"/erad2024/_preview/76"},"routes/$":{"config":{"options":{"favicon":"/erad2024/_preview/76/build/favicon-acfb93087d4a89beb8ca4e581a280aa3.ico","logo":"/erad2024/_preview/76/build/erad_white_backgroun-e338dec3af6d3f9e4b0338b5544e669d.png","logo_dark":"/erad2024/_preview/76/build/erad_white_backgroun-e338dec3af6d3f9e4b0338b5544e669d.png"},"myst":"1.3.4","nav":[{"title":"Conference Home","url":"https://www.erad2024.it"},{"title":"Open Radar Community","url":"https://openradarscience.org"}],"actions":[{"title":"Launch Environment","url":"https://binder.projectpythia.org/v2/gh/openradar/erad2024/main?labpath=notebooks","internal":false,"static":false}],"projects":[{"open_access":true,"license":{"content":{"id":"Apache-2.0","name":"Apache License 2.0","osi":true,"free":true,"url":"https://opensource.org/licenses/Apache-2.0"},"code":{"id":"CC-BY-4.0","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true,"url":"https://creativecommons.org/licenses/by/4.0/"}},"abbreviations":{"ARM":"Atmospheric Radiation Measurement","NCAR":"National Center for Atmospheric Research"},"title":"ERAD 2024","authors":[{"nameParsed":{"literal":"Alfonso Ladino","given":"Alfonso","family":"Ladino"},"name":"Alfonso Ladino","orcid":"0000-0001-8081-7827","github":"aladinor","id":"contributors-myst-generated-uid-0"},{"nameParsed":{"literal":"Anna del Moral Méndez","given":"Anna","non_dropping_particle":"del","family":"Moral Méndez"},"name":"Anna del Moral Méndez","orcid":"0000-0002-5015-840X","id":"contributors-myst-generated-uid-1"},{"nameParsed":{"literal":"Brenda Javornik","given":"Brenda","family":"Javornik"},"name":"Brenda Javornik","github":"leavesntwigs","id":"contributors-myst-generated-uid-2"},{"nameParsed":{"literal":"Daniel Michelson","given":"Daniel","family":"Michelson"},"name":"Daniel Michelson","orcid":"0000-0003-3222-9881","github":"DanielMichelson","id":"contributors-myst-generated-uid-3"},{"nameParsed":{"literal":"Daniel Wolfensberger","given":"Daniel","family":"Wolfensberger"},"name":"Daniel Wolfensberger","github":"wolfidan","id":"contributors-myst-generated-uid-4"},{"nameParsed":{"literal":"Gionata Ghiggi","given":"Gionata","family":"Ghiggi"},"name":"Gionata Ghiggi","orcid":"0000-0002-0818-0865","github":"ghiggi","id":"contributors-myst-generated-uid-5"},{"nameParsed":{"literal":"Jen DeHart","given":"Jen","family":"DeHart"},"name":"Jen DeHart","orcid":"0000-0001-8536-4927","github":"jcdehart","id":"contributors-myst-generated-uid-6"},{"nameParsed":{"literal":"Jordi Figueras i Ventura","given":"Jordi Figueras","non_dropping_particle":"i","family":"Ventura"},"name":"Jordi Figueras i Ventura","orcid":"0000-0002-4949-422X","github":"jfigui","id":"contributors-myst-generated-uid-7"},{"nameParsed":{"literal":"Julian Giles","given":"Julian","family":"Giles"},"name":"Julian Giles","orcid":"0000-0001-8134-008X","github":"JulianGiles","id":"contributors-myst-generated-uid-8"},{"nameParsed":{"literal":"Kai Mühlbauer","given":"Kai","family":"Mühlbauer"},"name":"Kai Mühlbauer","orcid":"0000-0001-6599-1034","github":"kmuehlbauer","id":"contributors-myst-generated-uid-9"},{"nameParsed":{"literal":"Maxwell Grover","given":"Maxwell","family":"Grover"},"name":"Maxwell Grover","orcid":"0000-0002-0370-8974","github":"mgrover1","id":"contributors-myst-generated-uid-10"},{"nameParsed":{"literal":"Mike Dixon","given":"Mike","family":"Dixon"},"name":"Mike Dixon","orcid":"0000-0002-9597-9113","github":"mike-dixon","id":"contributors-myst-generated-uid-11"},{"nameParsed":{"literal":"Robert Jackson","given":"Robert","family":"Jackson"},"name":"Robert Jackson","orcid":"0000-0003-2518-1234","github":"rcjackson","id":"contributors-myst-generated-uid-12"},{"nameParsed":{"literal":"Scott Collis","given":"Scott","family":"Collis"},"name":"Scott Collis","orcid":"0000-0002-2303-687X","github":"scollis","id":"contributors-myst-generated-uid-13"},{"nameParsed":{"literal":"Ting-Yu Cha","given":"Ting-Yu","family":"Cha"},"name":"Ting-Yu Cha","orcid":"0000-0002-6292-8483","github":"tingyucha","id":"contributors-myst-generated-uid-14"}],"github":"https://github.com/openradar/erad2024","copyright":"2024","references":{"foundations":{"url":"https://projectpythia-mystmd.github.io/pythia-foundations"},"xarray":{"url":"https://docs.xarray.dev/en/stable"},"matplotlib":{"url":"https://matplotlib.org/stable"}},"thebe":{"binder":{"url":"https://binder.projectpythia.org/","provider":"github","repo":"openradar/erad2024","ref":"HEAD"}},"toc":[{"file":"README.md"},{"children":[{"file":"notebooks/how-to-cite.md"}],"title":"Preamble"},{"children":[{"file":"notebooks/data-access/intro-data-access.ipynb"}],"title":"Data Access"},{"children":[{"children":[{"file":"notebooks/xradar-pyart/xradar-basics.ipynb"}],"title":"XRadar"},{"children":[{"file":"notebooks/xradar-pyart/pyart-basics.ipynb"},{"file":"notebooks/wradlib/wradlib_clutter_beamblockage.ipynb"}],"title":"Py-ART and wradlib"},{"children":[{"pattern":"notebooks/baltrad/baltrad_short_course/*.ipynb"},{"pattern":"notebooks/baltrad/pyart2baltrad/*.ipynb"},{"file":"notebooks/baltrad/baltrad2wradlib/baltrad2wradlib.ipynb"}],"title":"BALTRAD"},{"children":[{"file":"notebooks/lrose/lrose-introduction.ipynb"}],"title":"LROSE"}],"title":"Radar Software Foundations"},{"children":[{"file":"notebooks/environment"}],"title":"Notebook Environment"},{"children":[{"file":"notebooks/Retrieving_winds_with_pydda.ipynb"}],"title":"Retrieving winds with PyDDA"}],"thumbnail":"/erad2024/_preview/76/build/0885e6292c6be2fd643fbc952d479a01.jpeg","exports":[],"bibliography":[],"index":"readme","pages":[{"level":1,"title":"Preamble"},{"slug":"how-to-cite","title":"How to Cite This Cookbook","description":"","date":"","thumbnail":"/erad2024/_preview/76/build/72a08caa5cbe5f9cce5999dbd1a81dfd.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Data Access"},{"slug":"intro-data-access","title":"Data Access Instructions","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Radar Software Foundations"},{"level":2,"title":"XRadar"},{"slug":"xradar-basics","title":"Xradar Basics","description":"","date":"","thumbnail":"/erad2024/_preview/76/build/xradar_logo-2a95fed8155191180f39cb57899abfeb.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"Py-ART and wradlib"},{"slug":"pyart-basics","title":"Py-ART Basics with Xradar","description":"","date":"","thumbnail":"/erad2024/_preview/76/build/arm_logo-b9b29a4a15afe87ea7324a177f3a080f.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"wradlib-clutter-beamblockage","title":"clutter and beamblockage","description":"","date":"","thumbnail":"/erad2024/_preview/76/build/wradlib_logo.svg-582403ae472ffe2fa62d74e3aaf0d55c.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"BALTRAD"},{"slug":"baltrad-io","title":"I/O model","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad-qc","title":"Quality Control","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad-drqc","title":"Quality Control using DR","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad-parallel-processing","title":"Parallel processing","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad-compositing","title":"Compositing","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad-pyart-rain-rate-example","title":"Rain Rate retrieval with Py-ART","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"pyart-baltrad-dealias-example","title":"Doppler Velocity Dealiasing with Py-ART","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad2wradlib","title":"Attenuation correction comparison with wradlib","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"LROSE"},{"slug":"lrose-introduction","title":"LROSE Echo and Wind Retrieval Tutorial","description":"","date":"","thumbnail":"/erad2024/_preview/76/build/8ad65774263f4fd7856f5554d1df1971.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"Notebook Environment"},{"slug":"environment","title":"Environment overview","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Retrieving winds with PyDDA"},{"slug":"retrieving-winds-with-pydda","title":"PyDDA tutorial","description":"","date":"","thumbnail":"/erad2024/_preview/76/build/5e2d147096249dc3a37da495168a9e9e.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"page":{"kind":"Notebook","sha256":"9e246a55140f403337c85c4bc83b5c31aa5868ea7f64f2647e388b1dcfba5bea","slug":"retrieving-winds-with-pydda","location":"/notebooks/Retrieving_winds_with_pydda.ipynb","dependencies":[],"frontmatter":{"title":"PyDDA tutorial","content_includes_title":false,"authors":[{"nameParsed":{"literal":"Alfonso Ladino","given":"Alfonso","family":"Ladino"},"name":"Alfonso Ladino","orcid":"0000-0001-8081-7827","github":"aladinor","id":"contributors-myst-generated-uid-0"},{"nameParsed":{"literal":"Anna del Moral Méndez","given":"Anna","non_dropping_particle":"del","family":"Moral Méndez"},"name":"Anna del Moral Méndez","orcid":"0000-0002-5015-840X","id":"contributors-myst-generated-uid-1"},{"nameParsed":{"literal":"Brenda Javornik","given":"Brenda","family":"Javornik"},"name":"Brenda Javornik","github":"leavesntwigs","id":"contributors-myst-generated-uid-2"},{"nameParsed":{"literal":"Daniel Michelson","given":"Daniel","family":"Michelson"},"name":"Daniel Michelson","orcid":"0000-0003-3222-9881","github":"DanielMichelson","id":"contributors-myst-generated-uid-3"},{"nameParsed":{"literal":"Daniel Wolfensberger","given":"Daniel","family":"Wolfensberger"},"name":"Daniel Wolfensberger","github":"wolfidan","id":"contributors-myst-generated-uid-4"},{"nameParsed":{"literal":"Gionata Ghiggi","given":"Gionata","family":"Ghiggi"},"name":"Gionata Ghiggi","orcid":"0000-0002-0818-0865","github":"ghiggi","id":"contributors-myst-generated-uid-5"},{"nameParsed":{"literal":"Jen DeHart","given":"Jen","family":"DeHart"},"name":"Jen DeHart","orcid":"0000-0001-8536-4927","github":"jcdehart","id":"contributors-myst-generated-uid-6"},{"nameParsed":{"literal":"Jordi Figueras i Ventura","given":"Jordi Figueras","non_dropping_particle":"i","family":"Ventura"},"name":"Jordi Figueras i Ventura","orcid":"0000-0002-4949-422X","github":"jfigui","id":"contributors-myst-generated-uid-7"},{"nameParsed":{"literal":"Julian Giles","given":"Julian","family":"Giles"},"name":"Julian Giles","orcid":"0000-0001-8134-008X","github":"JulianGiles","id":"contributors-myst-generated-uid-8"},{"nameParsed":{"literal":"Kai Mühlbauer","given":"Kai","family":"Mühlbauer"},"name":"Kai Mühlbauer","orcid":"0000-0001-6599-1034","github":"kmuehlbauer","id":"contributors-myst-generated-uid-9"},{"nameParsed":{"literal":"Maxwell Grover","given":"Maxwell","family":"Grover"},"name":"Maxwell Grover","orcid":"0000-0002-0370-8974","github":"mgrover1","id":"contributors-myst-generated-uid-10"},{"nameParsed":{"literal":"Mike Dixon","given":"Mike","family":"Dixon"},"name":"Mike Dixon","orcid":"0000-0002-9597-9113","github":"mike-dixon","id":"contributors-myst-generated-uid-11"},{"nameParsed":{"literal":"Robert Jackson","given":"Robert","family":"Jackson"},"name":"Robert Jackson","orcid":"0000-0003-2518-1234","github":"rcjackson","id":"contributors-myst-generated-uid-12"},{"nameParsed":{"literal":"Scott Collis","given":"Scott","family":"Collis"},"name":"Scott Collis","orcid":"0000-0002-2303-687X","github":"scollis","id":"contributors-myst-generated-uid-13"},{"nameParsed":{"literal":"Ting-Yu Cha","given":"Ting-Yu","family":"Cha"},"name":"Ting-Yu Cha","orcid":"0000-0002-6292-8483","github":"tingyucha","id":"contributors-myst-generated-uid-14"}],"open_access":true,"license":{"content":{"id":"Apache-2.0","name":"Apache License 2.0","osi":true,"free":true,"url":"https://opensource.org/licenses/Apache-2.0"},"code":{"id":"CC-BY-4.0","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true,"url":"https://creativecommons.org/licenses/by/4.0/"}},"github":"https://github.com/openradar/erad2024","copyright":"2024","abbreviations":{"ARM":"Atmospheric Radiation Measurement","NCAR":"National Center for Atmospheric Research"},"thumbnail":"/erad2024/_preview/76/build/5e2d147096249dc3a37da495168a9e9e.png","exports":[{"format":"ipynb","filename":"Retrieving_winds_with_pydda.ipynb","url":"/erad2024/_preview/76/build/Retrieving_winds_wit-0ee2c7be9374f70093b67df6962ae5da.ipynb"}]},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"image","url":"/erad2024/_preview/76/build/5e2d147096249dc3a37da495168a9e9e.png","alt":"PyDDA logo","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Z4ryd0XqXm","urlSource":"https://openradarscience.org/PyDDA/_images/logo.png"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"PyDDA is an open source Python package for retrieving winds using Multiple Doppler analyses. It uses the 3D variational technique for retrieving winds from multiple Doppler radars. It uses Py-ART Grid Objects as inputs. Therefore, preprocessed and gridded data are needed for PyDDA to run.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"cBS1mJaTyo"}],"key":"tajbwJgJaN"},{"type":"heading","depth":2,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"3D variational technique","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"LkqtK2ki26"}],"identifier":"id-3d-variational-technique","label":"3D variational technique","html_id":"id-3d-variational-technique","implicit":true,"key":"VjeiQlFVpw"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"PyDDA uses a 3D variational technique to retrieve the 3D wind field. We will leave students that are interested in more information about these technqiues two references to read at the end of this notebook. A basic introduction to 3D variational analysis is given here.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"aBc7gvzWue"}],"key":"mijCActFXm"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"PyDDA minimizes a cost function ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"WXa3sz0gwv"},{"type":"inlineMath","value":"J","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eJ\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eJ\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.09618em;\"\u003eJ\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"Y1M7JXV9yj"},{"type":"text","value":" that corresponds to various penalties including:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"eBi9504Guq"}],"key":"fvlSckiF6D"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"inlineMath","value":"J_{m} = \\nabla \\cdot V","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003eJ\u003c/mi\u003e\u003cmi\u003em\u003c/mi\u003e\u003c/msub\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmi mathvariant=\"normal\"\u003e∇\u003c/mi\u003e\u003cmo\u003e⋅\u003c/mo\u003e\u003cmi\u003eV\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eJ_{m} = \\nabla \\cdot V\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.09618em;\"\u003eJ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0962em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003em\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e∇\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e⋅\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.22222em;\"\u003eV\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"mRMTIhqLFu"},{"type":"text","value":" which corresponds to the mass continuity equation.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"dPt3Hp0K02"}],"key":"tAPzZtSQ9t"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"inlineMath","value":"J_{o} = ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003eJ\u003c/mi\u003e\u003cmi\u003eo\u003c/mi\u003e\u003c/msub\u003e\u003cmo\u003e=\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eJ_{o} = \u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.09618em;\"\u003eJ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0962em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003eo\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"y8UFe7HLLI"},{"type":"text","value":" RMSE between radar winds and analysis winds.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Al0KBXiLVP"}],"key":"hFQ8RKHt5P"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"inlineMath","value":"J_{b} = ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003eJ\u003c/mi\u003e\u003cmi\u003eb\u003c/mi\u003e\u003c/msub\u003e\u003cmo\u003e=\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eJ_{b} = \u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.09618em;\"\u003eJ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3361em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0962em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003eb\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"D4z8tGcmsr"},{"type":"text","value":" RMSE between sounding winds and analysis winds.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"j9cx33B1X5"}],"key":"kdbv1MRyGP"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"inlineMath","value":"J_{s} = \\nabla^2 V","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003eJ\u003c/mi\u003e\u003cmi\u003es\u003c/mi\u003e\u003c/msub\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmsup\u003e\u003cmi mathvariant=\"normal\"\u003e∇\u003c/mi\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msup\u003e\u003cmi\u003eV\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eJ_{s} = \\nabla^2 V\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.09618em;\"\u003eJ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0962em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003es\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8141em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e∇\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8141em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.22222em;\"\u003eV\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"RS2sMSGzHq"},{"type":"text","value":" which corresponds to the smoothness of wind field to eliminate high-frequency noise that can result from numerical instability.","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"f5UkE2ksYY"}],"key":"Rp50Pq7s67"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"The cost function to be minimized is a weighted sum of the various cost functions in PyDDA and are represented in Equation (1):","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"SRWSLPMlJ4"}],"key":"YOhGVyEK7X"},{"type":"paragraph","children":[{"type":"text","value":"$J = c_{m}J_{m} + c_{o}J_{o} + c_{b}J_{b} + c_{s}J_{s} + ...$ (1)","key":"rm0lBHUR4E"}],"key":"aoFundzYvk"},{"type":"heading","depth":3,"position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"References","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"HSNa3wMNL8"}],"identifier":"references","label":"References","html_id":"references","implicit":true,"key":"Dkzf8ac2KW"}],"key":"KNqvhDpJSW"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Imports","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sjSUKlEd4N"}],"identifier":"imports","label":"Imports","html_id":"imports","implicit":true,"key":"qpmOuRMOjd"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Let’s import the necessary libraries. For now, we’ll need PyART, glob, matplotlib, and PyDDA.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TmEqRmpzLy"}],"key":"xHlvcDdmy5"}],"key":"RcFhEw7TWo"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-08-15T13:08:53.555706Z","iopub.status.busy":"2024-08-15T13:08:53.555516Z","iopub.status.idle":"2024-08-15T13:09:00.098348Z","shell.execute_reply":"2024-08-15T13:09:00.097813Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"import glob\n\nimport pyart\nimport matplotlib.pyplot as plt\nimport pydda\nimport warnings\nimport numpy as np\nimport pandas as pd\nimport fsspec\nimport cartopy.crs as ccrs\n\nwarnings.filterwarnings(\"ignore\")","key":"lO7OSMxFqq"},{"type":"output","id":"cFapGrkRe9zYJlwaQ1pqz","data":[{"name":"stdout","output_type":"stream","text":"\n## You are using the Python ARM Radar Toolkit (Py-ART), an open source\n## library for working with weather radar data. Py-ART is partly\n## supported by the U.S. Department of Energy as part of the Atmospheric\n## Radiation Measurement (ARM) Climate Research Facility, an Office of\n## Science user facility.\n##\n## If you use this software to prepare a publication, please cite:\n##\n##     JJ Helmus and SM Collis, JORS 2016, doi: 10.5334/jors.119\n\n"},{"name":"stderr","output_type":"stream","text":"Downloading file 'example_grid_radar0.nc' from 'https://github.com/rcjackson/pydda-sample-data/raw/main/pydda-sample-data/example_grid_radar0.nc' to '/home/jovyan/.cache/pydda'.\n"},{"name":"stderr","output_type":"stream","text":"Downloading file 'example_grid_radar1.nc' from 'https://github.com/rcjackson/pydda-sample-data/raw/main/pydda-sample-data/example_grid_radar1.nc' to '/home/jovyan/.cache/pydda'.\n"},{"name":"stderr","output_type":"stream","text":"Downloading file 'test_sounding.cdf' from 'https://github.com/rcjackson/pydda-sample-data/raw/main/pydda-sample-data/test_sounding.cdf' to '/home/jovyan/.cache/pydda'.\n"},{"name":"stderr","output_type":"stream","text":"Downloading file 'test_era_interim.nc' from 'https://github.com/rcjackson/pydda-sample-data/raw/main/pydda-sample-data/test_era_interim.nc' to '/home/jovyan/.cache/pydda'.\n"},{"name":"stdout","output_type":"stream","text":"Welcome to PyDDA 2.0.0\nIf you are using PyDDA in your publications, please cite:\nJackson et al. (2020) Journal of Open Research Science\nDetecting Jax...\nJax engine enabled!\nDetecting TensorFlow...\nTensorFlow detected. Checking for tensorflow-probability...\nTensorFlow-probability detected. TensorFlow engine enabled!\n"}],"key":"RhuErRRJu3"}],"key":"o59xtiQOM6"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Case study","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WXCsoMet51"}],"identifier":"case-study","label":"Case study","html_id":"case-study","implicit":true,"key":"e9YsDJLwCP"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We will examine the same case study over Italy that has been used for this entire short course. For this case in May 2024, we had weak convective cells in the region of","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TcXGij7S9X"}],"key":"w9BwtFXQ5r"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"For this case, we had coverage of the storm from two radars, a MeteoSwiss C-band radar near Monte Lema, CH and an X-band radar from ARPA Lombardia located about 50 km away in Milano, IT.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Py2DBqUy5b"}],"key":"i8RF54jg7K"}],"key":"aX1OCvTdrN"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"C-band Radar","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Gm5lam1jM8"}],"identifier":"c-band-radar","label":"C-band Radar","html_id":"c-band-radar","implicit":true,"key":"qp9O81WIxm"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We need to load and preprocess the C-band radar data first. In order to do so, we first need to load the MeteoSwiss C-band radar file.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"MR1o3ZPhjM"}],"key":"NinzS1IZWy"}],"key":"N4bb5XVtDc"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-08-15T13:09:00.100954Z","iopub.status.busy":"2024-08-15T13:09:00.100301Z","iopub.status.idle":"2024-08-15T13:09:02.319585Z","shell.execute_reply":"2024-08-15T13:09:02.319063Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Set the URL and path for the cloud\nURL = \"https://js2.jetstream-cloud.org:8001/\"\npath = f\"pythia/radar/erad2024\"\n\n\nfs = fsspec.filesystem(\"s3\", anon=True, client_kwargs=dict(endpoint_url=URL))\n\nfs.glob(f\"{path}/*\")\n\nfiles = fs.glob(\"pythia/radar/erad2024/dda_data/*\")\nlocal_files = [\n    fsspec.open_local(\n        f\"simplecache::{URL}{i}\", s3={\"anon\": True}, filecache={\"cache_storage\": \".\"}\n    )\n    for i in files\n]\n\nradar = pyart.io.read(local_files[1])","key":"i7OhjxeXgy"},{"type":"output","id":"qIlm9liN7RHVD-b2NAdwy","data":[],"key":"lWXPImxib5"}],"key":"UAuyfvliQ3"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-08-15T13:09:02.322246Z","iopub.status.busy":"2024-08-15T13:09:02.321668Z","iopub.status.idle":"2024-08-15T13:09:02.326392Z","shell.execute_reply":"2024-08-15T13:09:02.325929Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"radar.info()","key":"UxS0PjQ8Ha"},{"type":"output","id":"SXJLJ-_kmlrcG0_VRCxv1","data":[{"name":"stdout","output_type":"stream","text":"altitude:\n\tdata: \u003cndarray of type: float32 and shape: (1,)\u003e\n\tlong_name: Altitude\n\tunits: meters\n\tstandard_name: Altitude\n\tpositive: up\naltitude_agl: None\nantenna_transition: None\nazimuth:\n\tdata: \u003cndarray of type: float32 and shape: (7200,)\u003e\n\tlong_name: azimuth_angle_from_true_north\n\tunits: degrees\n\tstandard_name: beam_azimuth_angle\n\taxis: radial_azimuth_coordinate\n\tcomment: Azimuth of antenna relative to true north\nelevation:\n\tdata: \u003cndarray of type: float32 and shape: (7200,)\u003e\n\tlong_name: elevation_angle_from_horizontal_plane\n\tunits: degrees\n\tstandard_name: beam_elevation_angle\n\taxis: radial_elevation_coordinate\n\tcomment: Elevation of antenna relative to the horizontal plane\nfields:\n\treflectivity:\n\t\tdata: \u003cndarray of type: float64 and shape: (7200, 492)\u003e\n\t\t_FillValue: -9999.0\n\t\tlong_name: Horizontal Reflectivity\n\t\tunits: dBZ\n\t\tstandard_name: horizontal_reflectivity\n\t\tcoordinates: elevation azimuth range\n\tsignal_to_noise_ratio:\n\t\tdata: \u003cndarray of type: float64 and shape: (7200, 492)\u003e\n\t\t_FillValue: -9999.0\n\t\tlong_name: Signal to noise ratio\n\t\tunits: dB\n\t\tstandard_name: signal_to_noise_ratio\n\t\tcoordinates: elevation azimuth range\n\treflectivity_vv:\n\t\tdata: \u003cndarray of type: float64 and shape: (7200, 492)\u003e\n\t\t_FillValue: -9999.0\n\t\tlong_name: Vertical Reflectivity\n\t\tunits: dBZ\n\t\tstandard_name: vertical_reflectivity\n\t\tcoordinates: elevation azimuth range\n\tdifferential_reflectivity:\n\t\tdata: \u003cndarray of type: float64 and shape: (7200, 492)\u003e\n\t\t_FillValue: -9999.0\n\t\tlong_name: Differential reflectivity\n\t\tunits: dB\n\t\tstandard_name: differential_reflectivity\n\t\tcoordinates: elevation azimuth range\n\tuncorrected_cross_correlation_ratio:\n\t\tdata: \u003cndarray of type: float64 and shape: (7200, 492)\u003e\n\t\t_FillValue: -9999.0\n\t\tlong_name: Uncorrected copolar correlation coefficient (RHOHV)\n\t\tunits: -\n\t\tstandard_name: copolar_correlation_coefficient\n\t\tcoordinates: elevation azimuth range\n\tuncorrected_differential_phase:\n\t\tdata: \u003cndarray of type: float64 and shape: (7200, 492)\u003e\n\t\t_FillValue: -9999.0\n\t\tlong_name: Uncorrected differential propagation phase\n\t\tunits: deg\n\t\tstandard_name: differential_phase\n\t\tcoordinates: elevation azimuth range\n\tvelocity:\n\t\tdata: \u003cndarray of type: float64 and shape: (7200, 492)\u003e\n\t\t_FillValue: -9999.0\n\t\tlong_name: Mean Doppler velocity\n\t\tunits: m/s\n\t\tstandard_name: mean_Doppler_velocity\n\t\tcoordinates: elevation azimuth range\n\tspectrum_width:\n\t\tdata: \u003cndarray of type: float64 and shape: (7200, 492)\u003e\n\t\t_FillValue: -9999.0\n\t\tlong_name: Doppler spectrum width\n\t\tunits: m/s\n\t\tstandard_name: Doppler_spectrum_width\n\t\tcoordinates: elevation azimuth range\n\treflectivity_hh_clut:\n\t\tdata: \u003cndarray of type: float64 and shape: (7200, 492)\u003e\n\t\t_FillValue: -9999.0\n\tcorrected_velocity:\n\t\tdata: \u003cndarray of type: float64 and shape: (7200, 492)\u003e\n\t\t_FillValue: -9999.0\n\t\tlong_name: Corrected mean doppler velocity\n\t\tunits: meters_per_second\n\t\tstandard_name: corrected_radial_velocity_of_scatterers_away_from_instrument\n\t\tcoordinates: elevation azimuth range\n\t\tvalid_min: -24.75\n\t\tvalid_max: 24.75\nfixed_angle:\n\tdata: \u003cndarray of type: float32 and shape: (20,)\u003e\n\tlong_name: Target angle for sweep\n\tunits: degrees\n\tstandard_name: target_fixed_angle\ninstrument_parameters:\n\tfrequency:\n\t\tdata: \u003cndarray of type: float32 and shape: (1,)\u003e\n\t\tlong_name: Radiation frequency\n\t\tunits: s-1\n\t\tmeta_group: instrument_parameters\n\tpulse_width:\n\t\tdata: \u003cndarray of type: float32 and shape: (7200,)\u003e\n\t\tlong_name: Pulse width\n\t\tunits: seconds\n\t\tcomments: Pulse width\n\t\tmeta_group: instrument_parameters\n\tnyquist_velocity:\n\t\tdata: \u003cndarray of type: float32 and shape: (7200,)\u003e\n\t\tlong_name: Nyquist velocity\n\t\tunits: m/s\n\t\tcomments: Unambiguous velocity\n\t\tmeta_group: instrument_parameters\n\tradar_beam_width_h:\n\t\tdata: \u003cndarray of type: float32 and shape: (1,)\u003e\n\t\tlong_name: Antenna beam width H polarization\n\t\tunits: degrees\n\t\tmeta_group: radar_parameters\n\tradar_beam_width_v:\n\t\tdata: \u003cndarray of type: float32 and shape: (1,)\u003e\n\t\tlong_name: Antenna beam width V polarization\n\t\tunits: degrees\n\t\tmeta_group: radar_parameters\nlatitude:\n\tdata: \u003cndarray of type: float32 and shape: (1,)\u003e\n\tlong_name: Latitude\n\tunits: degrees_north\n\tstandard_name: Latitude\nlongitude:\n\tdata: \u003cndarray of type: float32 and shape: (1,)\u003e\n\tlong_name: Longitude\n\tunits: degrees_east\n\tstandard_name: Longitude\nnsweeps: 20\nngates: 492\nnrays: 7200\nradar_calibration: None\nrange:\n\tdata: \u003cndarray of type: float32 and shape: (492,)\u003e\n\tlong_name: range_to_measurement_volume\n\tunits: meters\n\tstandard_name: projection_range_coordinate\n\taxis: radial_range_coordinate\n\tspacing_is_constant: true\n\tcomment: Coordinate variable for range. Range to center of each bin.\nscan_rate: None\nscan_type: ppi\nsweep_end_ray_index:\n\tdata: \u003cndarray of type: int32 and shape: (20,)\u003e\n\tlong_name: Index of last ray in sweep, 0-based\n\tunits: count\nsweep_mode:\n\tdata: \u003cndarray of type: |S1 and shape: (20, 32)\u003e\n\tlong_name: Sweep mode\n\tunits: unitless\n\tstandard_name: sweep_mode\n\tcomment: Options are: \"sector\", \"coplane\", \"rhi\", \"vertical_pointing\", \"idle\", \"azimuth_surveillance\", \"elevation_surveillance\", \"sunscan\", \"pointing\", \"manual_ppi\", \"manual_rhi\"\nsweep_number:\n\tdata: \u003cndarray of type: int64 and shape: (20,)\u003e\n\tlong_name: Sweep number\n\tunits: count\n\tstandard_name: sweep_number\nsweep_start_ray_index:\n\tdata: \u003cndarray of type: int32 and shape: (20,)\u003e\n\tlong_name: Index of first ray in sweep, 0-based\n\tunits: count\ntarget_scan_rate: None\ntime:\n\tdata: \u003cndarray of type: float64 and shape: (7200,)\u003e\n\tlong_name: time_in_seconds_since_volume_start\n\tunits: seconds since 1970-01-01T00:00:00Z\n\tstandard_name: time\n\tcalendar: gregorian\n\tcomment: Coordinate variable for time. Time at the center of each ray, in fractional seconds since the global variable time_coverage_start\nmetadata:\n\tConventions: CF/Radial instrument_parameters\n\tversion: 1.3\n\ttitle: \n\tinstitution: \n\treferences: \n\tsource: \n\tcomment: \n\tinstrument_name: L\n\tfield_names: reflectivity, signal_to_noise_ratio, reflectivity_vv, differential_reflectivity, uncorrected_cross_correlation_ratio, uncorrected_differential_phase, velocity, spectrum_width, reflectivity_hh_clut\n\thistory: \n\tvolume_number: 0\n\tplatform_type: fixed\n\tinstrument_type: radar\n\tprimary_axis: axis_z\n"}],"key":"JblNGaAswo"}],"key":"BBNabZHHDd"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Dealiasing","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"H2t924l1L7"}],"identifier":"dealiasing","label":"Dealiasing","html_id":"dealiasing","implicit":true,"key":"ukGkw8jbcr"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The next step is to dealias the radar data. We will follow the steps that were shown eariler in this course to dealias the radar data. Dealiasing is covered in detail in the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YkskO85k8J"},{"type":"link","url":"https://projectpythia.org/radar-cookbook/notebooks/foundations/pyart-corrections.html","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Radar Cookbook","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uXSVNXWLbP"}],"urlSource":"https://projectpythia.org/radar-cookbook/notebooks/foundations/pyart-corrections.html","key":"tDzytLqYIU"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XTxlWqWAUd"}],"key":"JUdlvkHzaR"}],"key":"L0yGaEQtPp"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-08-15T13:09:02.328360Z","iopub.status.busy":"2024-08-15T13:09:02.328195Z","iopub.status.idle":"2024-08-15T13:09:03.708989Z","shell.execute_reply":"2024-08-15T13:09:03.708456Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"nyquist = radar.instrument_parameters[\"nyquist_velocity\"][\"data\"][0]\nvel_dealias = pyart.correct.dealias_region_based(\n    radar,\n    vel_field=\"velocity\",\n    nyquist_vel=nyquist,\n    centered=True,\n)\nradar.add_field(\"corrected_velocity\", vel_dealias, replace_existing=True)","key":"vkolrkMSnR"},{"type":"output","id":"psA6JhEOK7uaHS7Zmof1Y","data":[],"key":"j3Z7lsTZ7W"}],"key":"wtpDs5ARz2"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot the data to make sure dealiasing succeeded.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HHPenW3DAY"}],"key":"w1sk5ipkVg"}],"key":"yLLYtWISGK"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-08-15T13:09:03.711773Z","iopub.status.busy":"2024-08-15T13:09:03.711290Z","iopub.status.idle":"2024-08-15T13:09:04.010245Z","shell.execute_reply":"2024-08-15T13:09:04.009681Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"display = pyart.graph.RadarDisplay(radar)\ndisplay.plot(\"reflectivity\", vmin=-20, vmax=70, cmap=\"pyart_ChaseSpectral\", sweep=0)","key":"m08C2mfhki"},{"type":"output","id":"sQiNpP61XZK8JvE9MUuAs","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"71c61a2e5e9269248c9fea6850f46800","path":"/erad2024/_preview/76/build/71c61a2e5e9269248c9fea6850f46800.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"Jked98mxCn"}],"key":"syndApYARq"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-08-15T13:09:04.012607Z","iopub.status.busy":"2024-08-15T13:09:04.012243Z","iopub.status.idle":"2024-08-15T13:09:04.304546Z","shell.execute_reply":"2024-08-15T13:09:04.303990Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"display = pyart.graph.RadarDisplay(radar)\ndisplay.plot(\"corrected_velocity\", vmin=-30, vmax=30, cmap=\"twilight_shifted\", sweep=0)","key":"AO8LNmflHF"},{"type":"output","id":"OHSGzKu3tiJWC8-R7hjcu","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7d3f182e14091fe346164628134a6ce1","path":"/erad2024/_preview/76/build/7d3f182e14091fe346164628134a6ce1.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"ApHBZX9xwS"}],"key":"gyMBeXIKlK"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Some regions did not dealias correctly, like in the region around (-100 km, -100 km) where gate-to-gate shear exceeds the Nyquist interval in the absence of . The region-based algorithm is very sensitive to speckles that are present in the above image. Let’s despeckle the above radar data to remove some artifacts.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"isxi5tXNlU"}],"key":"kCTO6l0RM6"}],"key":"ekqP9U203S"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-08-15T13:09:04.306680Z","iopub.status.busy":"2024-08-15T13:09:04.306495Z","iopub.status.idle":"2024-08-15T13:09:06.761122Z","shell.execute_reply":"2024-08-15T13:09:06.760519Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"gatefilter = pyart.filters.GateFilter(radar)\ngatefilter.exclude_above(\"spectrum_width\", 7)\n# gatefilter.exclude_below('cross_correlation_ratio', 0.8)\ngatefilter = pyart.correct.despeckle_field(\n    radar, \"reflectivity\", gatefilter=gatefilter, size=36\n)\ndisplay = pyart.graph.RadarDisplay(radar)\ndisplay.plot(\n    \"reflectivity\",\n    vmin=-20,\n    vmax=70,\n    gatefilter=gatefilter,\n    cmap=\"pyart_ChaseSpectral\",\n    sweep=0,\n)","key":"eQoHFiCS2f"},{"type":"output","id":"YqMYX0cGCUa9BQnpQIjtG","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"dc4f75bac0607032af2cea9fa5783dbd","path":"/erad2024/_preview/76/build/dc4f75bac0607032af2cea9fa5783dbd.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"mN5Qmg0esT"}],"key":"VbYe5rEba2"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s also tweak the settings of the region based dealiasing. Currently, the dealiasing will attempt to dealias regions that are separated by 100 masked gates in the radial. We will disable this feature by setting ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XXvjN15q2k"},{"type":"inlineCode","value":"skip_between_rays","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kCdBJXlBVy"},{"type":"text","value":" to 0 so that all dealiasing across filtered gates along the azimuth is disabled.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OsgWjjk4ei"}],"key":"ZVrxRZnQ5a"}],"key":"YxH3nWxkJ2"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-08-15T13:09:06.763306Z","iopub.status.busy":"2024-08-15T13:09:06.763114Z","iopub.status.idle":"2024-08-15T13:09:07.540626Z","shell.execute_reply":"2024-08-15T13:09:07.540023Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"nyquist = radar.instrument_parameters[\"nyquist_velocity\"][\"data\"][0]\nvel_dealias = pyart.correct.dealias_region_based(\n    radar,\n    vel_field=\"velocity\",\n    nyquist_vel=nyquist,\n    gatefilter=gatefilter,\n    centered=True,\n    skip_between_rays=0,\n)\nradar.add_field(\"corrected_velocity\", vel_dealias, replace_existing=True)","key":"V3vN2k2wnp"},{"type":"output","id":"dlXckSXBT0LhQ41NriWDb","data":[],"key":"Fu3Jw4p7xh"}],"key":"f49HV2RShO"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Let’s plot all of the sweeps to make sure dealiasing worked correctly.\nA good indicator of checking this is to check if there are discontinuities in the radial velocities between sweeps on the order of the Nyquist velocity. If there are such discontinuties, further tweaking of the parameters or grounding the retrieval to a sounding may be needed. Using these parameters, the above example radar data is properly dealiased.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OfM9VrJhBE"}],"key":"kWAA36azC6"}],"key":"CKVRaF1mIg"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-08-15T13:09:07.543347Z","iopub.status.busy":"2024-08-15T13:09:07.542867Z","iopub.status.idle":"2024-08-15T13:09:12.528617Z","shell.execute_reply":"2024-08-15T13:09:12.528101Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"display = pyart.graph.RadarDisplay(radar)\nfig, ax = plt.subplots(4, 5, figsize=(15, 10))\nfor i in range(radar.nsweeps):\n    display.plot(\n        \"corrected_velocity\",\n        vmin=-30,\n        vmax=30,\n        cmap=\"twilight_shifted\",\n        sweep=i,\n        colorbar_label=\"m/s\",\n        ax=ax[int(i / 5), i % 5],\n    )\n    ax[int(i / 5), i % 5].set_title(\"%2.1f deg\" % radar.fixed_angle[\"data\"][i])\n    ax[int(i / 5), i % 5].set_xlabel(\"X [km]\")\n    ax[int(i / 5), i % 5].set_ylabel(\"Y [km]\")\nfig.tight_layout()","key":"aphrSMst2K"},{"type":"output","id":"_9W_l6PtEQyI5aQHJM3e6","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a9d44befbc6e4da81bf2235c1039556c","path":"/erad2024/_preview/76/build/a9d44befbc6e4da81bf2235c1039556c.png"},"text/plain":{"content":"\u003cFigure size 1500x1000 with 40 Axes\u003e","content_type":"text/plain"}}}],"key":"OSEDwroNs5"}],"key":"ncEDcWElJN"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-08-15T13:09:12.530969Z","iopub.status.busy":"2024-08-15T13:09:12.530556Z","iopub.status.idle":"2024-08-15T13:09:16.005993Z","shell.execute_reply":"2024-08-15T13:09:16.005003Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"pyart.io.write_cfradial(\"MonteLema.20240522.151606_dealiased.nc\", radar)","key":"hCG7mzwqbp"},{"type":"output","id":"s7SHyDuN6QmfAjN37FKw9","data":[],"key":"BSQjtaWYgi"}],"key":"Xa5DffmFuo"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Gridding","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sFgf5P9jRj"}],"identifier":"gridding","label":"Gridding","html_id":"gridding","implicit":true,"key":"NlUiLrwb9j"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"PyDDA requires data to be gridded to Cartesian coordinates in order to retrieve the 3D wind fields. Therefore, we will use Py-ART’s ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BTEC9yt77N"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"grid_from_radars","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Iz49hNqgws"}],"key":"xMRnBKwscf"},{"type":"text","value":" function in order to do the gridding. You usually want to have a grid resolution such that your features of interest are covered by four grid points. In this case, we’re at 1 km horizontal and 0.5 km vertical resolution. For more information on gridding with Py-ART, see the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Zw8oQeKtLp"},{"type":"link","url":"https://projectpythia.org/radar-cookbook/notebooks/foundations/pyart-gridding.html","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Radar Cookbook","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ajYxB3DPCc"}],"urlSource":"https://projectpythia.org/radar-cookbook/notebooks/foundations/pyart-gridding.html","key":"DXPZ7gGytd"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"rW93H6lJVp"}],"key":"ioyP9Rqof2"}],"key":"bx9kt4t0i8"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-08-15T13:09:16.008473Z","iopub.status.busy":"2024-08-15T13:09:16.008271Z","iopub.status.idle":"2024-08-15T13:09:17.934695Z","shell.execute_reply":"2024-08-15T13:09:17.934144Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"grid_limits = ((0.0, 15000.0), (-100_000.0, 100_000.0), (-100_000.0, 100_000.0))\ngrid_shape = (31, 201, 201)\nradar.fields[\"corrected_velocity\"][\"data\"] = np.ma.masked_where(\n    gatefilter.gate_excluded, radar.fields[\"corrected_velocity\"][\"data\"]\n)\nradar.fields[\"reflectivity\"][\"data\"] = np.ma.masked_where(\n    gatefilter.gate_excluded, radar.fields[\"reflectivity\"][\"data\"]\n)\n\ncband_grid = pyart.map.grid_from_radars(\n    [radar], grid_limits=grid_limits, grid_shape=grid_shape\n)\ncband_ds = cband_grid.to_xarray()\ncband_ds","key":"D1hJ4inhqD"},{"type":"output","id":"-o-V6-dLWaGxDTYK_vE2A","data":[{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"56bb03cbc380946a5143697b351a63ea","path":"/erad2024/_preview/76/build/56bb03cbc380946a5143697b351a63ea.html"},"text/plain":{"content":"\u003cxarray.Dataset\u003e Size: 106MB\nDimensions:                              (time: 1, z: 31, y: 201, x: 201)\nCoordinates:\n  * time                                 (time) object 8B 2024-05-22 15:16:06...\n  * z                                    (z) float64 248B 0.0 500.0 ... 1.5e+04\n    lat                                  (y, x) float64 323kB 45.13 ... 46.93\n    lon                                  (y, x) float64 323kB 7.558 ... 10.15\n  * y                                    (y) float64 2kB -1e+05 ... 1e+05\n  * x                                    (x) float64 2kB -1e+05 ... 1e+05\nData variables:\n    velocity                             (time, z, y, x) float64 10MB 3.374 ....\n    uncorrected_differential_phase       (time, z, y, x) float64 10MB 2.025 ....\n    signal_to_noise_ratio                (time, z, y, x) float64 10MB 13.93 ....\n    reflectivity_hh_clut                 (time, z, y, x) float64 10MB 23.53 ....\n    corrected_velocity                   (time, z, y, x) float64 10MB 3.374 ....\n    spectrum_width                       (time, z, y, x) float64 10MB 2.603 ....\n    reflectivity                         (time, z, y, x) float64 10MB 23.59 ....\n    differential_reflectivity            (time, z, y, x) float64 10MB 0.02067...\n    uncorrected_cross_correlation_ratio  (time, z, y, x) float64 10MB 0.8806 ...\n    reflectivity_vv                      (time, z, y, x) float64 10MB 23.51 ....\n    ROI                                  (time, z, y, x) float32 5MB 2.469e+0...\nAttributes: (12/16)\n    nradar:           1\n    radar_name:       {'long_name': 'Name of radar used to make the grid', 'd...\n    Conventions:      CF/Radial instrument_parameters\n    version:          1.3\n    title:            \n    institution:      \n    ...               ...\n    field_names:      reflectivity, signal_to_noise_ratio, reflectivity_vv, d...\n    history:          \n    volume_number:    0\n    platform_type:    fixed\n    instrument_type:  radar\n    primary_axis:     axis_z","content_type":"text/plain"}}}],"key":"oi5F1Fbd02"}],"key":"RPkwiusIwr"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s make sure the grid looks good!","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"V04QbInxbZ"}],"key":"c8HMaEkAS6"}],"key":"eHUEJbaRxG"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-08-15T13:09:17.937023Z","iopub.status.busy":"2024-08-15T13:09:17.936594Z","iopub.status.idle":"2024-08-15T13:09:18.151998Z","shell.execute_reply":"2024-08-15T13:09:18.151349Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"cband_ds.isel(z=1).reflectivity.plot(\n    x=\"lon\", y=\"lat\", vmin=-20, vmax=70, cmap=\"pyart_ChaseSpectral\"\n)","key":"ZNkQxUQWkg"},{"type":"output","id":"BCuQVKnXTvHY0i82cfrL6","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"16d82f0cd8b5f5e60e09614f40a91e7a","path":"/erad2024/_preview/76/build/16d82f0cd8b5f5e60e09614f40a91e7a.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"IQGtZvxcWe"}],"key":"uKJGbd4Lsl"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-08-15T13:09:18.154404Z","iopub.status.busy":"2024-08-15T13:09:18.153996Z","iopub.status.idle":"2024-08-15T13:09:18.361344Z","shell.execute_reply":"2024-08-15T13:09:18.360787Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"cband_ds.isel(y=35).reflectivity.plot(\n    x=\"x\", y=\"z\", vmin=-20, vmax=70, cmap=\"pyart_ChaseSpectral\"\n)","key":"gvwk9njRCU"},{"type":"output","id":"KG_P3jDvY5Bianj9lwKXi","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"bd20eb53f8febff010a7af65383c7046","path":"/erad2024/_preview/76/build/bd20eb53f8febff010a7af65383c7046.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"qxC8uISwbf"}],"key":"PEJmsLCHtX"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"X-band Data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ffr2KfyjJ6"}],"identifier":"x-band-data","label":"X-band Data","html_id":"x-band-data","implicit":true,"key":"PZ434iLx53"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Next, we need to load the X-band radar data from the archive.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TDCNonaDYh"}],"key":"nwFYC6ODpL"}],"key":"lPk5cMXnUI"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-08-15T13:09:18.363475Z","iopub.status.busy":"2024-08-15T13:09:18.363296Z","iopub.status.idle":"2024-08-15T13:09:18.863156Z","shell.execute_reply":"2024-08-15T13:09:18.862593Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"radar_xband = pyart.io.read(local_files[0])","key":"V6jR7pW8PY"},{"type":"output","id":"GFv7SCXQQoDjT_jarF7eB","data":[],"key":"CvXV5s0j5R"}],"key":"wm7xeJdgkr"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Read a single file, the one closes to the UAH volume scan used before","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"d8gsagdHND"}],"key":"LOSyA0lzrE"}],"key":"J85t7901fH"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-08-15T13:09:18.865565Z","iopub.status.busy":"2024-08-15T13:09:18.865359Z","iopub.status.idle":"2024-08-15T13:09:18.869949Z","shell.execute_reply":"2024-08-15T13:09:18.869468Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"radar.info()","key":"gCfbNKNk1f"},{"type":"output","id":"BoYyc1DwzjyT-AoO6eABU","data":[{"name":"stdout","output_type":"stream","text":"altitude:\n\tdata: \u003cndarray of type: float32 and shape: (1,)\u003e\n\tlong_name: Altitude\n\tunits: meters\n\tstandard_name: Altitude\n\tpositive: up\naltitude_agl: None\nantenna_transition: None\nazimuth:\n\tdata: \u003cndarray of type: float32 and shape: (7200,)\u003e\n\tlong_name: azimuth_angle_from_true_north\n\tunits: degrees\n\tstandard_name: beam_azimuth_angle\n\taxis: radial_azimuth_coordinate\n\tcomment: Azimuth of antenna relative to true north\nelevation:\n\tdata: \u003cndarray of type: float32 and shape: (7200,)\u003e\n\tlong_name: elevation_angle_from_horizontal_plane\n\tunits: degrees\n\tstandard_name: beam_elevation_angle\n\taxis: radial_elevation_coordinate\n\tcomment: Elevation of antenna relative to the horizontal plane\nfields:\n\treflectivity:\n\t\tdata: \u003cndarray of type: float64 and shape: (7200, 492)\u003e\n\t\t_FillValue: -9999.0\n\t\tlong_name: Horizontal Reflectivity\n\t\tunits: dBZ\n\t\tstandard_name: horizontal_reflectivity\n\t\tcoordinates: elevation azimuth range\n\tsignal_to_noise_ratio:\n\t\tdata: \u003cndarray of type: float64 and shape: (7200, 492)\u003e\n\t\t_FillValue: -9999.0\n\t\tlong_name: Signal to noise ratio\n\t\tunits: dB\n\t\tstandard_name: signal_to_noise_ratio\n\t\tcoordinates: elevation azimuth range\n\treflectivity_vv:\n\t\tdata: \u003cndarray of type: float64 and shape: (7200, 492)\u003e\n\t\t_FillValue: -9999.0\n\t\tlong_name: Vertical Reflectivity\n\t\tunits: dBZ\n\t\tstandard_name: vertical_reflectivity\n\t\tcoordinates: elevation azimuth range\n\tdifferential_reflectivity:\n\t\tdata: \u003cndarray of type: float64 and shape: (7200, 492)\u003e\n\t\t_FillValue: -9999.0\n\t\tlong_name: Differential reflectivity\n\t\tunits: dB\n\t\tstandard_name: differential_reflectivity\n\t\tcoordinates: elevation azimuth range\n\tuncorrected_cross_correlation_ratio:\n\t\tdata: \u003cndarray of type: float64 and shape: (7200, 492)\u003e\n\t\t_FillValue: -9999.0\n\t\tlong_name: Uncorrected copolar correlation coefficient (RHOHV)\n\t\tunits: -\n\t\tstandard_name: copolar_correlation_coefficient\n\t\tcoordinates: elevation azimuth range\n\tuncorrected_differential_phase:\n\t\tdata: \u003cndarray of type: float64 and shape: (7200, 492)\u003e\n\t\t_FillValue: -9999.0\n\t\tlong_name: Uncorrected differential propagation phase\n\t\tunits: deg\n\t\tstandard_name: differential_phase\n\t\tcoordinates: elevation azimuth range\n\tvelocity:\n\t\tdata: \u003cndarray of type: float64 and shape: (7200, 492)\u003e\n\t\t_FillValue: -9999.0\n\t\tlong_name: Mean Doppler velocity\n\t\tunits: m/s\n\t\tstandard_name: mean_Doppler_velocity\n\t\tcoordinates: elevation azimuth range\n\tspectrum_width:\n\t\tdata: \u003cndarray of type: float64 and shape: (7200, 492)\u003e\n\t\t_FillValue: -9999.0\n\t\tlong_name: Doppler spectrum width\n\t\tunits: m/s\n\t\tstandard_name: Doppler_spectrum_width\n\t\tcoordinates: elevation azimuth range\n\treflectivity_hh_clut:\n\t\tdata: \u003cndarray of type: float64 and shape: (7200, 492)\u003e\n\t\t_FillValue: -9999.0\n\tcorrected_velocity:\n\t\tdata: \u003cndarray of type: float64 and shape: (7200, 492)\u003e\n\t\tunits: meters_per_second\n\t\tstandard_name: corrected_radial_velocity_of_scatterers_away_from_instrument\n\t\tlong_name: Corrected mean doppler velocity\n\t\tcoordinates: elevation azimuth range\n\t\t_FillValue: -9999.0\n\t\tvalid_min: -24.75\n\t\tvalid_max: 24.75\nfixed_angle:\n\tdata: \u003cndarray of type: float32 and shape: (20,)\u003e\n\tlong_name: Target angle for sweep\n\tunits: degrees\n\tstandard_name: target_fixed_angle\ninstrument_parameters:\n\tfrequency:\n\t\tdata: \u003cndarray of type: float32 and shape: (1,)\u003e\n\t\tlong_name: Radiation frequency\n\t\tunits: s-1\n\t\tmeta_group: instrument_parameters\n\tpulse_width:\n\t\tdata: \u003cndarray of type: float32 and shape: (7200,)\u003e\n\t\tlong_name: Pulse width\n\t\tunits: seconds\n\t\tcomments: Pulse width\n\t\tmeta_group: instrument_parameters\n\tnyquist_velocity:\n\t\tdata: \u003cndarray of type: float32 and shape: (7200,)\u003e\n\t\tlong_name: Nyquist velocity\n\t\tunits: m/s\n\t\tcomments: Unambiguous velocity\n\t\tmeta_group: instrument_parameters\n\tradar_beam_width_h:\n\t\tdata: \u003cndarray of type: float32 and shape: (1,)\u003e\n\t\tlong_name: Antenna beam width H polarization\n\t\tunits: degrees\n\t\tmeta_group: radar_parameters\n\tradar_beam_width_v:\n\t\tdata: \u003cndarray of type: float32 and shape: (1,)\u003e\n\t\tlong_name: Antenna beam width V polarization\n\t\tunits: degrees\n\t\tmeta_group: radar_parameters\nlatitude:\n\tdata: \u003cndarray of type: float32 and shape: (1,)\u003e\n\tlong_name: Latitude\n\tunits: degrees_north\n\tstandard_name: Latitude\nlongitude:\n\tdata: \u003cndarray of type: float32 and shape: (1,)\u003e\n\tlong_name: Longitude\n\tunits: degrees_east\n\tstandard_name: Longitude\nnsweeps: 20\nngates: 492\nnrays: 7200\nradar_calibration: None\nrange:\n\tdata: \u003cndarray of type: float32 and shape: (492,)\u003e\n\tlong_name: range_to_measurement_volume\n\tunits: meters\n\tstandard_name: projection_range_coordinate\n\taxis: radial_range_coordinate\n\tspacing_is_constant: true\n\tcomment: Coordinate variable for range. Range to center of each bin.\nscan_rate: None\nscan_type: ppi\nsweep_end_ray_index:\n\tdata: \u003cndarray of type: int32 and shape: (20,)\u003e\n\tlong_name: Index of last ray in sweep, 0-based\n\tunits: count\nsweep_mode:\n\tdata: \u003cndarray of type: |S1 and shape: (20, 32)\u003e\n\tlong_name: Sweep mode\n\tunits: unitless\n\tstandard_name: sweep_mode\n\tcomment: Options are: \"sector\", \"coplane\", \"rhi\", \"vertical_pointing\", \"idle\", \"azimuth_surveillance\", \"elevation_surveillance\", \"sunscan\", \"pointing\", \"manual_ppi\", \"manual_rhi\"\nsweep_number:\n\tdata: \u003cndarray of type: int64 and shape: (20,)\u003e\n\tlong_name: Sweep number\n\tunits: count\n\tstandard_name: sweep_number\nsweep_start_ray_index:\n\tdata: \u003cndarray of type: int32 and shape: (20,)\u003e\n\tlong_name: Index of first ray in sweep, 0-based\n\tunits: count\ntarget_scan_rate: None\ntime:\n\tdata: \u003cndarray of type: float64 and shape: (7200,)\u003e\n\tlong_name: time_in_seconds_since_volume_start\n\tunits: seconds since 1970-01-01T00:00:00Z\n\tstandard_name: time\n\tcalendar: gregorian\n\tcomment: Coordinate variable for time. Time at the center of each ray, in fractional seconds since the global variable time_coverage_start\nmetadata:\n\tConventions: CF/Radial instrument_parameters\n\tversion: 1.3\n\ttitle: \n\tinstitution: \n\treferences: \n\tsource: \n\tcomment: \n\tinstrument_name: L\n\tfield_names: reflectivity, signal_to_noise_ratio, reflectivity_vv, differential_reflectivity, uncorrected_cross_correlation_ratio, uncorrected_differential_phase, velocity, spectrum_width, reflectivity_hh_clut\n\thistory: \n\tvolume_number: 0\n\tplatform_type: fixed\n\tinstrument_type: radar\n\tprimary_axis: axis_z\n"}],"key":"jDqtF3ohiU"}],"key":"xwkdBcDEpG"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Visualize the data to make sure we have the correct scan.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LpkNr967z1"}],"key":"ekjzfWlImy"}],"key":"yLewDagKnu"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-08-15T13:09:18.871963Z","iopub.status.busy":"2024-08-15T13:09:18.871553Z","iopub.status.idle":"2024-08-15T13:09:19.180010Z","shell.execute_reply":"2024-08-15T13:09:19.179442Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"display = pyart.graph.RadarDisplay(radar_xband)\ndisplay.plot(\"DBZ\", vmin=0, vmax=70, cmap=\"pyart_ChaseSpectral\", sweep=0)\nplt.ylim(-100, 100)\nplt.xlim(-100, 100)","key":"fvtVyiNXVq"},{"type":"output","id":"GmDV8Umk93ze6wNxNB6NH","data":[{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/plain":{"content":"(-100.0, 100.0)","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7a27aaeae2b42e92588def1cc6ea427e","path":"/erad2024/_preview/76/build/7a27aaeae2b42e92588def1cc6ea427e.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"U2TCIW73Cu"}],"key":"r1inMU3oHo"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The X-band radar data also need to be dealiased. We will still need to filter out the noise in the above radar data.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Xs76ixasDK"}],"key":"aROTSQedfx"}],"key":"wypLbz9rgK"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-08-15T13:09:19.182150Z","iopub.status.busy":"2024-08-15T13:09:19.181961Z","iopub.status.idle":"2024-08-15T13:09:20.143345Z","shell.execute_reply":"2024-08-15T13:09:20.142754Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Use the C-band radar lat/lon as the center for the grid\n\ngatefilter = pyart.filters.GateFilter(radar_xband)\ngatefilter.exclude_above(\"WIDTH\", 7)\ngatefilter.exclude_below(\"RHOHV\", 0.8)\ngatefilter = pyart.correct.despeckle_field(\n    radar_xband, \"DBZ\", gatefilter=gatefilter, size=100\n)\nvel_dealias = pyart.correct.dealias_region_based(\n    radar_xband,\n    vel_field=\"VEL\",\n    nyquist_vel=nyquist,\n    centered=True,\n    skip_between_rays=0,\n    skip_along_ray=0,\n    interval_splits=3,\n)\nradar_xband.add_field(\"corrected_velocity\", vel_dealias, replace_existing=True)","key":"XKD3XokhoE"},{"type":"output","id":"5ZCfordU0v6cTa11-O445","data":[],"key":"NtnZkuvJUy"}],"key":"vqvDXsy3mc"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s view the sweeps to make sure that dealiasing is working correctly.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"noGDAQcBDy"}],"key":"YQpgnWJ94R"}],"key":"A8QyItkNRK"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-08-15T13:09:20.145892Z","iopub.status.busy":"2024-08-15T13:09:20.145517Z","iopub.status.idle":"2024-08-15T13:09:21.862726Z","shell.execute_reply":"2024-08-15T13:09:21.862140Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"display = pyart.graph.RadarDisplay(radar_xband)\nfig, ax = plt.subplots(2, 4, figsize=(15, 5))\nfor i in range(radar_xband.nsweeps):\n    display.plot(\n        \"corrected_velocity\",\n        vmin=-30,\n        vmax=30,\n        cmap=\"twilight_shifted\",\n        sweep=i,\n        colorbar_label=\"m/s\",\n        ax=ax[int(i / 4), i % 4],\n    )\n    ax[int(i / 4), i % 4].set_title(\"%2.1f deg\" % radar.fixed_angle[\"data\"][i])\n    ax[int(i / 4), i % 4].set_xlabel(\"X [km]\")\n    ax[int(i / 4), i % 4].set_ylabel(\"Y [km]\")\nfig.tight_layout()","key":"hN6LyziaLT"},{"type":"output","id":"Qr4DvUplTISCzr4NHaszs","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c867742301938de9c1622d827b5fd1dd","path":"/erad2024/_preview/76/build/c867742301938de9c1622d827b5fd1dd.png"},"text/plain":{"content":"\u003cFigure size 1500x500 with 16 Axes\u003e","content_type":"text/plain"}}}],"key":"X4IgqSqhcy"}],"key":"iYUYls2ll2"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-08-15T13:09:21.864766Z","iopub.status.busy":"2024-08-15T13:09:21.864587Z","iopub.status.idle":"2024-08-15T13:09:23.189001Z","shell.execute_reply":"2024-08-15T13:09:23.188508Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"pyart.io.write_cfradial(\"ARPA_Lombardia.20240522.151546_dealiased.nc\", radar_xband)","key":"TUdEUNgUK4"},{"type":"output","id":"R1nNeTgagO_mLsIXeqzfz","data":[],"key":"uKRze4ArMZ"}],"key":"aw1AFRFGSX"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-08-15T13:09:23.191291Z","iopub.status.busy":"2024-08-15T13:09:23.191124Z","iopub.status.idle":"2024-08-15T13:09:24.474341Z","shell.execute_reply":"2024-08-15T13:09:24.473767Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"grid_lat = radar.latitude[\"data\"][0]\ngrid_lon = radar.longitude[\"data\"][0]\nxband_grid = pyart.map.grid_from_radars(\n    [radar_xband],\n    grid_limits=grid_limits,\n    grid_shape=grid_shape,\n    grid_origin=(grid_lat, grid_lon),\n)\n\n# Convert to xarray and remove the time dimension\nxband_ds = xband_grid.to_xarray().squeeze()","key":"aImwJUsj7C"},{"type":"output","id":"izOJtWtkBRBss7O1O6WEK","data":[],"key":"TWorJ7lrjs"}],"key":"epGkoGe6MJ"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Visualize the grids","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PtCZooWGdx"}],"identifier":"visualize-the-grids","label":"Visualize the grids","html_id":"visualize-the-grids","implicit":true,"key":"jJgWZOJdO8"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Let’s see what our output data looks like!","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NBodVyi6NG"}],"key":"ZtYPDIJu1C"}],"key":"A3VOvSpO60"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-08-15T13:09:24.476844Z","iopub.status.busy":"2024-08-15T13:09:24.476464Z","iopub.status.idle":"2024-08-15T13:09:24.675142Z","shell.execute_reply":"2024-08-15T13:09:24.674575Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"xband_ds.DBZ.isel(z=1).plot(x=\"lon\", y=\"lat\", cmap=\"Spectral_r\", vmin=-20, vmax=50)","key":"NMDl1Df0jE"},{"type":"output","id":"jXl-iunZeyNNCZw5x8sTA","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"be75193a1f6fdfb7dee25570ecf77b09","path":"/erad2024/_preview/76/build/be75193a1f6fdfb7dee25570ecf77b09.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"bHif1r1CZ5"}],"key":"GTN7nbh4kC"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Velocities look good!","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gZFTRUUNjy"}],"key":"F6atMHsCgV"}],"key":"uKA8X70j6j"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-08-15T13:09:24.677444Z","iopub.status.busy":"2024-08-15T13:09:24.677034Z","iopub.status.idle":"2024-08-15T13:09:24.875526Z","shell.execute_reply":"2024-08-15T13:09:24.874889Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"xband_ds.corrected_velocity.isel(z=4).plot(\n    x=\"lon\", y=\"lat\", cmap=\"twilight_shifted\", vmin=-30, vmax=30\n)","key":"N0AvftiOqW"},{"type":"output","id":"INum0KOCioXjJgWjwTLgn","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"078f482f9210b00e1063bae9d62ebf52","path":"/erad2024/_preview/76/build/078f482f9210b00e1063bae9d62ebf52.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"nLfS9vW307"}],"key":"bbGGvpLZrs"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-08-15T13:09:24.877595Z","iopub.status.busy":"2024-08-15T13:09:24.877404Z","iopub.status.idle":"2024-08-15T13:09:25.074770Z","shell.execute_reply":"2024-08-15T13:09:25.074173Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"xband_ds.corrected_velocity.isel(y=55).plot(\n    x=\"x\", y=\"z\", cmap=\"twilight_shifted\", vmin=-20, vmax=20\n)","key":"EHprMR8t4Z"},{"type":"output","id":"gfaG32g4f6DqmT1VzcIQ-","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c7a0b4afb85d614eb56c256b3428b821","path":"/erad2024/_preview/76/build/c7a0b4afb85d614eb56c256b3428b821.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"NSjU2gfJiK"}],"key":"cShrF0AJPC"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"PyDDA initialization","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rFjheoDeZP"}],"identifier":"pydda-initialization","label":"PyDDA initialization","html_id":"pydda-initialization","implicit":true,"key":"Lle1TSAw1Q"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The 3DVAR wind retrieval first requires an initial guess at the wind field in order to start the cost function minimization process. PyDDA has support for using WRF and sounding data as an initial guess of the wind field as well as constant wind fields.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mDiSXV48rH"}],"key":"Moqrwq4nQS"},{"type":"table","position":{"start":{"line":5,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Initalization functions in ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"chmirsP64Y"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"pydda.initialization","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Ab4gXGEMIH"}],"key":"KVRu6mVEfx"},{"type":"text","value":" module:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"TFmZcfN5xM"}],"key":"HYwrvcJzyM"},{"type":"tableCell","header":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Functionality","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"KQToCcUjUW"}],"key":"KNhgTfpXpW"}],"key":"aazjI90ok2"},{"type":"tableRow","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"make_constant_wind_field(Grid[, wind, vel_field])","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"j1GOBNYJ0a"}],"key":"tRTOQiNkhv"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"This function makes a constant wind field given a wind vector","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"HryKMAPHea"}],"key":"IF5ixMClqa"}],"key":"mpXEyXFN7z"},{"type":"tableRow","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"make_wind_field_from_profile(Grid, profile)","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"KJDX9dRspJ"}],"key":"mdNuYdhX1r"},{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"This function makes a 3D wind field from a sounding.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"ZRqRTH7RIl"}],"key":"XdVjktkYIL"}],"key":"TsD9AnaO0P"},{"type":"tableRow","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"make_background_from_wrf(Grid, file_path, ...)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Y2VQ3NM8eM"}],"key":"a4hp75hNFO"},{"type":"tableCell","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"This function makes an initalization field based off of the u and w from a WRF run.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"dFXrfGgTz8"}],"key":"Q5Pg1W86hh"}],"key":"mePMmHDyWX"},{"type":"tableRow","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"make_initialization_from_era_interim(Grid[, ...])","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"lwX2KKUQn4"}],"key":"JL8qedeMrU"},{"type":"tableCell","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"This function will read ERA Interim in NetCDF format and add it to the Py-ART grid specified by Grid.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"Bc9ASb3OMp"}],"key":"kHeck7PNc1"}],"key":"gI2TYqOCd4"}],"key":"JbDwlX8xHt"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"For this example, using a zero initialization field is sufficient to create an accurate representation of the wind field. Depending on your radar set up, you may need to adjust the input initial wind field to avoid artifacts at the edges of the multi-Doppler lobes.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"wbVjemF1CK"}],"key":"WfjWYMHp5k"}],"key":"YVmSI9Fshu"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-08-15T13:09:25.076843Z","iopub.status.busy":"2024-08-15T13:09:25.076656Z","iopub.status.idle":"2024-08-15T13:09:26.024345Z","shell.execute_reply":"2024-08-15T13:09:26.023714Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"cband_ds = pydda.io.read_from_pyart_grid(cband_grid)\nxband_ds = pydda.io.read_from_pyart_grid(xband_grid)\ncband_ds = pydda.initialization.make_constant_wind_field(\n    cband_ds, (0.0, 0.0, 0.0), \"velocity\"\n)\nxband_ds[\"reflectivity\"] = xband_ds[\"DBZ\"]","key":"CaXwwlutFH"},{"type":"output","id":"kmMDHlNsuRK1eMBfe1yQk","data":[],"key":"zD4WmGyxAD"}],"key":"TuTiRMxjsc"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"PyDDA wind retrieval","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IKrnSSjI3T"}],"identifier":"pydda-wind-retrieval","label":"PyDDA wind retrieval","html_id":"pydda-wind-retrieval","implicit":true,"key":"Lg4VqdtY2W"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The core wind retrieval function in PyDDA is done using ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yMAcAxtoXq"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"retrieval.get_dd_wind_field","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"glBh4SWcCL"}],"key":"tlNvGAW0y4"},{"type":"text","value":". It has many potential keyword inputs that the user can enter. In this example, we are specifying:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"FBsD4s3XF2"}],"key":"Aeh1KsJnmI"},{"type":"table","position":{"start":{"line":5,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Input to ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"IyCdH4btxQ"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"pydda.initialization","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ysqAdCF0tR"}],"key":"ZJbm22bZuw"},{"type":"text","value":" module:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"xDnfQEjDCH"}],"key":"PJtR3rfJDo"},{"type":"tableCell","header":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Meaning","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"HBcsR9p6AL"}],"key":"xBgEOtKVFb"},{"type":"tableCell","header":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Value","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"kpnY661q7E"}],"key":"rhgv0JMhWP"}],"key":"QEJuq2siQW"},{"type":"tableRow","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Grids","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"tozkbH6DP8"}],"key":"ZzSuUtzonl"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The input grids to analyze.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"UND8z1yrS3"}],"key":"FhR4iuA2So"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"[uah_grid, nexrad_grid]","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"BWpS17wpyr"}],"key":"mjuqe8ijLT"}],"key":"zROAqsQxXQ"},{"type":"tableRow","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"u_init","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"Phgx6M2le1"}],"key":"kuSFoS0FhV"},{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Initial guess of ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"aJNrul6fEV"},{"type":"emphasis","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"u","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"dvn4x19GO8"}],"key":"aEZeZpV2HM"},{"type":"text","value":" field.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"HU5OO8dcq3"}],"key":"gVD596KADx"},{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"u_init","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"U0RSDCICEg"}],"key":"MirA2vZt75"}],"key":"GvAsvNZjru"},{"type":"tableRow","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"v_init","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"lgsEY16azy"}],"key":"nTLbyNb2Ep"},{"type":"tableCell","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Initial guess of ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"y8WkjhIiMO"},{"type":"emphasis","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"u","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"P4OuKEvkNp"}],"key":"qe6BHRpkKY"},{"type":"text","value":" field.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"FFVGBEAYA2"}],"key":"yZzTRDrAyq"},{"type":"tableCell","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"v_init","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"bT3qi9fIuW"}],"key":"YKP4ccNhmU"}],"key":"EIcNsCrXOR"},{"type":"tableRow","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"w_init","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"eAE4cYUdW3"}],"key":"PztuhZ4lzA"},{"type":"tableCell","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Initial guess of ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"SoZTWFXeS2"},{"type":"emphasis","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"u","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"ZAfMY1ZYJE"}],"key":"hhff78rQtR"},{"type":"text","value":" field.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"V0VFn04fjM"}],"key":"joXv2almA2"},{"type":"tableCell","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"w_init","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"aJrBWXHFjK"}],"key":"TdF6zYNAvU"}],"key":"E5AIqHGObk"},{"type":"tableRow","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Co","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"OLKBWOHoid"}],"key":"Cyo3MhdDdl"},{"type":"tableCell","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Weight for cost function related to radar observations","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"c7FqB1E5zQ"}],"key":"nEe7jXa8Uj"},{"type":"tableCell","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"1.0","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"zkXHzVNbjM"}],"key":"XJEi6SbzS6"}],"key":"FwglhxlQ3B"},{"type":"tableRow","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Cm","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"EeMdIF4QzC"}],"key":"h5nITuKGVK"},{"type":"tableCell","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Weight of cost function related to mass continuity equation","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"DLQACwzjMk"}],"key":"wdC4w36NG8"},{"type":"tableCell","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"256.0","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"m7eI50YPQ3"}],"key":"r9r80XiIdC"}],"key":"xFG1Zh90Ln"},{"type":"tableRow","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Cx","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"mxobvMF0vT"}],"key":"j1YoxTtBWL"},{"type":"tableCell","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Weight of cost function for smoothess in the ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"mFxmb5g8F6"},{"type":"emphasis","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"x","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"cFUkjMuvzW"}],"key":"KIOSH2HuZy"},{"type":"text","value":"-direction","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"zEK6wzxYkM"}],"key":"c6ip83Avdm"},{"type":"tableCell","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"1e-3","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"rrrUxj3HPx"}],"key":"u9UGVCNZHr"}],"key":"Nz1sh7YGDe"},{"type":"tableRow","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Cy","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"ZNgC9Ba2Wy"}],"key":"Hr2V0nHd7t"},{"type":"tableCell","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Weight of cost function for smoothess in the ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"iOnLIQquTs"},{"type":"emphasis","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"y","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"dvTnNPHkyu"}],"key":"bLlQlxCIoJ"},{"type":"text","value":"-direction","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"EfWjmQuYEV"}],"key":"Hi9S5nN53o"},{"type":"tableCell","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"1e-3","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"Y1iCKbY2AT"}],"key":"A3xrTtFLkM"}],"key":"WM8dLfOpCh"},{"type":"tableRow","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Cz","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"gSmyoanrWF"}],"key":"SKrohkNS1q"},{"type":"tableCell","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Weight of cost function for smoothess in the ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"JtQ76jXRoU"},{"type":"emphasis","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"z","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"neiFa0q6Y9"}],"key":"eDBVHqEDI2"},{"type":"text","value":"-direction","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"RsK662SgyL"}],"key":"OkJtH7FFgw"},{"type":"tableCell","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"1e-3","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"hg0FH6iyIB"}],"key":"xDlVbhGEJ5"}],"key":"Sf4IPB3QxQ"},{"type":"tableRow","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Cb","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"ktyzLmxwAn"}],"key":"DEuhNS0F6R"},{"type":"tableCell","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Weight of cost function for sounding (background) constraint","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"nD87ut1dnU"}],"key":"ezL1Xz6uAK"},{"type":"tableCell","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"0","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"X3XkENB3VB"}],"key":"uQnfghrv8z"}],"key":"PSDnV21zov"},{"type":"tableRow","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"frz","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"mLUdZo8Q6h"}],"key":"F9qULmWErB"},{"type":"tableCell","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"The freezing level in meters. This is to tell PyDDA where to use ice particle fall speeds in the wind retrieval verus liquid.","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"xIcVEAzJK9"}],"key":"U8JcsJTAKj"},{"type":"tableCell","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"5000.","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"Om5heTcgd6"}],"key":"L3xeCla3iT"}],"key":"rRw1iQIIZd"},{"type":"tableRow","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"filter_window","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"AzkFr2k6RY"}],"key":"ufsLxlK3LN"},{"type":"tableCell","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"The window to apply the low pass filter on","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"ymjNuujf8b"}],"key":"B3EmQSUP9M"},{"type":"tableCell","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"5","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"VrEBEDVSSE"}],"key":"wQuxkT8rrJ"}],"key":"utPPRMwOeb"},{"type":"tableRow","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"mask_outside_opt","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"rqY6V2d8O4"}],"key":"bli80MeLK8"},{"type":"tableCell","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Mask all winds outside the Dual Doppler lobes","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"aTPIapG63z"}],"key":"rSyUvuIzMT"},{"type":"tableCell","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"True","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"nXNI4uadzw"}],"key":"jVaxxsSj00"}],"key":"wP7fWucBP8"},{"type":"tableRow","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"vel_name","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"sWZvCFzq7O"}],"key":"X2Ta2GPIXK"},{"type":"tableCell","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"The name of the velocity field in the radar data","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"ByUI7AgJXB"}],"key":"Q9JXgTWt1i"},{"type":"tableCell","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"‘corrected_velocity’","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"W0balZB5u8"}],"key":"qfrgGWD9t6"}],"key":"lYLS4cnbg4"},{"type":"tableRow","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"wind_tol","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"Ndfdn3vZEL"}],"key":"LhGESfIc3W"},{"type":"tableCell","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Stop optimization when the change in wind speeds between iterations is less than this value","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"kctkjSBDI1"}],"key":"KIQ0B6hoH7"},{"type":"tableCell","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[],"key":"Z8VStfbeST"}],"key":"W2AIsH2fgb"},{"type":"tableRow","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"engine","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"nDfTp8N4yY"}],"key":"saUKpab8ey"},{"type":"tableCell","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"PyDDA supports three backends for optimization: SciPy, JAX, and TensorFlow.","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"YnS7KW7emG"}],"key":"Z7SvJc2kK0"},{"type":"tableCell","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"“scipy”","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"NixwivHynG"}],"key":"ra33XDDAjo"}],"key":"hiTNFrzZI2"}],"key":"QJDgJIO1dg"}],"key":"HtAlGvY6NO"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-08-15T13:09:26.027041Z","iopub.status.busy":"2024-08-15T13:09:26.026523Z","iopub.status.idle":"2024-08-15T13:15:25.818863Z","shell.execute_reply":"2024-08-15T13:15:25.818306Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"grids, params = pydda.retrieval.get_dd_wind_field(\n    [cband_ds, xband_ds],\n    Co=1,\n    Cm=1024.0,\n    Cx=1e-2,\n    Cy=1e-2,\n    Cz=1e-2,\n    frz=5000.0,\n    mask_outside_opt=True,\n    upper_bc=1,\n    vel_name=\"corrected_velocity\",\n    wind_tol=0.5,\n    engine=\"scipy\",\n)","key":"iwzCesRLOe"},{"type":"output","id":"8vOj_h5LUikrrxNk8Mxlc","data":[{"name":"stdout","output_type":"stream","text":"False\nCalculating weights for radars 0 and 1\n"},{"name":"stdout","output_type":"stream","text":"Calculating weights for radars 1 and 0\nCalculating weights for models...\nStarting solver \nrmsVR = 4.581783784636946\nTotal points: 230030\nThe max of w_init is 0.0\n"},{"name":"stdout","output_type":"stream","text":"Total number of model points: 0\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n      0|225018.1796|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000\n"},{"name":"stdout","output_type":"stream","text":"The gradient of the cost functions is 4.950675247614054\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n     10|  34.4083| 392.7000|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  16.9523\n"},{"name":"stdout","output_type":"stream","text":"Max change in w: 16.085\n"},{"name":"stdout","output_type":"stream","text":"The gradient of the cost functions is 0.6383715029246938\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n     20|   5.5491| 153.1899|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  13.4433\n"},{"name":"stdout","output_type":"stream","text":"Max change in w: 8.973\n"},{"name":"stdout","output_type":"stream","text":"The gradient of the cost functions is 0.6723123436679119\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n     30|   7.8224|  73.2793|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  14.9393\n"},{"name":"stdout","output_type":"stream","text":"Max change in w: 6.432\n"},{"name":"stdout","output_type":"stream","text":"The gradient of the cost functions is 0.582234285230258\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n     40|   7.3156|  57.5159|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  27.5207\n"},{"name":"stdout","output_type":"stream","text":"Max change in w: 6.491\n"},{"name":"stdout","output_type":"stream","text":"The gradient of the cost functions is 0.67846610972528\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n     50|   0.7408|  59.7204|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  32.4783\n"},{"name":"stdout","output_type":"stream","text":"The gradient of the cost functions is 0.30557291330146774\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n     60|   0.8089|  59.5485|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  32.1450\n"},{"name":"stdout","output_type":"stream","text":"The gradient of the cost functions is 0.30631472916262437\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n     70|   0.6816|  59.6884|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  33.0122\n"},{"name":"stdout","output_type":"stream","text":"The gradient of the cost functions is 0.30220215717698357\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n     80|   0.6993|  59.6325|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  32.8112\n"},{"name":"stdout","output_type":"stream","text":"The gradient of the cost functions is 0.2917681362090366\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n     90|   0.6757|  59.6542|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  33.1916\n"},{"name":"stdout","output_type":"stream","text":"The gradient of the cost functions is 0.2786782822470347\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n    100|   0.6440|  59.6514|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  33.7041\n"},{"name":"stdout","output_type":"stream","text":"The gradient of the cost functions is 0.2747334654695774\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n    110|   0.6382|  59.6543|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  33.9057\n"},{"name":"stdout","output_type":"stream","text":"The gradient of the cost functions is 1.0853226344610831\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n    120|   0.7693|  59.9989|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  37.4743\n"},{"name":"stdout","output_type":"stream","text":"Max change in w: 2.157\n"},{"name":"stdout","output_type":"stream","text":"The gradient of the cost functions is 0.2642855661530291\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n    130|   0.6523|  59.5959|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  35.5306\n"},{"name":"stdout","output_type":"stream","text":"The gradient of the cost functions is 0.2774927128972392\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n    140|   0.6649|  59.5624|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  36.3377\n"},{"name":"stdout","output_type":"stream","text":"The gradient of the cost functions is 0.25866632663912736\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n    150|   0.6552|  59.5546|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  36.1585\n"},{"name":"stdout","output_type":"stream","text":"The gradient of the cost functions is 0.26001276377032473\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n    160|   0.6707|  59.5210|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  36.9809\n"},{"name":"stdout","output_type":"stream","text":"The gradient of the cost functions is 0.2565228871631343\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n    170|   0.6690|  59.5196|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  37.0096\n"},{"name":"stdout","output_type":"stream","text":"The gradient of the cost functions is 0.256205445180571\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n    180|   0.6720|  59.5080|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  37.3294\n"},{"name":"stdout","output_type":"stream","text":"The gradient of the cost functions is 0.25450229363720805\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n    190|   0.6737|  59.5032|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  37.8427\n"},{"name":"stdout","output_type":"stream","text":"The gradient of the cost functions is 0.25435811988533746\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n    200|   0.6732|  59.4985|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  37.9252\n"},{"name":"stdout","output_type":"stream","text":"The gradient of the cost functions is 0.2528037367461622\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n    210|   0.6724|  59.4972|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  38.4874\n"},{"name":"stdout","output_type":"stream","text":"The gradient of the cost functions is 2.04331424012824\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n    220|   0.8126|  60.4458|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  42.4441\n"},{"name":"stdout","output_type":"stream","text":"The gradient of the cost functions is 0.2505531691485409\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n    230|   0.6688|  59.4925|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  38.4192\n"},{"name":"stdout","output_type":"stream","text":"Max change in w: 1.818\n"},{"name":"stdout","output_type":"stream","text":"The gradient of the cost functions is 0.2507347447809678\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n    240|  19.5743| 141.9802|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  89.3783\n"},{"name":"stdout","output_type":"stream","text":"The gradient of the cost functions is 0.24758103808464288\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n    250|   0.6621|  59.4905|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  38.8797\n"},{"name":"stdout","output_type":"stream","text":"The gradient of the cost functions is 0.24739519570110888\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n    260|   0.6613|  59.4911|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  38.9386\n"},{"name":"stdout","output_type":"stream","text":"The gradient of the cost functions is 0.24751217301828826\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n    270|   0.6592|  59.4892|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  39.1910\n"},{"name":"stdout","output_type":"stream","text":"The gradient of the cost functions is 4.291183664026434\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n    280|   1.2372|  60.5478|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  43.6677\n"},{"name":"stdout","output_type":"stream","text":"The gradient of the cost functions is 0.24638003909051479\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n    290|   0.6547|  59.4918|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  39.4391\n"},{"name":"stdout","output_type":"stream","text":"The gradient of the cost functions is 8.167839990431528\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n    300|   1.9076|  60.1367|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  43.3397\n"},{"name":"stdout","output_type":"stream","text":"The gradient of the cost functions is 0.4170924416185285\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n    310|   0.5864|  60.6746|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  44.1338\n"},{"name":"stdout","output_type":"stream","text":"The gradient of the cost functions is 0.24767287768719704\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n    320|   0.6517|  59.4861|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  39.8488\n"},{"name":"stdout","output_type":"stream","text":"The gradient of the cost functions is 0.24318754831199724\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n    330|   0.6012|  59.3620|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  39.8844\n"},{"name":"stdout","output_type":"stream","text":"Max change in w: 1.631\n"},{"name":"stdout","output_type":"stream","text":"The gradient of the cost functions is 0.4176164198347478\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n    340|   2.4095|  56.1453|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  42.3272\n"},{"name":"stdout","output_type":"stream","text":"The gradient of the cost functions is 0.4478134154295641\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n    350|   2.4223|  56.1240|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  42.2716\n"},{"name":"stdout","output_type":"stream","text":"The gradient of the cost functions is 0.29808338367150805\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n    360|   1.1264|  56.0815|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  42.4743\n"},{"name":"stdout","output_type":"stream","text":"The gradient of the cost functions is 0.2967212994946185\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n    370|   0.6689|  56.1071|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  43.2161\n"},{"name":"stdout","output_type":"stream","text":"The gradient of the cost functions is 0.2957556197546136\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n    380|   0.6716|  56.1042|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  43.1960\n"},{"name":"stdout","output_type":"stream","text":"The gradient of the cost functions is 0.2962155183804333\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n    390|   0.6717|  56.1040|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  43.1947\n"},{"name":"stdout","output_type":"stream","text":"The gradient of the cost functions is 0.20295191276306826\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n    400|   0.4706|  56.1542|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  43.4186\n"},{"name":"stdout","output_type":"stream","text":"The gradient of the cost functions is 0.20142559345196445\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n    410|   0.4704|  56.1540|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  43.4177\n"},{"name":"stdout","output_type":"stream","text":"Max change in w: 2.186\n"},{"name":"stdout","output_type":"stream","text":"The gradient of the cost functions is 0.269276801222094\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n    420|   0.4185|  56.1840|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  43.5425\n"},{"name":"stdout","output_type":"stream","text":"The gradient of the cost functions is 0.16413083971733644\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n    430|   0.4238|  56.1677|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  43.4769\n"},{"name":"stdout","output_type":"stream","text":"The gradient of the cost functions is 0.1634871368702149\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n    440|   0.4236|  56.1683|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  43.4792\n"},{"name":"stdout","output_type":"stream","text":"The gradient of the cost functions is 0.1641308436351384\n"},{"name":"stdout","output_type":"stream","text":"Nfeval | Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  \n    450|   0.4238|  56.1677|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  43.4769\n"},{"name":"stdout","output_type":"stream","text":"Applying low pass filter to wind field...\nDone! Time = 359.2\n"}],"key":"dJE7eQXAAJ"}],"key":"aFz6xE70lV"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Visualize the results","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aOlBdU4rTu"}],"identifier":"visualize-the-results","label":"Visualize the results","html_id":"visualize-the-results","implicit":true,"key":"Cr5BbeCkye"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Let’s visualize the results. There are two ways in which this data can be visualized. One way is by using PyDDA’s visualization routines. You can also use xarray to visualize the output grids.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"w3vNppxKlT"}],"key":"Hf1AFZv4UI"}],"key":"WpxiMeimNQ"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-08-15T13:15:25.821114Z","iopub.status.busy":"2024-08-15T13:15:25.820724Z","iopub.status.idle":"2024-08-15T13:15:25.869844Z","shell.execute_reply":"2024-08-15T13:15:25.869347Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"ds = grids[0]\nds","key":"auVgMVLySH"},{"type":"output","id":"Ywm-pPhtIR2R_dw-vTFWZ","data":[{"output_type":"execute_result","execution_count":26,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"f2ebeac8cebb735d943f7d823cd6aa03","path":"/erad2024/_preview/76/build/f2ebeac8cebb735d943f7d823cd6aa03.html"},"text/plain":{"content":"\u003cxarray.Dataset\u003e Size: 216MB\nDimensions:                              (time: 1, z: 31, y: 201, x: 201,\n                                          nradar: 1)\nCoordinates:\n  * time                                 (time) object 8B 2024-05-22 15:16:06...\n  * z                                    (z) float64 248B 0.0 500.0 ... 1.5e+04\n    lat                                  (y, x) float64 323kB 45.13 ... 46.93\n    lon                                  (y, x) float64 323kB 7.558 ... 10.15\n  * y                                    (y) float64 2kB -1e+05 ... 1e+05\n  * x                                    (x) float64 2kB -1e+05 ... 1e+05\nDimensions without coordinates: nradar\nData variables: (12/29)\n    velocity                             (time, z, y, x) float64 10MB 3.374 ....\n    uncorrected_differential_phase       (time, z, y, x) float64 10MB 2.025 ....\n    signal_to_noise_ratio                (time, z, y, x) float64 10MB 13.93 ....\n    reflectivity_hh_clut                 (time, z, y, x) float64 10MB 23.53 ....\n    corrected_velocity                   (time, z, y, x) float64 10MB 3.374 ....\n    spectrum_width                       (time, z, y, x) float64 10MB 2.603 ....\n    ...                                   ...\n    point_latitude                       (z, y, x) float64 10MB 45.13 ... 46.93\n    AZ                                   (time, z, y, x) float64 10MB 225.0 ....\n    EL                                   (time, z, y, x) float64 10MB -1.136 ...\n    u                                    (time, z, y, x) float64 10MB nan ......\n    v                                    (time, z, y, x) float64 10MB nan ......\n    w                                    (time, z, y, x) float64 10MB nan ......\nAttributes: (12/19)\n    nradar:           1\n    radar_name:       {'long_name': 'Name of radar used to make the grid', 'd...\n    Conventions:      CF/Radial instrument_parameters\n    version:          1.3\n    title:            \n    institution:      \n    ...               ...\n    platform_type:    fixed\n    instrument_type:  radar\n    primary_axis:     axis_z\n    first_grid_name:  velocity\n    units:            m\n    long_name:        Point altitude","content_type":"text/plain"}}}],"key":"X3NVWQxv4b"}],"key":"Rh0PD7tskf"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"If you are not able to get the above example to run on your laptop, pre-generated grid files are available ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"k2G3ifbGj9"},{"type":"link","url":"https://drive.google.com/drive/folders/1LmfJeiYHcC_NGWuNAW7gAPMUNp7Z4UZq?usp=sharing","children":[{"type":"text","value":"here","key":"kko2NSGNFj"}],"urlSource":"https://drive.google.com/drive/folders/1LmfJeiYHcC_NGWuNAW7gAPMUNp7Z4UZq?usp=sharing","key":"uLspMwUNay"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ny1XV5fQv2"}],"key":"TLnrtwLfKu"}],"key":"KCZv576zN9"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-08-15T13:15:25.871724Z","iopub.status.busy":"2024-08-15T13:15:25.871330Z","iopub.status.idle":"2024-08-15T13:15:26.088136Z","shell.execute_reply":"2024-08-15T13:15:26.087617Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"ds.reflectivity.sel(z=2000, method=\"nearest\").plot(\n    cmap=\"pyart_ChaseSpectral\", vmin=-10, vmax=60\n)\nds.isel(time=0).sel(z=2000, method=\"nearest\").w.plot.contour(\n    x=\"x\", y=\"y\", levels=np.arange(1, 5, 1)\n)\nplt.xlim([-50000, 25000])\nplt.ylim([-100000, -25000])","key":"vl3s21VV55"},{"type":"output","id":"opWkL2YlNCfYfcEAjyQRO","data":[{"output_type":"execute_result","execution_count":27,"metadata":{},"data":{"text/plain":{"content":"(-100000.0, -25000.0)","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f366d7db622f92af636520eb6cd1584c","path":"/erad2024/_preview/76/build/f366d7db622f92af636520eb6cd1584c.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"LEwdYgP3U3"}],"key":"PkxY7UKRIk"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Saving the grids","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vC1B4gTKRh"}],"identifier":"saving-the-grids","label":"Saving the grids","html_id":"saving-the-grids","implicit":true,"key":"WIj40b1iI1"}],"key":"LhRHcmA9JW"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can save the grids using either ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"v0ToqIxXYv"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"xarray","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"o5de6Haruo"}],"key":"EVZEVXqhP6"},{"type":"text","value":"’s or Py-ART’s functionality. To save the output grids,  use ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aKxCfUivqK"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"pyart.io.write_grid","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"l174uHddnv"}],"key":"LReuyAwSF1"},{"type":"text","value":" (PyART) functions. For example:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vxRcGbtiLc"}],"key":"SEOuekVVea"}],"key":"ptf5mZlqLO"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-08-15T13:15:26.090210Z","iopub.status.busy":"2024-08-15T13:15:26.089878Z","iopub.status.idle":"2024-08-15T13:15:26.752672Z","shell.execute_reply":"2024-08-15T13:15:26.752156Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Keep these lines if we can't update PyDDA in time for ERAD\ngrids[0].attrs[\"radar_name\"] = \"C-band\"\ndel grids[0][\"time\"].attrs[\"units\"]\ngrids[1].attrs[\"radar_name\"] = \"X-band\"\ndel grids[1][\"time\"].attrs[\"units\"]\n\ngrids[0].to_netcdf(\"output_grid_Cband.nc\")\ngrids[1].to_netcdf(\"output_grid_Xband.nc\")","key":"I2mqp7wLDL"},{"type":"output","id":"25IK3TrLacgPoS0sPXq8v","data":[],"key":"R7IsABrkoU"}],"key":"inDrGsOucL"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In order to load the grids again, we can just use PyART’s ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tD3VaDNPgM"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"pyart.io.read_grid","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bK6PM0Xdz2"}],"key":"bT6Bm0T1UB"},{"type":"text","value":" procedure.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"u0KLJTa0O6"}],"key":"feS8FSzH9R"}],"key":"wvcC3HnyMd"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-08-15T13:15:26.755023Z","iopub.status.busy":"2024-08-15T13:15:26.754694Z","iopub.status.idle":"2024-08-15T13:15:27.599749Z","shell.execute_reply":"2024-08-15T13:15:27.599229Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# For live demos, load these since retrieval takes about 7 minutes\ngrids = [\n    pydda.io.read_grid(\"output_grid_Cband.nc\"),\n    pydda.io.read_grid(\"output_grid_Xband.nc\"),\n]","key":"Q4L4WmgjsQ"},{"type":"output","id":"FNnGfuKYKFM3R4h6Gut66","data":[],"key":"tSnTcJ9698"}],"key":"JKUr4wx20f"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"PyDDA visualization routines","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"s8ivP8JCDT"}],"identifier":"pydda-visualization-routines","label":"PyDDA visualization routines","html_id":"pydda-visualization-routines","implicit":true,"key":"SAbao1nbu7"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"PyDDA’s visualization routines support the native PyART grids that are output by PyDDA. These routines have an advantage over xarray’s plotting routines for adjusting your barb and quiver size by specifying their using parameters that are in scales of kilometers. This makes it easier to plot barb and quiver plots compared to using xarray’s functionality.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"DZELq9l49y"}],"key":"OhdWhWvYM8"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"For example, the documentation for ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"P9OblLfBCp"},{"type":"emphasis","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"pydda.vis.plot_horiz_xsection_quiver","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"MzlHW97CcH"}],"key":"InXbizSL2Y"},{"type":"text","value":" is given below.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"U4RWiuwDX4"}],"key":"C8WMuDCnR8"}],"key":"kDSvNAjPYL"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-08-15T13:15:27.601974Z","iopub.status.busy":"2024-08-15T13:15:27.601780Z","iopub.status.idle":"2024-08-15T13:15:27.631259Z","shell.execute_reply":"2024-08-15T13:15:27.630681Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"?pydda.vis.plot_horiz_xsection_quiver","key":"A2QogyaFMZ"},{"type":"output","id":"cfukGKKrqxlbWVpDTxwkO","data":[],"key":"KomFGlOTPn"}],"key":"MFE1JMQZSV"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"PyDDA has the following visualization routines for your sets of grids:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WMHCDkEr9L"}],"key":"iqv48M22Sa"},{"type":"table","position":{"start":{"line":3,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Procedure","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"klCfdH2oos"}],"key":"rnTQLNGuMS"},{"type":"tableCell","header":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Description","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"AySFu66CNZ"}],"key":"uzu7owOVSQ"}],"key":"QHV07Q6rRD"},{"type":"tableRow","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"plot_horiz_xsection_barbs(Grids[, ax, ...])","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"E1H0p624F3"}],"key":"J4VkarhO9k"},{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Horizontal cross section of winds from wind fields generated by PyDDA using barbs.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"SJ7376bP3X"}],"key":"Y3UrUPC0eK"}],"key":"zUFt2w2Fra"},{"type":"tableRow","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"plot_xz_xsection_barbs(Grids[, ax, ...])","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"dva1wwqcKJ"}],"key":"l5aC3Kpppn"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Cross section of winds from wind fields generated by PyDDA in the X-Z plane using barbs.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"ZtNq9fopJX"}],"key":"Z5j83FOzfE"}],"key":"NyBOlgTP4R"},{"type":"tableRow","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"plot_yz_xsection_barbs(Grids[, ax, ...])","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"nKkYqknfGh"}],"key":"MHDHNaN5kq"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Cross section of winds from wind fields generated by PyDDA in the Y-Z plane using barbs.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"cksJdcaAE8"}],"key":"BpuhJ2Y4WP"}],"key":"gk8tJNTlaw"},{"type":"tableRow","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"plot_horiz_xsection_barbs_map(Grids[, ax, ...])","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"nvYsEIGMxB"}],"key":"pJe6uCtrvr"},{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Horizontal cross section of winds from wind fields generated by PyDDA onto a geographical map using barbs.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"kxKkZvWaWH"}],"key":"hnu1mTAr1n"}],"key":"DmEVrd85vE"},{"type":"tableRow","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"plot_horiz_xsection_streamlines(Grids[, ax, ...])","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"I4PFcjnLiJ"}],"key":"OS2nNfg6GD"},{"type":"tableCell","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Horizontal cross section of winds from wind fields generated by PyDDA using streamlines.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"giYFUiDdB0"}],"key":"QjtfTr9e6c"}],"key":"l2myKoc946"},{"type":"tableRow","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"plot_xz_xsection_streamlines(Grids[, ax, ...])","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"eYMyzUNR3I"}],"key":"Gnuhf0nX8P"},{"type":"tableCell","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Cross section of winds from wind fields generated by PyDDA in the X-Z plane using streamlines.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"r1mZhj9Bt7"}],"key":"hiHE6bZ3mj"}],"key":"P4fwAJSl4z"},{"type":"tableRow","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"plot_yz_xsection_streamlines(Grids[, ax, ...])","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"uxD613TKzf"}],"key":"ucfXz9oWLY"},{"type":"tableCell","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Cross section of winds from wind fields generated by PyDDA in the Y-Z plane using streamlines.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"Q4CuGKivsC"}],"key":"VkBCAm1DhO"}],"key":"jkbT2MRBeO"},{"type":"tableRow","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"plot_horiz_xsection_streamlines_map(Grids[, ...])","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"i8gb1TiEUp"}],"key":"zEatBdy7YQ"},{"type":"tableCell","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Horizontal cross section of winds from wind fields generated by PyDDA using streamlines.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"Bhx3SpXRxO"}],"key":"e8CalQjpW1"}],"key":"Ovd2JWK5Aj"},{"type":"tableRow","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"plot_horiz_xsection_quiver(Grids[, ax, ...])","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"QspRrpSsRy"}],"key":"GBU8FtxKIW"},{"type":"tableCell","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Horizontal cross section of winds from wind fields generated by PyDDA using quivers.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"MI975useKn"}],"key":"TNloCxwGhK"}],"key":"RsmczftYtv"},{"type":"tableRow","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"plot_xz_xsection_quiver(Grids[, ax, ...])","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"AfUgAcpZeu"}],"key":"wIEnp57iw7"},{"type":"tableCell","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Cross section of winds from wind fields generated by PyDDA in the X-Z plane using quivers.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"o3VScdQVZS"}],"key":"LiBpqOrv8J"}],"key":"OLeNLwABYa"},{"type":"tableRow","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"plot_yz_xsection_quiver(Grids[, ax, ...])","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"dajiSdiV6z"}],"key":"nrJAy3JUSp"},{"type":"tableCell","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Cross section of winds from wind fields generated by PyDDA in the Y-Z plane using quivers.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"IdqmyNC0rb"}],"key":"yNLUYV5hEd"}],"key":"pnImtAgnqO"},{"type":"tableRow","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"plot_horiz_xsection_quiver_map(Grids[, ax, ...])","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"mhruAykDkr"}],"key":"XDucex3BGw"},{"type":"tableCell","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Horizontal cross section of winds from wind fields generated by PyDDA using quivers onto a geographical map.","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"RE8GJ7gmKr"}],"key":"nyEBOJDFP5"}],"key":"bJbvom4m1L"}],"key":"YVNK64JYVe"}],"key":"HgSr4N9wgp"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s show a quiver plot of this storm!","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gtdeR4tzI6"}],"key":"PMl2dmrfk9"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We have specified the quivers to be 4 km apart and moved the key to the bottom right with the specific length indicating 20 m/s winds. Let’s look at the 3 km level.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"AOFupqfFm2"}],"key":"wc7lWLBmAU"}],"key":"hEan7OBZOj"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-08-15T13:15:27.633778Z","iopub.status.busy":"2024-08-15T13:15:27.633402Z","iopub.status.idle":"2024-08-15T13:15:28.091028Z","shell.execute_reply":"2024-08-15T13:15:28.090471Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots(1, 1, figsize=(6, 6))\npydda.vis.plot_horiz_xsection_quiver(\n    grids,\n    quiver_spacing_x_km=2.5,\n    quiver_spacing_y_km=2.5,\n    quiver_width=0.005,\n    vmax=60,\n    quiverkey_len=10.0,\n    w_vel_contours=np.arange(1, 5, 1),\n    level=4,\n    cmap=\"pyart_ChaseSpectral\",\n    ax=ax,\n    quiverkey_loc=\"bottom_right\",\n)\nplt.xlim([-75, 25])\nplt.ylim([-100, -25])","key":"l41UaSmFzE"},{"type":"output","id":"tXk-QiwK-NFpAv4ckGQtr","data":[{"output_type":"execute_result","execution_count":31,"metadata":{},"data":{"text/plain":{"content":"(-100.0, -25.0)","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"fb5e3fe9fd4f09a2abf11c2eb08d0e7c","path":"/erad2024/_preview/76/build/fb5e3fe9fd4f09a2abf11c2eb08d0e7c.png"},"text/plain":{"content":"\u003cFigure size 600x600 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"qBfHkEEoEp"}],"key":"bvRVRsUHrk"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can zoom in and modify the plot using standard matplotlib functions on the axis handle.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OUrmfESVLm"}],"key":"zSmQEojDxb"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"It is much easier to see updrafts being placed just to the outside of the strongest precipitation, with potential new growth in the north of the domain with updraft velocities \u003e 7 m/s. The precipitation is downwind of the updraft as we would expect.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"FRMSg2h98A"}],"key":"SJ6ijRP6rQ"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Updrafts are right tilted due to the horizontal wind shear. The horizontal wind shear also causes the most intense precipitation to be downshear of the updraft. This therefore shows us that we have a good quality wind retrieval below about 5 km in altitude.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"rZ8a5u4mWv"}],"key":"Agaux4bK7f"}],"key":"CTt131JGPl"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-08-15T13:15:28.093148Z","iopub.status.busy":"2024-08-15T13:15:28.092837Z","iopub.status.idle":"2024-08-15T13:15:28.345072Z","shell.execute_reply":"2024-08-15T13:15:28.344550Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots(1, 1, figsize=(6, 4))\npydda.vis.plot_xz_xsection_quiver(\n    grids,\n    quiver_spacing_x_km=2.0,\n    quiver_spacing_z_km=1.0,\n    quiver_width=0.005,\n    quiverkey_len=10.0,\n    w_vel_contours=np.arange(1, 5, 1),\n    level=37,\n    cmap=\"pyart_ChaseSpectral\",\n    ax=ax,\n    quiverkey_loc=\"top_right\",\n)\nax.set_xlim([-75, -25])\nax.set_ylim([0, 13])","key":"z1aRio9dUh"},{"type":"output","id":"iwVSp8SwFZyea1coblALJ","data":[{"output_type":"execute_result","execution_count":32,"metadata":{},"data":{"text/plain":{"content":"(0.0, 13.0)","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a3f47bd1f643896910bcbc8364b1338e","path":"/erad2024/_preview/76/build/a3f47bd1f643896910bcbc8364b1338e.png"},"text/plain":{"content":"\u003cFigure size 600x400 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"nUoQCMtvsT"}],"key":"a1rk6eC1CB"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s view a horizontal cross section with barbs!","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"raoSfB8P6k"}],"key":"xuRPhvXvbY"}],"key":"DQLJjsyDGe"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-08-15T13:15:28.347209Z","iopub.status.busy":"2024-08-15T13:15:28.346872Z","iopub.status.idle":"2024-08-15T13:15:28.755734Z","shell.execute_reply":"2024-08-15T13:15:28.755204Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots(1, 1, figsize=(6, 6))\npydda.vis.plot_horiz_xsection_barbs(\n    grids,\n    barb_spacing_x_km=6.0,\n    barb_spacing_y_km=6.0,\n    w_vel_contours=np.arange(1, 10, 1),\n    level=6,\n    cmap=\"pyart_ChaseSpectral\",\n    ax=ax,\n)\n# ax.set_xlim([-60, 0])\n# ax.set_ylim([0, 70])","key":"y3tI7TnwYW"},{"type":"output","id":"0ZnbYDyzRDd_t8BuC4_hM","data":[{"output_type":"execute_result","execution_count":33,"metadata":{},"data":{"text/plain":{"content":"\u003cAxes: title={'center': 'PyDDA retreived winds @4.626 km'}, xlabel='X [km]', ylabel='Y [km]'\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"21583c340e74b2904553c5e09ceabb34","path":"/erad2024/_preview/76/build/21583c340e74b2904553c5e09ceabb34.png"},"text/plain":{"content":"\u003cFigure size 600x600 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"DQGjU54Eoe"}],"key":"qwdKmRSq7Z"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-08-15T13:15:28.758257Z","iopub.status.busy":"2024-08-15T13:15:28.757934Z","iopub.status.idle":"2024-08-15T13:15:28.762182Z","shell.execute_reply":"2024-08-15T13:15:28.761685Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"cband_ds[\"time\"][0].dt.year.values","key":"NTPINMoRcs"},{"type":"output","id":"7JIr3yaFasRQbo5oXSGbB","data":[{"output_type":"execute_result","execution_count":34,"metadata":{},"data":{"text/plain":{"content":"array(2024)","content_type":"text/plain"}}}],"key":"EiaUPs6QRg"}],"key":"VWWCB7Y33r"}],"key":"fPS3KkPFnC"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Environment overview","url":"/environment","group":"Notebook Environment"}}},"domain":"http://localhost:3000"},"project":{"open_access":true,"license":{"content":{"id":"Apache-2.0","name":"Apache License 2.0","osi":true,"free":true,"url":"https://opensource.org/licenses/Apache-2.0"},"code":{"id":"CC-BY-4.0","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true,"url":"https://creativecommons.org/licenses/by/4.0/"}},"abbreviations":{"ARM":"Atmospheric Radiation Measurement","NCAR":"National Center for Atmospheric Research"},"title":"ERAD 2024","authors":[{"nameParsed":{"literal":"Alfonso Ladino","given":"Alfonso","family":"Ladino"},"name":"Alfonso Ladino","orcid":"0000-0001-8081-7827","github":"aladinor","id":"contributors-myst-generated-uid-0"},{"nameParsed":{"literal":"Anna del Moral Méndez","given":"Anna","non_dropping_particle":"del","family":"Moral Méndez"},"name":"Anna del Moral Méndez","orcid":"0000-0002-5015-840X","id":"contributors-myst-generated-uid-1"},{"nameParsed":{"literal":"Brenda Javornik","given":"Brenda","family":"Javornik"},"name":"Brenda Javornik","github":"leavesntwigs","id":"contributors-myst-generated-uid-2"},{"nameParsed":{"literal":"Daniel Michelson","given":"Daniel","family":"Michelson"},"name":"Daniel Michelson","orcid":"0000-0003-3222-9881","github":"DanielMichelson","id":"contributors-myst-generated-uid-3"},{"nameParsed":{"literal":"Daniel Wolfensberger","given":"Daniel","family":"Wolfensberger"},"name":"Daniel Wolfensberger","github":"wolfidan","id":"contributors-myst-generated-uid-4"},{"nameParsed":{"literal":"Gionata Ghiggi","given":"Gionata","family":"Ghiggi"},"name":"Gionata Ghiggi","orcid":"0000-0002-0818-0865","github":"ghiggi","id":"contributors-myst-generated-uid-5"},{"nameParsed":{"literal":"Jen DeHart","given":"Jen","family":"DeHart"},"name":"Jen DeHart","orcid":"0000-0001-8536-4927","github":"jcdehart","id":"contributors-myst-generated-uid-6"},{"nameParsed":{"literal":"Jordi Figueras i Ventura","given":"Jordi Figueras","non_dropping_particle":"i","family":"Ventura"},"name":"Jordi Figueras i Ventura","orcid":"0000-0002-4949-422X","github":"jfigui","id":"contributors-myst-generated-uid-7"},{"nameParsed":{"literal":"Julian Giles","given":"Julian","family":"Giles"},"name":"Julian Giles","orcid":"0000-0001-8134-008X","github":"JulianGiles","id":"contributors-myst-generated-uid-8"},{"nameParsed":{"literal":"Kai Mühlbauer","given":"Kai","family":"Mühlbauer"},"name":"Kai Mühlbauer","orcid":"0000-0001-6599-1034","github":"kmuehlbauer","id":"contributors-myst-generated-uid-9"},{"nameParsed":{"literal":"Maxwell Grover","given":"Maxwell","family":"Grover"},"name":"Maxwell Grover","orcid":"0000-0002-0370-8974","github":"mgrover1","id":"contributors-myst-generated-uid-10"},{"nameParsed":{"literal":"Mike Dixon","given":"Mike","family":"Dixon"},"name":"Mike Dixon","orcid":"0000-0002-9597-9113","github":"mike-dixon","id":"contributors-myst-generated-uid-11"},{"nameParsed":{"literal":"Robert Jackson","given":"Robert","family":"Jackson"},"name":"Robert Jackson","orcid":"0000-0003-2518-1234","github":"rcjackson","id":"contributors-myst-generated-uid-12"},{"nameParsed":{"literal":"Scott Collis","given":"Scott","family":"Collis"},"name":"Scott Collis","orcid":"0000-0002-2303-687X","github":"scollis","id":"contributors-myst-generated-uid-13"},{"nameParsed":{"literal":"Ting-Yu Cha","given":"Ting-Yu","family":"Cha"},"name":"Ting-Yu Cha","orcid":"0000-0002-6292-8483","github":"tingyucha","id":"contributors-myst-generated-uid-14"}],"github":"https://github.com/openradar/erad2024","copyright":"2024","references":{"foundations":{"url":"https://projectpythia-mystmd.github.io/pythia-foundations"},"xarray":{"url":"https://docs.xarray.dev/en/stable"},"matplotlib":{"url":"https://matplotlib.org/stable"}},"thebe":{"binder":{"url":"https://binder.projectpythia.org/","provider":"github","repo":"openradar/erad2024","ref":"HEAD"}},"toc":[{"file":"README.md"},{"children":[{"file":"notebooks/how-to-cite.md"}],"title":"Preamble"},{"children":[{"file":"notebooks/data-access/intro-data-access.ipynb"}],"title":"Data Access"},{"children":[{"children":[{"file":"notebooks/xradar-pyart/xradar-basics.ipynb"}],"title":"XRadar"},{"children":[{"file":"notebooks/xradar-pyart/pyart-basics.ipynb"},{"file":"notebooks/wradlib/wradlib_clutter_beamblockage.ipynb"}],"title":"Py-ART and wradlib"},{"children":[{"pattern":"notebooks/baltrad/baltrad_short_course/*.ipynb"},{"pattern":"notebooks/baltrad/pyart2baltrad/*.ipynb"},{"file":"notebooks/baltrad/baltrad2wradlib/baltrad2wradlib.ipynb"}],"title":"BALTRAD"},{"children":[{"file":"notebooks/lrose/lrose-introduction.ipynb"}],"title":"LROSE"}],"title":"Radar Software Foundations"},{"children":[{"file":"notebooks/environment"}],"title":"Notebook Environment"},{"children":[{"file":"notebooks/Retrieving_winds_with_pydda.ipynb"}],"title":"Retrieving winds with PyDDA"}],"thumbnail":"/erad2024/_preview/76/build/0885e6292c6be2fd643fbc952d479a01.jpeg","exports":[],"bibliography":[],"index":"readme","pages":[{"level":1,"title":"Preamble"},{"slug":"how-to-cite","title":"How to Cite This Cookbook","description":"","date":"","thumbnail":"/erad2024/_preview/76/build/72a08caa5cbe5f9cce5999dbd1a81dfd.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Data Access"},{"slug":"intro-data-access","title":"Data Access Instructions","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Radar Software Foundations"},{"level":2,"title":"XRadar"},{"slug":"xradar-basics","title":"Xradar Basics","description":"","date":"","thumbnail":"/erad2024/_preview/76/build/xradar_logo-2a95fed8155191180f39cb57899abfeb.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"Py-ART and wradlib"},{"slug":"pyart-basics","title":"Py-ART Basics with Xradar","description":"","date":"","thumbnail":"/erad2024/_preview/76/build/arm_logo-b9b29a4a15afe87ea7324a177f3a080f.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"wradlib-clutter-beamblockage","title":"clutter and beamblockage","description":"","date":"","thumbnail":"/erad2024/_preview/76/build/wradlib_logo.svg-582403ae472ffe2fa62d74e3aaf0d55c.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"BALTRAD"},{"slug":"baltrad-io","title":"I/O model","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad-qc","title":"Quality Control","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad-drqc","title":"Quality Control using DR","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad-parallel-processing","title":"Parallel processing","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad-compositing","title":"Compositing","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad-pyart-rain-rate-example","title":"Rain Rate retrieval with Py-ART","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"pyart-baltrad-dealias-example","title":"Doppler Velocity Dealiasing with Py-ART","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad2wradlib","title":"Attenuation correction comparison with wradlib","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"LROSE"},{"slug":"lrose-introduction","title":"LROSE Echo and Wind Retrieval Tutorial","description":"","date":"","thumbnail":"/erad2024/_preview/76/build/8ad65774263f4fd7856f5554d1df1971.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"Notebook Environment"},{"slug":"environment","title":"Environment overview","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Retrieving winds with PyDDA"},{"slug":"retrieving-winds-with-pydda","title":"PyDDA tutorial","description":"","date":"","thumbnail":"/erad2024/_preview/76/build/5e2d147096249dc3a37da495168a9e9e.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":false,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/erad2024/_preview/76/build/manifest-4C03D258.js";
import * as route0 from "/erad2024/_preview/76/build/root-ZSMPVWLZ.js";
import * as route1 from "/erad2024/_preview/76/build/routes/$-OW6NTZY2.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/erad2024/_preview/76/build/entry.client-K6EYMIDZ.js");</script></body></html>