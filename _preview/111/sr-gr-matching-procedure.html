<!DOCTYPE html><html lang="en" class="light" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Spaceborne-Ground Radar Matching (Methodology) - ERAD 2024</title><meta property="og:title" content="Spaceborne-Ground Radar Matching (Methodology) - ERAD 2024"/><meta name="generator" content="mystmd"/><meta name="keywords" content=""/><meta name="image" content="/erad2024/_preview/111/build/cc72069fb56e0a54f1123fbe9c2fcb76.png"/><meta property="og:image" content="/erad2024/_preview/111/build/cc72069fb56e0a54f1123fbe9c2fcb76.png"/><link rel="icon" href="/favicon.ico"/><link rel="stylesheet" href="/erad2024/_preview/111/build/_assets/app-BCJ7T4EU.css"/><link rel="stylesheet" href="/erad2024/_preview/111/build/_assets/thebe-core-C4ZDKLDU.css"/><link rel="stylesheet" href="/myst-theme.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="block px-2 py-1 text-black underline">Skip to article content</a></div><div class="bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-screen top-0 z-30 h-[60px]"><nav class="flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block xl:hidden"><button class="flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="2rem" height="2rem" class="m-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 013.75 6h16.5a.75.75 0 010 1.5H3.75A.75.75 0 013 6.75zM3 12a.75.75 0 01.75-.75h16.5a.75.75 0 010 1.5H3.75A.75.75 0 013 12zm0 5.25a.75.75 0 01.75-.75h16.5a.75.75 0 010 1.5H3.75a.75.75 0 01-.75-.75z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/erad2024/_preview/111/"><div class="p-1 mr-3"><img src="/erad2024/_preview/111/build/erad_white_backgroun-fef88c318808c418b43394c058f8d30d.png" class="h-9 dark:hidden" height="2.25rem"/><img src="/erad2024/_preview/111/build/erad_white_backgroun-fef88c318808c418b43394c058f8d30d.png" class="hidden h-9 dark:block" height="2.25rem"/></div><span class="text-md sm:text-xl tracking-tight sm:mr-5 sr-only">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"><div class="relative inline-block mx-2 grow-0"><a href="https://www.erad2024.it" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center w-full mx-2 py-1 text-md font-medium dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75">Conference Home</a></div><div class="relative inline-block mx-2 grow-0"><a href="https://openradarscience.org" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center w-full mx-2 py-1 text-md font-medium dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75">Community</a></div><div class="relative inline-block mx-2 grow-0"><a href="https://openradar.discourse.group/" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center w-full mx-2 py-1 text-md font-medium dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75">Discourse</a></div></div><div class="flex-grow block"></div><button class="theme rounded-full border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-8 h-8 mx-3" title="Change theme to dark mode." aria-label="Change theme to dark mode."><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="h-full w-full p-0.5"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z"></path></svg></button><div class="block sm:hidden"><div class="relative" data-headlessui-state=""><div><button class="flex text-sm bg-transparent rounded-full focus:outline-none" id="headlessui-menu-button-:Rciop:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Open Menu</span><div class="flex items-center text-stone-200 hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="2rem" height="2rem" class="p-1"><path fill-rule="evenodd" d="M10.5 6a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zm0 6a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zm0 6a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0z" clip-rule="evenodd"></path></svg></div></button></div></div></div><div class="hidden sm:block"><a href="https://binder.projectpythia.org/v2/gh/openradar/erad2024/main?labpath=notebooks" target="_blank" rel="noopener noreferrer" class="inline-block px-4 py-2 mx-1 mt-0 leading-none border rounded text-md border-stone-700 dark:border-white text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 hover:bg-neutral-100">Launch Environment</a></div></div></nav></div><div class="fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden z-10" style="top:60px"><div class="pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><div class="flex-grow py-6 overflow-y-auto"><nav aria-label="Navigation" class="overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px] lg:hidden"><div class="w-full px-1 dark:text-white"><a href="https://www.erad2024.it" target="_blank" rel="noopener noreferrer" class="p-2 my-1 rounded-lg hover:bg-slate-300/30 block break-words focus:outline outline-blue-200 outline-2 rounded">Conference Home</a><a href="https://openradarscience.org" target="_blank" rel="noopener noreferrer" class="p-2 my-1 rounded-lg hover:bg-slate-300/30 block break-words focus:outline outline-blue-200 outline-2 rounded">Community</a><a href="https://openradar.discourse.group/" target="_blank" rel="noopener noreferrer" class="p-2 my-1 rounded-lg hover:bg-slate-300/30 block break-words focus:outline outline-blue-200 outline-2 rounded">Discourse</a></div></nav><div class="my-3 border-b-2 lg:hidden"></div><nav aria-label="Table of Contents" class="flex-grow overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="w-full px-1 dark:text-white"><a title="ERAD 2024" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="/erad2024/_preview/111/">ERAD 2024</a><a title="How to Cite" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/erad2024/_preview/111/how-to-cite">How to Cite</a><a title="Schedule" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/erad2024/_preview/111/schedule">Schedule</a><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Getting started" class="block break-words rounded py-2 grow cursor-pointer">Getting started</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rjd8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rjd8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Radar Software Foundations" class="block break-words rounded py-2 grow cursor-pointer">Radar Software Foundations</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rnd8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rnd8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Project Workflows" class="block break-words rounded py-2 grow cursor-pointer">Project Workflows</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rrd8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rrd8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div></div></nav></div><div class="flex-none py-6 transition-all duration-700 translate-y-6 opacity-0"><a class="flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><article class="article content article-grid grid-gap"><main class="article-grid subgrid-gap col-screen"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="mb-8 pt-9"><div class="flex items-center h-6 mb-5 text-sm font-light"><div class="flex-grow"></div><a href="https://opensource.org/licenses/Apache-2.0" target="_blank" rel="noopener noreferrer" title="Content License: Apache License 2.0 (Apache-2.0)" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="mx-1 inline-block opacity-60 hover:opacity-100 hover:text-[#599F46]"><path d="M13.2 15.6c1.4-.5 2.1-1.6 2.1-3.3S13.8 8.9 12 8.9c-1.9 0-3.3 1.6-3.3 3.3 0 1.8.8 3 2.2 3.4l-2.3 5.9c-3.1-.8-6.3-4.6-6.3-9.3 0-5.5 4.3-10 9.7-10s9.8 4.5 9.8 10c0 4.7-3.1 8.5-6.3 9.3l-2.3-5.9z"></path></svg></a><a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="noopener noreferrer" class="opacity-50 hover:opacity-100 text-inherit hover:text-inherit" aria-label="Code License: Creative Commons Attribution 4.0 International (CC-BY-4.0)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mx-1"><title>Code License: Creative Commons Attribution 4.0 International (CC-BY-4.0)</title><path d="M12 2.2c2.7 0 5 1 7 2.9.9.9 1.6 2 2.1 3.1.5 1.2.7 2.4.7 3.8 0 1.3-.2 2.6-.7 3.8-.5 1.2-1.2 2.2-2.1 3.1-1 .9-2 1.7-3.2 2.2-1.2.5-2.5.7-3.7.7s-2.6-.3-3.8-.8c-1.2-.5-2.2-1.2-3.2-2.1s-1.6-2-2.1-3.2-.8-2.4-.8-3.7c0-1.3.2-2.5.7-3.7S4.2 6 5.1 5.1C7 3.2 9.3 2.2 12 2.2zM12 4c-2.2 0-4.1.8-5.6 2.3C5.6 7.1 5 8 4.6 9c-.4 1-.6 2-.6 3s.2 2.1.6 3c.4 1 1 1.8 1.8 2.6S8 19 9 19.4c1 .4 2 .6 3 .6s2.1-.2 3-.6c1-.4 1.9-1 2.7-1.8 1.5-1.5 2.3-3.3 2.3-5.6 0-1.1-.2-2.1-.6-3.1-.4-1-1-1.8-1.7-2.6C16.1 4.8 14.2 4 12 4zm-.1 6.4l-1.3.7c-.1-.3-.3-.5-.5-.6-.2-.1-.4-.2-.6-.2-.9 0-1.3.6-1.3 1.7 0 .5.1.9.3 1.3.2.3.5.5 1 .5.6 0 1-.3 1.2-.8l1.2.6c-.3.5-.6.9-1.1 1.1-.5.3-1 .4-1.5.4-.9 0-1.6-.3-2.1-.8-.5-.6-.8-1.3-.8-2.3 0-.9.3-1.7.8-2.2.6-.6 1.3-.8 2.1-.8 1.2 0 2.1.4 2.6 1.4zm5.6 0l-1.3.7c-.1-.3-.3-.5-.5-.6-.2-.1-.4-.2-.6-.2-.9 0-1.3.6-1.3 1.7 0 .5.1.9.3 1.3.2.3.5.5 1 .5.6 0 1-.3 1.2-.8l1.2.6c-.3.5-.6.9-1.1 1.1-.4.2-.9.3-1.4.3-.9 0-1.6-.3-2.1-.8s-.8-1.3-.8-2.2c0-.9.3-1.7.8-2.2.5-.5 1.2-.8 2-.8 1.2 0 2.1.4 2.6 1.4z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1"><title>Credit must be given to the creator</title><path d="M12 2.2c2.7 0 5 .9 6.9 2.8 1.9 1.9 2.8 4.2 2.8 6.9s-.9 5-2.8 6.8c-2 1.9-4.3 2.9-7 2.9-2.6 0-4.9-1-6.9-2.9-1.8-1.7-2.8-4-2.8-6.7s1-5 2.9-6.9C7 3.2 9.3 2.2 12 2.2zM12 4c-2.2 0-4.1.8-5.6 2.3C4.8 8 4 9.9 4 12c0 2.2.8 4 2.4 5.6C8 19.2 9.8 20 12 20c2.2 0 4.1-.8 5.7-2.4 1.5-1.5 2.3-3.3 2.3-5.6 0-2.2-.8-4.1-2.3-5.7C16.1 4.8 14.2 4 12 4zm2.6 5.6v4h-1.1v4.7h-3v-4.7H9.4v-4c0-.2.1-.3.2-.4.1-.2.2-.2.4-.2h4c.2 0 .3.1.4.2.2.1.2.2.2.4zm-4-2.5c0-.9.5-1.4 1.4-1.4s1.4.5 1.4 1.4c0 .9-.5 1.4-1.4 1.4s-1.4-.5-1.4-1.4z"></path></svg></a><a href="https://en.wikipedia.org/wiki/Open_access" target="_blank" rel="noopener noreferrer" title="Open Access" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="mr-1 inline-block opacity-60 hover:opacity-100 hover:text-[#E18435]"><path d="M17.1 12.6h-2V7.5c0-1.7-1.4-3.1-3-3.1-.8 0-1.6.3-2.2.9-.6.5-.9 1.3-.9 2.2v.7H7v-.7c0-1.4.5-2.7 1.5-3.7s2.2-1.5 3.6-1.5 2.6.5 3.6 1.5 1.5 2.3 1.5 3.7v5.1z"></path><path d="M12 21.8c-.8 0-1.6-.2-2.3-.5-.7-.3-1.4-.8-1.9-1.3-.6-.6-1-1.2-1.3-2-.3-.8-.5-1.6-.5-2.4s.2-1.6.5-2.4c.3-.7.7-1.4 1.3-2s1.2-1 1.9-1.3c.7-.3 1.5-.5 2.3-.5.8 0 1.6.2 2.3.5.7.3 1.4.8 1.9 1.3.6.6 1 1.2 1.3 2 .3.8.5 1.6.5 2.4s-.2 1.6-.5 2.4c-.3.7-.7 1.4-1.3 2-.6.6-1.2 1-1.9 1.3-.7.3-1.5.5-2.3.5zm0-10.3c-2.2 0-4 1.8-4 4.1s1.8 4.1 4 4.1 4-1.8 4-4.1-1.8-4.1-4-4.1z"></path><circle cx="12" cy="15.6" r="1.7"></circle></svg></a><a href="https://github.com/openradar/erad2024" title="GitHub Repository: openradar/erad2024" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a><div class="inline-block mr-1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block"><title>Jupyter Notebook</title><path d="M20.2 1.7c0 .8-.5 1.4-1.3 1.5-.8 0-1.4-.5-1.5-1.3 0-.8.5-1.4 1.3-1.5.8-.1 1.5.5 1.5 1.3zM12 17.9c-3.7 0-7-1.3-8.7-3.3 1.8 4.8 7.1 7.3 11.9 5.5 2.5-.9 4.5-2.9 5.5-5.5-1.7 2-4.9 3.3-8.7 3.3zM12 5.1c3.7 0 7 1.3 8.7 3.3-1.8-4.8-7.1-7.3-11.9-5.5-2.5.9-4.5 2.9-5.5 5.5 1.7-2 5-3.3 8.7-3.3zM6.9 21.8c.1 1-.7 1.8-1.7 1.9-1 .1-1.8-.7-1.9-1.7 0-1 .7-1.8 1.7-1.9 1-.1 1.8.7 1.9 1.7zM3.7 4.6c-.6 0-1-.4-1-1s.4-1 1-1 1 .4 1 1c0 .5-.4 1-1 1z"></path></svg></div><div class="relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="relative ml-2 -mr-1" id="headlessui-menu-button-:Rd4fop:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem"><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="mb-0">Spaceborne-Ground Radar Matching (Methodology)</h1><header class="mt-4 not-prose"><div><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rhkfop:" data-state="closed">Alfonso Ladino</button><a class="ml-1" href="https://orcid.org/0000-0001-8081-7827" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rikfop:" data-state="closed">Anna del Moral Méndez</button><a class="ml-1" href="https://orcid.org/0000-0002-5015-840X" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rjkfop:" data-state="closed">Brenda Javornik</button><a class="ml-1" href="https://orcid.org/0009-0004-9266-9293" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rkkfop:" data-state="closed">Daniel Michelson</button><a class="ml-1" href="https://orcid.org/0000-0003-3222-9881" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rlkfop:" data-state="closed">Daniel Wolfensberger</button><a class="ml-1" href="https://orcid.org/0009-0006-1419-0556" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rmkfop:" data-state="closed">Gionata Ghiggi</button><a class="ml-1" href="https://orcid.org/0000-0002-0818-0865" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rnkfop:" data-state="closed">Jen DeHart</button><a class="ml-1" href="https://orcid.org/0000-0001-8536-4927" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rokfop:" data-state="closed">Jordi Figueras i Ventura</button><a class="ml-1" href="https://orcid.org/0000-0002-4949-422X" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rpkfop:" data-state="closed">Julian Giles</button><a class="ml-1" href="https://orcid.org/0000-0001-8134-008X" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rqkfop:" data-state="closed">Kai Mühlbauer</button><a class="ml-1" href="https://orcid.org/0000-0001-6599-1034" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rrkfop:" data-state="closed">Maxwell Grover</button><a class="ml-1" href="https://orcid.org/0000-0002-0370-8974" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rskfop:" data-state="closed">Mike Dixon</button><a class="ml-1" href="https://orcid.org/0000-0002-9597-9113" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rtkfop:" data-state="closed">Robert Jackson</button><a class="ml-1" href="https://orcid.org/0000-0003-2518-1234" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rukfop:" data-state="closed">Scott Collis</button><a class="ml-1" href="https://orcid.org/0000-0002-2303-687X" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span><span class="font-semibold text-sm inline-block"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rvkfop:" data-state="closed">Ting-Yu Cha</button><a class="ml-1" href="https://orcid.org/0000-0002-6292-8483" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span></div></header></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div class="sticky top-[60px] flex justify-end w-full z-20 pointer-events-none"><div class="flex p-1 m-1 space-x-1 border rounded-full shadow pointer-events-auto border-stone-300 bg-white/80 dark:bg-stone-900/80 backdrop-blur"><div class="rounded"><button class="flex text-center rounded-full cursor-pointer text-stone-800 dark:text-white hover:opacity-100 opacity-60" aria-label="start compute environment"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="inline-block w-6 h-6 align-top"><title>enable compute</title><path stroke-linecap="round" stroke-linejoin="round" d="M5.636 5.636a9 9 0 1012.728 0M12 3v9"></path></svg></button></div></div></div><div id="skip-to-article"></div><div id="t74xpl9iYY" class="relative group/block article-grid subgrid-gap col-screen"><p>In this tutorial, we demonstrate how to exploit GPM-API along with other radar software such
<a target="_blank" href="https://docs.openradarscience.org/projects/xradar/en/stable/" rel="noreferrer">xradar</a> and
<a target="_blank" href="https://docs.wradlib.org/en/latest/" rel="noreferrer">wradlib</a> to match reflectivities measurements of spaceborne (SR) and ground (GR) radars.</p><p>We guide you step-by-step through the process of obtaining spatially and temporally coincident radar samples.</p><p>The procedure, based on <cite data-state="closed"><a href="https://doi.org/10.1175/2010jtecha1403.1" target="_blank" rel="noreferrer" class="hover-link">Schwaller and Morris (2011)</a></cite> and adapted by <cite data-state="closed"><a href="https://doi.org/10.1175/jtech-d-17-0128.1" target="_blank" rel="noreferrer" class="hover-link">Warren, et. al. (2018)</a></cite>, involves:</p><ul><li>averaging SR reflectivities vertically along the SR beam between the half-power points of the GR sweep.</li><li>averaging GR reflectivities horizontally within the SR beam’s footprint.</li></ul><p>The basic principle is illustrated in Fig. 2 of the original paper of Schwaller and Morris (2011).</p><img id="a1btfpGy7c" style="margin:0 auto" src="/erad2024/_preview/111/build/cc72069fb56e0a54f1123fbe9c2fcb76.png" alt="figure 2" data-canonical-url="https://raw.githubusercontent.com/ghiggi/gpm_api/main/docs/source/static/fig2_schwaller_morris_2011.png"/><p>Warren et al. (2018) describe the method as follows:
<em>“[...] intersections between individual SR beams and GR elevation sweeps are identified and the reflectivity values from both  instruments are averaged within a spatial neighborhood around the intersection.
Specifically, SR data are averaged in range over the width of the GR beam at the GR range of the intersection, while GR data are averaged in the range–azimuth plane within the footprint of the SR beam.
The result is a pair of reflectivity measurements corresponding to approximately the same volume of atmosphere. [...]”.</em></p><p>The procedure should become clearer in Fig. 3:</p><img id="qugXDdSX58" style="margin:0 auto" src="/erad2024/_preview/111/build/93c53af642c2e2adf0ec8670f4a9a2f4.png" alt="figure 3" data-canonical-url="https://raw.githubusercontent.com/ghiggi/gpm_api/main/docs/source/static/fig3_schwaller_morris_2011.png"/></div><div id="G5kPIhNzBJ" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="relevant-software" class="relative group"><span class="heading-text">Relevant software</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#relevant-software" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="ivQKItHurg" class="relative group/block article-grid subgrid-gap col-screen"><p>To run this tutorial, it is necessary to install additional libraries which are not automatically required by GPM-API.
The libraries are
<a target="_blank" href="https://docs.openradarscience.org/projects/xradar/en/stable/" rel="noreferrer">xradar</a>,
<a target="_blank" href="https://docs.wradlib.org/en/latest/" rel="noreferrer">wradlib</a>,
<a target="_blank" href="https://geopandas.org/en/stable/" rel="noreferrer">geopandas</a>,
<a target="_blank" href="https://filesystem-spec.readthedocs.io/en/latest/" rel="noreferrer">fsspec</a>,
<a target="_blank" href="https://s3fs.readthedocs.io/en/latest/" rel="noreferrer">s3fs</a> and
<a target="_blank" href="https://python-visualization.github.io/folium/latest/" rel="noreferrer">folium</a>.
You can install them with terminal command <code>conda install -c conda-forge xradar wradlib geopandas fsspec s3fs folium</code></p></div><div id="GBZBmLWMVu" class="relative group/block article-grid subgrid-gap col-screen"><p>If you have such libraries installed, you can start importing the required packages:</p></div><div id="dUu1zCS3H4" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">import warnings

warnings.filterwarnings(&quot;ignore&quot;)
import datetime
from functools import reduce

import cartopy.crs as ccrs
import fsspec
import geopandas as gpd
import matplotlib.pyplot as plt
import numpy as np
import pandas as pd
import wradlib as wrl
import xarray as xr
import xradar as xd
from IPython.display import display
from shapely import Point
from xarray.backends.api import open_datatree
import gpm
from gpm.gv.routines import (
    convert_s_to_ku_band,
    retrieve_gates_projection_coordinates,
    xyz_to_antenna_coordinates,
)
from gpm.utils.remapping import reproject_coords
from gpm.utils.zonal_stats import PolyAggregator

np.set_printoptions(suppress=True)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="N47-eaHjsV_qmgh6sNO2a" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="tT0q7JIKH9" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="load-sr-and-gr-data" class="relative group"><span class="heading-text">Load SR and GR data</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#load-sr-and-gr-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="Qs6exBq5ry" class="relative group/block article-grid subgrid-gap col-screen"><p>In this tutorial, we exploit a coincident GPM DPR and NEXRAD overpass over San Diego, USA, during the landfall of Tropical Storm Hilary in 2023, to illustrate step-by-step the SR/GR volume matching procedure.</p><p>To facilitate your hands-on experience, we’ve preprocessed the native NEXRAD radar data using the xradar package and the coincident GPM DPR overpass using GPM-API. The resulting data has been uploaded in Zarr format to the Pythia Cloud Bucket, allowing you to start the tutorial directly in the Binder environment.</p><p>If you wish to adapt this tutorial to your own case study, you can use the xradar package to read your GR radar data into the expected xarray format. Similarly, you can retrieve the relevant GPM data using GPM-API. The GPM-API <a target="_blank" href="https://gpm-api.readthedocs.io/en/latest/tutorials/tutorial_03_SR_GR_Matching.html" rel="noreferrer">Spaceborne-Ground Radar Matching Tutorial</a> shows how to read NEXRAD GR data directly from the AWS S3 bucket and how to download the GPM data of interest using GPM-API.</p></div><div id="eX8vPDUwEM" class="relative group/block article-grid subgrid-gap col-screen"><p>To start this tutorial let’s open the NEXRAD ground radar data and the GPM granule with the coincident overpass.</p></div><div id="TKH4aJeED4" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Open fsspec connection to the bucket
bucket_url = &quot;https://js2.jetstream-cloud.org:8001&quot;
fs = fsspec.filesystem(&quot;s3&quot;, anon=True, client_kwargs=dict(endpoint_url=bucket_url))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Zg_rTOTbfdOtRxO9ydOEK" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="KZTRyLEz9H" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Open the GR datatree
file = fs.get_mapper(f&quot;pythia/radar/erad2024/gpm_api/KNKX20230820_221341_V06.zarr&quot;)
dt_gr = open_datatree(file, engine=&quot;zarr&quot;, consolidated=True, chunks={})
display(dt_gr)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="bMmIpjmwRI4pDtLFZmwuh" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="pEqJQgl9P9" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Open the SR dataset
file = fs.get_mapper(
    f&quot;pythia/radar/erad2024/gpm_api/2A.GPM.DPR.V9-20211125.20230820-S213941-E231213.053847.V07B.zarr&quot;
)
ds_sr = xr.open_zarr(file, consolidated=True, chunks={})</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="AV6Llhp_vMkB6VZkRg5TU" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="ATj67SgkP5" class="relative group/block article-grid subgrid-gap col-screen"><p>During this tutorial we will use only the GPM DPR Ku band reflectivities, therefore we subset the dataset here to facilitate the analysis.</p><p>Please note that the GPM DPR reflectivites measurements are provided by the <code>ZFactorFinal</code>and <code>ZFactorMeasured</code> variables:</p><ul><li>The <code>ZFactorMeasured</code> variable contains the reflectivity measurements with sidelobe clutter removed. However, it still includes ground clutter, background noise, and is not corrected for atmospheric and hydrometeors attenuation.</li><li>The <code>ZFactorFinal</code> represents the reflectivity measurements with background noise, ground clutter, and sidelobe clutter removed. The reflectivites have been corrected atmospheric and hydrometeors attenuation.</li></ul></div><div id="sYnYzo2fMx" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">ds_sr = ds_sr.sel({&quot;radar_frequency&quot;: &quot;Ku&quot;})</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="HbASnUghP1fT0izp-m7S2" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="RMOdVKHyLb" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">display(ds_sr)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="jeC2Xo3B_fximypRcKypR" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="tnVzEkIwmD" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="define-settings-for-sr-gr-matching" class="relative group"><span class="heading-text">Define settings for SR/GR matching</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#define-settings-for-sr-gr-matching" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="KT0jviNDBM" class="relative group/block article-grid subgrid-gap col-screen"><p>Here, we define key parameters and settings necessary for the SR/GR comparison. Minimum reflectivity thresholds are applied to exclude certain radar gates from the analysis, primarily to distinguish precipitating regions.</p><p>We strongly recommend specifying an “optimistic” minimum reflectivity sensitivity threshold, as reflectivities may be biased, and this approach allows for the assessment of non-uniform beam filling (NUBF) during the SR/GR matching process.</p><p>More restrictive filtering can be applied after the SR/GR gate matching is completed.</p></div><div id="eTNWOblPL6" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Define half power beam width angle (in degrees)
azimuth_beamwidth_gr = 1.0
elevation_beamwidth_gr = 1.0

# Define Z min threshold
z_min_threshold_gr = 0  # to remove dry case
z_min_threshold_sr = 10

# GR matching ROI
min_gr_range_lb = 0
max_gr_range_ub = 150_000

# Define SR CRS
crs_sr = ds_sr.gpm.pyproj_crs</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="EMCORvayv4sfQPRVvmh23" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="XUt5C1NBAP" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="preprocess-gr-data-with-xradar" class="relative group"><span class="heading-text">Preprocess GR data with xradar</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#preprocess-gr-data-with-xradar" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="pHeVrfVRFZ" class="relative group/block article-grid subgrid-gap col-screen"><p>Now we select the GR sweep, we georeference the dataset, we set the GR CRS and we extract GR radar gates coordinates.</p></div><div id="ZnrIrc3doe" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">sweep_idx = 0
sweep_group = f&quot;sweep_{sweep_idx}&quot;  # GR sweep (elevation to be used)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="0HTnAiYXlMNl0kiK5eJsQ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="NhhJ5dd5Zw" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Select sweep dataset
ds_gr = dt_gr[sweep_group].to_dataset().compute()

print(&quot;Sweep Mode:&quot;, ds_gr[&quot;sweep_mode&quot;].to_numpy())
print(&quot;Sweep Elevation Angle:&quot;, ds_gr[&quot;sweep_fixed_angle&quot;].to_numpy())

# Set auxiliary info as coordinates
# - To avoid broadcasting i.e. when masking
possible_coords = [&quot;sweep_mode&quot;, &quot;sweep_number&quot;, &quot;prt_mode&quot;, &quot;follow_mode&quot;, &quot;sweep_fixed_angle&quot;]
extra_coords = [coord for coord in possible_coords if coord in ds_gr]
ds_gr = ds_gr.set_coords(extra_coords)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="C7GHhgCCGmzHnTdFux9yU" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Sweep Mode: azimuth_surveillance
Sweep Elevation Angle: 0.4833984375
</span></code></pre></div></div></div><div id="RK7If8IYPU" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Georeference the data on a azimuthal_equidistant projection centered on the radar
ds_gr = ds_gr.xradar.georeference()
ds_gr[&quot;crs_wkt&quot;].attrs</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="_c6Om2s4KbDorQodHCwWT" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>{&#x27;crs_wkt&#x27;: &#x27;PROJCRS[&quot;unknown&quot;,BASEGEOGCRS[&quot;unknown&quot;,DATUM[&quot;World Geodetic System 1984&quot;,ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,LENGTHUNIT[&quot;metre&quot;,1]],ID[&quot;EPSG&quot;,6326]],PRIMEM[&quot;Greenwich&quot;,0,ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],ID[&quot;EPSG&quot;,8901]]],CONVERSION[&quot;unknown&quot;,METHOD[&quot;Azimuthal Equidistant&quot;,ID[&quot;EPSG&quot;,1125]],PARAMETER[&quot;Latitude of natural origin&quot;,32.919017791748,ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],ID[&quot;EPSG&quot;,8801]],PARAMETER[&quot;Longitude of natural origin&quot;,-117.041801452637,ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],ID[&quot;EPSG&quot;,8802]],PARAMETER[&quot;False easting&quot;,0,LENGTHUNIT[&quot;metre&quot;,1],ID[&quot;EPSG&quot;,8806]],PARAMETER[&quot;False northing&quot;,0,LENGTHUNIT[&quot;metre&quot;,1],ID[&quot;EPSG&quot;,8807]]],CS[Cartesian,2],AXIS[&quot;(E)&quot;,east,ORDER[1],LENGTHUNIT[&quot;metre&quot;,1,ID[&quot;EPSG&quot;,9001]]],AXIS[&quot;(N)&quot;,north,ORDER[2],LENGTHUNIT[&quot;metre&quot;,1,ID[&quot;EPSG&quot;,9001]]]]&#x27;,
 &#x27;semi_major_axis&#x27;: 6378137.0,
 &#x27;semi_minor_axis&#x27;: 6356752.314245179,
 &#x27;inverse_flattening&#x27;: 298.257223563,
 &#x27;reference_ellipsoid_name&#x27;: &#x27;WGS 84&#x27;,
 &#x27;longitude_of_prime_meridian&#x27;: 0.0,
 &#x27;prime_meridian_name&#x27;: &#x27;Greenwich&#x27;,
 &#x27;geographic_crs_name&#x27;: &#x27;unknown&#x27;,
 &#x27;horizontal_datum_name&#x27;: &#x27;World Geodetic System 1984&#x27;,
 &#x27;projected_crs_name&#x27;: &#x27;unknown&#x27;,
 &#x27;grid_mapping_name&#x27;: &#x27;azimuthal_equidistant&#x27;,
 &#x27;latitude_of_projection_origin&#x27;: 32.91901779174805,
 &#x27;longitude_of_projection_origin&#x27;: -117.04180145263672,
 &#x27;false_easting&#x27;: 0.0,
 &#x27;false_northing&#x27;: 0.0}</span></code></div></div></div><div id="NSrVXTmBck" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Get the GR CRS
crs_gr = ds_gr.xradar_dev.pyproj_crs</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="fdbOTRmYK5gzby7C27CfV" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="cZRg5gV3hF" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Add lon/lat coordinates to GR
# - Useful for plotting ;)
lon_gr, lat_gr, height_gr = reproject_coords(x=ds_gr[&quot;x&quot;], y=ds_gr[&quot;y&quot;], z=ds_gr[&quot;z&quot;], src_crs=crs_gr, dst_crs=crs_sr)
ds_gr[&quot;lon&quot;] = lon_gr
ds_gr[&quot;lat&quot;] = lat_gr
ds_gr = ds_gr.set_coords([&quot;lon&quot;, &quot;lat&quot;])</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="kGdqPyPx8Kr4EnSrwYIIm" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="LOwpD4LEW9" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Set GR gates with Z &lt; 0 to NaN
# - Following Morris and Schwaller 2011 recommendation
ds_gr = ds_gr.where(ds_gr[&quot;DBZH&quot;] &gt;= 0)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="mCx713-DUmV_orcdAS5CF" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="Z3ByJWiK8C" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Show some GR fields
ds_gr[&quot;DBZH&quot;].xradar_dev.plot_map()
ds_gr[&quot;RHOHV&quot;].xradar_dev.plot_map()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="gg5LR1y5RdXIOXleKxcA-" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&lt;cartopy.mpl.geocollection.GeoQuadMesh at 0x7f2f4c33d850&gt;</span></code></div><img src="/erad2024/_preview/111/build/f6a366e8db38782e0b8ab41855aec2f9.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/8e9cab792ad1638eb3623f948e2ba5d7.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="CXXunN4Vtf" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Retrieve GR extent
extent_gr = ds_gr.xradar_dev.extent(max_distance=None, crs=None)
extent_gr</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="CLH6ErRjrnym8jJzCZ8Sp" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>[-121.95467110437517,
 -112.12893180089884,
 28.771031109975677,
 37.06425438465268]</span></code></div></div></div><div id="bBohm0HOtL" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="preprocess-sr-data" class="relative group"><span class="heading-text">Preprocess SR data</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#preprocess-sr-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="FIvAUACNqw" class="relative group/block article-grid subgrid-gap col-screen"><p>Let’s start by cropping the SR granule on the GR extent and put data into memory:</p></div><div id="u4Iv14TiGX" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">ds_sr = ds_sr.gpm.crop(extent_gr).compute()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="ieHOCq4QUb_qr5snAjNng" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="VKq830UmFN" class="relative group/block article-grid subgrid-gap col-screen"><p>We can further subset the GPM overpass selecting the scans occured between the following timesteps:</p></div><div id="xrJ7DllGOT" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">start_time = datetime.datetime.strptime(&quot;2023-08-20 22:12:00&quot;, &quot;%Y-%m-%d %H:%M:%S&quot;)
end_time = datetime.datetime.strptime(&quot;2023-08-20 22:13:45&quot;, &quot;%Y-%m-%d %H:%M:%S&quot;)
ds_sr = ds_sr.gpm.sel(time=slice(start_time, end_time))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="pSb3DMWK5wFpQvcOX4NM6" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="OaPq9Jlr07" class="relative group/block article-grid subgrid-gap col-screen"><p>Now let’s display some variables illustrating the GPM overpass</p></div><div id="xIff2r6XkN" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">ds_sr[&quot;precipRateNearSurface&quot;].gpm.plot_map()
ds_sr[&quot;zFactorMeasured&quot;].gpm.slice_range_at_bin(ds_sr[&quot;binClutterFreeBottom&quot;]).gpm.plot_map(
    vmax=40,
)  # zFactorMeasuredNearSurface
ds_sr[&quot;zFactorFinalNearSurface&quot;].gpm.plot_map(vmax=40)
ds_sr[&quot;flagPrecip&quot;].gpm.plot_map()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="l056Bn0auyhDD5CkAfeY9" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&lt;cartopy.mpl.geocollection.GeoQuadMesh at 0x7f2f2be77950&gt;</span></code></div><img src="/erad2024/_preview/111/build/7ed85a8083cdb44e053a26d9b8ae27fa.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/ee7c417f3e6316dc4a6b87bbc558a326.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/6413220e5698f8357fd077c32fd12285.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/d3e34621f0f5b74bb1eabc917866490a.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="TjXBuwf8EQ" class="relative group/block article-grid subgrid-gap col-screen"><p>In the following map and cross-sections, we can see that the <code>zFactorMeasured</code> variable is contaminated by ground clutter:</p></div><div id="IaBjEasHe4" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Display the maximum observed reflectivity
ds_sr[&quot;zFactorMeasured&quot;].max(dim=&quot;range&quot;).gpm.plot_map()
ds_sr[&quot;zFactorFinal&quot;].max(dim=&quot;range&quot;).gpm.plot_map(vmax=40)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="9lRoA208zDE8PzUm890Bo" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&lt;cartopy.mpl.geocollection.GeoQuadMesh at 0x7f2f4418ee50&gt;</span></code></div><img src="/erad2024/_preview/111/build/b9d4e0f81cf20abda9c06ad51a0dc867.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/911bb6696dcef801a60647d01e9033bd.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="bzrIC2i5OI" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Compute SR attenuation correction
ds_sr[&quot;zFactorCorrection&quot;] = ds_sr[&quot;zFactorFinal&quot;] - ds_sr[&quot;zFactorMeasured&quot;]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="lOR0VLB-LBRz9HYnNORv4" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="hQc0nzj3AL" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Display cross-section
ds_sr[&quot;zFactorMeasured&quot;].isel(cross_track=24).gpm.plot_cross_section(zoom=False)
ds_sr[&quot;zFactorFinal&quot;].isel(cross_track=24).gpm.plot_cross_section(zoom=False)
ds_sr[&quot;zFactorCorrection&quot;].isel(cross_track=24).gpm.plot_cross_section(vmin=0, vmax=3, cmap=&quot;Spectral_r&quot;, zoom=False)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="RWG-MhuLjGiEhEbbcovwz" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/111/build/a8c0b5c8438002949c47e4c866761dee.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/14b7bc7e01f058a6814c28982a10def2.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/d9d35dcee96373af08b99126776f4eb6.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="z2K03n7FmB" class="relative group/block article-grid subgrid-gap col-screen"><p>So now we mask out gates impacted by ground clutter, adn we verify with maps and cross-sections that the ground clutter is effectively removed:</p></div><div id="HUig6BPSoG" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Mask SR gates with ground clutter
ds_sr[&quot;zFactorMeasured&quot;] = ds_sr[&quot;zFactorMeasured&quot;].gpm.mask_below_bin(
    bins=ds_sr[&quot;binClutterFreeBottom&quot;],
    strict=False,
)  # do not mask the specified bin
ds_sr[&quot;zFactorCorrection&quot;] = ds_sr[&quot;zFactorCorrection&quot;].gpm.mask_below_bin(
    bins=ds_sr[&quot;binClutterFreeBottom&quot;],
    strict=False,
)  # do not mask the specified bin</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Qfk2xMsXOVIBiPT_OIdvd" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="VWHPFnk9z4" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Display the maximum observed reflectivity
ds_sr[&quot;zFactorMeasured&quot;].max(dim=&quot;range&quot;).gpm.plot_map()
ds_sr[&quot;zFactorFinal&quot;].max(dim=&quot;range&quot;).gpm.plot_map(vmax=40)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="oYeuuHRJ35jB2zKxqul59" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&lt;cartopy.mpl.geocollection.GeoQuadMesh at 0x7f2f44ff2f10&gt;</span></code></div><img src="/erad2024/_preview/111/build/9b397d664e673f5cc43fa05d3e71d2df.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/911bb6696dcef801a60647d01e9033bd.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="fsTdzNsXvT" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Display cross-section with ground clutter masked out
ds_sr[&quot;zFactorMeasured&quot;].isel(cross_track=24).gpm.plot_cross_section(zoom=False)
ds_sr[&quot;zFactorFinal&quot;].isel(cross_track=24).gpm.plot_cross_section(zoom=False)
ds_sr[&quot;zFactorCorrection&quot;].isel(cross_track=24).gpm.plot_cross_section(vmin=0, vmax=3, cmap=&quot;Spectral_r&quot;, zoom=False)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="kjf-UXUPt9KpqnMHqaiwV" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/111/build/5787f86ae210879886b966f1c37fb0a7.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/14b7bc7e01f058a6814c28982a10def2.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/f6260996327fb352405b01be1fe80d16.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="kRChiogqgH" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="retrieve-gr-gate-resolution" class="relative group"><span class="heading-text">Retrieve GR gate resolution</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#retrieve-gr-gate-resolution" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>In this subsection we derive the horizontal and vertical resolution of GR gates.</p><p>The GR horizontal and vertical resolution change as a function of the range distance.</p></div><div id="ZYc06ze0kW" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Compute horizontal and vertical GR gate resolution
h_res_gr, v_res_gr = ds_gr.xradar_dev.resolution_at_range(
    azimuth_beamwidth=azimuth_beamwidth_gr,
    elevation_beamwidth=elevation_beamwidth_gr,
)
h_res_gr.xradar_dev.plot_map()
v_res_gr.xradar_dev.plot_map()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="ZK54ZFRE5nNfQwGmW8bDu" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&lt;cartopy.mpl.geocollection.GeoQuadMesh at 0x7f2f2b565d10&gt;</span></code></div><img src="/erad2024/_preview/111/build/bb0fdf9ea9b251aef609087c2e8e57bc.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/bb0fdf9ea9b251aef609087c2e8e57bc.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="DgvNRVkpkR" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="define-gr-range-distance-interval" class="relative group"><span class="heading-text">Define GR range distance interval</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#define-gr-range-distance-interval" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="PA9TbtZn4t" class="relative group/block article-grid subgrid-gap col-screen"><p>Now let’s define the minimum range distance at which the GR gate vertical resolution is larger than 150/250 m (the range resolution of GPM) and at which GR distance the GR gate vertical resolution exceed 1500 m (which correspond to 12/6 SR gates included in a GR gate)</p></div><div id="M4iYvKPTyl" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">mask_gr_gate_depth_above_250 = v_res_gr &gt; 250
mask_gr_gate_depth_above_250.xradar_dev.plot_map()
min_gr_range = np.max(
    mask_gr_gate_depth_above_250[&quot;range&quot;].data[mask_gr_gate_depth_above_250.sum(dim=&quot;azimuth&quot;) == 0],
)  # min_range_distance

mask_gr_gate_depth_below_2000 = v_res_gr &gt; 1500
mask_gr_gate_depth_below_2000.xradar_dev.plot_map()
max_gr_range = np.max(
    mask_gr_gate_depth_below_2000[&quot;range&quot;].data[mask_gr_gate_depth_below_2000.sum(dim=&quot;azimuth&quot;) == 0],
)  # min_range_distance

print(&quot;Minimum GR distance:&quot;, min_gr_range, &quot;m&quot;)
print(&quot;Maximum GR distance:&quot;, max_gr_range, &quot;m&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="FUvMkJXGTHVqU3e-Olfct" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Minimum GR distance: 14125.0 m
Maximum GR distance: 85875.0 m
</span></code></pre></div><img src="/erad2024/_preview/111/build/d038a702d422e356bc0a0126e6d0d9e7.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/2495d1f4d0cfaa5de1d47bfbcb5e4f57.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="Z3V3qFBSnB" class="relative group/block article-grid subgrid-gap col-screen"><p>Now let’s specify the minimum and maximum GR range distance to consider when matching SR/GR gates.</p><p>It’s good practice to avoid restricting too much at this stage. Matched SR/GR gates can be filtered afterwards.</p></div><div id="Wk676a55nf" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Specify GR range distance interval over which to perform SR matching
min_gr_range = 7_000  # about 15_000 km
max_gr_range = 150_000</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="2w-cwnkoFFxchc2sngBFu" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="AE4ygvWMtl" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="display-sr-slice-and-gr-sweep" class="relative group"><span class="heading-text">Display SR slice and GR sweep</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#display-sr-slice-and-gr-sweep" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="xWDqRt05w5" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Slice SR volume
da_sr = ds_sr[&quot;zFactorFinal&quot;].isel(range=-5)
da_sr = ds_sr[&quot;zFactorFinal&quot;].gpm.slice_range_at_bin(ds_sr[&quot;binClutterFreeBottom&quot;])
da_sr = ds_sr[&quot;zFactorFinal&quot;].gpm.slice_range_at_height(value=2000)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="7w4wJBd90PRMGNhB85Pui" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="SoIMhnFQWl" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Define SR and GR mask
mask_gr = ds_gr[&quot;DBZH&quot;] &gt;= z_min_threshold_gr
# mask_gr = np.logical_and(ds_gr[&quot;DBZH&quot;] &gt;= z_min_threshold_gr, ds_gr[&quot;RHOHV&quot;] &gt;= 0.80)

mask_sr = True  # aka do not mask

# Retrieve SR extent
sr_extent = ds_sr.gpm.extent()

# Define cmap
cmap = &quot;Spectral_r&quot;

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(8, 4), dpi=120, subplot_kw={&quot;projection&quot;: ccrs.PlateCarree()})
# - Plot SR
p_sr = da_sr.where(mask_sr).gpm.plot_map(
    ax=ax1,
    cmap=cmap,
    vmin=0,
    vmax=40,
    cbar_kwargs={&quot;label&quot;: &quot;SR Reflectivity (dBz)&quot;},
    add_colorbar=True,
)
# - Plot GR
ds_gr[&quot;DBZH&quot;].where(mask_gr).xradar_dev.plot_map(
    ax=ax2,
    cmap=cmap,
    vmin=0,
    vmax=40,
    cbar_kwargs={&quot;label&quot;: &quot;GR Reflectivity (dBz)&quot;, &quot;extend&quot;: &quot;both&quot;},
    add_colorbar=True,
)
# - Add the SR swath boundary
da_sr.gpm.plot_swath_lines(ax=ax2)
# - Restrict the extent to the SR overpass
ax2.set_extent(sr_extent)
# - Display GR range distances
for ax in [ax1, ax2]:
    ds_gr.xradar_dev.plot_range_distance(
        distance=min_gr_range,
        ax=ax,
        add_background=True,
        linestyle=&quot;dashed&quot;,
        edgecolor=&quot;black&quot;,
    )
    ds_gr.xradar_dev.plot_range_distance(
        distance=max_gr_range,
        ax=ax,
        add_background=True,
        linestyle=&quot;dashed&quot;,
        edgecolor=&quot;black&quot;,
    )
    ds_gr.xradar_dev.plot_range_distance(
        distance=250_000,
        ax=ax,
        add_background=True,
        linestyle=&quot;dashed&quot;,
        edgecolor=&quot;black&quot;,
    )
# - Add GR location
ax1.scatter(ds_gr[&quot;longitude&quot;], ds_gr[&quot;latitude&quot;], c=&quot;black&quot;, marker=&quot;X&quot;, s=4)
ax2.scatter(ds_gr[&quot;longitude&quot;], ds_gr[&quot;latitude&quot;], c=&quot;black&quot;, marker=&quot;X&quot;, s=4)
# - Set title
ax1.set_title(&quot;GPM&quot;, fontsize=12, loc=&quot;left&quot;)
ax2.set_title(&quot;Ground Radar&quot;, fontsize=12, loc=&quot;left&quot;)
# - Improve layout and display
plt.tight_layout()
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="OJRHVs4D8sUahoVRl0G40" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/111/build/188ee71808681d3e31b23f9e72fc9f06.png" alt="&lt;Figure size 960x480 with 4 Axes&gt;"/></div></div><div id="ZqlogFCrly" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="retrieve-gr-lon-lat-coordinates" class="relative group"><span class="heading-text">Retrieve GR (lon, lat) coordinates</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#retrieve-gr-lon-lat-coordinates" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Here we retrieve the 2D non-dimensional longitude and latitude coordinates in the CRS of the SR.
These 2D coordinates will have dimensions (azimuth, range)</p></div><div id="KJesUeVldH" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">lon_gr, lat_gr, height_gr = reproject_coords(x=ds_gr[&quot;x&quot;], y=ds_gr[&quot;y&quot;], z=ds_gr[&quot;z&quot;], src_crs=crs_gr, dst_crs=crs_sr)

# If crs_gr and crs_sr share same datum/ellispoid, z does not vary
print(crs_gr.datum)
print(crs_sr.datum)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="kUYN7X-X3vcc5ZNV2NgLt" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>World Geodetic System 1984
Unknown based on WGS 84 ellipsoid
</span></code></pre></div></div></div><div id="Bfb5pShEZY" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="retrieve-sr-x-y-z-coordinates" class="relative group"><span class="heading-text">Retrieve SR (x,y,z) coordinates</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#retrieve-sr-x-y-z-coordinates" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Here we retrieve the 3D (x,y,z) coordinates of SR gates in the GR CRS projection.</p><p>The GR CRS is a azimuthal equidistant (AZEQ) projection centered on the ground radar.
In the GR CRS, the (x,y) coordinates (0,0) corresponds to the location of the ground radar.
Therefore, the retrieved SR (x,y) coordinates are relative to the ground radar site, while the z coordinates is relative to the ellipsoid.</p></div><div id="wyVsNNuDZo" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">x_sr, y_sr, z_sr = retrieve_gates_projection_coordinates(ds_sr, dst_crs=crs_gr)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="poYTFVo6mQjvFIEPifOdM" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="MTvx0F4M8Z" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="retrieve-sr-range-azimuth-elevation-coordinates" class="relative group"><span class="heading-text">Retrieve SR (range, azimuth, elevation) coordinates</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#retrieve-sr-range-azimuth-elevation-coordinates" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="snLY8eIGBL" class="relative group/block article-grid subgrid-gap col-screen"><p>Now we inverse the SR (x,y,z) 3D GR CRS coordinates to derive the SR (range, azimuth, elevation) coordinates with respect to GR sweep.
These coordinates allow to identify the SR gates intersecting the GR sweep.</p></div><div id="oxM49Tlovu" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">range_sr, azimuth_sr, elevation_sr = xyz_to_antenna_coordinates(
    x=x_sr,
    y=y_sr,
    z=z_sr,
    site_altitude=ds_gr[&quot;altitude&quot;],
    crs=crs_gr,
    effective_radius_fraction=None,
)
print(range_sr.isel(cross_track=0).min().item(), &quot;m&quot;)  # far from the radar
print(range_sr.isel(cross_track=-1).min().item(), &quot;m&quot;)  # closer to radar</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Ab8S8W8qL1vPKmg0XLTND" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>252837.9704755049 m
9164.066906023296 m
</span></code></pre></div></div></div><div id="HTYvH02FbD" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Show elevation angle at different SR scan angle
elevation_sr.isel(cross_track=0).gpm.plot_cross_section(vmin=0)  # far from the radar
elevation_sr.isel(cross_track=-1).gpm.plot_cross_section(vmin=0)  # closer to radar</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="NELHYClaouNffV67EUnsm" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/111/build/3df66bf3f8f6d2f6f10a8143a68e8d8b.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/4ce35b466fe00f95aabdfc96289aa63a.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="BKNxNnWRmq" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="retrieve-sr-range-distance" class="relative group"><span class="heading-text">Retrieve SR range distance</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#retrieve-sr-range-distance" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>The range distance from the satellite for each SR radar gate has been precomputed using information in the GPM L1B product and already included in the preprocessed GPM Zarr Store.</p></div><div id="VBNbWD6UuT" class="relative group/block article-grid subgrid-gap col-screen"><p>The <code>range_distance_from_satellite</code> can also be derived from the GPM L2 product if we assume a cross-track scan angle.
However, uncertainties in cross-tracks scan angle can erroneously impacts the estimates.
As we show here below, an uncertainty of 0.1° translates to a range distance difference of up to 400 m which corresponds to 3/4 radar gates !</p></div><div id="kPjy0Bv12A" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Show impact of scan angle on range distance
# - Variation of 0.01 impacts range distance up to 30 m
# - Variation of 0.05 impacts range distance up to 100 m
# - Variation of 0.1 impacts range distance up to 400 m
scan_angle_template = np.abs(np.linspace(-17.04, 17.04, 49))  # assuming Ku swath of size 49
scan_angle = xr.DataArray(scan_angle_template[ds_sr[&quot;gpm_cross_track_id&quot;].data], dims=&quot;cross_track&quot;)
scan_angle = scan_angle + 0.1
l2_distance = ds_sr.gpm.retrieve(&quot;range_distance_from_satellite&quot;, scan_angle=scan_angle)

diff = l2_distance - ds_sr[&quot;range_distance_from_satellite&quot;]
diff.isel(along_track=0).gpm.plot_cross_section()  # difference &gt; 500 m</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="vJeIJ1XVTJxzDbn-ThaqX" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/111/build/50bfa253a6cbc798c065f63d6f6f5508.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="lfxpNeRKgu" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="retrieve-radar-gates-volumes" class="relative group"><span class="heading-text">Retrieve radar gates volumes</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#retrieve-radar-gates-volumes" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Here we compute SR and GR gate volumes.</p><p>An accurate beam width is necessary to derive accurate gate volume estimates. This is demonstrated here below !</p></div><div id="DYgNio2ljH" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Compute GR gates volumes
vol_gr = wrl.qual.pulse_volume(
    ds_gr[&quot;range&quot;],  # range distance
    h=ds_gr[&quot;range&quot;].diff(&quot;range&quot;).median(),  # range resolution
    theta=elevation_beamwidth_gr,
)  # beam width
vol_gr = vol_gr.broadcast_like(ds_gr[&quot;DBZH&quot;])
vol_gr = vol_gr.assign_coords({&quot;lon&quot;: ds_gr[&quot;lon&quot;], &quot;lat&quot;: ds_gr[&quot;lat&quot;]})</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="R1WaXgUlV6usUqbc9G9e2" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="ceg4eyfc8S" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Compute SR gates volumes
range_distance = ds_sr[&quot;range_distance_from_satellite&quot;]
vol_sr = ds_sr.gpm.retrieve(&quot;gate_volume&quot;, beam_width=ds_sr[&quot;crossTrackBeamWidth&quot;], range_distance=range_distance)
vol_sr.isel(along_track=0).gpm.plot_cross_section()
vol_sr.isel(range=-1).gpm.plot_map()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="tSIlU8UA8VjmMbpJs9aXd" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&lt;cartopy.mpl.geocollection.GeoQuadMesh at 0x7f2f4c421bd0&gt;</span></code></div><img src="/erad2024/_preview/111/build/aa76b6e08b6e20fbbab1fc3eba5b70e5.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/adda2487f074d09b8415aaba9f87a43d.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="DDahItV57t" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Assuming fixed beamwidth with SR leads to volume difference up to 0.35 km3
vol_sr1 = ds_sr.gpm.retrieve(&quot;gate_volume&quot;, beam_width=0.71, range_distance=range_distance)
diff = vol_sr - vol_sr1
diff.isel(along_track=0).gpm.plot_cross_section()
diff.isel(range=-1).gpm.plot_map()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="nJ549cSSLYlbiCrlobEa4" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&lt;cartopy.mpl.geocollection.GeoQuadMesh at 0x7f2f292b7b50&gt;</span></code></div><img src="/erad2024/_preview/111/build/254c479626641018a801abe173e4d649.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/40ecdda63d7ac4d63e0866bdd27ae770.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="Mbrlt7JIH5" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="retrieve-sr-gate-resolution" class="relative group"><span class="heading-text">Retrieve SR gate resolution</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#retrieve-sr-gate-resolution" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>In this subsection we derive the horizontal and vertical SR gate resolution.</p><p>The SR horizontal resolution change for each radar gate, while the vertical resolution varies only across SR footprints.
Note that the vertical resolution here derived is equivalent to the GPM L2 product variable <code>height</code>.</p><p>Assuming a fixed beamwidth of 0.71 can leads to variations in horizontal resolution estimates up to 400 m on the outer-track.</p></div><div id="tBTEL7qYkF" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Compute horizontal and vertical SR gate resolution
range_distance = ds_sr[&quot;range_distance_from_satellite&quot;]
h_res_sr, v_res_sr = ds_sr.gpm.retrieve(&quot;gate_resolution&quot;, beam_width=ds_sr[&quot;crossTrackBeamWidth&quot;], range_distance=range_distance)
h_radius = h_res_sr / 2</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="r0-PfsXCo9tZ1ug2xrkvu" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="EQ1gnQbOKh" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Validate v_res_sr [OK !]
diff = -ds_sr[&quot;height&quot;].diff(dim=&quot;range&quot;) - v_res_sr
diff.isel(along_track=0).gpm.plot_cross_section(y=&quot;range&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Y5g5s_cCSYCd7ooVZMX0i" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/111/build/cab32ecb811a96f0b79165ce2e44a1dd.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="sPVyKK5Xvb" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Validate h_res [PROBLEMATIC WITH FIXED BEAM WIDTH]
h_res1_sr, _ = ds_sr.gpm.retrieve(&quot;gate_resolution&quot;, beam_width=None, range_distance=range_distance)  # Use 0.71
diff = h_res_sr - h_res1_sr
diff.isel(along_track=0).gpm.plot_cross_section(y=&quot;range&quot;)
diff.isel(range=-1).gpm.plot_map()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="i2LJohu81f3ATsoXk0iu0" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&lt;cartopy.mpl.geocollection.GeoQuadMesh at 0x7f2f44b274d0&gt;</span></code></div><img src="/erad2024/_preview/111/build/d48dde345555207c83edc6515bf52c1b.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/b1ccb053f2a8444cee730c6e46e4fec4.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="SMbdr6IUfu" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="retrieve-bright-band-bb-ratio" class="relative group"><span class="heading-text">Retrieve Bright Band (BB) Ratio</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#retrieve-bright-band-bb-ratio" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Here we derive the bright band ratio, which is defined as follow:</p><ul><li>A BB ratio of &lt; 0 indicates that a bin is located below the melting layer (ML).</li><li>A BB ratio of &gt; 0 indicates that a bin is located above the ML.</li><li>A BB ratio with values in between 0 and 1 indicates tha the radar is inside the ML.</li></ul></div><div id="PC1krkEMoU" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">da_bb_ratio, da_bb_mask = ds_sr.gpm.retrieve(&quot;bright_band_ratio&quot;, return_bb_mask=True)
da_bb_ratio.isel(cross_track=24).gpm.plot_cross_section(vmin=0, vmax=1)
da_bb_ratio.isel(range=0).gpm.plot_map()  # top
da_bb_ratio.isel(range=-1).gpm.plot_map()  # bottom</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="U28adyjt0ftuKwZM1ogvS" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&lt;cartopy.mpl.geocollection.GeoQuadMesh at 0x7f2f4499c250&gt;</span></code></div><img src="/erad2024/_preview/111/build/00a77674411e179d68d55d5fcf8a1fb4.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/b7f5201ed33394ee13fc42167da96ffe.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/9a42084c618d61e6ea45ba71d9b8124e.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="JNA4HkWwuf" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Show difference between L2 qualityBB and custom derived BB mask
ds_sr[&quot;qualityBB&quot;].gpm.plot_map()
da_bb_mask.gpm.plot_map()
ds_sr[&quot;qualityBB&quot;].attrs</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="KUOO93lknWHPb6KXTo4JB" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>{&#x27;description&#x27;: &#x27;Quality of Bright-Band Detection&#x27;,
 &#x27;flag_meanings&#x27;: [&#x27;BB not detected&#x27;, &#x27;BB detected&#x27;],
 &#x27;flag_values&#x27;: [0, 1],
 &#x27;gpm_api_decoded&#x27;: &#x27;yes&#x27;,
 &#x27;gpm_api_product&#x27;: &#x27;2A-DPR&#x27;,
 &#x27;grid_mapping&#x27;: &#x27;crsWGS84&#x27;}</span></code></div><img src="/erad2024/_preview/111/build/c521eda0d3f37fc04859a14d39abd2bc.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/c699496c02a906a7527a67a4e93c34d6.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="K1GrOIwoe2" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="retrieve-precipitation-and-hydrometeors-types" class="relative group"><span class="heading-text">Retrieve Precipitation and Hydrometeors Types</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#retrieve-precipitation-and-hydrometeors-types" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="SAWOs0TmRN" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Retrieve precipitation type classification
ds_sr[&quot;flagPrecipitationType&quot;] = ds_sr.gpm.retrieve(&quot;flagPrecipitationType&quot;, method=&quot;major_rain_type&quot;)
ds_sr[&quot;flagPrecipitationType&quot;].gpm.plot_map()
ds_sr[&quot;flagPrecipitationType&quot;].attrs</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="r4JQkJeLXd10qhzyk6IrK" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>{&#x27;flag_values&#x27;: [0, 1, 2, 3],
 &#x27;flag_meanings&#x27;: [&#x27;no rain&#x27;, &#x27;stratiform&#x27;, &#x27;convective&#x27;, &#x27;other&#x27;],
 &#x27;description&#x27;: &#x27;Precipitation type&#x27;}</span></code></div><img src="/erad2024/_preview/111/build/7a4549d4fb32d6d2c1829cacd09d25ce.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="MT0eWuoQV8" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Retrieve hydrometeors classification
ds_sr[&quot;flagHydroClass&quot;] = ds_sr.gpm.retrieve(&quot;flagHydroClass&quot;)
ds_sr[&quot;flagHydroClass&quot;].isel(cross_track=24).gpm.plot_cross_section()
ds_sr[&quot;flagHydroClass&quot;].attrs</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="LLBduPkntuUb2K3Pm3gVb" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>{&#x27;flag_values&#x27;: [0, 1, 2, 3, 4, 5],
 &#x27;flag_meanings&#x27;: [&#x27;no precipitation&#x27;,
  &#x27;rain&#x27;,
  &#x27;snow&#x27;,
  &#x27;hail&#x27;,
  &#x27;melting layer&#x27;,
  &#x27;clutter&#x27;]}</span></code></div><img src="/erad2024/_preview/111/build/5fe8eb64f1ca97ed4fc547f83b21bf8e.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="LRu8qpQru5" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Visualize cross-section
precip_type3d = xr.ones_like(ds_sr[&quot;flagHydroClass&quot;]) * ds_sr[&quot;flagPrecipitationType&quot;]
precip_type3d = precip_type3d.where(ds_sr[&quot;zFactorFinal&quot;] &gt; 10)
precip_type3d.name = ds_sr[&quot;flagPrecipitationType&quot;].name

precip_type3d.isel(cross_track=24).gpm.plot_cross_section()
ds_sr[&quot;flagHydroClass&quot;].where(ds_sr[&quot;flagHydroClass&quot;] &gt; 0).isel(cross_track=24).gpm.plot_cross_section()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="8oZpSio260DebhEQy1c6I" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/111/build/2a96d0bb168d3abb750eec9da515daf1.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/cc991e79952eb5133ce51eb720935e9a.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="fnf2aMDZ31" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="convert-sr-ku-band-to-s-band" class="relative group"><span class="heading-text">Convert SR Ku-band to S-band</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#convert-sr-ku-band-to-s-band" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="eqMtAsvI2M" class="relative group/block article-grid subgrid-gap col-screen"><p>Here we convert reflectivities from Ku-band to S-band based on <cite data-state="closed"><a href="https://doi.org/10.1002/jgrd.50138" target="_blank" rel="noreferrer" class="hover-link">Cao et al., (2013)</a></cite>.</p><p>When filtering the SR/GR matched samples, plase consider to select:</p><ul><li>only reflectivities below 35 dBZ for S-band GR radars to avoid non-rayleigh scattering</li><li>only reflectivities below 25 dBZ for C/X-band GR radars</li></ul></div><div id="sqAbRS30kQ" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># With attenuation corrected reflectivity
da_z_s_final = ds_sr.gpm.retrieve(&quot;s_band_cao2013&quot;, reflectivity=&quot;zFactorFinal&quot;, bb_ratio=None, precip_type=None)
da_z_ku_final = ds_sr[&quot;zFactorFinal&quot;]
dfr_s_ku_final = da_z_s_final - da_z_ku_final
dfr_s_ku_final.name = &quot;DRF_S_Ku&quot;

dfr_s_ku_final.isel(cross_track=24).gpm.plot_cross_section()
da_z_ku_final.isel(cross_track=24).gpm.plot_cross_section()
da_z_s_final.isel(cross_track=24).gpm.plot_cross_section()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="HDWv31bv-FcgB4zfKgm8k" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/111/build/93673c05c68b8def1c6be7cc9a352943.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/e92b81a0e1d7aed383a3a21b7ba845ce.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/84e3d34f61c50a013d0e047adf45caa5.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="hPe2Pjna0i" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># With measured reflectivity
da_z_s_measured = ds_sr.gpm.retrieve(&quot;s_band_cao2013&quot;, reflectivity=&quot;zFactorMeasured&quot;, bb_ratio=None, precip_type=None)
da_z_ku_measured = ds_sr[&quot;zFactorMeasured&quot;]
dfr_s_ku_measured = da_z_s_measured - da_z_ku_measured
dfr_s_ku_measured.name = &quot;DRF_S_Ku&quot;

dfr_s_ku_measured.isel(cross_track=24).gpm.plot_cross_section()
da_z_ku_measured.isel(cross_track=24).gpm.plot_cross_section()
da_z_s_measured.isel(cross_track=24).gpm.plot_cross_section()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="DuHl_qjFGNIgS9SzpSS37" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/111/build/ffbeb88b7769bf1542c404ffcd8ac9e0.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/4e44d3acb4892fd83f315d1892b0ab7d.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/e249e8fbd11a3d3d4be60ffed309a1e4.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="CJenXIcWUC" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Compute attenuation correction in S-band
da_z_s_correction = da_z_s_final - da_z_s_measured
da_z_s_correction.isel(cross_track=24).gpm.plot_cross_section()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="jL2QERBm695jW7QAZ00wc" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/111/build/35a7c08f5276023ccae52f6807be74e7.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="tSuurwS7eT" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="convert-sr-ku-band-to-x-and-c-band" class="relative group"><span class="heading-text">Convert SR Ku-band to X and C-band</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#convert-sr-ku-band-to-x-and-c-band" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Here we convert reflectivities from Ku-band to X and C-band.</p><p>We welcome contributions to improve this portion of code !</p></div><div id="OtXrxfx4Aw" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">da_z_c = ds_sr.gpm.retrieve(&quot;c_band_tan&quot;, bb_ratio=None, precip_type=None)
da_z_x = ds_sr.gpm.retrieve(&quot;x_band_tan&quot;, bb_ratio=None, precip_type=None)

da_z_c.isel(cross_track=24).gpm.plot_cross_section()
da_z_x.isel(cross_track=24).gpm.plot_cross_section()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="5m5_yGV2WgP9Mxz_5aJXm" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/111/build/199dbdd0223cc5193876ffe287158ac8.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/c9010b480be4da13fa5113cef49e412d.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="bBGE1mrkBd" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="convert-gr-s-band-to-ku-band" class="relative group"><span class="heading-text">Convert GR S-band to Ku-band</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#convert-gr-s-band-to-ku-band" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Here we provide some code to convert GR S-band reflectivities to Ku-band.</p><p>However, the resulting reflectivities are not used in the rest of the tutorial.</p><p>The methodology we adopt currently use only an average bright band height to discern between liquid and solid phase precipitation, and it does not account for mixed-phase precipitation and the phase transition.</p><p>We welcome contributions to improve this portion of code ;)</p></div><div id="t5hfSsJAbf" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Estimate bright band height
bright_band_height = np.nanmean(ds_sr[&quot;heightBB&quot;])
# Retrieve Ku-band reflectivities from GR S-band reflectivities
da_gr_ku = convert_s_to_ku_band(ds_gr=ds_gr, bright_band_height=bright_band_height)

da_gr_s = ds_gr[&quot;DBZH&quot;]
da_gr_s.xradar_dev.plot_map(vmin=0, vmax=50)
plt.show()

da_gr_ku.xradar_dev.plot_map(vmin=0, vmax=50)
plt.show()

diff = da_gr_ku - da_gr_s
diff.rename(&quot;diff&quot;).xradar_dev.plot_map()
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="9MmbT9KE_VXSvPTLdgPlg" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/111/build/c3b1c5721a2b676a4f812973869cb079.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/2b4af4942d76b8bf5b905435aef5cdcc.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/0f574e30080bec40355e027e893267ea.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="r3G7U2OjFR" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="identify-sr-gates-intersecting-gr-sweep" class="relative group"><span class="heading-text">Identify SR gates intersecting GR sweep</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#identify-sr-gates-intersecting-gr-sweep" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Here we define the mask used to select SR footprints intersecting the GR sweep gates.
Using other terms, we can describe this task as finding SR gates that, once aggregated, “match” with the GR sweep plane-position-indicator (PPI) display.</p><p>To this end, we need to filter SR gates by GR <code>range</code> distance and <code>elevation</code> angle.</p><p>Since the GR CRS is centered on the GR radar location, we can define the SR range mask using the “GR” <code>range</code> coordinate.
So here below, we define the SR range mask with GR <code>range</code> between <code>min_gr_range_lb</code> and <code>max_gr_range_ub</code>.
We suggest to specify <code>min_gr_range_lb</code> and <code>max_gr_range_ub</code> not to restrictively, and rather perform more aggressive filtering once the SR/GR matched database is obtained.</p><p>The SR elevation mask is obtained by selecting SR gates with <code>elevation</code> angle between the GR sweep elevation angle minus/plus its half beamwidth.</p><p>Important note:</p><ul><li>Here we currently use the GR <code>range</code> computed at the SR gate centroids (instead of at the SR gate lower and upper bound)</li><li>Here we currently use the GR <code>elevation</code> computed at the SR gate centroids (instead of at the SR gate lower and upper bound)</li></ul></div><div id="kOi2jebKqs" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Define mask of SR footprints within GR range
r = np.sqrt(x_sr**2 + y_sr**2)
mask_sr_within_gr_range = r &lt; ds_gr[&quot;range&quot;].max().item()
mask_sr_within_gr_range.isel(range=-1).gpm.plot_map()

mask_sr_within_gr_range_interval = (r &gt;= min_gr_range_lb) &amp; (r &lt;= max_gr_range_ub)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="jG4USBLvLwWgXxU2UWUw6" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/111/build/3efec8ad8f7da20084696d11d9468da4.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="ebBo3GoJ4b" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Show how elevation angle (of GR) varies along SR scan angles
elevation_sr.isel(cross_track=0).gpm.plot_cross_section(vmin=0, y=&quot;range&quot;)
elevation_sr.isel(cross_track=24).gpm.plot_cross_section(vmin=0, y=&quot;range&quot;)
elevation_sr.isel(cross_track=-1).gpm.plot_cross_section(vmin=0, y=&quot;range&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="NKQKfKbKl3155WjWVbZTJ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/111/build/3f2e567ebf6e011e93a52f9aa5b85224.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/50031cdea01706313adeb289aa76f07f.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/eba81135d3fceaaea3676a12f4f29c42.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="LP8a3QMGMO" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Show SR/GR matched elevation
mask_sr_matched_elevation = (elevation_sr &gt;= (ds_gr[&quot;sweep_fixed_angle&quot;] - elevation_beamwidth_gr / 2.0)) &amp; (
    elevation_sr &lt;= (ds_gr[&quot;sweep_fixed_angle&quot;] + elevation_beamwidth_gr / 2.0)
)
mask_sr_matched_elevation.isel(cross_track=0).gpm.plot_cross_section()
mask_sr_matched_elevation.isel(cross_track=24).gpm.plot_cross_section()
mask_sr_matched_elevation.isel(cross_track=-1).gpm.plot_cross_section()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="FFdCBUoryCMZABpArntCL" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/111/build/9e5fbf993168652d27be6b4c42a097c1.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/1c03ac0311ffb011f25803c3908a2b7d.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/98ac89f72d54f4e525eb87284baf4ccd.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="nDuAhFlbm4" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Define mask of SR footprints matching GR gates
mask_ppi = mask_sr_matched_elevation &amp; mask_sr_within_gr_range_interval</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="KIeibntri81oJ512D1LlW" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="bmKaTgbsJ8" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Show mask (as SR map)
mask_ppi.any(dim=&quot;range&quot;).gpm.plot_map(vmin=0)
mask_ppi.isel(range=-10).gpm.plot_map(vmin=0)
mask_ppi.isel(range=-30).gpm.plot_map(vmin=0)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Hc_rK7kLhF3L6N-0yl29i" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&lt;cartopy.mpl.geocollection.GeoQuadMesh at 0x7f2f38a27b10&gt;</span></code></div><img src="/erad2024/_preview/111/build/c69b5a7311232f45fdfae7450436dbfa.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/a587ed30b2905b1d7d9ab8dd30e17be5.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/99d5295ddad191837d6225785ec85f62.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="Q8psZ8P3kE" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Show mask (as SR cross-section)
mask_ppi.isel(cross_track=24).gpm.plot_cross_section()
mask_ppi.isel(cross_track=-1).gpm.plot_cross_section()
mask_ppi.isel(cross_track=-1, along_track=slice(10, 60), range=slice(-40, None)).gpm.plot_cross_section()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="2cG_E14tM-qTCNJWzKHIM" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/111/build/f10dcb7302dc35e411c8d02e4395efe4.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/4d6ef5f24ce8f52ef2f94416b45d09bd.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/f29000cd6dff037a1bfa22ebb2695b29.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="wOfZAMJW4R" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="define-sr-masks" class="relative group"><span class="heading-text">Define SR Masks</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#define-sr-masks" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Here we start by defining and analysing various SR masks that can be used to subset SR footprints to be matched with the GR sweep.</p></div><div id="s5sCvl2GkJ" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Select scan with &quot;normal&quot; dataQuality (for entire cross-track scan)
mask_sr_quality = ds_sr[&quot;dataQuality&quot;] == 0</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="uo0XD5JD4o9mNvi3Bp7Rd" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="ism5M3vgJu" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Select beams with detected precipitation
ds_sr[&quot;flagPrecip&quot;].gpm.plot_map()
mask_sr_precip = ds_sr[&quot;flagPrecip&quot;] &gt; 0
mask_sr_precip.name = &quot;mask_precip&quot;
mask_sr_precip.gpm.plot_map()
ds_sr[&quot;flagPrecip&quot;].attrs</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="2ysc3FFdln42uEj2FIjaS" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>{&#x27;description&#x27;: &#x27;Flag for precipitation detection&#x27;,
 &#x27;flag_meanings&#x27;: [&#x27;not detected by both Ku and Ka&#x27;,
  &#x27;detected by Ka only&#x27;,
  &#x27;detected by Ka only&#x27;,
  &#x27;detected by Ku only&#x27;,
  &#x27;detected by both Ku and Ka&#x27;,
  &#x27;detected by both Ku and Ka&#x27;,
  &#x27;detected by both Ku and Ka&#x27;,
  &#x27;detected by both Ku and Ka&#x27;,
  &#x27;detected by both Ku and Ka&#x27;],
 &#x27;flag_values&#x27;: [0, 1, 2, 10, 11, 12, 20, 21, 22],
 &#x27;gpm_api_decoded&#x27;: &#x27;yes&#x27;,
 &#x27;gpm_api_product&#x27;: &#x27;2A-DPR&#x27;,
 &#x27;grid_mapping&#x27;: &#x27;crsWGS84&#x27;}</span></code></div><img src="/erad2024/_preview/111/build/d3e34621f0f5b74bb1eabc917866490a.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/7b67558771ebad7894472e4697a95310.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="wUcYk4Xppg" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Select above minimum SR reflectivity
mask_sr_minimum_z = ds_sr[&quot;zFactorFinal&quot;] &gt; z_min_threshold_sr
mask_sr_minimum_z.name = &quot;Minimum_Reflectitvity&quot;
mask_sr_minimum_z.any(dim=&quot;range&quot;).gpm.plot_map()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="4xhlp4QrXgDiOGkaXjONu" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&lt;cartopy.mpl.geocollection.GeoQuadMesh at 0x7f2f44ca8590&gt;</span></code></div><img src="/erad2024/_preview/111/build/ca934a427dd00737796ae460a7f5b3dc.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="sosYuU2NcR" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Select only &#x27;normal&#x27; data
# mask_sr_quality_data = ds_sr[&quot;qualityData&quot;] == 0
# mask_sr_quality_data.gpm.plot_map()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="wWehCdn4_3md58XZagYJ3" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="mM6p1D2YrX" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Select only &#x27;high quality&#x27; data
# - qualityFlag derived from qualityData.
# - qualityFlag == 1 indicates low quality retrievals
# - qualityFlag == 2 indicates bad/missing retrievals
mask_sr_quality_data = ds_sr[&quot;qualityFlag&quot;] == 0</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="ecgrFOIqBURCi6EZsDs1Z" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="h2A82FDnrn" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Select only beams with detected bright band
ds_sr[&quot;qualityBB&quot;].gpm.plot_map()
mask_sr_quality_bb = ds_sr[&quot;qualityBB&quot;] == 1
mask_sr_quality_bb.name = &quot;mask_bb&quot;
mask_sr_quality_bb.gpm.plot_map()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Nnei2bW6GP9XDA1U1dpgY" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&lt;cartopy.mpl.geocollection.GeoQuadMesh at 0x7f2f29492ed0&gt;</span></code></div><img src="/erad2024/_preview/111/build/c521eda0d3f37fc04859a14d39abd2bc.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/5c6c35f82d40a4afb2df6eb3907c3f89.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="syEXkkmDU1" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Select only beams with confident precipitation type
ds_sr[&quot;qualityTypePrecip&quot;].gpm.plot_map()
mask_sr_quality_precip = ds_sr[&quot;qualityTypePrecip&quot;] == 1
mask_sr_quality_precip.name = &quot;mask_precip_type&quot;
mask_sr_quality_precip.gpm.plot_map()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="OU7rXHQbPX40PG1Jhw41Z" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&lt;cartopy.mpl.geocollection.GeoQuadMesh at 0x7f2f44be56d0&gt;</span></code></div><img src="/erad2024/_preview/111/build/2630329c3b7b34505b353b8e876770e6.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/9e53ea554b1444bf96e8e4d6fdf3b8e2.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="Nqg2RHlhdv" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Select only stratiform precipitation
ds_sr[&quot;flagPrecipitationType&quot;].gpm.plot_map()
mask_sr_stratiform = ds_sr[&quot;flagPrecipitationType&quot;] == 1
mask_sr_stratiform.name = &quot;mask_stratiform&quot;
mask_sr_stratiform.gpm.plot_map()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="w0zVTQGDD9nAGaJ3oJ1-D" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&lt;cartopy.mpl.geocollection.GeoQuadMesh at 0x7f2f44769210&gt;</span></code></div><img src="/erad2024/_preview/111/build/7a4549d4fb32d6d2c1829cacd09d25ce.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/73989bb5181d63cfbe539c223b28db7d.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="QySv4tXegL" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Select only beams with reduced path attenuation
# ...
ds_sr[&quot;piaFinal&quot;].gpm.plot_map()  # PIA from DSD module
ds_sr[&quot;pathAtten&quot;].gpm.plot_map()  # PIAeff
ds_sr[&quot;reliabFlag&quot;].gpm.plot_map()  # reliability of PIAeff</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="7ivZeQ-oBL7u2NTQ1_Pzp" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&lt;cartopy.mpl.geocollection.GeoQuadMesh at 0x7f2f4438a6d0&gt;</span></code></div><img src="/erad2024/_preview/111/build/9cbb4b74d2a5c8d0d25d85ed1b61529a.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/47e6d2e7852df9b0ffd8f8be80f1e508.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/b044e51bafd601e3033b9369da278876.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="yGL6KktAFf" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Select only beams with limited attenuation correction
# ...
ds_sr[&quot;zFactorCorrection&quot;].isel(cross_track=24).gpm.plot_cross_section(vmin=0, vmax=3, zoom=False)
ds_sr[&quot;zFactorCorrection&quot;].isel(range=-20).gpm.plot_map(vmin=0, vmax=6)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="MlbuKy9iho8Ggm7c-GKvE" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&lt;cartopy.mpl.geocollection.GeoQuadMesh at 0x7f2f388745d0&gt;</span></code></div><img src="/erad2024/_preview/111/build/f6260996327fb352405b01be1fe80d16.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/4fbb7207ed8259c7b862bbe1ea9ef8ee.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="uvyE7oIdFM" class="relative group/block article-grid subgrid-gap col-screen"><p>Here we define the actual SR mask used to select the SR footprints on which the SR/GR matching will be performed.
Once again, we suggest to avoid, at this stage, being too restrictive in the selection of SR footprints.</p></div><div id="kpb2hW1Pjs" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Define 3D mask of SR gates matching GR PPI gates
# - TIP: do not mask eccessively here ... but rather at final stage
mask_matched_ppi_3d = mask_ppi &amp; mask_sr_precip &amp; mask_sr_quality

# Define 2D mask of SR beams matching the GR PPI
mask_matched_ppi_2d = mask_matched_ppi_3d.any(dim=&quot;range&quot;)
mask_matched_ppi_2d.gpm.plot_map()

# Number of matching SR gates per beam
n_matching_sr_gates = mask_matched_ppi_3d.sum(dim=&quot;range&quot;)
n_matching_sr_gates.where(n_matching_sr_gates &gt; 0).gpm.plot_map()

# Beam indices with at least one matching bin
cross_track_indices, along_track_indices = np.where(mask_matched_ppi_3d.sum(dim=&quot;range&quot;))

# Number of beams with at least one valid bin
len(along_track_indices)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="qYTvdMfhpX266SulvhjQC" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>1305</span></code></div><img src="/erad2024/_preview/111/build/eb314d3fc766b437610d55056b854e4a.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/cf566fa026860a35f5c4616e7c72777b.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="K4lTbMKYEs" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="aggregate-sr-radar-gates" class="relative group"><span class="heading-text">Aggregate SR radar gates</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#aggregate-sr-radar-gates" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>In this subsection, we aggregate SR radar gates intersecting the GR sweep.</p><p>SR reflectivities are averaged along the SR beam (approximately vertically) between the half-power points of the GR sweep.</p><p>To select SR radar gates for aggregation, the following criteria must be met:</p><ul><li>The SR footprints must contain precipitation.</li><li>The SR radar gates must overlap with GR gates.</li><li>The SR radar gates must fall within a specified GR range distance, defined by <code>min_gr_range</code> and <code>max_gr_range</code>.</li></ul><p>The <code>min_gr_range</code> ensures that the GR beamwidth is not smaller than the SR gate spacing.</p><p>Important Notes:</p><ul><li>Reflectivity must not be aggregated in dBZ, but rather in mm6 m−3</li></ul></div><div id="Umz0xSdn7G" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Add variables to SR dataset
ds_sr[&quot;zFactorMeasured_Ku&quot;] = ds_sr[&quot;zFactorMeasured&quot;]
ds_sr[&quot;zFactorFinal_Ku&quot;] = ds_sr[&quot;zFactorFinal&quot;]
ds_sr[&quot;zFactorFinal_S&quot;] = da_z_s_final
ds_sr[&quot;zFactorMeasured_S&quot;] = da_z_s_measured
ds_sr[&quot;zFactorCorrection_Ku&quot;] = ds_sr[&quot;zFactorCorrection&quot;]
ds_sr[&quot;zFactorCorrection_S&quot;] = da_z_s_correction
ds_sr[&quot;hres&quot;] = h_res_sr
ds_sr[&quot;vres&quot;] = v_res_sr
ds_sr[&quot;gate_volume&quot;] = vol_sr
ds_sr[&quot;x&quot;] = x_sr
ds_sr[&quot;y&quot;] = y_sr
ds_sr[&quot;z&quot;] = z_sr

# Compute path-integrated reflectivities
ds_sr[&quot;zFactorFinal_Ku_cumsum&quot;] = ds_sr[&quot;zFactorFinal&quot;].gpm.idecibel.cumsum(&quot;range&quot;).gpm.decibel
ds_sr[&quot;zFactorFinal_Ku_cumsum&quot;] = ds_sr[&quot;zFactorFinal_Ku_cumsum&quot;].where(np.isfinite(ds_sr[&quot;zFactorFinal_Ku_cumsum&quot;]))
ds_sr[&quot;zFactorMeasured_Ku_cumsum&quot;] = ds_sr[&quot;zFactorMeasured&quot;].gpm.idecibel.cumsum(&quot;range&quot;).gpm.decibel
ds_sr[&quot;zFactorMeasured_Ku_cumsum&quot;] = ds_sr[&quot;zFactorMeasured_Ku_cumsum&quot;].where(
    np.isfinite(ds_sr[&quot;zFactorMeasured_Ku_cumsum&quot;]),
)
ds_sr[&quot;zFactorFinal_S_cumsum&quot;] = ds_sr[&quot;zFactorFinal_S&quot;].gpm.idecibel.cumsum(&quot;range&quot;).gpm.decibel
ds_sr[&quot;zFactorFinal_S_cumsum&quot;] = ds_sr[&quot;zFactorFinal_S_cumsum&quot;].where(np.isfinite(ds_sr[&quot;zFactorFinal_S_cumsum&quot;]))
ds_sr[&quot;zFactorMeasured_S_cumsum&quot;] = ds_sr[&quot;zFactorMeasured_S&quot;].gpm.idecibel.cumsum(&quot;range&quot;).gpm.decibel
ds_sr[&quot;zFactorMeasured_S_cumsum&quot;] = ds_sr[&quot;zFactorMeasured_S_cumsum&quot;].where(
    np.isfinite(ds_sr[&quot;zFactorMeasured_S_cumsum&quot;]),
)

# Add variables to the spaceborne dataset
z_variables = [&quot;zFactorFinal_Ku&quot;, &quot;zFactorFinal_S&quot;, &quot;zFactorMeasured_Ku&quot;, &quot;zFactorMeasured_S&quot;]
sr_variables = [
    *z_variables,
    &quot;zFactorCorrection_Ku&quot;,
    &quot;zFactorCorrection_S&quot;,
    &quot;precipRate&quot;,
    &quot;airTemperature&quot;,
    &quot;zFactorFinal_Ku_cumsum&quot;,
    &quot;zFactorMeasured_Ku_cumsum&quot;,
    &quot;zFactorFinal_S_cumsum&quot;,
    &quot;zFactorMeasured_S_cumsum&quot;,
    &quot;hres&quot;,
    &quot;vres&quot;,
    &quot;gate_volume&quot;,
    &quot;x&quot;,
    &quot;y&quot;,
    &quot;z&quot;,
]

# Initialize Dataset where to add aggregated SR gates
ds_sr_match_ppi = xr.Dataset()

# Mask SR gates not matching the GR PPI
ds_sr_ppi = ds_sr[sr_variables].where(mask_matched_ppi_3d)

# Compute aggregation statistics
ds_sr_ppi_min = ds_sr_ppi.min(&quot;range&quot;)
ds_sr_ppi_max = ds_sr_ppi.max(&quot;range&quot;)
ds_sr_ppi_sum = ds_sr_ppi.sum(dim=&quot;range&quot;, skipna=True)
ds_sr_ppi_mean = ds_sr_ppi.mean(&quot;range&quot;)
ds_sr_ppi_std = ds_sr_ppi.std(&quot;range&quot;)

# Aggregate reflectivities (in mm6/mm3)
for var in z_variables:
    ds_sr_ppi_mean[var] = ds_sr_ppi[var].gpm.idecibel.mean(&quot;range&quot;).gpm.decibel
    ds_sr_ppi_std[var] = ds_sr_ppi[var].gpm.idecibel.std(&quot;range&quot;).gpm.decibel
    # If only 1 value, std=0, log transform become -inf --&gt; Set to 0
    is_inf = np.isinf(ds_sr_ppi_std[var])
    ds_sr_ppi_std[var] = ds_sr_ppi_std[var].where(~is_inf, 0)

# Compute counts and fractions above sensitivity thresholds
sr_sensitivity_thresholds = [10, 12, 14, 16, 18]
ds_sr_match_ppi[&quot;SR_counts&quot;] = mask_matched_ppi_3d.sum(dim=&quot;range&quot;)
ds_sr_match_ppi[&quot;SR_counts_valid&quot;] = (~np.isnan(ds_sr_ppi[&quot;zFactorFinal_Ku&quot;])).sum(dim=&quot;range&quot;)
for var in z_variables:
    for thr in sr_sensitivity_thresholds:
        fraction = (ds_sr_ppi[var] &gt;= thr).sum(dim=&quot;range&quot;) / ds_sr_match_ppi[&quot;SR_counts&quot;]
        ds_sr_match_ppi[f&quot;SR_{var}_fraction_above_{thr}dBZ&quot;] = fraction

# Compute fraction of hydrometeor types
da_hydro_class = ds_sr[&quot;flagHydroClass&quot;].where(mask_matched_ppi_3d)
ds_sr_match_ppi[&quot;SR_fraction_no_precip&quot;] = (da_hydro_class == 0).sum(dim=&quot;range&quot;) / ds_sr_match_ppi[&quot;SR_counts&quot;]
ds_sr_match_ppi[&quot;SR_fraction_rain&quot;] = (da_hydro_class == 1).sum(dim=&quot;range&quot;) / ds_sr_match_ppi[&quot;SR_counts&quot;]
ds_sr_match_ppi[&quot;SR_fraction_snow&quot;] = (da_hydro_class == 2).sum(dim=&quot;range&quot;) / ds_sr_match_ppi[&quot;SR_counts&quot;]
ds_sr_match_ppi[&quot;SR_fraction_hail&quot;] = (da_hydro_class == 3).sum(dim=&quot;range&quot;) / ds_sr_match_ppi[&quot;SR_counts&quot;]
ds_sr_match_ppi[&quot;SR_fraction_melting_layer&quot;] = (da_hydro_class == 4).sum(dim=&quot;range&quot;) / ds_sr_match_ppi[&quot;SR_counts&quot;]
ds_sr_match_ppi[&quot;SR_fraction_clutter&quot;] = (da_hydro_class == 5).sum(dim=&quot;range&quot;) / ds_sr_match_ppi[&quot;SR_counts&quot;]
ds_sr_match_ppi[&quot;SR_fraction_below_isotherm&quot;] = (ds_sr_ppi[&quot;airTemperature&quot;] &gt;= 273.15).sum(
    dim=&quot;range&quot;,
) / ds_sr_match_ppi[&quot;SR_counts&quot;]
ds_sr_match_ppi[&quot;SR_fraction_above_isotherm&quot;] = (ds_sr_ppi[&quot;airTemperature&quot;] &lt; 273.15).sum(
    dim=&quot;range&quot;,
) / ds_sr_match_ppi[&quot;SR_counts&quot;]

# Add aggregation statistics
for var in ds_sr_ppi_mean.data_vars:
    ds_sr_match_ppi[f&quot;SR_{var}_mean&quot;] = ds_sr_ppi_mean[var]
for var in ds_sr_ppi_std.data_vars:
    ds_sr_match_ppi[f&quot;SR_{var}_std&quot;] = ds_sr_ppi_std[var]
for var in ds_sr_ppi_sum.data_vars:
    ds_sr_match_ppi[f&quot;SR_{var}_sum&quot;] = ds_sr_ppi_sum[var]
for var in ds_sr_ppi_max.data_vars:
    ds_sr_match_ppi[f&quot;SR_{var}_max&quot;] = ds_sr_ppi_max[var]
for var in ds_sr_ppi_min.data_vars:
    ds_sr_match_ppi[f&quot;SR_{var}_min&quot;] = ds_sr_ppi_min[var]
for var in ds_sr_ppi_min.data_vars:
    ds_sr_match_ppi[f&quot;SR_{var}_range&quot;] = ds_sr_ppi_max[var] - ds_sr_ppi_min[var]

# Compute coefficient of variation
for var in z_variables:
    ds_sr_match_ppi[f&quot;SR_{var}_cov&quot;] = ds_sr_match_ppi[f&quot;SR_{var}_std&quot;] / ds_sr_match_ppi[f&quot;SR_{var}_mean&quot;]

# Add SR L2 variables (useful for final filtering and analysis)
var_l2 = [
    &quot;flagPrecip&quot;,
    &quot;flagPrecipitationType&quot;,
    &quot;dataQuality&quot;,
    &quot;sunLocalTime&quot;,
    &quot;SCorientation&quot;,
    &quot;qualityFlag&quot;,
    &quot;qualityTypePrecip&quot;,
    &quot;qualityBB&quot;,
    &quot;pathAtten&quot;,
    &quot;piaFinal&quot;,
    &quot;reliabFlag&quot;,
]
for var in var_l2:
    ds_sr_match_ppi[f&quot;SR_{var}&quot;] = ds_sr[var]

# Add SR time
ds_sr_match_ppi[&quot;SR_time&quot;] = ds_sr_match_ppi[&quot;time&quot;]
ds_sr_match_ppi = ds_sr_match_ppi.drop(&quot;time&quot;)

# Mask SR beams not matching the GR PPI
ds_sr_match_ppi = ds_sr_match_ppi.where(mask_matched_ppi_2d)

# Remove unecessary coordinates
unecessary_coords = [
    &quot;radar_frequency&quot;,
    &quot;sweep_mode&quot;,
    &quot;prt_mode&quot;,
    &quot;follow_mode&quot;,
    &quot;latitude&quot;,
    &quot;longitude&quot;,
    &quot;altitude&quot;,
    &quot;crs_wkt&quot;,
    &quot;time&quot;,
    &quot;crsWGS84&quot;,
    &quot;dataQuality&quot;,
    &quot;sunLocalTime&quot;,
    &quot;SCorientation&quot;,
]
for coord in unecessary_coords:
    if coord in ds_sr_match_ppi:
        ds_sr_match_ppi = ds_sr_match_ppi.drop(coord)
    if coord in mask_matched_ppi_2d.coords:
        mask_matched_ppi_2d = mask_matched_ppi_2d.drop(coord)

# Stack aggregated dataset to beam dimension index
ds_sr_stack = ds_sr_match_ppi.stack(sr_beam_index=(&quot;along_track&quot;, &quot;cross_track&quot;))
da_mask_matched_ppi_stack = mask_matched_ppi_2d.stack(sr_beam_index=(&quot;along_track&quot;, &quot;cross_track&quot;))

# Drop beams not matching the GR PPI
ds_sr_match = ds_sr_stack.isel(sr_beam_index=da_mask_matched_ppi_stack)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="t73ZeleL4d82N51Fte_Kh" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="AFiMbquPsn" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="display-aggregated-sr-variables" class="relative group"><span class="heading-text">Display aggregated SR variables</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#display-aggregated-sr-variables" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="fLFvZZw4Bt" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Original SR near surface reflectivity
p = ds_sr[&quot;zFactorFinalNearSurface&quot;].gpm.plot_map(vmin=10, vmax=40)
p.axes.set_extent(ds_gr.xradar_dev.extent(max_distance=max_gr_range))

# Original GR reflectivities
p = ds_gr[&quot;DBZH&quot;].where(mask_gr).xradar_dev.plot_map(vmin=10, vmax=40)
p.axes.set_extent(ds_gr.xradar_dev.extent(max_distance=max_gr_range))
ds_sr.gpm.plot_swath_lines(ax=p.axes)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="yfyTQvEGaE3tFbytYUR0R" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/111/build/c2766a43f535d05101f3289f94db4a00.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/d076f7252591cf06141f6ef46093e014.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="HgoAKLxc7S" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># SR reflectivity statistics matching the GR PPI (using xr.Dataset)
p = ds_sr_ppi_max[&quot;zFactorFinal_Ku&quot;].gpm.plot_map(cmap=cmap, vmin=10, vmax=40)
p.axes.set_extent(ds_gr.xradar_dev.extent(max_distance=max_gr_range))

p = ds_sr_ppi_mean[&quot;zFactorFinal_Ku&quot;].gpm.plot_map(cmap=cmap, vmin=10, vmax=40)
p.axes.set_extent(ds_gr.xradar_dev.extent(max_distance=max_gr_range))

p = ds_sr_ppi_mean[&quot;zFactorMeasured_Ku&quot;].gpm.plot_map(cmap=cmap, vmin=10, vmax=40)
p.axes.set_extent(ds_gr.xradar_dev.extent(max_distance=max_gr_range))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="EXFs1x9jpJSpHvCTGoqd4" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/111/build/e1c90b02c46d9af45042e987eca90e4e.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/15aa2b9c8e13b3d92d7198bf73ab5a33.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/90e0c027ae94265637d64e51e7b718a0.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="jR1GIyDTfs" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Show difference between using Ku mean and max !
diff = ds_sr_ppi_max[&quot;zFactorFinal_Ku&quot;] - ds_sr_ppi_mean[&quot;zFactorFinal_Ku&quot;]
diff.name = &quot;Difference between Z max and Z mean&quot;
p = diff.gpm.plot_map(cmap=&quot;Spectral_r&quot;)
p.axes.set_extent(ds_gr.xradar_dev.extent(max_distance=max_gr_range))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="-_bAfLgqVDaKt-VNW_r5u" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/111/build/1c8e87af25575734b5fa67a09289a015.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="w5c4Mnxumd" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Show SR mean precip rate
p = ds_sr_ppi_mean[&quot;precipRate&quot;].gpm.plot_map()
p.axes.set_extent(ds_gr.xradar_dev.extent(max_distance=max_gr_range))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="2N59L-dHXu9ABm3F5xCZW" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/111/build/e871c51c3acaa31bbe54f81eecbe87ab.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="USdZ8BakG2" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Display reflectivity in 3D

fig = plt.figure()
ax = fig.add_subplot(111, projection=&quot;3d&quot;)
ax.scatter(
    ds_sr_match[&quot;SR_x_mean&quot;].values,
    ds_sr_match[&quot;SR_y_mean&quot;].values,
    ds_sr_match[&quot;SR_z_mean&quot;].values,
    c=ds_sr_match[&quot;SR_zFactorFinal_Ku_mean&quot;].values,
    cmap=&quot;turbo&quot;,
    vmin=10,
    vmax=40,
    s=5,
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="qokk8Ovsgl5_jRoZ0MUek" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&lt;mpl_toolkits.mplot3d.art3d.Path3DCollection at 0x7f2f4dc28e50&gt;</span></code></div><img src="/erad2024/_preview/111/build/f2a4fcb2c49a4f0397f7fd8a9952e51a.png" alt="&lt;Figure size 640x480 with 1 Axes&gt;"/></div></div><div id="XRLTVwIkES" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Disply SR footprint horizontal resolution
p = ds_sr_ppi_max[&quot;hres&quot;].gpm.plot_map(cmap=&quot;turbo&quot;)
p.axes.set_extent(ds_gr.xradar_dev.extent(max_distance=max_gr_range))
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="N7bMJigsS-6inxnYKVPSo" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/111/build/a7d44dc3ceffc4bed95932e7c3e0aeaf.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="I4LzrMSOWI" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Display SR depth over which data are integrated
p = ds_sr_ppi_sum[&quot;vres&quot;].gpm.plot_map(cmap=&quot;turbo&quot;)
p.axes.set_extent(ds_gr.xradar_dev.extent(max_distance=max_gr_range))
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="PZiU7a9H-X5Jn30r_ZlTj" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/111/build/d6c837a0b457b5dc48c8b0e48a4b5632.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="RGhJNBpthS" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Display SR volume over which data are integrated
p = ds_sr_ppi_sum[&quot;gate_volume&quot;].gpm.plot_map(cmap=&quot;turbo&quot;)
p.axes.set_extent(ds_gr.xradar_dev.extent(max_distance=max_gr_range))
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="l8jqRjWs7MSetrchas943" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/111/build/c5cccec469d9fe1be6e574d142440a3b.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="MhBJTJ0Uq3" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Display GR radar volume
p = vol_gr.xradar_dev.plot_map()
p.axes.set_extent(ds_gr.xradar_dev.extent(max_distance=max_gr_range))
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="7s6v2tupyBHK-X_Ycg3j4" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/111/build/5f3883a8a2badc6fa8728e5c59483a89.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="pC9MbMQ8uK" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="retrieve-the-sr-footprints-polygons" class="relative group"><span class="heading-text">Retrieve the SR footprints polygons</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#retrieve-the-sr-footprints-polygons" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Here we retrieve SR footprints polygons and then we construct a <code>geopandas.DataFrame</code> with the aggregated SR reflectivities.</p></div><div id="nMkvTKsve3" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Retrieve SR footprint polygons (using the footprint radius in AEQD x,y coordinates)
xy_mean_sr = np.stack([ds_sr_match[&quot;SR_x_mean&quot;], ds_sr_match[&quot;SR_y_mean&quot;]], axis=-1)
footprint_radius = ds_sr_match[&quot;SR_hres_max&quot;].to_numpy() / 2
sr_poly = [Point(x, y).buffer(footprint_radius[i]) for i, (x, y) in enumerate(xy_mean_sr)]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="o2cmaivRCfQABeJCsZYb5" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="onxBaCH0f2" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Create geopandas DataFrame
df_sr_match = ds_sr_match.to_dataframe()
gdf_sr = gpd.GeoDataFrame(df_sr_match, crs=crs_gr, geometry=sr_poly)
gdf_sr.columns</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="g9ynSWwtX-1IBrI3-Ryk8" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>Index([&#x27;SR_counts&#x27;, &#x27;SR_counts_valid&#x27;,
       &#x27;SR_zFactorFinal_Ku_fraction_above_10dBZ&#x27;,
       &#x27;SR_zFactorFinal_Ku_fraction_above_12dBZ&#x27;,
       &#x27;SR_zFactorFinal_Ku_fraction_above_14dBZ&#x27;,
       &#x27;SR_zFactorFinal_Ku_fraction_above_16dBZ&#x27;,
       &#x27;SR_zFactorFinal_Ku_fraction_above_18dBZ&#x27;,
       &#x27;SR_zFactorFinal_S_fraction_above_10dBZ&#x27;,
       &#x27;SR_zFactorFinal_S_fraction_above_12dBZ&#x27;,
       &#x27;SR_zFactorFinal_S_fraction_above_14dBZ&#x27;,
       ...
       &#x27;gpm_cross_track_id&#x27;, &#x27;gpm_granule_id&#x27;, &#x27;gpm_id&#x27;, &#x27;lat&#x27;, &#x27;lon&#x27;,
       &#x27;sweep_fixed_angle&#x27;, &#x27;sweep_number&#x27;, &#x27;along_track&#x27;, &#x27;cross_track&#x27;,
       &#x27;geometry&#x27;],
      dtype=&#x27;object&#x27;, length=165)</span></code></div></div></div><div id="Cqiqjg5zlg" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Extract radar gate polygon on the range-azimuth axis
sr_poly = np.array(gdf_sr.geometry)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="NZdjHqHuLmBONH751GmBq" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="hyv2W7iInv" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="retrieve-the-gr-gates-polygons" class="relative group"><span class="heading-text">Retrieve the GR gates polygons</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#retrieve-the-gr-gates-polygons" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Here we retrieve GR gates polygons and then we construct a <code>geopandas.DataFrame</code> containing the GR measurements.</p><p>Currently the GR gates polygons are derived inferring the quadmesh around the GR gate centroids (using the x and y GR CRS coordinates).</p><p>More accurate GR gates polygons could be derived using the GR beamwidth. We welcome contributions addressing this point !</p></div><div id="bVAvdvCNlx" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Add variables to GR dataset
ds_gr[&quot;gate_volume&quot;] = vol_gr
ds_gr[&quot;vres&quot;] = v_res_gr
ds_gr[&quot;hres&quot;] = h_res_gr

# Add path_integrated_reflectivities
ds_gr[&quot;Z_cumsum&quot;] = ds_gr[&quot;DBZH&quot;].gpm.idecibel.cumsum(&quot;range&quot;).gpm.decibel
ds_gr[&quot;Z_cumsum&quot;] = ds_gr[&quot;Z_cumsum&quot;].where(np.isfinite(ds_gr[&quot;Z_cumsum&quot;]))

# Mask reflectivites above minimum GR Z threshold
mask_gr = ds_gr[&quot;DBZH&quot;] &gt; z_min_threshold_gr  # important !

# Subset gates in range distance interval
ds_gr_subset = ds_gr.sel(range=slice(min_gr_range_lb, max_gr_range_ub)).where(mask_gr)

# Retrieve geopandas dataframe
gdf_gr = ds_gr_subset.xradar_dev.to_geopandas()  # here we currently infer the quadmesh using the x,y coordinates
display(gdf_gr)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="YuJT06T_G7dfZhfR4gYIY" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="PePA0jXOiQ" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Extract radar gate polygon on the range-azimuth axis
gr_poly = np.array(gdf_gr.geometry)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Y23vCy_kRj2olpz8aOSS0" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="jwM0Zwgenr" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="aggregate-gr-data-on-sr-footprints" class="relative group"><span class="heading-text">Aggregate GR data on SR footprints</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#aggregate-gr-data-on-sr-footprints" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="rRUQVevjwC" class="relative group/block article-grid subgrid-gap col-screen"><p>To aggregate GR radar gates onto SR beam polygon footprints, we will use the <code>PolyAggregator</code>.
The <code>PolyAggregator</code> enable custom aggregation of source (GR) polygons data intesecting the target (SR) polygons.</p><p>When aggregating the data, you can use a combination of weighting schemes
By default, <code>PolyAggregator</code> applies <strong>area_weighting</strong>, which assigns weights based on the proportion of
source polygon area that intersects the target polygon.</p><p><strong>Custom Weighting Schemes</strong></p><p>Several additional weighting schemes can be utilized, typically derived as a function of the horizontal distance between the centroids of the source and target polygons. Examples include:</p><ul><li><p><strong>Inverse Distance Weighting</strong>: <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>weights</mtext><mo>=</mo><mfrac><mn>1</mn><msup><mtext>dist</mtext><mtext>order</mtext></msup></mfrac></mrow><annotation encoding="application/x-tex">\text{weights} = \frac{1}{\text{dist}^{\text{order}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">weights</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2414em;vertical-align:-0.3963em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.6037em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">dist</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8376em;"><span style="top:-2.8416em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">order</span></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3963em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p></li><li><p><strong>Barnes Gaussian Weighting</strong>: <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>weights</mtext><mo>=</mo><mi>exp</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><mo>−</mo><mfrac><msup><mtext>dist</mtext><mn>2</mn></msup><msup><mi>κ</mi><mn>2</mn></msup></mfrac><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{weights} = \exp\left(-\frac{\text{dist}^2}{\kappa^2}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">weights</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.8em;vertical-align:-0.65em;"></span><span class="mop">exp</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0179em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">κ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">dist</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span></span></span></span></span></p></li><li><p><strong>Cressman Weighting</strong>: <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>weights</mtext><mo>=</mo><mfrac><mrow><msup><mtext>max_distance</mtext><mn>2</mn></msup><mo>−</mo><msup><mtext>dist</mtext><mn>2</mn></msup></mrow><mrow><msup><mtext>max_distance</mtext><mn>2</mn></msup><mo>+</mo><msup><mtext>dist</mtext><mn>2</mn></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">\text{weights} = \frac{\text{max\_distance}^2 - \text{dist}^2}{\text{max\_distance}^2 + \text{dist}^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">weights</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.7392em;vertical-align:-0.5883em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1509em;"><span style="top:-2.6287em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">max_distance</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-2.8416em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">dist</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-2.8416em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.527em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">max_distance</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">dist</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5883em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p></li></ul><p>For example, the Barnes Gaussian Distance Weighting Scheme weights values proportionally to the distance measured from the center of the SR footprint to the center of the GR radar gate. This approach can partially account  for the nonuniform distribution of
power within the SR beam.</p><p>Custom weights can however also be passed to <code>PolyAggregator</code>, which will automatically handle normalization.</p><p>In the context of SR/GR matching, it may be beneficial to adopt a <strong>Volume Weighting Scheme</strong>, using the volumes of GR radar gates as weights so that larger volumes are weighted more heavily.</p></div><div id="n6KUslNEra" class="relative group/block article-grid subgrid-gap col-screen"><p>In the code here below, we currently apply only the Area Weighting Scheme:</p></div><div id="tXc1FDaCx9" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Define PolyAggregator
aggregator = PolyAggregator(source_polygons=gr_poly, target_polygons=sr_poly)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="xzD3NbV0cBicLSAlVvWfA" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="hXwBWzWfCh" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Aggregate GR reflecitvities and compute statistics
# - Timestep of acquisition
time_gr = aggregator.first(values=gdf_gr[&quot;time&quot;])

# - Total number of gates aggregated
counts = aggregator.counts()
counts_valid = aggregator.apply(lambda x, weights: np.sum(~np.isnan(x)), values=gdf_gr[&quot;DBZH&quot;])  # noqa

# - Total gate volume
sum_vol = aggregator.sum(values=gdf_gr[&quot;gate_volume&quot;])

# - Fraction of SR area covered
fraction_covered_area = aggregator.fraction_covered_area()

# - Reflectivity statistics
z_mean = wrl.trafo.decibel(aggregator.average(values=wrl.trafo.idecibel(gdf_gr[&quot;DBZH&quot;])))
z_std = wrl.trafo.decibel(aggregator.std(values=wrl.trafo.idecibel(gdf_gr[&quot;DBZH&quot;])))
z_std[np.isinf(z_std)] = 0  # If only 1 value, std=0, log transform become -inf --&gt; Set to 0
z_max = aggregator.max(values=gdf_gr[&quot;DBZH&quot;])
z_min = aggregator.min(values=gdf_gr[&quot;DBZH&quot;])
z_range = z_max - z_min
z_cov = z_std / z_mean  # coefficient of variation</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="4UK4PXMyGUjKdaO4akuJ0" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="Ldb6mbzak2" class="relative group/block article-grid subgrid-gap col-screen"><p>Now we create a <code>geopandas.DataFrame</code> with aggregated GR statistics:</p></div><div id="t6fYEa2cdt" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Create DataFrame with GR matched statistics
df = pd.DataFrame(
    {
        &quot;GR_Z_mean&quot;: z_mean,
        &quot;GR_Z_std&quot;: z_std,
        &quot;GR_Z_max&quot;: z_max,
        &quot;GR_Z_min&quot;: z_min,
        &quot;GR_Z_range&quot;: z_range,
        &quot;GR_Z_cov&quot;: z_cov,
        &quot;GR_time&quot;: time_gr,
        &quot;GR_gate_volume_sum&quot;: sum_vol,
        &quot;GR_fraction_covered_area&quot;: fraction_covered_area,
        &quot;GR_counts&quot;: counts,
        &quot;GR_counts_valid&quot;: counts_valid,
    },
    index=gdf_sr.index,
)
gdf_gr_match = gpd.GeoDataFrame(df, crs=crs_gr, geometry=aggregator.target_polygons)
gdf_gr_match.head()

# Add GR range statistics
gdf_gr_match[&quot;GR_range_max&quot;] = aggregator.max(values=gdf_gr[&quot;range&quot;])
gdf_gr_match[&quot;GR_range_mean&quot;] = aggregator.mean(values=gdf_gr[&quot;range&quot;])
gdf_gr_match[&quot;GR_range_min&quot;] = aggregator.min(values=gdf_gr[&quot;range&quot;])

# Fraction above sensitivity thresholds
gr_sensitivity_thresholds = [8, 10, 12, 14, 16, 18]
for thr in sr_sensitivity_thresholds:
    fraction = aggregator.apply(lambda x, weights: np.sum(x &gt; thr), values=gdf_gr[&quot;DBZH&quot;]) / counts  # noqa
    gdf_gr_match[f&quot;GR_Z_fraction_above_{thr}dBZ&quot;] = fraction

# Compute further aggregation statistics
stats_var = [&quot;vres&quot;, &quot;hres&quot;, &quot;x&quot;, &quot;y&quot;, &quot;z&quot;, &quot;Z_cumsum&quot;]
for var in stats_var:
    gdf_gr_match[f&quot;GR_{var}_mean&quot;] = aggregator.average(values=gdf_gr[var])
    gdf_gr_match[f&quot;GR_{var}_min&quot;] = aggregator.min(values=gdf_gr[var])
    gdf_gr_match[f&quot;GR_{var}_max&quot;] = aggregator.max(values=gdf_gr[var])
    gdf_gr_match[f&quot;GR_{var}_std&quot;] = aggregator.std(values=gdf_gr[var])
    gdf_gr_match[f&quot;GR_{var}_range&quot;] = gdf_gr_match[f&quot;GR_{var}_max&quot;] - gdf_gr_match[f&quot;GR_{var}_min&quot;]

# Compute horizontal distance between centroids
func_dict = {&quot;min&quot;: np.min, &quot;mean&quot;: np.mean, &quot;max&quot;: np.max}
for suffix, func in func_dict.items():
    arr = np.zeros(aggregator.n_target_polygons) * np.nan
    arr[aggregator.target_intersecting_indices] = np.array(
        [func(dist) for i, dist in aggregator.dict_distances.items()],
    )
    gdf_gr_match[f&quot;distance_horizontal_{suffix}&quot;] = arr</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="R11jNprlZX9iBkPNiogvl" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="ojLWsYSlMS" class="relative group/block article-grid subgrid-gap col-screen"><hr class="py-2 my-5 translate-y-2"/><p>To compute custom statistics, you can use the following approaches. Remember that the function must have the <code>values</code> and <code>weights</code> arguments. Add the <code>weights</code> argument also if they are not used in your function !</p></div><div id="yfDQJcT7zD" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">def weighted_mean(values, weights):
    return np.average(values, weights=weights)


aggregated_values = aggregator.apply(weighted_mean, values=gdf_gr[&quot;DBZH&quot;], area_weighting=True)
aggregated_values = aggregator.apply(
    lambda x, weights: np.average(x, weights=weights),
    values=gdf_gr[&quot;DBZH&quot;],
    area_weighting=True,
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="J2sZfLds9YMjFaO7oO2Wm" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="rdNUJHzfyk" class="relative group/block article-grid subgrid-gap col-screen"><p>Here below we compare the usage of Inverse Distance Weighting, Barnes Gaussian Distance Weighting, Cressman Weighting, and Volume Weighting.</p></div><div id="c77DICZ38I" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">from gpm.utils.zonal_stats import BarnesGaussianWeights, CressmanWeights, InverseDistanceWeights, PolyAggregator

gdf_gr_match1 = gdf_gr_match.copy()

# Weighted by intersection area
gdf_gr_match1[&quot;GR_Z_area&quot;] = aggregator.mean(values=gdf_gr[&quot;DBZH&quot;], area_weighting=True)

# Weighted by ntersection area and Inverse Distance Weighting
gdf_gr_match1[&quot;GR_Z_idw&quot;] = aggregator.mean(
    values=gdf_gr[&quot;DBZH&quot;],
    area_weighting=True,
    distance_weighting=InverseDistanceWeights(order=1),
)
# Weighted by intersection area and Cressman Weighting
gdf_gr_match1[&quot;GR_Z_cressman&quot;] = aggregator.mean(
    values=gdf_gr[&quot;DBZH&quot;],
    area_weighting=True,
    distance_weighting=CressmanWeights(max_distance=2000),
)
# Weighted by intersection area and Barnes Gaussian Weighting (kappa=SR_hres_mean)
gdf_gr_match1[&quot;GR_Z_barnes&quot;] = aggregator.mean(
    values=gdf_gr[&quot;DBZH&quot;],
    area_weighting=True,
    distance_weighting=BarnesGaussianWeights(kappa=gdf_sr[&quot;SR_hres_mean&quot;]),
)
# Weighted Barnes Gaussian Weighting (kappa=SR_radius_mean)
gdf_gr_match1[&quot;GR_Z_barnes_without_area&quot;] = aggregator.mean(
    values=gdf_gr[&quot;DBZH&quot;],
    area_weighting=False,
    distance_weighting=BarnesGaussianWeights(kappa=gdf_sr[&quot;SR_hres_mean&quot;]),
)
# Weighted by intersection area and by GR volume
gdf_gr_match1[&quot;GR_Z_volume&quot;] = aggregator.mean(
    values=gdf_gr[&quot;DBZH&quot;],
    weights=gdf_gr[&quot;gate_volume&quot;],
    area_weighting=True,
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="BBW7JSvt32hbROY_Iydoz" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="wsdDqTbpEu" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">gdf_gr_match1.plot(column=&quot;GR_Z_area&quot;, legend=True, cmap=&quot;Spectral_r&quot;, vmin=0, vmax=40)
gdf_gr_match1.plot(column=&quot;GR_Z_idw&quot;, legend=True, cmap=&quot;Spectral_r&quot;, vmin=0, vmax=40)
gdf_gr_match1.plot(column=&quot;GR_Z_cressman&quot;, legend=True, cmap=&quot;Spectral_r&quot;, vmin=0, vmax=40)
gdf_gr_match1.plot(column=&quot;GR_Z_barnes&quot;, legend=True, cmap=&quot;Spectral_r&quot;, vmin=0, vmax=40)
gdf_gr_match1.plot(column=&quot;GR_Z_volume&quot;, legend=True, cmap=&quot;Spectral_r&quot;, vmin=0, vmax=40)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="R0-jw224UTk41s2FLpZMP" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&lt;Axes: &gt;</span></code></div><img src="/erad2024/_preview/111/build/1883f4ede0d060971383474643d71d98.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/3e9b32d83862aebb6578a43169a00a5e.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/7c544faa42541fe30440c5f76273a08d.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/d85724d9afe65ad1b4f44716bc7adba3.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/fac5ecd8c38e23441a8f088baf59fabb.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="qFXUcGvf9M" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Impact of Barnes with and without area-weighting
gdf_gr_match1[&quot;DIFF_Barnes_Without_Area&quot;] = gdf_gr_match1[&quot;GR_Z_barnes&quot;] - gdf_gr_match1[&quot;GR_Z_barnes_without_area&quot;]
gdf_gr_match1.plot(column=&quot;DIFF_Barnes_Without_Area&quot;, legend=True, cmap=&quot;Spectral_r&quot;, vmin=-0.25, vmax=0.25)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="COMYNxNYemv9rj_ak1EHc" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&lt;Axes: &gt;</span></code></div><img src="/erad2024/_preview/111/build/175dbd9f3e5a20a35f93368e91530e23.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="LN0Cntf0no" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Impact of Barnes with area-weighting and default area weighting
gdf_gr_match1[&quot;DIFF_Barnes_Naive&quot;] = gdf_gr_match1[&quot;GR_Z_area&quot;] - gdf_gr_match1[&quot;GR_Z_barnes&quot;]
gdf_gr_match1.plot(column=&quot;DIFF_Barnes_Naive&quot;, legend=True, cmap=&quot;Spectral_r&quot;, vmin=-0.25, vmax=0.25)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="JF4kRqm5Taj6m4PmborPm" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&lt;Axes: &gt;</span></code></div><img src="/erad2024/_preview/111/build/c8336c86f68570368f8ff4314d7c2602.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="atEDZxqIXt" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="create-the-sr-gr-database" class="relative group"><span class="heading-text">Create the SR/GR Database</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#create-the-sr-gr-database" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Let’s back to our main task and merge SR/GR aggregated variables into an unique database:</p></div><div id="psRQNVrD89" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Create DataFrame with matched variables
gdf_match = gdf_gr_match.merge(gdf_sr, on=&quot;geometry&quot;)

# Compute ratio SR/GR volume
gdf_match[&quot;VolumeRatio&quot;] = gdf_match[&quot;SR_gate_volume_sum&quot;] / gdf_match[&quot;GR_gate_volume_sum&quot;]

# Compute difference in SR/GR gate volume
gdf_match[&quot;VolumeDiff&quot;] = gdf_match[&quot;SR_gate_volume_sum&quot;] - gdf_match[&quot;GR_gate_volume_sum&quot;]

# Compute time difference [in seconds]
gdf_match[&quot;time_difference&quot;] = gdf_match[&quot;GR_time&quot;] - gdf_match[&quot;SR_time&quot;]
gdf_match[&quot;time_difference&quot;] = gdf_match[&quot;time_difference&quot;].dt.total_seconds().astype(int)

# Compute lower bound and upper bound height
gdf_match[&quot;GR_z_lower_bound&quot;] = gdf_match[&quot;GR_z_min&quot;] - gdf_match[&quot;GR_vres_mean&quot;] / 2
gdf_match[&quot;GR_z_upper_bound&quot;] = gdf_match[&quot;GR_z_max&quot;] + gdf_match[&quot;GR_vres_mean&quot;] / 2

gdf_match[&quot;SR_z_lower_bound&quot;] = gdf_match[&quot;SR_z_min&quot;] - gdf_match[&quot;SR_vres_mean&quot;] / 2
gdf_match[&quot;SR_z_upper_bound&quot;] = gdf_match[&quot;SR_z_max&quot;] + gdf_match[&quot;SR_vres_mean&quot;] / 2</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="u1Hihyu-ROEFoOUZxd780" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="R4ojm9JB9F" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="analyse-the-sr-gr-database" class="relative group"><span class="heading-text">Analyse the SR/GR Database</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#analyse-the-sr-gr-database" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="ZhpLOtruny" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Show fraction SR footprint horizontal area covered by GR
gdf_match.plot(column=&quot;GR_fraction_covered_area&quot;, legend=True, cmap=&quot;Spectral_r&quot;)

# Show ratio SR/GR volume
gdf_match.plot(column=&quot;VolumeRatio&quot;, legend=True, cmap=&quot;Spectral_r&quot;)

# Show difference in total gate volume
gdf_match.plot(column=&quot;VolumeDiff&quot;, legend=True, cmap=&quot;Spectral_r&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="H7raC87MYmDHfw9BXD1T_" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&lt;Axes: &gt;</span></code></div><img src="/erad2024/_preview/111/build/bb168e7d2a7efebc53d9b853f46f01a6.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/2ac7ef42d53a9e6e51c9f9d4b1da597c.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/6ba21816ec767d08cb16be4842c1fd11.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="FOZq2zkEpo" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">gdf_gr_match.plot(column=&quot;distance_horizontal_max&quot;, legend=True, cmap=&quot;Spectral_r&quot;)
gdf_gr_match.plot(column=&quot;distance_horizontal_mean&quot;, legend=True, cmap=&quot;Spectral_r&quot;)
gdf_gr_match.plot(column=&quot;distance_horizontal_min&quot;, legend=True, cmap=&quot;Spectral_r&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="mpbHiVh82hPxW9yAMOsDh" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&lt;Axes: &gt;</span></code></div><img src="/erad2024/_preview/111/build/0cd31e3f1436ff9e49e5e88873a39f08.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/3efce0b832df24c69faa2f1114d8d64c.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/ace3c0a92113565c7debca9753c22b54.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="g79oljPxpi" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Analyse variations in gate resolution
gdf_match.plot(column=&quot;GR_vres_mean&quot;, legend=True, cmap=&quot;Spectral_r&quot;)
gdf_match.plot(column=&quot;SR_vres_mean&quot;, legend=True, cmap=&quot;Spectral_r&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="1I9leRnzgZeU57wuiEAR4" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&lt;Axes: &gt;</span></code></div><img src="/erad2024/_preview/111/build/327b2a0530263a19910b2aa40f88b860.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/e12bd9a3955ccb92183fcb44b1903ba3.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="QrKKr71JlT" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Analyse variations in minimum and maximum gate elevation
gdf_match.plot(column=&quot;GR_z_upper_bound&quot;, legend=True, cmap=&quot;Spectral_r&quot;)
gdf_match.plot(column=&quot;SR_z_upper_bound&quot;, legend=True, cmap=&quot;Spectral_r&quot;)

gdf_match.plot(column=&quot;GR_z_lower_bound&quot;, legend=True, cmap=&quot;Spectral_r&quot;)
gdf_match.plot(column=&quot;SR_z_lower_bound&quot;, legend=True, cmap=&quot;Spectral_r&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="hFpXWnttdpzVblK7I4Vq7" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&lt;Axes: &gt;</span></code></div><img src="/erad2024/_preview/111/build/415c70b7a0b9b2d0a9b34e27daf8b00e.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/a9dea70b131486ed4e9795a5f4c095dc.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/05f35dd5178b6218aaf52e8de6f78811.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/d711440018d61fb4960113467391458a.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="Igtx5g3du8" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Analyse fraction hydrometeors and sensitivity
gdf_match.plot(column=&quot;SR_counts&quot;, legend=True, cmap=&quot;Spectral_r&quot;, vmin=0)
gdf_match.plot(column=&quot;SR_counts_valid&quot;, legend=True, cmap=&quot;Spectral_r&quot;, vmin=0)

gdf_match.plot(column=&quot;SR_fraction_clutter&quot;, legend=True, cmap=&quot;Spectral_r&quot;, vmin=0, vmax=1)

# gdf_match.plot(column=&quot;SR_fraction_melting_layer&quot;, legend=True, cmap=&quot;Spectral_r&quot;, vmin=0, vmax=1)
# gdf_match.plot(column=&quot;SR_fraction_hail&quot;, legend=True, cmap=&quot;Spectral_r&quot;, vmin=0, vmax=1)
# gdf_match.plot(column=&quot;SR_fraction_snow&quot;, legend=True, cmap=&quot;Spectral_r&quot;, vmin=0, vmax=1)
# gdf_match.plot(column=&quot;SR_fraction_rain&quot;, legend=True, cmap=&quot;Spectral_r&quot;, vmin=0, vmax=1)
# gdf_match.plot(column=&quot;SR_fraction_no_precip&quot;, legend=True, cmap=&quot;Spectral_r&quot;, vmin=0, vmax=1)
# gdf_match.plot(column=&quot;SR_fraction_below_isotherm&quot;, legend=True, cmap=&quot;Spectral_r&quot;, vmin=0, vmax=1)
# gdf_match.plot(column=&quot;SR_fraction_above_isotherm&quot;, legend=True, cmap=&quot;Spectral_r&quot;, vmin=0, vmax=1)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="B6lCeW-_A5lRjz0xY93QY" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&lt;Axes: &gt;</span></code></div><img src="/erad2024/_preview/111/build/d545c86b3e1ddefca290299b8f726050.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/f71bd85658f47d39cef21106bec3c5ad.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/fb2f033c35e193e7b51cd7a292d55ce8.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="C3pUkuNsz7" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Analyse sensitivity
gdf_match.plot(column=&quot;GR_Z_fraction_above_10dBZ&quot;, legend=True, cmap=&quot;Spectral_r&quot;, vmin=0, vmax=1)
# gdf_match.plot(column=&quot;GR_Z_fraction_above_12dBZ&quot;, legend=True, cmap=&quot;Spectral_r&quot;, vmin=0, vmax=1)
# gdf_match.plot(column=&quot;GR_Z_fraction_above_14dBZ&quot;, legend=True, cmap=&quot;Spectral_r&quot;, vmin=0, vmax=1)

gdf_match.plot(column=&quot;SR_zFactorFinal_Ku_fraction_above_12dBZ&quot;, legend=True, cmap=&quot;Spectral_r&quot;, vmin=0, vmax=1)
# gdf_match.plot(column=&quot;SR_zFactorFinal_Ku_fraction_above_14dBZ&quot;, legend=True, cmap=&quot;Spectral_r&quot;, vmin=0, vmax=1)
# gdf_match.plot(column=&quot;SR_zFactorFinal_Ku_fraction_above_16dBZ&quot;, legend=True, cmap=&quot;Spectral_r&quot;, vmin=0, vmax=1)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="OvMKDhF4-mWc2Q2lFZGou" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&lt;Axes: &gt;</span></code></div><img src="/erad2024/_preview/111/build/33c322981df2f6d91bc788039f846918.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/44e8074905457106edbb2ed7eaec3405.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="JhPFcBSHVS" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Analyse SR attenuation statistics
gdf_match.plot(column=&quot;SR_reliabFlag&quot;, legend=True, cmap=&quot;Spectral_r&quot;)
gdf_match.plot(column=&quot;SR_pathAtten&quot;, legend=True, cmap=&quot;Spectral_r&quot;, vmin=0, vmax=5)
gdf_match.plot(column=&quot;SR_piaFinal&quot;, legend=True, cmap=&quot;Spectral_r&quot;, vmin=0, vmax=5)
gdf_match.plot(column=&quot;SR_zFactorCorrection_Ku_max&quot;, legend=True, cmap=&quot;Spectral_r&quot;, vmin=0, vmax=5)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="JB_PeGLE8E5EUHCTKgyLq" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&lt;Axes: &gt;</span></code></div><img src="/erad2024/_preview/111/build/7610bc3037426f231c576bbe41e717e1.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/1d7fa4f4583bb3b7c9b116cb884a3b62.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/c283a38ad54dcdfed132fa97a6a4c69b.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/b79189c7b56c65defe96c161ed9d38db.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="eXaJYl9BuL" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Analyse SR NUBF
gdf_match.plot(column=&quot;SR_zFactorFinal_Ku_std&quot;, legend=True, cmap=&quot;Spectral_r&quot;, vmin=0, vmax=8)
gdf_match.plot(column=&quot;GR_Z_std&quot;, legend=True, cmap=&quot;Spectral_r&quot;, vmin=0, vmax=8)

# gdf_match.plot(column=&quot;SR_zFactorFinal_Ku_range&quot;, legend=True, cmap=&quot;Spectral_r&quot;, vmin=0, vmax=8)
# gdf_match.plot(column=&quot;GR_Z_range&quot;, legend=True, cmap=&quot;Spectral_r&quot;, vmin=0, vmax=20)

# gdf_match.plot(column=&quot;SR_zFactorFinal_Ku_cov&quot;, legend=True, cmap=&quot;Spectral_r&quot;)
# gdf_match.plot(column=&quot;GR_Z_cov&quot;, legend=True, cmap=&quot;Spectral_r&quot;)

# gdf_match[&quot;SR_zFactorFinal_Ku_range_rel&quot;] = gdf_match[&quot;SR_zFactorFinal_Ku_range&quot;]/gdf_match[&quot;SR_zFactorFinal_Ku_mean&quot;]
# gdf_match.plot(column=&quot;SR_zFactorFinal_Ku_range_rel&quot;, legend=True, cmap=&quot;Spectral_r&quot;, vmin=0, vmax=1)

# gdf_match[&quot;GR_Z_range_rel&quot;] = gdf_match[&quot;GR_Z_range&quot;]/gdf_match[&quot;GR_Z_mean&quot;]
# gdf_match.plot(column=&quot;GR_Z_range_rel&quot;, legend=True, cmap=&quot;Spectral_r&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="uU2l6O-qyXE2sTUCv7zHw" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&lt;Axes: &gt;</span></code></div><img src="/erad2024/_preview/111/build/50e6b97d411351dffe22b9f14a1dd4f6.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/b2c56d97bdbede8abecc8a3c46c91c62.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="TWG278NA3I" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Compare reflectivities
extent_xy = gdf_sr.total_bounds[[0, 2, 1, 3]]
p = gdf_match.plot(
    column=&quot;SR_zFactorFinal_Ku_mean&quot;,
    legend=True,
    legend_kwds={&quot;label&quot;: &quot;SR Reflectivity (dBz)&quot;},
    cmap=&quot;Spectral_r&quot;,
    vmin=10,
    vmax=40,
)
p.axes.set_xlim(extent_xy[0:2])
p.axes.set_ylim(extent_xy[2:4])
p.axes.set_title(&quot;SR&quot;)
plt.xlabel(&quot;x (m)&quot;, fontsize=12)
plt.ylabel(&quot;y (m)&quot;, fontsize=12)
plt.grid(lw=0.25, color=&quot;grey&quot;)

p = gdf_match.plot(
    column=&quot;GR_Z_mean&quot;,
    legend=True,
    legend_kwds={&quot;label&quot;: &quot;GR Reflectivity (dBz)&quot;},
    cmap=&quot;Spectral_r&quot;,
    vmin=10,
    vmax=40,
)
p.axes.set_xlim(extent_xy[0:2])
p.axes.set_ylim(extent_xy[2:4])
p.axes.set_title(&quot;GR&quot;)
plt.xlabel(&quot;x (m)&quot;, fontsize=12)
plt.ylabel(&quot;y (m)&quot;, fontsize=12)
plt.grid(lw=0.25, color=&quot;grey&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="S1rR-M-_18Z-8BqZ2Psxn" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/111/build/85fb8b8eb49a8a3e21d05cc700c86373.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/ae48bb000571ff8d990e5f880a2dcb96.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="qOWF1FIXP4" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Compute difference (also with bias removed)
gdf_match[&quot;DIFF_Z_SR_GR&quot;] = gdf_match[&quot;SR_zFactorFinal_Ku_mean&quot;] - gdf_match[&quot;GR_Z_mean&quot;]
gdf_match[&quot;DIFF_Z_GR_SR&quot;] = gdf_match[&quot;GR_Z_mean&quot;] - gdf_match[&quot;SR_zFactorFinal_Ku_mean&quot;]
bias_gr_sr = np.nanmedian(gdf_match[&quot;DIFF_Z_GR_SR&quot;]).round(2)
bias_sr_gr = np.nanmedian(gdf_match[&quot;DIFF_Z_SR_GR&quot;]).round(2)
p = gdf_match.plot(
    column=&quot;DIFF_Z_SR_GR&quot;,
    legend_kwds={&quot;label&quot;: &quot;SR-GR Reflectivity Difference (dBz)&quot;},
    cmap=&quot;RdBu&quot;,
    legend=True,
    vmax=10,
)
p.axes.set_xlim(extent_xy[0:2])
p.axes.set_ylim(extent_xy[2:4])
p.axes.set_title(&quot;SR - GR&quot;)
plt.xlabel(&quot;x (m)&quot;, fontsize=12)
plt.ylabel(&quot;y (m)&quot;, fontsize=12)
plt.grid(lw=0.25, color=&quot;grey&quot;)

gdf_match[&quot;DIFF_Z_GR_SR_unbiased&quot;] = gdf_match[&quot;DIFF_Z_GR_SR&quot;] - bias_gr_sr
p = gdf_match.plot(
    column=&quot;DIFF_Z_GR_SR_unbiased&quot;,
    legend_kwds={&quot;label&quot;: &quot;SR-GR Reflectivity Difference (wihout bias) (dBz)&quot;},
    cmap=&quot;RdBu&quot;,
    legend=True,
    vmin=-4,
    vmax=4,
)
p.axes.set_xlim(extent_xy[0:2])
p.axes.set_ylim(extent_xy[2:4])
p.axes.set_title(&quot;SR - GR&quot;)
plt.xlabel(&quot;x (m)&quot;, fontsize=12)
plt.ylabel(&quot;y (m)&quot;, fontsize=12)
plt.grid(lw=0.25, color=&quot;grey&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="UTssQVW2C6q5gASq3nwbH" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/111/build/2995b088ad2b9cadda40c49d7f4de3be.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/07679d0b382f27a00809cd9e882f22fa.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="ymvRO4ElvF" class="relative group/block article-grid subgrid-gap col-screen"><hr class="py-2 my-5 translate-y-2"/><p>Here we show how to explore interactively the reflectivity fields using Folium:</p></div><div id="U9xyjQ432A" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">gdf_match1 = gdf_match.copy()
gdf_match1.explore(column=&quot;GR_Z_mean&quot;, legend=True, cmap=&quot;Spectral_r&quot;, vmin=0, vmax=40)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="r-hh3Km97Mv9iLoSgQXBK" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="cHcqADT1Vj" class="relative group/block article-grid subgrid-gap col-screen"><hr class="py-2 my-5 translate-y-2"/><p>Here we show how to plot cartopy maps in WGS84 and GR CRS AEQD.</p></div><div id="a4LUSmF5Mu" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Define Cartopy AEQD CRS
ccrs_aeqd = ccrs.AzimuthalEquidistant(
    central_longitude=ds_gr[&quot;longitude&quot;].item(),
    central_latitude=ds_gr[&quot;latitude&quot;].item(),
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="KpUgfVJ7uNc3JdX1ulm4u" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="oubyY2inAr" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Define Cartopy WGS84 CRS
ccrs_wgs84 = ccrs.PlateCarree()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="qKyEvaQk_IJjFo0beNyqN" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="hohXi7Z5Sm" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Print CRS of geopandas geometries
gdf_match.crs</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="wLzslwSWF4qYy7PIQhZML" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&lt;Projected CRS: PROJCRS[&quot;unknown&quot;,BASEGEOGCRS[&quot;unknown&quot;,DATUM[&quot;Wor ...&gt;
Name: unknown
Axis Info [cartesian]:
- E[east]: Easting (metre)
- N[north]: Northing (metre)
Area of Use:
- undefined
Coordinate Operation:
- name: unknown
- method: Azimuthal Equidistant
Datum: World Geodetic System 1984
- Ellipsoid: WGS 84
- Prime Meridian: Greenwich</span></code></div></div></div><div id="JE6dSpxYIm" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Plot in AEQD CRS (same crs of geopandas geometries)
fig, ax = plt.subplots(subplot_kw={&quot;projection&quot;: ccrs_aeqd})
gdf_match.plot(ax=ax, column=&quot;GR_Z_mean&quot;, cmap=&quot;turbo&quot;, legend=True)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="FbKy39dDu5EmOX-fpL1JS" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&lt;GeoAxes: &gt;</span></code></div><img src="/erad2024/_preview/111/build/bb2cc022a696556cfeb31b7b7cb220dd.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="Pk2xQN0K0k" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Convert geopandas dataframe to another crs
gdf_match_wgs84 = gdf_match.to_crs(crs_sr)
# Plot in WGS84 CRS
fig, ax = plt.subplots(subplot_kw={&quot;projection&quot;: ccrs_wgs84})
# plot_cartopy_background(ax)
gdf_match_wgs84.plot(ax=ax, column=&quot;GR_Z_mean&quot;, cmap=&quot;turbo&quot;, legend=True)
ax.set_extent(ds_gr.xradar_dev.extent(max_distance=max_gr_range))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="GkbY6hNaxXJxCfJg7hKPf" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/111/build/938cdae6cc54234730626037e3c65b45.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="a62o5TC0gw" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="filter-the-sr-gr-database" class="relative group"><span class="heading-text">Filter the SR/GR Database</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#filter-the-sr-gr-database" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>When calibrating or comparing SR and GR data, there is a necessary tradeoff between the strictness of filtering criteria filtering and the number of available samples. Here below we provide some general recommendations for effective filtering:</p><ol start="1"><li><p><strong>Sensitivity Thresholds</strong>: Retain only those radar beams where the aggregated gate reflectivities exceed the instrument sensitivities.
The <code>GR_Z_fraction_above_&lt;thr&gt;dBZ</code> and <code>SR_zFactorFinal_Ku_fraction_above_&lt;thr&gt;dBZ</code> variables can be used filter the samples.</p></li><li><p><strong>Stratiform Precipitation</strong>:  If the purpose of your analysis is to assess the calibration bias of GR data, it is suggested to focus on stratiform precipitation that ocurrs outside the melting layer (i.e. avoiding the bright band). Only stratiform samples above the melting layer are used in ground validation of the GPM DPR (W. Petersen 2017, personal communication).
Convective SR footprints are typically excluded to avoid dealing with:</p><ul><li>the high spatial variability in the precipitation field and issues with non-uniform beam filling (NUBF),</li><li>the potential biases introduced by the SR attenuation correction,</li><li>the potential biases in GR reflectivities, especially at C and X band, due to beam attenuation,</li><li>the multiple scattering signature caused by hail particles.</li></ul></li><li><p><strong>Reflectivity Range</strong>: According to Warren et al. (2018), volume-averaged SR and GR reflectivity values should be selected within the range of 24 to 36 dBZ. This range minimizes the impact of low SR sensitivity,  SR beam attenuation and non-rayleigh scattering effects.</p></li><li><p><strong>Clutter Removal</strong>: Exclude SR/GR samples that are contaminated by ground clutter, anomalous propagation, or beam blockage.</p></li><li><p><strong>Volume matching</strong>: Exclude SR/GR samples where there are excessive differences in the total gate volume.</p></li></ol></div><div id="whc6UtHIgW" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Define mask
masks = [
    # Select SR scan with &quot;normal&quot; dataQuality (for entire cross-track scan)
    gdf_match[&quot;SR_dataQuality&quot;] == 0,
    # Select SR beams with detected precipitation
    gdf_match[&quot;SR_flagPrecip&quot;] &gt; 0,
    # Select only &#x27;high quality&#x27; SR data
    # - qualityFlag == 1 indicates low quality retrievals
    # - qualityFlag == 2 indicates bad/missing retrievals
    gdf_match[&quot;SR_qualityFlag&quot;] == 0,
    # Select SR beams with SR above minimum reflectivity
    gdf_match[&quot;SR_zFactorFinal_Ku_fraction_above_12dBZ&quot;] &gt; 0.95,
    # Select SR beams with GR above minimum reflectivity
    gdf_match[&quot;GR_Z_fraction_above_10dBZ&quot;] &gt; 0.95,
    # Select only SR beams with detected bright band
    gdf_match[&quot;SR_qualityBB&quot;] == 1,
    # Select only beams with confident precipitation type
    gdf_match[&quot;SR_qualityTypePrecip&quot;] == 1,
    # Select only stratiform precipitation
    # - SR_flagPrecipitationType == 2 indicates convective
    gdf_match[&quot;SR_flagPrecipitationType&quot;] == 1,
    # Select only SR beams with reliable attenuation correction
    gdf_match[&quot;SR_reliabFlag&quot;].isin((1, 2)),  # or == 1
    # Select only beams with reduced path attenuation
    # gdf_match[&quot;SR_zFactorCorrection_Ku_max&quot;]
    # gdf_match[&quot;SR_piaFinal&quot;]
    # gdf_match[&quot;SR_pathAtten&quot;]
    # Select only SR beams with matching SR gates with no clutter
    gdf_match[&quot;SR_fraction_clutter&quot;] == 0,
    # Select only SR beams with matching SR gates not in the melting layer
    gdf_match[&quot;SR_fraction_melting_layer&quot;] == 0,
    # Select only SR beams with matching SR gates with precipitation
    gdf_match[&quot;SR_fraction_no_precip&quot;] == 0,
    # Select only SR beams with matching SR gates with no hail
    # gdf_match[&quot;SR_fraction_hail&quot;] == 0,
    # Select only SR beams with matching SR gates with rain
    # gdf_match[&quot;SR_fraction_hail&quot;] == 1,
    # Select only SR beams with matching SR gates with snow
    # gdf_match[&quot;SR_fraction_snow&quot;] == 1,
    # Discard SR beams with high NUBF
    # gdf_match[&quot;SR_zFactorFinal_Ku_range&quot;] &gt; 5,
    # gdf_match[&quot;SR_zFactorFinal_Ku_cov&quot;] &lt; 0.5,
    # gdf_match[&quot;GR_Z_cov&quot;] &lt; 0.5,
    # gdf_match[&quot;GR_Z_range&quot;] &gt; 5,
    # Select only interval of reflectivities
    # - Warren et al., 2018:  between 24 and 36 dBZ
    # (gdf_match[&quot;SR_zFactorFinal_Ku_mean&quot;] &gt; 24) &amp; (gdf_match[&quot;SR_zFactorFinal_Ku_mean&quot;] &lt; 36),
    # (gdf_match[&quot;GR_Z_mean&quot;] &gt; 24) &amp; (gdf_match[&quot;GR_Z_mean&quot;] &lt; 36),
    # Select SR beams only within given GR radius interval
    # (gdf_match[&quot;GR_range_min&quot;] &gt; min_gr_range) &amp; (gdf_match[&quot;GR_range_max&quot;] &lt; max_gr_range),
    # Discard SR beams where scanning time difference (provided in seconds)
    gdf_match[&quot;time_difference&quot;] &lt; 5 * 60,  # 5 min
    # Discard SR beams where GR gates does not cover 80% of the horizontal area
    # gdf_match[&quot;GR_fraction_covered_area&quot;] &gt; 0.8,
    # Filter footprints where volume ratio exceeds 60
    # gdf_match[&quot;VolumeRatio&quot;] &gt; 60,
    # Filter footprints where GR affected by beam blockage
    # TODO: Filtering by beam blockage
]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="vMx7hH4UmDQsRjWC27ncd" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="UDeTMXLLwN" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Define final mask
mask_final = reduce(np.logical_and, masks)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="AuPEW_mr5qGe8jCemaAp2" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="ZdTaQEFOOt" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Dsplay final filtering mask
gdf_match[&quot;filtering_mask&quot;] = mask_final
gdf_match.plot(column=&quot;filtering_mask&quot;, legend=True, cmap=&quot;Spectral&quot;)
gdf_match.plot(column=&quot;SR_zFactorFinal_Ku_mean&quot;, legend=True, cmap=&quot;Spectral&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="eyl3L8S3abwkEmw3q16in" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&lt;Axes: &gt;</span></code></div><img src="/erad2024/_preview/111/build/ec9413610a6a6d1b96da79c255b23203.png" alt="&lt;Figure size 640x480 with 1 Axes&gt;"/><img src="/erad2024/_preview/111/build/042c6ba5e9415a0c224a9e578c10b360.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="EY7pa2SjJ3" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Filter matching dataset
gdf_final = gdf_match[mask_final]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="sJnZko_qoV10shxFlugKx" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="W3L5smOk5R" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Plot results
gdf_final.plot(column=&quot;SR_zFactorFinal_Ku_mean&quot;, legend=True, cmap=&quot;Spectral_r&quot;, vmin=0, vmax=40)
gdf_final.plot(column=&quot;GR_Z_mean&quot;, legend=True, cmap=&quot;Spectral_r&quot;, vmin=0, vmax=40)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="y9_W08cDBJI3lTDXejKek" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&lt;Axes: &gt;</span></code></div><img src="/erad2024/_preview/111/build/6a3ae1e79e2aaf2ad5a9e5e3440fb898.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/111/build/3231e6512d7ee90fd04eccce5be4dfc3.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="txb73J5Xow" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="determine-the-gr-calibration-bias" class="relative group"><span class="heading-text">Determine the GR Calibration Bias</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#determine-the-gr-calibration-bias" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="zUY20THFId" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Compute statistics
bias = np.nanmean(gdf_match[&quot;DIFF_Z_GR_SR&quot;]).round(2)
robBias = np.nanmedian(gdf_match[&quot;DIFF_Z_GR_SR&quot;]).round(2)

# R2 (pearson, spearman rank)
print(f&quot;Th ZH Calibration offset is (mean): {bias} dB&quot;)
print(f&quot;Th ZH Calibration offset is (median): {robBias} dB&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="_WC5mC3iZtxWWBd3olyX3" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Th ZH Calibration offset is (mean): -5.53 dB
Th ZH Calibration offset is (median): -4.58 dB
</span></code></pre></div></div></div><div id="l5Jat1H8SP" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Comparison of GR vs SR reflectivities
hue_variable = &quot;VolumeDiff&quot;
hue_title = &quot;Difference in volume between SR and GR [m³]&quot;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="3qnvmTUSBnbqc75A_WqHv" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="m9LykM5F1n" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># - Histograms
fig = plt.figure(figsize=(12, 5))
ax = fig.add_subplot(121, aspect=&quot;equal&quot;)
plt.scatter(
    gdf_match[&quot;GR_Z_mean&quot;],
    gdf_match[&quot;SR_zFactorFinal_Ku_mean&quot;],
    marker=&quot;+&quot;,
    c=gdf_match[hue_variable],
    cmap=&quot;turbo&quot;,
)
plt.colorbar(label=hue_title)
plt.plot([0, 60], [0, 60], linestyle=&quot;solid&quot;, color=&quot;black&quot;)
plt.xlim(10, 50)
plt.ylim(10, 50)
plt.xlabel(&quot;GR reflectivity (dBZ)&quot;)
plt.ylabel(&quot;SR reflectivity (dBZ)&quot;)
plt.title(f&quot;Offset GR-SR: {bias} dBZ&quot;)
ax = fig.add_subplot(122)
plt.hist(
    gdf_match[&quot;GR_Z_mean&quot;][gdf_match[&quot;GR_Z_mean&quot;] &gt; z_min_threshold_gr],
    bins=np.arange(10, 60, 5),
    edgecolor=&quot;None&quot;,
    label=&quot;GR&quot;,
)
plt.hist(
    gdf_match[&quot;SR_zFactorFinal_Ku_mean&quot;][gdf_match[&quot;SR_zFactorFinal_Ku_mean&quot;] &gt; z_min_threshold_sr],
    bins=np.arange(10, 60, 5),
    edgecolor=&quot;red&quot;,
    facecolor=&quot;None&quot;,
    label=&quot;SR&quot;,
)
plt.xlabel(&quot;Reflectivity (dBZ)&quot;)
plt.legend()
fig.suptitle(&quot;GR vs SR&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="A33SYxrJHjbZLTEPoXBao" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/111/build/1b625a75f43cafe6c67701a9c8a2475b.png" alt="&lt;Figure size 1200x500 with 3 Axes&gt;"/></div></div><div id="pudK5z5hr4" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="next-steps" class="relative group"><span class="heading-text">Next Steps</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#next-steps" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="L6gUOkuQiB" class="relative group/block article-grid subgrid-gap col-screen"><p>Congratulations on reaching the end of this tutorial!
If you have suggestions for improving this tutorial or the SR/GR matching process, please feel free to open
a Pull Request or create a GitHub issue on the <a target="_blank" href="https://github.com/ghiggi/gpm_api" rel="noreferrer">GPM-API GitHub repository</a>.</p><p>The code for the SR/GR matching process is encapsulated in the <code>volume_matching</code> function contained in the <a href="https://github.com/ghiggi/gpm_api/blob/main/gpm/gv/routines.py" class="italic" target="_blank" rel="noreferrer" data-state="closed">gpm.gv module</a>. User are free to use or adapt such function to accomplish their tasks.
The <a target="_blank" href="https://gpm-api.readthedocs.io/en/latest/tutorials/tutorial_03_SR_GR_Calibration.html" rel="noreferrer">Spaceborne-Ground Radar Calibration Applied Tutorial</a> shows how to assess the GR calibration bias by abstracting away the complexities discussed in this tutorial.</p></div><div id="j2mxDS97GB" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="references" class="relative group"><span class="heading-text">References</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#references" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="YcD5D2swjD" class="relative group/block article-grid subgrid-gap col-screen"><ul><li><cite data-state="closed"><a href="https://doi.org/10.1002/jgrd.50138" target="_blank" rel="noreferrer" class="hover-link">Cao, Q., Y. Hong, Y. Qi, Y. Wen, J. Zhang, J. J. Gourley, and L. Liao, 2013: Empirical conversion of the vertical profile of reflectivity from Ku-band to S-band frequency. J. Geophys. Res. Atmos., 118, 1814–1825, https://doi.org/10.1002/jgrd.50138</a></cite></li><li><cite data-state="closed"><a href="https://doi.org/10.1175/2010jtecha1403.1" target="_blank" rel="noreferrer" class="hover-link">Schwaller, MR, and Morris, KR. 2011. A ground validation network for the Global Precipitation Measurement mission. J. Atmos. Oceanic Technol., 28, 301-319.28, https://doi.org/10.1175/2010JTECHA1403.1</a></cite></li><li><cite data-state="closed"><a href="https://doi.org/10.1175/jtech-d-17-0128.1" target="_blank" rel="noreferrer" class="hover-link">Warren, R.A., A. Protat, S.T. Siems, H.A. Ramsay, V. Louf, M.J. Manton, and T.A. Kane, 2018. Calibrating ground-based radars against TRMM and GPM. J. Atmos. Oceanic Technol., 35, 323–346, https://doi.org/10.1175/JTECH-D-17-0128.1</a></cite></li></ul></div><div id="bDlTCi0RFL" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="citation" class="relative group"><span class="heading-text">Citation</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#citation" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="I5wq9D1IsJ" class="relative group/block article-grid subgrid-gap col-screen"><p>This notebook is part of the <a target="_blank" href="https://gpm-api.readthedocs.io/" rel="noreferrer">GPM-API  documentation</a>.</p><p>Large portions of this tutorials were adapted and derived from an old <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ω</mi><mi>r</mi><mi>a</mi><mi>d</mi><mi>l</mi><mi>i</mi><mi>b</mi></mrow><annotation encoding="application/x-tex">\omega radlib</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">a</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">ib</span></span></span></span></span>  tutorial.</p><p>Copyright: <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ω</mi><mi>r</mi><mi>a</mi><mi>d</mi><mi>l</mi><mi>i</mi><mi>b</mi></mrow><annotation encoding="application/x-tex">\omega radlib</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">a</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">ib</span></span></span></span></span>  and GPM-API developers.
Distributed under the MIT License. See <a href="https://github.com/ghiggi/gpm_api/blob/main/LICENSE" class="italic" target="_blank" rel="noreferrer" data-state="closed">GPM-API license</a> for more info.</p></div><div></div><section id="references" class="article-grid subgrid-gap col-screen"><div><header class="text-lg font-semibold text-stone-900 dark:text-white group">References<a class="no-underline text-inherit hover:text-inherit ml-2 select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#references" title="Link to References" aria-label="Link to References">¶</a></header></div><div class="pl-3 mb-8 text-xs text-stone-500 dark:text-stone-300"><ol><li class="break-words" id="cite-Schwaller_2011">Schwaller, M. R., & Morris, K. R. (2011). A Ground Validation Network for the Global Precipitation Measurement Mission. <i>Journal of Atmospheric and Oceanic Technology</i>, <i>28</i>(3), 301–319. <a target="_blank" rel="noreferrer" href="https://doi.org/10.1175/2010jtecha1403.1">10.1175/2010jtecha1403.1</a></li><li class="break-words" id="cite-Warren_2018">Warren, R. A., Protat, A., Siems, S. T., Ramsay, H. A., Louf, V., Manton, M. J., & Kane, T. A. (2018). Calibrating Ground-Based Radars against TRMM and GPM. <i>Journal of Atmospheric and Oceanic Technology</i>, <i>35</i>(2), 323–346. <a target="_blank" rel="noreferrer" href="https://doi.org/10.1175/jtech-d-17-0128.1">10.1175/jtech-d-17-0128.1</a></li><li class="break-words" id="cite-Cao_2013">Cao, Q., Hong, Y., Qi, Y., Wen, Y., Zhang, J., Gourley, J. J., & Liao, L. (2013). Empirical conversion of the vertical profile of reflectivity from Ku‐band to S‐band frequency. <i>Journal of Geophysical Research: Atmospheres</i>, <i>118</i>(4), 1814–1825. <a target="_blank" rel="noreferrer" href="https://doi.org/10.1002/jgrd.50138">10.1002/jgrd.50138</a></li></ol></div></section><div class="flex pt-10 mb-10 space-x-4"><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/erad2024/_preview/111/sr-gr-calibration-applied"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="text-xs text-gray-500 dark:text-gray-400">Spaceborne - Ground Radar Matching and Calibration</div>Spaceborne-Ground Radar Calibration (Application)</div></div></a><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/erad2024/_preview/111/description-pyrad-tutorial"><div class="flex h-full align-middle"><div class="flex-grow"><div class="text-xs text-gray-500 dark:text-gray-400">Spaceborne - Ground Radar Matching and Calibration</div>Pyrad QPE Exercise</div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3"></path></svg></div></a></div></main></article><script>((o,u)=>{if(!window.history.state||!window.history.state.key){let f=Math.random().toString(32).slice(2);window.history.replaceState({key:f},"")}try{let d=JSON.parse(sessionStorage.getItem(o)||"{}")[u||window.history.state.key];typeof d=="number"&&window.scrollTo(0,d)}catch(f){console.error(f),sessionStorage.removeItem(o)}})("positions", null)</script><link rel="modulepreload" href="/erad2024/_preview/111/build/entry.client-QAC4OMCW.js"/><link rel="modulepreload" href="/erad2024/_preview/111/build/_shared/chunk-ELJFAI6P.js"/><link rel="modulepreload" href="/erad2024/_preview/111/build/_shared/chunk-XJN3BT5Q.js"/><link rel="modulepreload" href="/erad2024/_preview/111/build/_shared/chunk-2NH4LW52.js"/><link rel="modulepreload" href="/erad2024/_preview/111/build/_shared/chunk-K5W6CIRR.js"/><link rel="modulepreload" href="/erad2024/_preview/111/build/_shared/chunk-YAIQ7LUU.js"/><link rel="modulepreload" href="/erad2024/_preview/111/build/_shared/chunk-HTHE5KDW.js"/><link rel="modulepreload" href="/erad2024/_preview/111/build/_shared/chunk-YOTPU7U7.js"/><link rel="modulepreload" href="/erad2024/_preview/111/build/_shared/chunk-QB27XQSF.js"/><link rel="modulepreload" href="/erad2024/_preview/111/build/_shared/chunk-JOLZ6LZB.js"/><link rel="modulepreload" href="/erad2024/_preview/111/build/_shared/chunk-MITWS4PZ.js"/><link rel="modulepreload" href="/erad2024/_preview/111/build/_shared/chunk-J6FHCSRC.js"/><link rel="modulepreload" href="/erad2024/_preview/111/build/_shared/chunk-FSSJOMYR.js"/><link rel="modulepreload" href="/erad2024/_preview/111/build/_shared/chunk-TEYZXLTV.js"/><link rel="modulepreload" href="/erad2024/_preview/111/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/erad2024/_preview/111/build/root-5DLIE3NT.js"/><link rel="modulepreload" href="/erad2024/_preview/111/build/_shared/chunk-M2HO7LAT.js"/><link rel="modulepreload" href="/erad2024/_preview/111/build/routes/$-7SLCSLL3.js"/><script>window.__remixContext = {"url":"/sr-gr-matching-procedure","state":{"loaderData":{"root":{"theme":"light","config":{"options":{"favicon":"/erad2024/_preview/111/build/config-item-7674c9ca-4081652ed9d0f1fd636dda854a7dafc5.ico","logo":"/erad2024/_preview/111/build/erad_white_backgroun-fef88c318808c418b43394c058f8d30d.png","logo_dark":"/erad2024/_preview/111/build/erad_white_backgroun-fef88c318808c418b43394c058f8d30d.png"},"myst":"1.3.7","nav":[{"title":"Conference Home","url":"https://www.erad2024.it"},{"title":"Community","url":"https://openradarscience.org"},{"title":"Discourse","url":"https://openradar.discourse.group/"}],"actions":[{"title":"Launch Environment","url":"https://binder.projectpythia.org/v2/gh/openradar/erad2024/main?labpath=notebooks","internal":false,"static":false}],"projects":[{"open_access":true,"license":{"content":{"id":"Apache-2.0","name":"Apache License 2.0","osi":true,"free":true,"url":"https://opensource.org/licenses/Apache-2.0"},"code":{"id":"CC-BY-4.0","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true,"url":"https://creativecommons.org/licenses/by/4.0/"}},"abbreviations":{"ARM":"Atmospheric Radiation Measurement","NCAR":"National Center for Atmospheric Research"},"settings":{"output_matplotlib_strings":"remove"},"title":"ERAD 2024","authors":[{"nameParsed":{"literal":"Alfonso Ladino","given":"Alfonso","family":"Ladino"},"name":"Alfonso Ladino","orcid":"0000-0001-8081-7827","github":"aladinor","id":"contributors-myst-generated-uid-0"},{"nameParsed":{"literal":"Anna del Moral Méndez","given":"Anna","non_dropping_particle":"del","family":"Moral Méndez"},"name":"Anna del Moral Méndez","orcid":"0000-0002-5015-840X","id":"contributors-myst-generated-uid-1"},{"nameParsed":{"literal":"Brenda Javornik","given":"Brenda","family":"Javornik"},"name":"Brenda Javornik","orcid":"0009-0004-9266-9293","github":"leavesntwigs","id":"contributors-myst-generated-uid-2"},{"nameParsed":{"literal":"Daniel Michelson","given":"Daniel","family":"Michelson"},"name":"Daniel Michelson","orcid":"0000-0003-3222-9881","github":"DanielMichelson","id":"contributors-myst-generated-uid-3"},{"nameParsed":{"literal":"Daniel Wolfensberger","given":"Daniel","family":"Wolfensberger"},"name":"Daniel Wolfensberger","orcid":"0009-0006-1419-0556","github":"wolfidan","id":"contributors-myst-generated-uid-4"},{"nameParsed":{"literal":"Gionata Ghiggi","given":"Gionata","family":"Ghiggi"},"name":"Gionata Ghiggi","orcid":"0000-0002-0818-0865","github":"ghiggi","id":"contributors-myst-generated-uid-5"},{"nameParsed":{"literal":"Jen DeHart","given":"Jen","family":"DeHart"},"name":"Jen DeHart","orcid":"0000-0001-8536-4927","github":"jcdehart","id":"contributors-myst-generated-uid-6"},{"nameParsed":{"literal":"Jordi Figueras i Ventura","given":"Jordi Figueras","non_dropping_particle":"i","family":"Ventura"},"name":"Jordi Figueras i Ventura","orcid":"0000-0002-4949-422X","github":"jfigui","id":"contributors-myst-generated-uid-7"},{"nameParsed":{"literal":"Julian Giles","given":"Julian","family":"Giles"},"name":"Julian Giles","orcid":"0000-0001-8134-008X","github":"JulianGiles","id":"contributors-myst-generated-uid-8"},{"nameParsed":{"literal":"Kai Mühlbauer","given":"Kai","family":"Mühlbauer"},"name":"Kai Mühlbauer","orcid":"0000-0001-6599-1034","github":"kmuehlbauer","id":"contributors-myst-generated-uid-9"},{"nameParsed":{"literal":"Maxwell Grover","given":"Maxwell","family":"Grover"},"name":"Maxwell Grover","orcid":"0000-0002-0370-8974","github":"mgrover1","id":"contributors-myst-generated-uid-10"},{"nameParsed":{"literal":"Mike Dixon","given":"Mike","family":"Dixon"},"name":"Mike Dixon","orcid":"0000-0002-9597-9113","github":"mike-dixon","id":"contributors-myst-generated-uid-11"},{"nameParsed":{"literal":"Robert Jackson","given":"Robert","family":"Jackson"},"name":"Robert Jackson","orcid":"0000-0003-2518-1234","github":"rcjackson","id":"contributors-myst-generated-uid-12"},{"nameParsed":{"literal":"Scott Collis","given":"Scott","family":"Collis"},"name":"Scott Collis","orcid":"0000-0002-2303-687X","github":"scollis","id":"contributors-myst-generated-uid-13"},{"nameParsed":{"literal":"Ting-Yu Cha","given":"Ting-Yu","family":"Cha"},"name":"Ting-Yu Cha","orcid":"0000-0002-6292-8483","github":"tingyucha","id":"contributors-myst-generated-uid-14"}],"github":"https://github.com/openradar/erad2024","copyright":"2024","references":{"foundations":{"url":"https://projectpythia-mystmd.github.io/pythia-foundations"},"xarray":{"url":"https://docs.xarray.dev/en/stable"},"matplotlib":{"url":"https://matplotlib.org/stable"}},"thebe":{"binder":{"url":"https://binder.projectpythia.org/","provider":"github","repo":"openradar/erad2024","ref":"HEAD"}},"toc":[{"file":"README.md"},{"file":"notebooks/how-to-cite.md"},{"file":"schedule.md"},{"children":[{"file":"getting_started.md"},{"file":"notebooks/data-access/intro-data-access.ipynb"},{"file":"notebooks/environment.ipynb"}],"title":"Getting started"},{"children":[{"file":"presentations/intro-to-open-radar-science.ipynb"},{"file":"notebooks/xradar-pyart/xradar-basics.ipynb"},{"children":[{"file":"notebooks/xradar-pyart/pyart-basics.ipynb"},{"file":"notebooks/wradlib/wradlib_clutter_beamblockage.ipynb"}],"title":"Py-ART and wradlib"},{"file":"notebooks/gpm-api/gpm-api-intro.ipynb"},{"children":[{"pattern":"notebooks/baltrad/baltrad_short_course/*.ipynb"},{"pattern":"notebooks/baltrad/pyart2baltrad/*.ipynb"},{"file":"notebooks/baltrad/baltrad2wradlib/baltrad2wradlib.ipynb"}],"title":"BALTRAD"},{"children":[{"file":"notebooks/lrose/LROSE_Basics.ipynb"},{"file":"notebooks/lrose/testing/stress_testing.ipynb"}],"title":"LROSE"}],"title":"Radar Software Foundations"},{"children":[{"file":"projects.md"},{"children":[{"file":"notebooks/lrose/DD_Tornado_ERAD24.ipynb"},{"file":"notebooks/Retrieving_winds_with_pydda.ipynb"},{"file":"notebooks/lrose/LROSE_ERAD_fractl_samurai.ipynb"}],"title":"LROSE \u0026 PyDDA multi doppler analysis"},{"children":[{"file":"notebooks/Analysis-Ready/ARCO-Datasets.ipynb"},{"file":"notebooks/Analysis-Ready/QPE-QVPs.ipynb"}],"title":"ARCO Radar Datasets"},{"children":[{"file":"notebooks/gpm-api/SR_GR_Calibration_Applied.ipynb"},{"file":"notebooks/gpm-api/SR_GR_Matching_Procedure.ipynb"}],"title":"Spaceborne - Ground Radar Matching and Calibration"},{"file":"notebooks/pyrad/description-pyrad-tutorial.ipynb"}],"title":"Project Workflows"}],"thumbnail":"/erad2024/_preview/111/build/0885e6292c6be2fd643fbc952d479a01.jpeg","exports":[],"bibliography":[],"index":"readme","pages":[{"slug":"how-to-cite","title":"How to Cite","description":"","date":"","thumbnail":"/erad2024/_preview/111/build/77214e045b66b8893a77f4793a31b1ba.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"schedule","title":"Schedule","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"level":1,"title":"Getting started"},{"slug":"getting-started","title":"Notebook Execution","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"intro-data-access","title":"Data Access Instructions","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"environment","title":"Environment overview","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Radar Software Foundations"},{"slug":"intro-to-open-radar-science","title":"An Introduction to Open Radar Science","description":"","date":"","thumbnail":"/erad2024/_preview/111/build/31631960e5ad8808b3289c31e033c7bf.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"xradar-basics","title":"Xradar Basics","description":"","date":"","thumbnail":"/erad2024/_preview/111/build/xradar_logo-6afafa20f95d9ebdba6dd467bd5a8abe.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":2,"title":"Py-ART and wradlib"},{"slug":"pyart-basics","title":"Py-ART Basics with Xradar","description":"","date":"","thumbnail":"/erad2024/_preview/111/build/arm_logo-8eb24d0ca02979674c9b7a2c42be2174.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"wradlib-clutter-beamblockage","title":"wradlib - clutter and beamblockage","description":"","date":"","thumbnail":"/erad2024/_preview/111/build/wradlib_logo.svg-632a8c70c575dd5d977b843285747573.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"gpm-api-intro","title":"Introduction to GPM-API","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":2,"title":"BALTRAD"},{"slug":"baltrad-io","title":"I/O model","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad-qc","title":"Quality Control","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad-drqc","title":"Quality Control using DR","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad-parallel-processing","title":"Parallel processing","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad-compositing","title":"Compositing","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad-pyart-rain-rate-example","title":"Rain Rate retrieval with Py-ART","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"pyart-baltrad-dealias-example","title":"Doppler Velocity Dealiasing with Py-ART","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad2wradlib","title":"Attenuation correction comparison with wradlib","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"LROSE"},{"slug":"lrose-basics","title":"An Introduction to LROSE","description":"","date":"","thumbnail":"/erad2024/_preview/111/build/colette_rose-04fdd4955b27b7afb0698bf821eef6da.jpg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"stress-testing","title":"stress-testing","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"Project Workflows"},{"slug":"projects","title":"Projects Overview","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":2,"title":"LROSE \u0026 PyDDA multi doppler analysis"},{"slug":"dd-tornado-erad24","title":"Introduction to Multidoppler Analysis","description":"","date":"","thumbnail":"/erad2024/_preview/111/build/logo-2a51d2c5875a2157457c94a178e89f75.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"retrieving-winds-with-pydda","title":"PyDDA tutorial","description":"","date":"","thumbnail":"/erad2024/_preview/111/build/5e2d147096249dc3a37da495168a9e9e.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"lrose-erad-fractl-samurai","title":"LROSE Wind Tutorial","description":"","date":"","thumbnail":"/erad2024/_preview/111/build/samurai-e283b264c57ee13ee973d49bc345649c.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"ARCO Radar Datasets"},{"slug":"arco-datasets","title":"Analysis-Ready Cloud-Optimized Datasets","description":"","date":"","thumbnail":"/erad2024/_preview/111/build/ARCO-17657a5969d0d7dd7614cf3e9b93f6a4.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"qpe-qvps","title":"QPE \u0026 QVPs","description":"","date":"","thumbnail":"/erad2024/_preview/111/build/QVP-25b8e6200a6aa9817e77abdcc7e8fabc.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"Spaceborne - Ground Radar Matching and Calibration"},{"slug":"sr-gr-calibration-applied","title":"Spaceborne-Ground Radar Calibration (Application)","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"sr-gr-matching-procedure","title":"Spaceborne-Ground Radar Matching (Methodology)","description":"","date":"","thumbnail":"/erad2024/_preview/111/build/cc72069fb56e0a54f1123fbe9c2fcb76.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"description-pyrad-tutorial","title":"Pyrad QPE Exercise","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"/erad2024/_preview/111"},"routes/$":{"config":{"options":{"favicon":"/erad2024/_preview/111/build/config-item-7674c9ca-4081652ed9d0f1fd636dda854a7dafc5.ico","logo":"/erad2024/_preview/111/build/erad_white_backgroun-fef88c318808c418b43394c058f8d30d.png","logo_dark":"/erad2024/_preview/111/build/erad_white_backgroun-fef88c318808c418b43394c058f8d30d.png"},"myst":"1.3.7","nav":[{"title":"Conference Home","url":"https://www.erad2024.it"},{"title":"Community","url":"https://openradarscience.org"},{"title":"Discourse","url":"https://openradar.discourse.group/"}],"actions":[{"title":"Launch Environment","url":"https://binder.projectpythia.org/v2/gh/openradar/erad2024/main?labpath=notebooks","internal":false,"static":false}],"projects":[{"open_access":true,"license":{"content":{"id":"Apache-2.0","name":"Apache License 2.0","osi":true,"free":true,"url":"https://opensource.org/licenses/Apache-2.0"},"code":{"id":"CC-BY-4.0","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true,"url":"https://creativecommons.org/licenses/by/4.0/"}},"abbreviations":{"ARM":"Atmospheric Radiation Measurement","NCAR":"National Center for Atmospheric Research"},"settings":{"output_matplotlib_strings":"remove"},"title":"ERAD 2024","authors":[{"nameParsed":{"literal":"Alfonso Ladino","given":"Alfonso","family":"Ladino"},"name":"Alfonso Ladino","orcid":"0000-0001-8081-7827","github":"aladinor","id":"contributors-myst-generated-uid-0"},{"nameParsed":{"literal":"Anna del Moral Méndez","given":"Anna","non_dropping_particle":"del","family":"Moral Méndez"},"name":"Anna del Moral Méndez","orcid":"0000-0002-5015-840X","id":"contributors-myst-generated-uid-1"},{"nameParsed":{"literal":"Brenda Javornik","given":"Brenda","family":"Javornik"},"name":"Brenda Javornik","orcid":"0009-0004-9266-9293","github":"leavesntwigs","id":"contributors-myst-generated-uid-2"},{"nameParsed":{"literal":"Daniel Michelson","given":"Daniel","family":"Michelson"},"name":"Daniel Michelson","orcid":"0000-0003-3222-9881","github":"DanielMichelson","id":"contributors-myst-generated-uid-3"},{"nameParsed":{"literal":"Daniel Wolfensberger","given":"Daniel","family":"Wolfensberger"},"name":"Daniel Wolfensberger","orcid":"0009-0006-1419-0556","github":"wolfidan","id":"contributors-myst-generated-uid-4"},{"nameParsed":{"literal":"Gionata Ghiggi","given":"Gionata","family":"Ghiggi"},"name":"Gionata Ghiggi","orcid":"0000-0002-0818-0865","github":"ghiggi","id":"contributors-myst-generated-uid-5"},{"nameParsed":{"literal":"Jen DeHart","given":"Jen","family":"DeHart"},"name":"Jen DeHart","orcid":"0000-0001-8536-4927","github":"jcdehart","id":"contributors-myst-generated-uid-6"},{"nameParsed":{"literal":"Jordi Figueras i Ventura","given":"Jordi Figueras","non_dropping_particle":"i","family":"Ventura"},"name":"Jordi Figueras i Ventura","orcid":"0000-0002-4949-422X","github":"jfigui","id":"contributors-myst-generated-uid-7"},{"nameParsed":{"literal":"Julian Giles","given":"Julian","family":"Giles"},"name":"Julian Giles","orcid":"0000-0001-8134-008X","github":"JulianGiles","id":"contributors-myst-generated-uid-8"},{"nameParsed":{"literal":"Kai Mühlbauer","given":"Kai","family":"Mühlbauer"},"name":"Kai Mühlbauer","orcid":"0000-0001-6599-1034","github":"kmuehlbauer","id":"contributors-myst-generated-uid-9"},{"nameParsed":{"literal":"Maxwell Grover","given":"Maxwell","family":"Grover"},"name":"Maxwell Grover","orcid":"0000-0002-0370-8974","github":"mgrover1","id":"contributors-myst-generated-uid-10"},{"nameParsed":{"literal":"Mike Dixon","given":"Mike","family":"Dixon"},"name":"Mike Dixon","orcid":"0000-0002-9597-9113","github":"mike-dixon","id":"contributors-myst-generated-uid-11"},{"nameParsed":{"literal":"Robert Jackson","given":"Robert","family":"Jackson"},"name":"Robert Jackson","orcid":"0000-0003-2518-1234","github":"rcjackson","id":"contributors-myst-generated-uid-12"},{"nameParsed":{"literal":"Scott Collis","given":"Scott","family":"Collis"},"name":"Scott Collis","orcid":"0000-0002-2303-687X","github":"scollis","id":"contributors-myst-generated-uid-13"},{"nameParsed":{"literal":"Ting-Yu Cha","given":"Ting-Yu","family":"Cha"},"name":"Ting-Yu Cha","orcid":"0000-0002-6292-8483","github":"tingyucha","id":"contributors-myst-generated-uid-14"}],"github":"https://github.com/openradar/erad2024","copyright":"2024","references":{"foundations":{"url":"https://projectpythia-mystmd.github.io/pythia-foundations"},"xarray":{"url":"https://docs.xarray.dev/en/stable"},"matplotlib":{"url":"https://matplotlib.org/stable"}},"thebe":{"binder":{"url":"https://binder.projectpythia.org/","provider":"github","repo":"openradar/erad2024","ref":"HEAD"}},"toc":[{"file":"README.md"},{"file":"notebooks/how-to-cite.md"},{"file":"schedule.md"},{"children":[{"file":"getting_started.md"},{"file":"notebooks/data-access/intro-data-access.ipynb"},{"file":"notebooks/environment.ipynb"}],"title":"Getting started"},{"children":[{"file":"presentations/intro-to-open-radar-science.ipynb"},{"file":"notebooks/xradar-pyart/xradar-basics.ipynb"},{"children":[{"file":"notebooks/xradar-pyart/pyart-basics.ipynb"},{"file":"notebooks/wradlib/wradlib_clutter_beamblockage.ipynb"}],"title":"Py-ART and wradlib"},{"file":"notebooks/gpm-api/gpm-api-intro.ipynb"},{"children":[{"pattern":"notebooks/baltrad/baltrad_short_course/*.ipynb"},{"pattern":"notebooks/baltrad/pyart2baltrad/*.ipynb"},{"file":"notebooks/baltrad/baltrad2wradlib/baltrad2wradlib.ipynb"}],"title":"BALTRAD"},{"children":[{"file":"notebooks/lrose/LROSE_Basics.ipynb"},{"file":"notebooks/lrose/testing/stress_testing.ipynb"}],"title":"LROSE"}],"title":"Radar Software Foundations"},{"children":[{"file":"projects.md"},{"children":[{"file":"notebooks/lrose/DD_Tornado_ERAD24.ipynb"},{"file":"notebooks/Retrieving_winds_with_pydda.ipynb"},{"file":"notebooks/lrose/LROSE_ERAD_fractl_samurai.ipynb"}],"title":"LROSE \u0026 PyDDA multi doppler analysis"},{"children":[{"file":"notebooks/Analysis-Ready/ARCO-Datasets.ipynb"},{"file":"notebooks/Analysis-Ready/QPE-QVPs.ipynb"}],"title":"ARCO Radar Datasets"},{"children":[{"file":"notebooks/gpm-api/SR_GR_Calibration_Applied.ipynb"},{"file":"notebooks/gpm-api/SR_GR_Matching_Procedure.ipynb"}],"title":"Spaceborne - Ground Radar Matching and Calibration"},{"file":"notebooks/pyrad/description-pyrad-tutorial.ipynb"}],"title":"Project Workflows"}],"thumbnail":"/erad2024/_preview/111/build/0885e6292c6be2fd643fbc952d479a01.jpeg","exports":[],"bibliography":[],"index":"readme","pages":[{"slug":"how-to-cite","title":"How to Cite","description":"","date":"","thumbnail":"/erad2024/_preview/111/build/77214e045b66b8893a77f4793a31b1ba.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"schedule","title":"Schedule","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"level":1,"title":"Getting started"},{"slug":"getting-started","title":"Notebook Execution","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"intro-data-access","title":"Data Access Instructions","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"environment","title":"Environment overview","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Radar Software Foundations"},{"slug":"intro-to-open-radar-science","title":"An Introduction to Open Radar Science","description":"","date":"","thumbnail":"/erad2024/_preview/111/build/31631960e5ad8808b3289c31e033c7bf.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"xradar-basics","title":"Xradar Basics","description":"","date":"","thumbnail":"/erad2024/_preview/111/build/xradar_logo-6afafa20f95d9ebdba6dd467bd5a8abe.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":2,"title":"Py-ART and wradlib"},{"slug":"pyart-basics","title":"Py-ART Basics with Xradar","description":"","date":"","thumbnail":"/erad2024/_preview/111/build/arm_logo-8eb24d0ca02979674c9b7a2c42be2174.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"wradlib-clutter-beamblockage","title":"wradlib - clutter and beamblockage","description":"","date":"","thumbnail":"/erad2024/_preview/111/build/wradlib_logo.svg-632a8c70c575dd5d977b843285747573.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"gpm-api-intro","title":"Introduction to GPM-API","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":2,"title":"BALTRAD"},{"slug":"baltrad-io","title":"I/O model","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad-qc","title":"Quality Control","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad-drqc","title":"Quality Control using DR","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad-parallel-processing","title":"Parallel processing","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad-compositing","title":"Compositing","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad-pyart-rain-rate-example","title":"Rain Rate retrieval with Py-ART","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"pyart-baltrad-dealias-example","title":"Doppler Velocity Dealiasing with Py-ART","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad2wradlib","title":"Attenuation correction comparison with wradlib","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"LROSE"},{"slug":"lrose-basics","title":"An Introduction to LROSE","description":"","date":"","thumbnail":"/erad2024/_preview/111/build/colette_rose-04fdd4955b27b7afb0698bf821eef6da.jpg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"stress-testing","title":"stress-testing","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"Project Workflows"},{"slug":"projects","title":"Projects Overview","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":2,"title":"LROSE \u0026 PyDDA multi doppler analysis"},{"slug":"dd-tornado-erad24","title":"Introduction to Multidoppler Analysis","description":"","date":"","thumbnail":"/erad2024/_preview/111/build/logo-2a51d2c5875a2157457c94a178e89f75.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"retrieving-winds-with-pydda","title":"PyDDA tutorial","description":"","date":"","thumbnail":"/erad2024/_preview/111/build/5e2d147096249dc3a37da495168a9e9e.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"lrose-erad-fractl-samurai","title":"LROSE Wind Tutorial","description":"","date":"","thumbnail":"/erad2024/_preview/111/build/samurai-e283b264c57ee13ee973d49bc345649c.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"ARCO Radar Datasets"},{"slug":"arco-datasets","title":"Analysis-Ready Cloud-Optimized Datasets","description":"","date":"","thumbnail":"/erad2024/_preview/111/build/ARCO-17657a5969d0d7dd7614cf3e9b93f6a4.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"qpe-qvps","title":"QPE \u0026 QVPs","description":"","date":"","thumbnail":"/erad2024/_preview/111/build/QVP-25b8e6200a6aa9817e77abdcc7e8fabc.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"Spaceborne - Ground Radar Matching and Calibration"},{"slug":"sr-gr-calibration-applied","title":"Spaceborne-Ground Radar Calibration (Application)","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"sr-gr-matching-procedure","title":"Spaceborne-Ground Radar Matching (Methodology)","description":"","date":"","thumbnail":"/erad2024/_preview/111/build/cc72069fb56e0a54f1123fbe9c2fcb76.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"description-pyrad-tutorial","title":"Pyrad QPE Exercise","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"page":{"kind":"Notebook","sha256":"63dbd7297f194bfd57c6af3a2ce6772ff6c99a1e0f24b5dabeb4f7bdb6f50d28","slug":"sr-gr-matching-procedure","location":"/notebooks/gpm-api/SR_GR_Matching_Procedure.ipynb","dependencies":[],"frontmatter":{"title":"Spaceborne-Ground Radar Matching (Methodology)","content_includes_title":false,"kernelspec":{"name":"gpm-api-dev","display_name":"gpm-api-dev","language":"python"},"authors":[{"nameParsed":{"literal":"Alfonso Ladino","given":"Alfonso","family":"Ladino"},"name":"Alfonso Ladino","orcid":"0000-0001-8081-7827","github":"aladinor","id":"contributors-myst-generated-uid-0"},{"nameParsed":{"literal":"Anna del Moral Méndez","given":"Anna","non_dropping_particle":"del","family":"Moral Méndez"},"name":"Anna del Moral Méndez","orcid":"0000-0002-5015-840X","id":"contributors-myst-generated-uid-1"},{"nameParsed":{"literal":"Brenda Javornik","given":"Brenda","family":"Javornik"},"name":"Brenda Javornik","orcid":"0009-0004-9266-9293","github":"leavesntwigs","id":"contributors-myst-generated-uid-2"},{"nameParsed":{"literal":"Daniel Michelson","given":"Daniel","family":"Michelson"},"name":"Daniel Michelson","orcid":"0000-0003-3222-9881","github":"DanielMichelson","id":"contributors-myst-generated-uid-3"},{"nameParsed":{"literal":"Daniel Wolfensberger","given":"Daniel","family":"Wolfensberger"},"name":"Daniel Wolfensberger","orcid":"0009-0006-1419-0556","github":"wolfidan","id":"contributors-myst-generated-uid-4"},{"nameParsed":{"literal":"Gionata Ghiggi","given":"Gionata","family":"Ghiggi"},"name":"Gionata Ghiggi","orcid":"0000-0002-0818-0865","github":"ghiggi","id":"contributors-myst-generated-uid-5"},{"nameParsed":{"literal":"Jen DeHart","given":"Jen","family":"DeHart"},"name":"Jen DeHart","orcid":"0000-0001-8536-4927","github":"jcdehart","id":"contributors-myst-generated-uid-6"},{"nameParsed":{"literal":"Jordi Figueras i Ventura","given":"Jordi Figueras","non_dropping_particle":"i","family":"Ventura"},"name":"Jordi Figueras i Ventura","orcid":"0000-0002-4949-422X","github":"jfigui","id":"contributors-myst-generated-uid-7"},{"nameParsed":{"literal":"Julian Giles","given":"Julian","family":"Giles"},"name":"Julian Giles","orcid":"0000-0001-8134-008X","github":"JulianGiles","id":"contributors-myst-generated-uid-8"},{"nameParsed":{"literal":"Kai Mühlbauer","given":"Kai","family":"Mühlbauer"},"name":"Kai Mühlbauer","orcid":"0000-0001-6599-1034","github":"kmuehlbauer","id":"contributors-myst-generated-uid-9"},{"nameParsed":{"literal":"Maxwell Grover","given":"Maxwell","family":"Grover"},"name":"Maxwell Grover","orcid":"0000-0002-0370-8974","github":"mgrover1","id":"contributors-myst-generated-uid-10"},{"nameParsed":{"literal":"Mike Dixon","given":"Mike","family":"Dixon"},"name":"Mike Dixon","orcid":"0000-0002-9597-9113","github":"mike-dixon","id":"contributors-myst-generated-uid-11"},{"nameParsed":{"literal":"Robert Jackson","given":"Robert","family":"Jackson"},"name":"Robert Jackson","orcid":"0000-0003-2518-1234","github":"rcjackson","id":"contributors-myst-generated-uid-12"},{"nameParsed":{"literal":"Scott Collis","given":"Scott","family":"Collis"},"name":"Scott Collis","orcid":"0000-0002-2303-687X","github":"scollis","id":"contributors-myst-generated-uid-13"},{"nameParsed":{"literal":"Ting-Yu Cha","given":"Ting-Yu","family":"Cha"},"name":"Ting-Yu Cha","orcid":"0000-0002-6292-8483","github":"tingyucha","id":"contributors-myst-generated-uid-14"}],"open_access":true,"license":{"content":{"id":"Apache-2.0","name":"Apache License 2.0","osi":true,"free":true,"url":"https://opensource.org/licenses/Apache-2.0"},"code":{"id":"CC-BY-4.0","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true,"url":"https://creativecommons.org/licenses/by/4.0/"}},"github":"https://github.com/openradar/erad2024","copyright":"2024","abbreviations":{"ARM":"Atmospheric Radiation Measurement","NCAR":"National Center for Atmospheric Research"},"settings":{"output_matplotlib_strings":"remove"},"thumbnail":"/erad2024/_preview/111/build/cc72069fb56e0a54f1123fbe9c2fcb76.png","exports":[{"format":"ipynb","filename":"SR_GR_Matching_Procedure.ipynb","url":"/erad2024/_preview/111/build/SR_GR_Matching_Proce-1f07cb13b15818670444be0c210ec02d.ipynb"}]},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In this tutorial, we demonstrate how to exploit GPM-API along with other radar software such\n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OLUFDrJsWb"},{"type":"link","url":"https://docs.openradarscience.org/projects/xradar/en/stable/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"xradar","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XclhvjXDKG"}],"urlSource":"https://docs.openradarscience.org/projects/xradar/en/stable/","key":"eFUHO1S2HK"},{"type":"text","value":" and\n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tz549Ujok2"},{"type":"link","url":"https://docs.wradlib.org/en/latest/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"wradlib","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eA6TaOVRdH"}],"urlSource":"https://docs.wradlib.org/en/latest/","key":"Tnl0Jyfq6c"},{"type":"text","value":" to match reflectivities measurements of spaceborne (SR) and ground (GR) radars.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IBDvf9F3Tc"}],"key":"TB2YLMYdQp"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"We guide you step-by-step through the process of obtaining spatially and temporally coincident radar samples.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"dNaiP7pJkC"}],"key":"Jp18L7mNUr"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The procedure, based on ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"IK3EsKQCuK"},{"type":"cite","url":"https://doi.org/10.1175/2010JTECHA1403.1","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Schwaller and Morris (2011)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"laaJdX2cch"}],"kind":"narrative","label":"Schwaller_2011","identifier":"https://doi.org/10.1175/2010JTECHA1403.1","enumerator":"1","key":"RZ1xA34R8s"},{"type":"text","value":" and adapted by ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"UyKE7gmwbU"},{"type":"cite","url":"https://doi.org/10.1175/JTECH-D-17-0128.1","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Warren, et. al. (2018)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"GjMQMFoYGD"}],"kind":"narrative","label":"Warren_2018","identifier":"https://doi.org/10.1175/JTECH-D-17-0128.1","enumerator":"2","key":"LXUokMZDHl"},{"type":"text","value":", involves:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ZaCOhTbRgg"}],"key":"AzW0kCIXX5"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"averaging SR reflectivities vertically along the SR beam between the half-power points of the GR sweep.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"lc9sZCqs7d"}],"key":"SuN9XEMPlM"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"averaging GR reflectivities horizontally within the SR beam’s footprint.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"RhM6LUlrTS"}],"key":"ZwKaEDXSMx"}],"key":"iMhrjpNCH5"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"The basic principle is illustrated in Fig. 2 of the original paper of Schwaller and Morris (2011).","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"OySaCUCdQp"}],"key":"MZzYbhAy7j"},{"type":"image","url":"/erad2024/_preview/111/build/cc72069fb56e0a54f1123fbe9c2fcb76.png","alt":"figure 2","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"a1btfpGy7c","urlSource":"https://raw.githubusercontent.com/ghiggi/gpm_api/main/docs/source/static/fig2_schwaller_morris_2011.png"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Warren et al. (2018) describe the method as follows:\n","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"H660GxBSH8"},{"type":"emphasis","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"“[...] intersections between individual SR beams and GR elevation sweeps are identified and the reflectivity values from both  instruments are averaged within a spatial neighborhood around the intersection.\nSpecifically, SR data are averaged in range over the width of the GR beam at the GR range of the intersection, while GR data are averaged in the range–azimuth plane within the footprint of the SR beam.\nThe result is a pair of reflectivity measurements corresponding to approximately the same volume of atmosphere. [...]”.","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"frMmuerJK6"}],"key":"KW6TAyAGBW"}],"key":"SXVkGaZaTF"},{"type":"paragraph","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"The procedure should become clearer in Fig. 3:","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"RogIa6oM8V"}],"key":"cfg3TbZxcA"},{"type":"image","url":"/erad2024/_preview/111/build/93c53af642c2e2adf0ec8670f4a9a2f4.png","alt":"figure 3","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"qugXDdSX58","urlSource":"https://raw.githubusercontent.com/ghiggi/gpm_api/main/docs/source/static/fig3_schwaller_morris_2011.png"}],"key":"t74xpl9iYY"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Relevant software","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LP7KloplRk"}],"identifier":"relevant-software","label":"Relevant software","html_id":"relevant-software","implicit":true,"key":"jKq9dLyxk2"}],"key":"G5kPIhNzBJ"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"To run this tutorial, it is necessary to install additional libraries which are not automatically required by GPM-API.\nThe libraries are\n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qKu2pwyQjv"},{"type":"link","url":"https://docs.openradarscience.org/projects/xradar/en/stable/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"xradar","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QDKGV79IMH"}],"urlSource":"https://docs.openradarscience.org/projects/xradar/en/stable/","key":"MekS9zQ3c9"},{"type":"text","value":",\n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jywr55D0NN"},{"type":"link","url":"https://docs.wradlib.org/en/latest/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"wradlib","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"s1AkZKKEki"}],"urlSource":"https://docs.wradlib.org/en/latest/","key":"ZYAzDQtblN"},{"type":"text","value":",\n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ijXy7ekpMY"},{"type":"link","url":"https://geopandas.org/en/stable/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"geopandas","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mVzjyMJjEo"}],"urlSource":"https://geopandas.org/en/stable/","key":"GrX5dEoGDr"},{"type":"text","value":",\n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"heYEU0BCnA"},{"type":"link","url":"https://filesystem-spec.readthedocs.io/en/latest/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"fsspec","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eB2Pj8v7J1"}],"urlSource":"https://filesystem-spec.readthedocs.io/en/latest/","key":"eDz1Joh0vu"},{"type":"text","value":",\n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"imclXMcnMq"},{"type":"link","url":"https://s3fs.readthedocs.io/en/latest/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"s3fs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Jut96XgW4A"}],"urlSource":"https://s3fs.readthedocs.io/en/latest/","key":"PlmaFzXlHF"},{"type":"text","value":" and\n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"j0SVx5wLGv"},{"type":"link","url":"https://python-visualization.github.io/folium/latest/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"folium","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"e0ohirjo9s"}],"urlSource":"https://python-visualization.github.io/folium/latest/","key":"NrzI4LfiZD"},{"type":"text","value":".\nYou can install them with terminal command ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hZy3NgvnqX"},{"type":"inlineCode","value":"conda install -c conda-forge xradar wradlib geopandas fsspec s3fs folium","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"M1j4kuSSZe"}],"key":"lK3F5TmT5q"}],"key":"ivQKItHurg"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"If you have such libraries installed, you can start importing the required packages:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qhfHm54Djm"}],"key":"AWS3uDmtgd"}],"key":"GBZBmLWMVu"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:08.126867Z","iopub.status.busy":"2024-09-08T06:22:08.126505Z","iopub.status.idle":"2024-09-08T06:22:09.950648Z","shell.execute_reply":"2024-09-08T06:22:09.950065Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"import warnings\n\nwarnings.filterwarnings(\"ignore\")\nimport datetime\nfrom functools import reduce\n\nimport cartopy.crs as ccrs\nimport fsspec\nimport geopandas as gpd\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport pandas as pd\nimport wradlib as wrl\nimport xarray as xr\nimport xradar as xd\nfrom IPython.display import display\nfrom shapely import Point\nfrom xarray.backends.api import open_datatree\nimport gpm\nfrom gpm.gv.routines import (\n    convert_s_to_ku_band,\n    retrieve_gates_projection_coordinates,\n    xyz_to_antenna_coordinates,\n)\nfrom gpm.utils.remapping import reproject_coords\nfrom gpm.utils.zonal_stats import PolyAggregator\n\nnp.set_printoptions(suppress=True)","key":"uVLlRKPMiW"},{"type":"output","id":"N47-eaHjsV_qmgh6sNO2a","data":[],"key":"CERIc4Jod0"}],"key":"dUu1zCS3H4"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Load SR and GR data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OZUQwl9Zug"}],"identifier":"load-sr-and-gr-data","label":"Load SR and GR data","html_id":"load-sr-and-gr-data","implicit":true,"key":"qYsd4HuHM8"}],"key":"tT0q7JIKH9"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In this tutorial, we exploit a coincident GPM DPR and NEXRAD overpass over San Diego, USA, during the landfall of Tropical Storm Hilary in 2023, to illustrate step-by-step the SR/GR volume matching procedure.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eqO52ng4qo"}],"key":"dAeR1pMmUE"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"To facilitate your hands-on experience, we’ve preprocessed the native NEXRAD radar data using the xradar package and the coincident GPM DPR overpass using GPM-API. The resulting data has been uploaded in Zarr format to the Pythia Cloud Bucket, allowing you to start the tutorial directly in the Binder environment.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"g0647kUdya"}],"key":"eDVX3jHPO9"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"If you wish to adapt this tutorial to your own case study, you can use the xradar package to read your GR radar data into the expected xarray format. Similarly, you can retrieve the relevant GPM data using GPM-API. The GPM-API ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"YmduOYz0PX"},{"type":"link","url":"https://gpm-api.readthedocs.io/en/latest/tutorials/tutorial_03_SR_GR_Matching.html","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Spaceborne-Ground Radar Matching Tutorial","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"h7ZkTx62T1"}],"urlSource":"https://gpm-api.readthedocs.io/en/latest/tutorials/tutorial_03_SR_GR_Matching.html","key":"tb8HW4gAGW"},{"type":"text","value":" shows how to read NEXRAD GR data directly from the AWS S3 bucket and how to download the GPM data of interest using GPM-API.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Chu9AHaMl3"}],"key":"OaR63ZniF5"}],"key":"Qs6exBq5ry"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"To start this tutorial let’s open the NEXRAD ground radar data and the GPM granule with the coincident overpass.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yuzyU3IYLp"}],"key":"Yj4QsNPGf2"}],"key":"eX8vPDUwEM"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:09.953577Z","iopub.status.busy":"2024-09-08T06:22:09.953213Z","iopub.status.idle":"2024-09-08T06:22:10.097873Z","shell.execute_reply":"2024-09-08T06:22:10.097286Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Open fsspec connection to the bucket\nbucket_url = \"https://js2.jetstream-cloud.org:8001\"\nfs = fsspec.filesystem(\"s3\", anon=True, client_kwargs=dict(endpoint_url=bucket_url))","key":"n8IudqW0Gx"},{"type":"output","id":"Zg_rTOTbfdOtRxO9ydOEK","data":[],"key":"GGYQxYEb1U"}],"key":"TKH4aJeED4"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:10.100355Z","iopub.status.busy":"2024-09-08T06:22:10.099969Z","iopub.status.idle":"2024-09-08T06:22:12.819546Z","shell.execute_reply":"2024-09-08T06:22:12.818930Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Open the GR datatree\nfile = fs.get_mapper(f\"pythia/radar/erad2024/gpm_api/KNKX20230820_221341_V06.zarr\")\ndt_gr = open_datatree(file, engine=\"zarr\", consolidated=True, chunks={})\ndisplay(dt_gr)","key":"yuADnCuBXe"},{"type":"output","id":"bMmIpjmwRI4pDtLFZmwuh","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"20a7e40e8f658087082d977d46c0ccc3","path":"/erad2024/_preview/111/build/20a7e40e8f658087082d977d46c0ccc3.html"},"text/plain":{"content_type":"text/plain","hash":"a4ed0eb4ad3ad105da250c49d6296045","path":"/erad2024/_preview/111/build/a4ed0eb4ad3ad105da250c49d6296045.txt"}}}],"key":"OpH5DCLNv8"}],"key":"KZTRyLEz9H"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:12.829143Z","iopub.status.busy":"2024-09-08T06:22:12.828604Z","iopub.status.idle":"2024-09-08T06:22:12.983896Z","shell.execute_reply":"2024-09-08T06:22:12.983293Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Open the SR dataset\nfile = fs.get_mapper(\n    f\"pythia/radar/erad2024/gpm_api/2A.GPM.DPR.V9-20211125.20230820-S213941-E231213.053847.V07B.zarr\"\n)\nds_sr = xr.open_zarr(file, consolidated=True, chunks={})","key":"V6X9yfrtm0"},{"type":"output","id":"AV6Llhp_vMkB6VZkRg5TU","data":[],"key":"avLz4bjgLE"}],"key":"pEqJQgl9P9"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"During this tutorial we will use only the GPM DPR Ku band reflectivities, therefore we subset the dataset here to facilitate the analysis.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"e7RfTRgdAy"}],"key":"s7z29NeNPk"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Please note that the GPM DPR reflectivites measurements are provided by the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"E8DciCCYZa"},{"type":"inlineCode","value":"ZFactorFinal","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"h5JxoE5cao"},{"type":"text","value":"and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Yef5AanPpr"},{"type":"inlineCode","value":"ZFactorMeasured","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kVjoFLNik0"},{"type":"text","value":" variables:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fPJ8PPdbky"}],"key":"vJWJ2yMDiV"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"nm9NyTrKVU"},{"type":"inlineCode","value":"ZFactorMeasured","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"fPdJ4TgrmL"},{"type":"text","value":" variable contains the reflectivity measurements with sidelobe clutter removed. However, it still includes ground clutter, background noise, and is not corrected for atmospheric and hydrometeors attenuation.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Tg6y2KSIvO"}],"key":"acjDBscoE2"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"tb0MW3IsCp"},{"type":"inlineCode","value":"ZFactorFinal","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Jx5cO9cKFC"},{"type":"text","value":" represents the reflectivity measurements with background noise, ground clutter, and sidelobe clutter removed. The reflectivites have been corrected atmospheric and hydrometeors attenuation.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Oei0NIkLxz"}],"key":"ZUpdkYWnZy"}],"key":"q8gF7ov8MU"}],"key":"ATj67SgkP5"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:12.986584Z","iopub.status.busy":"2024-09-08T06:22:12.986067Z","iopub.status.idle":"2024-09-08T06:22:12.999210Z","shell.execute_reply":"2024-09-08T06:22:12.998645Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"ds_sr = ds_sr.sel({\"radar_frequency\": \"Ku\"})","key":"lR43QjclWL"},{"type":"output","id":"HbASnUghP1fT0izp-m7S2","data":[],"key":"e8fQXaUEHh"}],"key":"sYnYzo2fMx"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:13.001516Z","iopub.status.busy":"2024-09-08T06:22:13.001121Z","iopub.status.idle":"2024-09-08T06:22:13.317289Z","shell.execute_reply":"2024-09-08T06:22:13.316683Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"display(ds_sr)","key":"xUFNgaIqnB"},{"type":"output","id":"jeC2Xo3B_fximypRcKypR","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"5211ddea807ad5b9556a3df33010c030","path":"/erad2024/_preview/111/build/5211ddea807ad5b9556a3df33010c030.html"},"text/plain":{"content":"\u003cxarray.Dataset\u003e Size: 5GB\nDimensions:                        (cross_track: 49, along_track: 7932,\n                                    range: 176, DSD_params: 2, four: 4,\n                                    method: 6, three: 3, nfreqHI: 3, nNode: 5,\n                                    nNUBF: 3, nNP: 4, foreBack: 2, nearFar: 2,\n                                    XYZ: 3, nbinSZP: 7, nsdew: 3)\nCoordinates: (12/16)\n  * DSD_params                     (DSD_params) \u003cU2 16B 'Nw' 'Dm'\n    SCorientation                  (along_track) float32 32kB dask.array\u003cchunksize=(7932,), meta=np.ndarray\u003e\n    crsWGS84                       int64 8B ...\n    dataQuality                    (along_track) float32 32kB dask.array\u003cchunksize=(7932,), meta=np.ndarray\u003e\n    gpm_along_track_id             (along_track) int64 63kB dask.array\u003cchunksize=(7932,), meta=np.ndarray\u003e\n    gpm_cross_track_id             (cross_track) int64 392B dask.array\u003cchunksize=(49,), meta=np.ndarray\u003e\n    ...                             ...\n    lat                            (cross_track, along_track) float32 2MB dask.array\u003cchunksize=(49, 7932), meta=np.ndarray\u003e\n    lon                            (cross_track, along_track) float32 2MB dask.array\u003cchunksize=(49, 7932), meta=np.ndarray\u003e\n    radar_frequency                \u003cU2 8B 'Ku'\n  * range                          (range) int64 1kB 1 2 3 4 ... 173 174 175 176\n    sunLocalTime                   (cross_track, along_track) float32 2MB dask.array\u003cchunksize=(25, 3966), meta=np.ndarray\u003e\n    time                           (along_track) datetime64[ns] 63kB dask.array\u003cchunksize=(7932,), meta=np.ndarray\u003e\nDimensions without coordinates: cross_track, along_track, four, method, three,\n                                nfreqHI, nNode, nNUBF, nNP, foreBack, nearFar,\n                                XYZ, nbinSZP, nsdew\nData variables: (12/142)\n    DFRforward1                    (cross_track, along_track, range) float32 274MB dask.array\u003cchunksize=(49, 500, 176), meta=np.ndarray\u003e\n    Dm                             (cross_track, along_track, range) float32 274MB dask.array\u003cchunksize=(49, 500, 176), meta=np.ndarray\u003e\n    FractionalGranuleNumber        (along_track) float64 63kB dask.array\u003cchunksize=(500,), meta=np.ndarray\u003e\n    MSindex                        (cross_track, along_track) float64 3MB dask.array\u003cchunksize=(49, 500), meta=np.ndarray\u003e\n    MSindexKa                      (cross_track, along_track) float64 3MB dask.array\u003cchunksize=(49, 500), meta=np.ndarray\u003e\n    MSindexKu                      (cross_track, along_track) float64 3MB dask.array\u003cchunksize=(49, 500), meta=np.ndarray\u003e\n    ...                             ...\n    widthBB                        (cross_track, along_track) float32 2MB dask.array\u003cchunksize=(25, 3966), meta=np.ndarray\u003e\n    zFactorFinal                   (cross_track, along_track, range) float32 274MB dask.array\u003cchunksize=(49, 500, 176), meta=np.ndarray\u003e\n    zFactorFinalESurface           (cross_track, along_track) float32 2MB dask.array\u003cchunksize=(49, 500), meta=np.ndarray\u003e\n    zFactorFinalNearSurface        (cross_track, along_track) float32 2MB dask.array\u003cchunksize=(49, 500), meta=np.ndarray\u003e\n    zFactorMeasured                (cross_track, along_track, range) float32 274MB dask.array\u003cchunksize=(49, 500, 176), meta=np.ndarray\u003e\n    zeta                           (cross_track, along_track) float32 2MB dask.array\u003cchunksize=(49, 500), meta=np.ndarray\u003e\nAttributes: (12/23)\n    AlgorithmID:           2ADPR\n    AlgorithmVersion:      9.20211125\n    AttitudeFileName:      \n    DOI:                   10.5067/GPM/DPR/GPM/2A/07\n    DOIauthority:          http://dx.doi.org/\n    DataFormatVersion:     7h\n    ...                    ...\n    ProductVersion:        V07B\n    SatelliteName:         GPM\n    ScanMode:              FS\n    TotalQualityCode:      Good\n    gpm_api_product:       2A-DPR\n    history:               Created by ghiggi/gpm_api software on 2024-08-22 1...","content_type":"text/plain"}}}],"key":"R9P38RduUu"}],"key":"RMOdVKHyLb"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define settings for SR/GR matching","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bZEjvQBPIu"}],"identifier":"define-settings-for-sr-gr-matching","label":"Define settings for SR/GR matching","html_id":"define-settings-for-sr-gr-matching","implicit":true,"key":"jgcdwtHzyv"}],"key":"tnVzEkIwmD"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here, we define key parameters and settings necessary for the SR/GR comparison. Minimum reflectivity thresholds are applied to exclude certain radar gates from the analysis, primarily to distinguish precipitating regions.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wcvcjVw06g"}],"key":"mNmDNgU24m"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We strongly recommend specifying an “optimistic” minimum reflectivity sensitivity threshold, as reflectivities may be biased, and this approach allows for the assessment of non-uniform beam filling (NUBF) during the SR/GR matching process.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XR7aDCkqKz"}],"key":"Thb8ihGkDF"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"More restrictive filtering can be applied after the SR/GR gate matching is completed.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"TuvVqnZzKc"}],"key":"qpsAouPt6N"}],"key":"KT0jviNDBM"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:13.324402Z","iopub.status.busy":"2024-09-08T06:22:13.323929Z","iopub.status.idle":"2024-09-08T06:22:13.329522Z","shell.execute_reply":"2024-09-08T06:22:13.328996Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Define half power beam width angle (in degrees)\nazimuth_beamwidth_gr = 1.0\nelevation_beamwidth_gr = 1.0\n\n# Define Z min threshold\nz_min_threshold_gr = 0  # to remove dry case\nz_min_threshold_sr = 10\n\n# GR matching ROI\nmin_gr_range_lb = 0\nmax_gr_range_ub = 150_000\n\n# Define SR CRS\ncrs_sr = ds_sr.gpm.pyproj_crs","key":"wlvHIDddDY"},{"type":"output","id":"EMCORvayv4sfQPRVvmh23","data":[],"key":"gp55gdFSsk"}],"key":"eTNWOblPL6"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Preprocess GR data with xradar","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"C0EAP2kUGg"}],"identifier":"preprocess-gr-data-with-xradar","label":"Preprocess GR data with xradar","html_id":"preprocess-gr-data-with-xradar","implicit":true,"key":"lTv2fZ4dtS"}],"key":"XUt5C1NBAP"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we select the GR sweep, we georeference the dataset, we set the GR CRS and we extract GR radar gates coordinates.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"suW52H4QIp"}],"key":"i8oYOMEiwp"}],"key":"pHeVrfVRFZ"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:13.331956Z","iopub.status.busy":"2024-09-08T06:22:13.331476Z","iopub.status.idle":"2024-09-08T06:22:13.334409Z","shell.execute_reply":"2024-09-08T06:22:13.333873Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"sweep_idx = 0\nsweep_group = f\"sweep_{sweep_idx}\"  # GR sweep (elevation to be used)","key":"SqwfTvRtu6"},{"type":"output","id":"0HTnAiYXlMNl0kiK5eJsQ","data":[],"key":"frNTH6CSWc"}],"key":"ZnrIrc3doe"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:13.336127Z","iopub.status.busy":"2024-09-08T06:22:13.335965Z","iopub.status.idle":"2024-09-08T06:22:13.677726Z","shell.execute_reply":"2024-09-08T06:22:13.677118Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Select sweep dataset\nds_gr = dt_gr[sweep_group].to_dataset().compute()\n\nprint(\"Sweep Mode:\", ds_gr[\"sweep_mode\"].to_numpy())\nprint(\"Sweep Elevation Angle:\", ds_gr[\"sweep_fixed_angle\"].to_numpy())\n\n# Set auxiliary info as coordinates\n# - To avoid broadcasting i.e. when masking\npossible_coords = [\"sweep_mode\", \"sweep_number\", \"prt_mode\", \"follow_mode\", \"sweep_fixed_angle\"]\nextra_coords = [coord for coord in possible_coords if coord in ds_gr]\nds_gr = ds_gr.set_coords(extra_coords)","key":"wfHdrbx7xR"},{"type":"output","id":"C7GHhgCCGmzHnTdFux9yU","data":[{"name":"stdout","output_type":"stream","text":"Sweep Mode: azimuth_surveillance\nSweep Elevation Angle: 0.4833984375\n"}],"key":"v6r8YmswpS"}],"key":"NhhJ5dd5Zw"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:13.679755Z","iopub.status.busy":"2024-09-08T06:22:13.679586Z","iopub.status.idle":"2024-09-08T06:22:13.726006Z","shell.execute_reply":"2024-09-08T06:22:13.725436Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Georeference the data on a azimuthal_equidistant projection centered on the radar\nds_gr = ds_gr.xradar.georeference()\nds_gr[\"crs_wkt\"].attrs","key":"kBs0jvx9Ui"},{"type":"output","id":"_c6Om2s4KbDorQodHCwWT","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"text/plain":{"content":"{'crs_wkt': 'PROJCRS[\"unknown\",BASEGEOGCRS[\"unknown\",DATUM[\"World Geodetic System 1984\",ELLIPSOID[\"WGS 84\",6378137,298.257223563,LENGTHUNIT[\"metre\",1]],ID[\"EPSG\",6326]],PRIMEM[\"Greenwich\",0,ANGLEUNIT[\"degree\",0.0174532925199433],ID[\"EPSG\",8901]]],CONVERSION[\"unknown\",METHOD[\"Azimuthal Equidistant\",ID[\"EPSG\",1125]],PARAMETER[\"Latitude of natural origin\",32.919017791748,ANGLEUNIT[\"degree\",0.0174532925199433],ID[\"EPSG\",8801]],PARAMETER[\"Longitude of natural origin\",-117.041801452637,ANGLEUNIT[\"degree\",0.0174532925199433],ID[\"EPSG\",8802]],PARAMETER[\"False easting\",0,LENGTHUNIT[\"metre\",1],ID[\"EPSG\",8806]],PARAMETER[\"False northing\",0,LENGTHUNIT[\"metre\",1],ID[\"EPSG\",8807]]],CS[Cartesian,2],AXIS[\"(E)\",east,ORDER[1],LENGTHUNIT[\"metre\",1,ID[\"EPSG\",9001]]],AXIS[\"(N)\",north,ORDER[2],LENGTHUNIT[\"metre\",1,ID[\"EPSG\",9001]]]]',\n 'semi_major_axis': 6378137.0,\n 'semi_minor_axis': 6356752.314245179,\n 'inverse_flattening': 298.257223563,\n 'reference_ellipsoid_name': 'WGS 84',\n 'longitude_of_prime_meridian': 0.0,\n 'prime_meridian_name': 'Greenwich',\n 'geographic_crs_name': 'unknown',\n 'horizontal_datum_name': 'World Geodetic System 1984',\n 'projected_crs_name': 'unknown',\n 'grid_mapping_name': 'azimuthal_equidistant',\n 'latitude_of_projection_origin': 32.91901779174805,\n 'longitude_of_projection_origin': -117.04180145263672,\n 'false_easting': 0.0,\n 'false_northing': 0.0}","content_type":"text/plain"}}}],"key":"hPgGROaZdJ"}],"key":"RK7If8IYPU"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:13.728470Z","iopub.status.busy":"2024-09-08T06:22:13.728284Z","iopub.status.idle":"2024-09-08T06:22:13.753181Z","shell.execute_reply":"2024-09-08T06:22:13.752629Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Get the GR CRS\ncrs_gr = ds_gr.xradar_dev.pyproj_crs","key":"mUQMkUMQCR"},{"type":"output","id":"fdbOTRmYK5gzby7C27CfV","data":[],"key":"BT2oHTAPH7"}],"key":"NSrVXTmBck"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:13.755697Z","iopub.status.busy":"2024-09-08T06:22:13.755203Z","iopub.status.idle":"2024-09-08T06:22:14.427634Z","shell.execute_reply":"2024-09-08T06:22:14.427054Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Add lon/lat coordinates to GR\n# - Useful for plotting ;)\nlon_gr, lat_gr, height_gr = reproject_coords(x=ds_gr[\"x\"], y=ds_gr[\"y\"], z=ds_gr[\"z\"], src_crs=crs_gr, dst_crs=crs_sr)\nds_gr[\"lon\"] = lon_gr\nds_gr[\"lat\"] = lat_gr\nds_gr = ds_gr.set_coords([\"lon\", \"lat\"])","key":"GRpUTqfzhV"},{"type":"output","id":"kGdqPyPx8Kr4EnSrwYIIm","data":[],"key":"FMJUdjWJdu"}],"key":"cZRg5gV3hF"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:14.429803Z","iopub.status.busy":"2024-09-08T06:22:14.429632Z","iopub.status.idle":"2024-09-08T06:22:14.450026Z","shell.execute_reply":"2024-09-08T06:22:14.449432Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Set GR gates with Z \u003c 0 to NaN\n# - Following Morris and Schwaller 2011 recommendation\nds_gr = ds_gr.where(ds_gr[\"DBZH\"] \u003e= 0)","key":"jl5fwQaeDO"},{"type":"output","id":"mCx713-DUmV_orcdAS5CF","data":[],"key":"oWUdWzEMAw"}],"key":"LOwpD4LEW9"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:14.452738Z","iopub.status.busy":"2024-09-08T06:22:14.452551Z","iopub.status.idle":"2024-09-08T06:22:23.446835Z","shell.execute_reply":"2024-09-08T06:22:23.446231Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Show some GR fields\nds_gr[\"DBZH\"].xradar_dev.plot_map()\nds_gr[\"RHOHV\"].xradar_dev.plot_map()","key":"TjMC7dFOzN"},{"type":"output","id":"gg5LR1y5RdXIOXleKxcA-","data":[{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"text/plain":{"content":"\u003ccartopy.mpl.geocollection.GeoQuadMesh at 0x7f2f4c33d850\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f6a366e8db38782e0b8ab41855aec2f9","path":"/erad2024/_preview/111/build/f6a366e8db38782e0b8ab41855aec2f9.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"8e9cab792ad1638eb3623f948e2ba5d7","path":"/erad2024/_preview/111/build/8e9cab792ad1638eb3623f948e2ba5d7.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"Kehj83rZ6W"}],"key":"Z3ByJWiK8C"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:23.449150Z","iopub.status.busy":"2024-09-08T06:22:23.448749Z","iopub.status.idle":"2024-09-08T06:22:23.456933Z","shell.execute_reply":"2024-09-08T06:22:23.456518Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Retrieve GR extent\nextent_gr = ds_gr.xradar_dev.extent(max_distance=None, crs=None)\nextent_gr","key":"VPyTM4vQDV"},{"type":"output","id":"CLH6ErRjrnym8jJzCZ8Sp","data":[{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"text/plain":{"content":"[-121.95467110437517,\n -112.12893180089884,\n 28.771031109975677,\n 37.06425438465268]","content_type":"text/plain"}}}],"key":"IAxCR4kFnq"}],"key":"CXXunN4Vtf"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Preprocess SR data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"obYXVk1ceT"}],"identifier":"preprocess-sr-data","label":"Preprocess SR data","html_id":"preprocess-sr-data","implicit":true,"key":"Z0qkfLUB6N"}],"key":"bBohm0HOtL"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s start by cropping the SR granule on the GR extent and put data into memory:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HrT1DwInip"}],"key":"wtMaZZLuOQ"}],"key":"FIvAUACNqw"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:23.458912Z","iopub.status.busy":"2024-09-08T06:22:23.458575Z","iopub.status.idle":"2024-09-08T06:22:24.424578Z","shell.execute_reply":"2024-09-08T06:22:24.423998Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"ds_sr = ds_sr.gpm.crop(extent_gr).compute()","key":"gPZ5f2xJz7"},{"type":"output","id":"ieHOCq4QUb_qr5snAjNng","data":[],"key":"lBvJOUCiFQ"}],"key":"u4Iv14TiGX"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can further subset the GPM overpass selecting the scans occured between the following timesteps:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VtVsHCvGfZ"}],"key":"bMRpfhIMhZ"}],"key":"VKq830UmFN"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:24.427099Z","iopub.status.busy":"2024-09-08T06:22:24.426929Z","iopub.status.idle":"2024-09-08T06:22:24.450764Z","shell.execute_reply":"2024-09-08T06:22:24.450124Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"start_time = datetime.datetime.strptime(\"2023-08-20 22:12:00\", \"%Y-%m-%d %H:%M:%S\")\nend_time = datetime.datetime.strptime(\"2023-08-20 22:13:45\", \"%Y-%m-%d %H:%M:%S\")\nds_sr = ds_sr.gpm.sel(time=slice(start_time, end_time))","key":"zWEb3n3x0z"},{"type":"output","id":"pSb3DMWK5wFpQvcOX4NM6","data":[],"key":"sJoNDQnQ1C"}],"key":"xrJ7DllGOT"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now let’s display some variables illustrating the GPM overpass","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eF9Un81n8S"}],"key":"STZ7UJw84Y"}],"key":"OaPq9Jlr07"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:24.452986Z","iopub.status.busy":"2024-09-08T06:22:24.452816Z","iopub.status.idle":"2024-09-08T06:22:26.138859Z","shell.execute_reply":"2024-09-08T06:22:26.138295Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"ds_sr[\"precipRateNearSurface\"].gpm.plot_map()\nds_sr[\"zFactorMeasured\"].gpm.slice_range_at_bin(ds_sr[\"binClutterFreeBottom\"]).gpm.plot_map(\n    vmax=40,\n)  # zFactorMeasuredNearSurface\nds_sr[\"zFactorFinalNearSurface\"].gpm.plot_map(vmax=40)\nds_sr[\"flagPrecip\"].gpm.plot_map()","key":"YF21veCNl4"},{"type":"output","id":"l056Bn0auyhDD5CkAfeY9","data":[{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"text/plain":{"content":"\u003ccartopy.mpl.geocollection.GeoQuadMesh at 0x7f2f2be77950\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7ed85a8083cdb44e053a26d9b8ae27fa","path":"/erad2024/_preview/111/build/7ed85a8083cdb44e053a26d9b8ae27fa.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ee7c417f3e6316dc4a6b87bbc558a326","path":"/erad2024/_preview/111/build/ee7c417f3e6316dc4a6b87bbc558a326.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6413220e5698f8357fd077c32fd12285","path":"/erad2024/_preview/111/build/6413220e5698f8357fd077c32fd12285.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d3e34621f0f5b74bb1eabc917866490a","path":"/erad2024/_preview/111/build/d3e34621f0f5b74bb1eabc917866490a.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"GAyzDDST3R"}],"key":"xIff2r6XkN"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In the following map and cross-sections, we can see that the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"o85I4awWFx"},{"type":"inlineCode","value":"zFactorMeasured","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zAXIr03sRU"},{"type":"text","value":" variable is contaminated by ground clutter:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"F3yoUsTKPi"}],"key":"b4esZOvvBt"}],"key":"TjXBuwf8EQ"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:26.143322Z","iopub.status.busy":"2024-09-08T06:22:26.143117Z","iopub.status.idle":"2024-09-08T06:22:26.938390Z","shell.execute_reply":"2024-09-08T06:22:26.937875Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Display the maximum observed reflectivity\nds_sr[\"zFactorMeasured\"].max(dim=\"range\").gpm.plot_map()\nds_sr[\"zFactorFinal\"].max(dim=\"range\").gpm.plot_map(vmax=40)","key":"JLmxlYu0Gt"},{"type":"output","id":"9lRoA208zDE8PzUm890Bo","data":[{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"text/plain":{"content":"\u003ccartopy.mpl.geocollection.GeoQuadMesh at 0x7f2f4418ee50\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b9d4e0f81cf20abda9c06ad51a0dc867","path":"/erad2024/_preview/111/build/b9d4e0f81cf20abda9c06ad51a0dc867.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"911bb6696dcef801a60647d01e9033bd","path":"/erad2024/_preview/111/build/911bb6696dcef801a60647d01e9033bd.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"w6YE3goyjs"}],"key":"IaBjEasHe4"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:26.940774Z","iopub.status.busy":"2024-09-08T06:22:26.940431Z","iopub.status.idle":"2024-09-08T06:22:26.946412Z","shell.execute_reply":"2024-09-08T06:22:26.946025Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Compute SR attenuation correction\nds_sr[\"zFactorCorrection\"] = ds_sr[\"zFactorFinal\"] - ds_sr[\"zFactorMeasured\"]","key":"if7vVCZLpI"},{"type":"output","id":"lOR0VLB-LBRz9HYnNORv4","data":[],"key":"h2FQM099GQ"}],"key":"bzrIC2i5OI"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:26.948275Z","iopub.status.busy":"2024-09-08T06:22:26.947959Z","iopub.status.idle":"2024-09-08T06:22:27.781408Z","shell.execute_reply":"2024-09-08T06:22:27.780781Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Display cross-section\nds_sr[\"zFactorMeasured\"].isel(cross_track=24).gpm.plot_cross_section(zoom=False)\nds_sr[\"zFactorFinal\"].isel(cross_track=24).gpm.plot_cross_section(zoom=False)\nds_sr[\"zFactorCorrection\"].isel(cross_track=24).gpm.plot_cross_section(vmin=0, vmax=3, cmap=\"Spectral_r\", zoom=False)","key":"BQfrpi2ztZ"},{"type":"output","id":"RWG-MhuLjGiEhEbbcovwz","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a8c0b5c8438002949c47e4c866761dee","path":"/erad2024/_preview/111/build/a8c0b5c8438002949c47e4c866761dee.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"14b7bc7e01f058a6814c28982a10def2","path":"/erad2024/_preview/111/build/14b7bc7e01f058a6814c28982a10def2.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d9d35dcee96373af08b99126776f4eb6","path":"/erad2024/_preview/111/build/d9d35dcee96373af08b99126776f4eb6.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"dxJIiiqnNE"}],"key":"hQc0nzj3AL"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"So now we mask out gates impacted by ground clutter, adn we verify with maps and cross-sections that the ground clutter is effectively removed:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"l2N7tRCGjz"}],"key":"nt3eck13zi"}],"key":"z2K03n7FmB"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:27.784182Z","iopub.status.busy":"2024-09-08T06:22:27.783695Z","iopub.status.idle":"2024-09-08T06:22:27.825364Z","shell.execute_reply":"2024-09-08T06:22:27.824662Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Mask SR gates with ground clutter\nds_sr[\"zFactorMeasured\"] = ds_sr[\"zFactorMeasured\"].gpm.mask_below_bin(\n    bins=ds_sr[\"binClutterFreeBottom\"],\n    strict=False,\n)  # do not mask the specified bin\nds_sr[\"zFactorCorrection\"] = ds_sr[\"zFactorCorrection\"].gpm.mask_below_bin(\n    bins=ds_sr[\"binClutterFreeBottom\"],\n    strict=False,\n)  # do not mask the specified bin","key":"d7ZzHsW1is"},{"type":"output","id":"Qfk2xMsXOVIBiPT_OIdvd","data":[],"key":"KRhGbS6E4G"}],"key":"HUig6BPSoG"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:27.827912Z","iopub.status.busy":"2024-09-08T06:22:27.827720Z","iopub.status.idle":"2024-09-08T06:22:28.678919Z","shell.execute_reply":"2024-09-08T06:22:28.678040Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Display the maximum observed reflectivity\nds_sr[\"zFactorMeasured\"].max(dim=\"range\").gpm.plot_map()\nds_sr[\"zFactorFinal\"].max(dim=\"range\").gpm.plot_map(vmax=40)","key":"bWw3j9MmCA"},{"type":"output","id":"oYeuuHRJ35jB2zKxqul59","data":[{"output_type":"execute_result","execution_count":23,"metadata":{},"data":{"text/plain":{"content":"\u003ccartopy.mpl.geocollection.GeoQuadMesh at 0x7f2f44ff2f10\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9b397d664e673f5cc43fa05d3e71d2df","path":"/erad2024/_preview/111/build/9b397d664e673f5cc43fa05d3e71d2df.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"911bb6696dcef801a60647d01e9033bd","path":"/erad2024/_preview/111/build/911bb6696dcef801a60647d01e9033bd.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"NmnCtslQtF"}],"key":"VWHPFnk9z4"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:28.681130Z","iopub.status.busy":"2024-09-08T06:22:28.680942Z","iopub.status.idle":"2024-09-08T06:22:29.367997Z","shell.execute_reply":"2024-09-08T06:22:29.367470Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Display cross-section with ground clutter masked out\nds_sr[\"zFactorMeasured\"].isel(cross_track=24).gpm.plot_cross_section(zoom=False)\nds_sr[\"zFactorFinal\"].isel(cross_track=24).gpm.plot_cross_section(zoom=False)\nds_sr[\"zFactorCorrection\"].isel(cross_track=24).gpm.plot_cross_section(vmin=0, vmax=3, cmap=\"Spectral_r\", zoom=False)","key":"l8MpNmSjLD"},{"type":"output","id":"kjf-UXUPt9KpqnMHqaiwV","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"5787f86ae210879886b966f1c37fb0a7","path":"/erad2024/_preview/111/build/5787f86ae210879886b966f1c37fb0a7.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"14b7bc7e01f058a6814c28982a10def2","path":"/erad2024/_preview/111/build/14b7bc7e01f058a6814c28982a10def2.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f6260996327fb352405b01be1fe80d16","path":"/erad2024/_preview/111/build/f6260996327fb352405b01be1fe80d16.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"cnqQh4rcje"}],"key":"fsTdzNsXvT"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Retrieve GR gate resolution","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"v6hrCIAr68"}],"identifier":"retrieve-gr-gate-resolution","label":"Retrieve GR gate resolution","html_id":"retrieve-gr-gate-resolution","implicit":true,"key":"waOA2GqxtW"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In this subsection we derive the horizontal and vertical resolution of GR gates.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NMjgiaYjZG"}],"key":"MhEmXRuczW"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The GR horizontal and vertical resolution change as a function of the range distance.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"XFa4lheWgm"}],"key":"J9auwLvtUW"}],"key":"kRChiogqgH"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:29.370035Z","iopub.status.busy":"2024-09-08T06:22:29.369693Z","iopub.status.idle":"2024-09-08T06:22:32.332028Z","shell.execute_reply":"2024-09-08T06:22:32.331470Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Compute horizontal and vertical GR gate resolution\nh_res_gr, v_res_gr = ds_gr.xradar_dev.resolution_at_range(\n    azimuth_beamwidth=azimuth_beamwidth_gr,\n    elevation_beamwidth=elevation_beamwidth_gr,\n)\nh_res_gr.xradar_dev.plot_map()\nv_res_gr.xradar_dev.plot_map()","key":"PtZ0kPcWgz"},{"type":"output","id":"ZK54ZFRE5nNfQwGmW8bDu","data":[{"output_type":"execute_result","execution_count":25,"metadata":{},"data":{"text/plain":{"content":"\u003ccartopy.mpl.geocollection.GeoQuadMesh at 0x7f2f2b565d10\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"bb0fdf9ea9b251aef609087c2e8e57bc","path":"/erad2024/_preview/111/build/bb0fdf9ea9b251aef609087c2e8e57bc.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"bb0fdf9ea9b251aef609087c2e8e57bc","path":"/erad2024/_preview/111/build/bb0fdf9ea9b251aef609087c2e8e57bc.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"gvlnRFZrJw"}],"key":"ZYc06ze0kW"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define GR range distance interval","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yxXwumjyZL"}],"identifier":"define-gr-range-distance-interval","label":"Define GR range distance interval","html_id":"define-gr-range-distance-interval","implicit":true,"key":"XQenbw58ss"}],"key":"DgvNRVkpkR"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now let’s define the minimum range distance at which the GR gate vertical resolution is larger than 150/250 m (the range resolution of GPM) and at which GR distance the GR gate vertical resolution exceed 1500 m (which correspond to 12/6 SR gates included in a GR gate)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TjQRiFoivz"}],"key":"LQJIP27eGS"}],"key":"PA9TbtZn4t"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:32.334164Z","iopub.status.busy":"2024-09-08T06:22:32.333737Z","iopub.status.idle":"2024-09-08T06:22:35.396684Z","shell.execute_reply":"2024-09-08T06:22:35.396157Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"mask_gr_gate_depth_above_250 = v_res_gr \u003e 250\nmask_gr_gate_depth_above_250.xradar_dev.plot_map()\nmin_gr_range = np.max(\n    mask_gr_gate_depth_above_250[\"range\"].data[mask_gr_gate_depth_above_250.sum(dim=\"azimuth\") == 0],\n)  # min_range_distance\n\nmask_gr_gate_depth_below_2000 = v_res_gr \u003e 1500\nmask_gr_gate_depth_below_2000.xradar_dev.plot_map()\nmax_gr_range = np.max(\n    mask_gr_gate_depth_below_2000[\"range\"].data[mask_gr_gate_depth_below_2000.sum(dim=\"azimuth\") == 0],\n)  # min_range_distance\n\nprint(\"Minimum GR distance:\", min_gr_range, \"m\")\nprint(\"Maximum GR distance:\", max_gr_range, \"m\")","key":"D7FwzIglQi"},{"type":"output","id":"FUvMkJXGTHVqU3e-Olfct","data":[{"name":"stdout","output_type":"stream","text":"Minimum GR distance: 14125.0 m\nMaximum GR distance: 85875.0 m\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d038a702d422e356bc0a0126e6d0d9e7","path":"/erad2024/_preview/111/build/d038a702d422e356bc0a0126e6d0d9e7.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2495d1f4d0cfaa5de1d47bfbcb5e4f57","path":"/erad2024/_preview/111/build/2495d1f4d0cfaa5de1d47bfbcb5e4f57.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"XzNsmmY7cy"}],"key":"M4iYvKPTyl"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now let’s specify the minimum and maximum GR range distance to consider when matching SR/GR gates.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Z0iQBZldxq"}],"key":"wx9cUibzxL"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"It’s good practice to avoid restricting too much at this stage. Matched SR/GR gates can be filtered afterwards.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Ue5z7dDJ41"}],"key":"faVaHFNpEO"}],"key":"Z3V3qFBSnB"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:35.398986Z","iopub.status.busy":"2024-09-08T06:22:35.398410Z","iopub.status.idle":"2024-09-08T06:22:35.401178Z","shell.execute_reply":"2024-09-08T06:22:35.400709Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Specify GR range distance interval over which to perform SR matching\nmin_gr_range = 7_000  # about 15_000 km\nmax_gr_range = 150_000","key":"nNEyyX1ojy"},{"type":"output","id":"2w-cwnkoFFxchc2sngBFu","data":[],"key":"G1v7ykFd5t"}],"key":"Wk676a55nf"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Display SR slice and GR sweep","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RMtsyN0uF4"}],"identifier":"display-sr-slice-and-gr-sweep","label":"Display SR slice and GR sweep","html_id":"display-sr-slice-and-gr-sweep","implicit":true,"key":"o0lcPLQE5A"}],"key":"AE4ygvWMtl"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:35.403093Z","iopub.status.busy":"2024-09-08T06:22:35.402840Z","iopub.status.idle":"2024-09-08T06:22:35.421101Z","shell.execute_reply":"2024-09-08T06:22:35.420660Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Slice SR volume\nda_sr = ds_sr[\"zFactorFinal\"].isel(range=-5)\nda_sr = ds_sr[\"zFactorFinal\"].gpm.slice_range_at_bin(ds_sr[\"binClutterFreeBottom\"])\nda_sr = ds_sr[\"zFactorFinal\"].gpm.slice_range_at_height(value=2000)","key":"jQqWnfZ58j"},{"type":"output","id":"7w4wJBd90PRMGNhB85Pui","data":[],"key":"so27vyl6cg"}],"key":"xWDqRt05w5"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:35.423432Z","iopub.status.busy":"2024-09-08T06:22:35.423001Z","iopub.status.idle":"2024-09-08T06:22:38.342849Z","shell.execute_reply":"2024-09-08T06:22:38.342269Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Define SR and GR mask\nmask_gr = ds_gr[\"DBZH\"] \u003e= z_min_threshold_gr\n# mask_gr = np.logical_and(ds_gr[\"DBZH\"] \u003e= z_min_threshold_gr, ds_gr[\"RHOHV\"] \u003e= 0.80)\n\nmask_sr = True  # aka do not mask\n\n# Retrieve SR extent\nsr_extent = ds_sr.gpm.extent()\n\n# Define cmap\ncmap = \"Spectral_r\"\n\nfig, (ax1, ax2) = plt.subplots(1, 2, figsize=(8, 4), dpi=120, subplot_kw={\"projection\": ccrs.PlateCarree()})\n# - Plot SR\np_sr = da_sr.where(mask_sr).gpm.plot_map(\n    ax=ax1,\n    cmap=cmap,\n    vmin=0,\n    vmax=40,\n    cbar_kwargs={\"label\": \"SR Reflectivity (dBz)\"},\n    add_colorbar=True,\n)\n# - Plot GR\nds_gr[\"DBZH\"].where(mask_gr).xradar_dev.plot_map(\n    ax=ax2,\n    cmap=cmap,\n    vmin=0,\n    vmax=40,\n    cbar_kwargs={\"label\": \"GR Reflectivity (dBz)\", \"extend\": \"both\"},\n    add_colorbar=True,\n)\n# - Add the SR swath boundary\nda_sr.gpm.plot_swath_lines(ax=ax2)\n# - Restrict the extent to the SR overpass\nax2.set_extent(sr_extent)\n# - Display GR range distances\nfor ax in [ax1, ax2]:\n    ds_gr.xradar_dev.plot_range_distance(\n        distance=min_gr_range,\n        ax=ax,\n        add_background=True,\n        linestyle=\"dashed\",\n        edgecolor=\"black\",\n    )\n    ds_gr.xradar_dev.plot_range_distance(\n        distance=max_gr_range,\n        ax=ax,\n        add_background=True,\n        linestyle=\"dashed\",\n        edgecolor=\"black\",\n    )\n    ds_gr.xradar_dev.plot_range_distance(\n        distance=250_000,\n        ax=ax,\n        add_background=True,\n        linestyle=\"dashed\",\n        edgecolor=\"black\",\n    )\n# - Add GR location\nax1.scatter(ds_gr[\"longitude\"], ds_gr[\"latitude\"], c=\"black\", marker=\"X\", s=4)\nax2.scatter(ds_gr[\"longitude\"], ds_gr[\"latitude\"], c=\"black\", marker=\"X\", s=4)\n# - Set title\nax1.set_title(\"GPM\", fontsize=12, loc=\"left\")\nax2.set_title(\"Ground Radar\", fontsize=12, loc=\"left\")\n# - Improve layout and display\nplt.tight_layout()\nplt.show()","key":"BKzxRznsd5"},{"type":"output","id":"OJRHVs4D8sUahoVRl0G40","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"188ee71808681d3e31b23f9e72fc9f06","path":"/erad2024/_preview/111/build/188ee71808681d3e31b23f9e72fc9f06.png"},"text/plain":{"content":"\u003cFigure size 960x480 with 4 Axes\u003e","content_type":"text/plain"}}}],"key":"kUvDIZ6gQN"}],"key":"SoIMhnFQWl"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Retrieve GR (lon, lat) coordinates","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lgjvBO3Viq"}],"identifier":"retrieve-gr-lon-lat-coordinates","label":"Retrieve GR (lon, lat) coordinates","html_id":"retrieve-gr-lon-lat-coordinates","implicit":true,"key":"k4QBG4pYLs"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here we retrieve the 2D non-dimensional longitude and latitude coordinates in the CRS of the SR.\nThese 2D coordinates will have dimensions (azimuth, range)","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"sCt3QiOeE2"}],"key":"CyUUYQfxb2"}],"key":"ZqlogFCrly"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:38.344972Z","iopub.status.busy":"2024-09-08T06:22:38.344665Z","iopub.status.idle":"2024-09-08T06:22:39.069626Z","shell.execute_reply":"2024-09-08T06:22:39.069157Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"lon_gr, lat_gr, height_gr = reproject_coords(x=ds_gr[\"x\"], y=ds_gr[\"y\"], z=ds_gr[\"z\"], src_crs=crs_gr, dst_crs=crs_sr)\n\n# If crs_gr and crs_sr share same datum/ellispoid, z does not vary\nprint(crs_gr.datum)\nprint(crs_sr.datum)","key":"cNXdgk5YPQ"},{"type":"output","id":"kUYN7X-X3vcc5ZNV2NgLt","data":[{"name":"stdout","output_type":"stream","text":"World Geodetic System 1984\nUnknown based on WGS 84 ellipsoid\n"}],"key":"w80e1oVx42"}],"key":"KJesUeVldH"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Retrieve SR (x,y,z) coordinates","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OcfToFZbzu"}],"identifier":"retrieve-sr-x-y-z-coordinates","label":"Retrieve SR (x,y,z) coordinates","html_id":"retrieve-sr-x-y-z-coordinates","implicit":true,"key":"ZICcHPFvfU"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here we retrieve the 3D (x,y,z) coordinates of SR gates in the GR CRS projection.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GpUihVgrLl"}],"key":"YNkGB00zf2"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The GR CRS is a azimuthal equidistant (AZEQ) projection centered on the ground radar.\nIn the GR CRS, the (x,y) coordinates (0,0) corresponds to the location of the ground radar.\nTherefore, the retrieved SR (x,y) coordinates are relative to the ground radar site, while the z coordinates is relative to the ellipsoid.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"mzEcgTWSXB"}],"key":"XISplU8Sc1"}],"key":"Bfb5pShEZY"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:39.071523Z","iopub.status.busy":"2024-09-08T06:22:39.071346Z","iopub.status.idle":"2024-09-08T06:22:39.282037Z","shell.execute_reply":"2024-09-08T06:22:39.281515Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"x_sr, y_sr, z_sr = retrieve_gates_projection_coordinates(ds_sr, dst_crs=crs_gr)","key":"Pgo96f0fxA"},{"type":"output","id":"poYTFVo6mQjvFIEPifOdM","data":[],"key":"VLfAjHO6EG"}],"key":"wyVsNNuDZo"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Retrieve SR (range, azimuth, elevation) coordinates","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XMlG2kmxud"}],"identifier":"retrieve-sr-range-azimuth-elevation-coordinates","label":"Retrieve SR (range, azimuth, elevation) coordinates","html_id":"retrieve-sr-range-azimuth-elevation-coordinates","implicit":true,"key":"OuWcps7K2q"}],"key":"MTvx0F4M8Z"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Now we inverse the SR (x,y,z) 3D GR CRS coordinates to derive the SR (range, azimuth, elevation) coordinates with respect to GR sweep.\nThese coordinates allow to identify the SR gates intersecting the GR sweep.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Xcn91q1o0C"}],"key":"OU5nh1avQp"}],"key":"snLY8eIGBL"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:39.284467Z","iopub.status.busy":"2024-09-08T06:22:39.284146Z","iopub.status.idle":"2024-09-08T06:22:39.421698Z","shell.execute_reply":"2024-09-08T06:22:39.421191Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"range_sr, azimuth_sr, elevation_sr = xyz_to_antenna_coordinates(\n    x=x_sr,\n    y=y_sr,\n    z=z_sr,\n    site_altitude=ds_gr[\"altitude\"],\n    crs=crs_gr,\n    effective_radius_fraction=None,\n)\nprint(range_sr.isel(cross_track=0).min().item(), \"m\")  # far from the radar\nprint(range_sr.isel(cross_track=-1).min().item(), \"m\")  # closer to radar","key":"OK98qyCj4H"},{"type":"output","id":"Ab8S8W8qL1vPKmg0XLTND","data":[{"name":"stdout","output_type":"stream","text":"252837.9704755049 m\n9164.066906023296 m\n"}],"key":"PkxdBQW5xf"}],"key":"oxM49Tlovu"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:39.423631Z","iopub.status.busy":"2024-09-08T06:22:39.423462Z","iopub.status.idle":"2024-09-08T06:22:40.012029Z","shell.execute_reply":"2024-09-08T06:22:40.011501Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Show elevation angle at different SR scan angle\nelevation_sr.isel(cross_track=0).gpm.plot_cross_section(vmin=0)  # far from the radar\nelevation_sr.isel(cross_track=-1).gpm.plot_cross_section(vmin=0)  # closer to radar","key":"jLMh6N5v3J"},{"type":"output","id":"NELHYClaouNffV67EUnsm","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3df66bf3f8f6d2f6f10a8143a68e8d8b","path":"/erad2024/_preview/111/build/3df66bf3f8f6d2f6f10a8143a68e8d8b.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4ce35b466fe00f95aabdfc96289aa63a","path":"/erad2024/_preview/111/build/4ce35b466fe00f95aabdfc96289aa63a.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"sCw45BmDD5"}],"key":"HTYvH02FbD"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Retrieve SR range distance","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TJFSpbLH1z"}],"identifier":"retrieve-sr-range-distance","label":"Retrieve SR range distance","html_id":"retrieve-sr-range-distance","implicit":true,"key":"rfyEN0sriB"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The range distance from the satellite for each SR radar gate has been precomputed using information in the GPM L1B product and already included in the preprocessed GPM Zarr Store.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"SKNZk8hZ1U"}],"key":"NZjhc3TtIc"}],"key":"BKNxNnWRmq"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GMxcoLdYKW"},{"type":"inlineCode","value":"range_distance_from_satellite","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jTVygEGKAY"},{"type":"text","value":" can also be derived from the GPM L2 product if we assume a cross-track scan angle.\nHowever, uncertainties in cross-tracks scan angle can erroneously impacts the estimates.\nAs we show here below, an uncertainty of 0.1° translates to a range distance difference of up to 400 m which corresponds to 3/4 radar gates !","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ocFbknCjYh"}],"key":"XiV9GOfbgo"}],"key":"VBNbWD6UuT"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:40.014222Z","iopub.status.busy":"2024-09-08T06:22:40.014056Z","iopub.status.idle":"2024-09-08T06:22:40.236796Z","shell.execute_reply":"2024-09-08T06:22:40.236297Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Show impact of scan angle on range distance\n# - Variation of 0.01 impacts range distance up to 30 m\n# - Variation of 0.05 impacts range distance up to 100 m\n# - Variation of 0.1 impacts range distance up to 400 m\nscan_angle_template = np.abs(np.linspace(-17.04, 17.04, 49))  # assuming Ku swath of size 49\nscan_angle = xr.DataArray(scan_angle_template[ds_sr[\"gpm_cross_track_id\"].data], dims=\"cross_track\")\nscan_angle = scan_angle + 0.1\nl2_distance = ds_sr.gpm.retrieve(\"range_distance_from_satellite\", scan_angle=scan_angle)\n\ndiff = l2_distance - ds_sr[\"range_distance_from_satellite\"]\ndiff.isel(along_track=0).gpm.plot_cross_section()  # difference \u003e 500 m","key":"ObQinpSXWA"},{"type":"output","id":"vJeIJ1XVTJxzDbn-ThaqX","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"50bfa253a6cbc798c065f63d6f6f5508","path":"/erad2024/_preview/111/build/50bfa253a6cbc798c065f63d6f6f5508.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"w9XCUk8jqq"}],"key":"kPjy0Bv12A"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Retrieve radar gates volumes","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QxAtsZG7JA"}],"identifier":"retrieve-radar-gates-volumes","label":"Retrieve radar gates volumes","html_id":"retrieve-radar-gates-volumes","implicit":true,"key":"QTqdpj9rur"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here we compute SR and GR gate volumes.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mO2LqTkzQC"}],"key":"W8Wsofz5y4"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"An accurate beam width is necessary to derive accurate gate volume estimates. This is demonstrated here below !","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"I4X3u2prg0"}],"key":"DHwwAGFUIB"}],"key":"lfxpNeRKgu"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:40.238878Z","iopub.status.busy":"2024-09-08T06:22:40.238535Z","iopub.status.idle":"2024-09-08T06:22:40.245453Z","shell.execute_reply":"2024-09-08T06:22:40.245072Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Compute GR gates volumes\nvol_gr = wrl.qual.pulse_volume(\n    ds_gr[\"range\"],  # range distance\n    h=ds_gr[\"range\"].diff(\"range\").median(),  # range resolution\n    theta=elevation_beamwidth_gr,\n)  # beam width\nvol_gr = vol_gr.broadcast_like(ds_gr[\"DBZH\"])\nvol_gr = vol_gr.assign_coords({\"lon\": ds_gr[\"lon\"], \"lat\": ds_gr[\"lat\"]})","key":"kXCaJWyE0m"},{"type":"output","id":"R1WaXgUlV6usUqbc9G9e2","data":[],"key":"S98eOQTSWr"}],"key":"DYgNio2ljH"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:40.247306Z","iopub.status.busy":"2024-09-08T06:22:40.246887Z","iopub.status.idle":"2024-09-08T06:22:40.862109Z","shell.execute_reply":"2024-09-08T06:22:40.861573Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Compute SR gates volumes\nrange_distance = ds_sr[\"range_distance_from_satellite\"]\nvol_sr = ds_sr.gpm.retrieve(\"gate_volume\", beam_width=ds_sr[\"crossTrackBeamWidth\"], range_distance=range_distance)\nvol_sr.isel(along_track=0).gpm.plot_cross_section()\nvol_sr.isel(range=-1).gpm.plot_map()","key":"mJKRCEfP6v"},{"type":"output","id":"tSIlU8UA8VjmMbpJs9aXd","data":[{"output_type":"execute_result","execution_count":36,"metadata":{},"data":{"text/plain":{"content":"\u003ccartopy.mpl.geocollection.GeoQuadMesh at 0x7f2f4c421bd0\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"aa76b6e08b6e20fbbab1fc3eba5b70e5","path":"/erad2024/_preview/111/build/aa76b6e08b6e20fbbab1fc3eba5b70e5.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"adda2487f074d09b8415aaba9f87a43d","path":"/erad2024/_preview/111/build/adda2487f074d09b8415aaba9f87a43d.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"Olh4iUx7Ui"}],"key":"ceg4eyfc8S"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:40.864317Z","iopub.status.busy":"2024-09-08T06:22:40.864007Z","iopub.status.idle":"2024-09-08T06:22:41.451457Z","shell.execute_reply":"2024-09-08T06:22:41.450912Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Assuming fixed beamwidth with SR leads to volume difference up to 0.35 km3\nvol_sr1 = ds_sr.gpm.retrieve(\"gate_volume\", beam_width=0.71, range_distance=range_distance)\ndiff = vol_sr - vol_sr1\ndiff.isel(along_track=0).gpm.plot_cross_section()\ndiff.isel(range=-1).gpm.plot_map()","key":"pVXrtWTetr"},{"type":"output","id":"nJ549cSSLYlbiCrlobEa4","data":[{"output_type":"execute_result","execution_count":37,"metadata":{},"data":{"text/plain":{"content":"\u003ccartopy.mpl.geocollection.GeoQuadMesh at 0x7f2f292b7b50\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"254c479626641018a801abe173e4d649","path":"/erad2024/_preview/111/build/254c479626641018a801abe173e4d649.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"40ecdda63d7ac4d63e0866bdd27ae770","path":"/erad2024/_preview/111/build/40ecdda63d7ac4d63e0866bdd27ae770.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"oGpLEe9wfy"}],"key":"DDahItV57t"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Retrieve SR gate resolution","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eUXGVhzCW3"}],"identifier":"retrieve-sr-gate-resolution","label":"Retrieve SR gate resolution","html_id":"retrieve-sr-gate-resolution","implicit":true,"key":"JaRAEoFQ9x"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In this subsection we derive the horizontal and vertical SR gate resolution.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"e3KbCWgu8D"}],"key":"BwC6oH019i"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"The SR horizontal resolution change for each radar gate, while the vertical resolution varies only across SR footprints.\nNote that the vertical resolution here derived is equivalent to the GPM L2 product variable ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"gI5uBzFeC4"},{"type":"inlineCode","value":"height","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"cKcua1aNA8"},{"type":"text","value":".","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"vViSTvPhTW"}],"key":"PEHsO7MurP"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Assuming a fixed beamwidth of 0.71 can leads to variations in horizontal resolution estimates up to 400 m on the outer-track.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"bU9AkTAiDR"}],"key":"ZNehd4Fu1U"}],"key":"Mbrlt7JIH5"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:41.453657Z","iopub.status.busy":"2024-09-08T06:22:41.453241Z","iopub.status.idle":"2024-09-08T06:22:41.489576Z","shell.execute_reply":"2024-09-08T06:22:41.489014Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Compute horizontal and vertical SR gate resolution\nrange_distance = ds_sr[\"range_distance_from_satellite\"]\nh_res_sr, v_res_sr = ds_sr.gpm.retrieve(\"gate_resolution\", beam_width=ds_sr[\"crossTrackBeamWidth\"], range_distance=range_distance)\nh_radius = h_res_sr / 2","key":"GhhY5CAbg9"},{"type":"output","id":"r0-PfsXCo9tZ1ug2xrkvu","data":[],"key":"yjPfzDb4N5"}],"key":"tBTEL7qYkF"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:41.491935Z","iopub.status.busy":"2024-09-08T06:22:41.491758Z","iopub.status.idle":"2024-09-08T06:22:41.610742Z","shell.execute_reply":"2024-09-08T06:22:41.610242Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Validate v_res_sr [OK !]\ndiff = -ds_sr[\"height\"].diff(dim=\"range\") - v_res_sr\ndiff.isel(along_track=0).gpm.plot_cross_section(y=\"range\")\nplt.show()","key":"Vb5wTOoU2z"},{"type":"output","id":"Y5g5s_cCSYCd7ooVZMX0i","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"cab32ecb811a96f0b79165ce2e44a1dd","path":"/erad2024/_preview/111/build/cab32ecb811a96f0b79165ce2e44a1dd.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"VoOFLdScDS"}],"key":"EQ1gnQbOKh"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:41.612850Z","iopub.status.busy":"2024-09-08T06:22:41.612545Z","iopub.status.idle":"2024-09-08T06:22:42.179287Z","shell.execute_reply":"2024-09-08T06:22:42.178721Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Validate h_res [PROBLEMATIC WITH FIXED BEAM WIDTH]\nh_res1_sr, _ = ds_sr.gpm.retrieve(\"gate_resolution\", beam_width=None, range_distance=range_distance)  # Use 0.71\ndiff = h_res_sr - h_res1_sr\ndiff.isel(along_track=0).gpm.plot_cross_section(y=\"range\")\ndiff.isel(range=-1).gpm.plot_map()","key":"r0UprsoalU"},{"type":"output","id":"i2LJohu81f3ATsoXk0iu0","data":[{"output_type":"execute_result","execution_count":40,"metadata":{},"data":{"text/plain":{"content":"\u003ccartopy.mpl.geocollection.GeoQuadMesh at 0x7f2f44b274d0\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d48dde345555207c83edc6515bf52c1b","path":"/erad2024/_preview/111/build/d48dde345555207c83edc6515bf52c1b.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b1ccb053f2a8444cee730c6e46e4fec4","path":"/erad2024/_preview/111/build/b1ccb053f2a8444cee730c6e46e4fec4.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"kbjFtOnywc"}],"key":"sPVyKK5Xvb"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Retrieve Bright Band (BB) Ratio","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UTjdawqvSz"}],"identifier":"retrieve-bright-band-bb-ratio","label":"Retrieve Bright Band (BB) Ratio","html_id":"retrieve-bright-band-bb-ratio","implicit":true,"key":"t5U3JHJAyz"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here we derive the bright band ratio, which is defined as follow:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"v6tqWwwIYa"}],"key":"lVv9j9VWM7"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"A BB ratio of \u003c 0 indicates that a bin is located below the melting layer (ML).","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"fpilB3XeGr"}],"key":"dzIbT2NUrw"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"A BB ratio of \u003e 0 indicates that a bin is located above the ML.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"yjvUq1OCXF"}],"key":"mbvjy38hSI"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"A BB ratio with values in between 0 and 1 indicates tha the radar is inside the ML.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"EOJEHtK7PJ"}],"key":"ROZDVMWNsc"}],"key":"SaMEitfnVI"}],"key":"SMbdr6IUfu"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:42.181546Z","iopub.status.busy":"2024-09-08T06:22:42.181104Z","iopub.status.idle":"2024-09-08T06:22:43.174522Z","shell.execute_reply":"2024-09-08T06:22:43.173901Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"da_bb_ratio, da_bb_mask = ds_sr.gpm.retrieve(\"bright_band_ratio\", return_bb_mask=True)\nda_bb_ratio.isel(cross_track=24).gpm.plot_cross_section(vmin=0, vmax=1)\nda_bb_ratio.isel(range=0).gpm.plot_map()  # top\nda_bb_ratio.isel(range=-1).gpm.plot_map()  # bottom","key":"f295XtqZJN"},{"type":"output","id":"U28adyjt0ftuKwZM1ogvS","data":[{"output_type":"execute_result","execution_count":41,"metadata":{},"data":{"text/plain":{"content":"\u003ccartopy.mpl.geocollection.GeoQuadMesh at 0x7f2f4499c250\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"00a77674411e179d68d55d5fcf8a1fb4","path":"/erad2024/_preview/111/build/00a77674411e179d68d55d5fcf8a1fb4.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b7f5201ed33394ee13fc42167da96ffe","path":"/erad2024/_preview/111/build/b7f5201ed33394ee13fc42167da96ffe.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9a42084c618d61e6ea45ba71d9b8124e","path":"/erad2024/_preview/111/build/9a42084c618d61e6ea45ba71d9b8124e.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"unBT2v5D4V"}],"key":"PC1krkEMoU"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:43.176862Z","iopub.status.busy":"2024-09-08T06:22:43.176468Z","iopub.status.idle":"2024-09-08T06:22:43.968119Z","shell.execute_reply":"2024-09-08T06:22:43.967586Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Show difference between L2 qualityBB and custom derived BB mask\nds_sr[\"qualityBB\"].gpm.plot_map()\nda_bb_mask.gpm.plot_map()\nds_sr[\"qualityBB\"].attrs","key":"LUNOdWc3Us"},{"type":"output","id":"KUOO93lknWHPb6KXTo4JB","data":[{"output_type":"execute_result","execution_count":42,"metadata":{},"data":{"text/plain":{"content":"{'description': 'Quality of Bright-Band Detection',\n 'flag_meanings': ['BB not detected', 'BB detected'],\n 'flag_values': [0, 1],\n 'gpm_api_decoded': 'yes',\n 'gpm_api_product': '2A-DPR',\n 'grid_mapping': 'crsWGS84'}","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c521eda0d3f37fc04859a14d39abd2bc","path":"/erad2024/_preview/111/build/c521eda0d3f37fc04859a14d39abd2bc.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c699496c02a906a7527a67a4e93c34d6","path":"/erad2024/_preview/111/build/c699496c02a906a7527a67a4e93c34d6.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"D0460pGjer"}],"key":"JNA4HkWwuf"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Retrieve Precipitation and Hydrometeors Types","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LkUTskCkCD"}],"identifier":"retrieve-precipitation-and-hydrometeors-types","label":"Retrieve Precipitation and Hydrometeors Types","html_id":"retrieve-precipitation-and-hydrometeors-types","implicit":true,"key":"NazVSVgvLt"}],"key":"K1GrOIwoe2"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:43.970436Z","iopub.status.busy":"2024-09-08T06:22:43.970268Z","iopub.status.idle":"2024-09-08T06:22:44.369908Z","shell.execute_reply":"2024-09-08T06:22:44.369311Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Retrieve precipitation type classification\nds_sr[\"flagPrecipitationType\"] = ds_sr.gpm.retrieve(\"flagPrecipitationType\", method=\"major_rain_type\")\nds_sr[\"flagPrecipitationType\"].gpm.plot_map()\nds_sr[\"flagPrecipitationType\"].attrs","key":"C6SRTYP2VG"},{"type":"output","id":"r4JQkJeLXd10qhzyk6IrK","data":[{"output_type":"execute_result","execution_count":43,"metadata":{},"data":{"text/plain":{"content":"{'flag_values': [0, 1, 2, 3],\n 'flag_meanings': ['no rain', 'stratiform', 'convective', 'other'],\n 'description': 'Precipitation type'}","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7a4549d4fb32d6d2c1829cacd09d25ce","path":"/erad2024/_preview/111/build/7a4549d4fb32d6d2c1829cacd09d25ce.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"TLj0Qg46Fc"}],"key":"SAWOs0TmRN"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:44.372368Z","iopub.status.busy":"2024-09-08T06:22:44.371904Z","iopub.status.idle":"2024-09-08T06:22:44.646120Z","shell.execute_reply":"2024-09-08T06:22:44.645558Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Retrieve hydrometeors classification\nds_sr[\"flagHydroClass\"] = ds_sr.gpm.retrieve(\"flagHydroClass\")\nds_sr[\"flagHydroClass\"].isel(cross_track=24).gpm.plot_cross_section()\nds_sr[\"flagHydroClass\"].attrs","key":"Cxm3MZfPfN"},{"type":"output","id":"LLBduPkntuUb2K3Pm3gVb","data":[{"output_type":"execute_result","execution_count":44,"metadata":{},"data":{"text/plain":{"content":"{'flag_values': [0, 1, 2, 3, 4, 5],\n 'flag_meanings': ['no precipitation',\n  'rain',\n  'snow',\n  'hail',\n  'melting layer',\n  'clutter']}","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"5fe8eb64f1ca97ed4fc547f83b21bf8e","path":"/erad2024/_preview/111/build/5fe8eb64f1ca97ed4fc547f83b21bf8e.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"c5SRLkOT7p"}],"key":"MT0eWuoQV8"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:44.648091Z","iopub.status.busy":"2024-09-08T06:22:44.647928Z","iopub.status.idle":"2024-09-08T06:22:45.001322Z","shell.execute_reply":"2024-09-08T06:22:45.000841Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Visualize cross-section\nprecip_type3d = xr.ones_like(ds_sr[\"flagHydroClass\"]) * ds_sr[\"flagPrecipitationType\"]\nprecip_type3d = precip_type3d.where(ds_sr[\"zFactorFinal\"] \u003e 10)\nprecip_type3d.name = ds_sr[\"flagPrecipitationType\"].name\n\nprecip_type3d.isel(cross_track=24).gpm.plot_cross_section()\nds_sr[\"flagHydroClass\"].where(ds_sr[\"flagHydroClass\"] \u003e 0).isel(cross_track=24).gpm.plot_cross_section()","key":"rkkp5fivUi"},{"type":"output","id":"8oZpSio260DebhEQy1c6I","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2a96d0bb168d3abb750eec9da515daf1","path":"/erad2024/_preview/111/build/2a96d0bb168d3abb750eec9da515daf1.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"cc991e79952eb5133ce51eb720935e9a","path":"/erad2024/_preview/111/build/cc991e79952eb5133ce51eb720935e9a.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"QoQYY3Bro2"}],"key":"LRu8qpQru5"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Convert SR Ku-band to S-band","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IDsWIXIOa3"}],"identifier":"convert-sr-ku-band-to-s-band","label":"Convert SR Ku-band to S-band","html_id":"convert-sr-ku-band-to-s-band","implicit":true,"key":"TfSDxZxc2u"}],"key":"fnf2aMDZ31"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here we convert reflectivities from Ku-band to S-band based on ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CJfjwmig6m"},{"type":"cite","url":"https://agupubs.onlinelibrary.wiley.com/doi/10.1002/jgrd.50138","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Cao et al., (2013)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GwuRvLWsSp"}],"kind":"narrative","label":"Cao_2013","identifier":"https://agupubs.onlinelibrary.wiley.com/doi/10.1002/jgrd.50138","enumerator":"3","key":"tXdFMccKUN"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"umK6xmFw9K"}],"key":"PfKY5vMWp5"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"When filtering the SR/GR matched samples, plase consider to select:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"eZZPLGbflQ"}],"key":"WQ7e6NVX9U"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"only reflectivities below 35 dBZ for S-band GR radars to avoid non-rayleigh scattering","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"llGWob7CPx"}],"key":"LnC11Ah1KE"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"only reflectivities below 25 dBZ for C/X-band GR radars","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"TZM72WDx93"}],"key":"e7XIy2Mkfh"}],"key":"bIdERceYM0"}],"key":"eqMtAsvI2M"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:45.003198Z","iopub.status.busy":"2024-09-08T06:22:45.003035Z","iopub.status.idle":"2024-09-08T06:22:46.185958Z","shell.execute_reply":"2024-09-08T06:22:46.185470Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# With attenuation corrected reflectivity\nda_z_s_final = ds_sr.gpm.retrieve(\"s_band_cao2013\", reflectivity=\"zFactorFinal\", bb_ratio=None, precip_type=None)\nda_z_ku_final = ds_sr[\"zFactorFinal\"]\ndfr_s_ku_final = da_z_s_final - da_z_ku_final\ndfr_s_ku_final.name = \"DRF_S_Ku\"\n\ndfr_s_ku_final.isel(cross_track=24).gpm.plot_cross_section()\nda_z_ku_final.isel(cross_track=24).gpm.plot_cross_section()\nda_z_s_final.isel(cross_track=24).gpm.plot_cross_section()","key":"fQILgUnl9Q"},{"type":"output","id":"HDWv31bv-FcgB4zfKgm8k","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"93673c05c68b8def1c6be7cc9a352943","path":"/erad2024/_preview/111/build/93673c05c68b8def1c6be7cc9a352943.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e92b81a0e1d7aed383a3a21b7ba845ce","path":"/erad2024/_preview/111/build/e92b81a0e1d7aed383a3a21b7ba845ce.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"84e3d34f61c50a013d0e047adf45caa5","path":"/erad2024/_preview/111/build/84e3d34f61c50a013d0e047adf45caa5.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"dbekVS3YlI"}],"key":"sqAbRS30kQ"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:46.187898Z","iopub.status.busy":"2024-09-08T06:22:46.187733Z","iopub.status.idle":"2024-09-08T06:22:47.091124Z","shell.execute_reply":"2024-09-08T06:22:47.090574Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# With measured reflectivity\nda_z_s_measured = ds_sr.gpm.retrieve(\"s_band_cao2013\", reflectivity=\"zFactorMeasured\", bb_ratio=None, precip_type=None)\nda_z_ku_measured = ds_sr[\"zFactorMeasured\"]\ndfr_s_ku_measured = da_z_s_measured - da_z_ku_measured\ndfr_s_ku_measured.name = \"DRF_S_Ku\"\n\ndfr_s_ku_measured.isel(cross_track=24).gpm.plot_cross_section()\nda_z_ku_measured.isel(cross_track=24).gpm.plot_cross_section()\nda_z_s_measured.isel(cross_track=24).gpm.plot_cross_section()","key":"WBM1slL5Ny"},{"type":"output","id":"DuHl_qjFGNIgS9SzpSS37","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ffbeb88b7769bf1542c404ffcd8ac9e0","path":"/erad2024/_preview/111/build/ffbeb88b7769bf1542c404ffcd8ac9e0.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4e44d3acb4892fd83f315d1892b0ab7d","path":"/erad2024/_preview/111/build/4e44d3acb4892fd83f315d1892b0ab7d.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e249e8fbd11a3d3d4be60ffed309a1e4","path":"/erad2024/_preview/111/build/e249e8fbd11a3d3d4be60ffed309a1e4.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"rwxgZeWo6c"}],"key":"hPe2Pjna0i"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:47.093374Z","iopub.status.busy":"2024-09-08T06:22:47.093175Z","iopub.status.idle":"2024-09-08T06:22:47.240634Z","shell.execute_reply":"2024-09-08T06:22:47.240076Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Compute attenuation correction in S-band\nda_z_s_correction = da_z_s_final - da_z_s_measured\nda_z_s_correction.isel(cross_track=24).gpm.plot_cross_section()","key":"tILnSn9rr6"},{"type":"output","id":"jL2QERBm695jW7QAZ00wc","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"35a7c08f5276023ccae52f6807be74e7","path":"/erad2024/_preview/111/build/35a7c08f5276023ccae52f6807be74e7.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"IVIoh8BCN7"}],"key":"CJenXIcWUC"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Convert SR Ku-band to X and C-band","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ysXbh04CU6"}],"identifier":"convert-sr-ku-band-to-x-and-c-band","label":"Convert SR Ku-band to X and C-band","html_id":"convert-sr-ku-band-to-x-and-c-band","implicit":true,"key":"BCpIxpEBUh"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here we convert reflectivities from Ku-band to X and C-band.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"f09Ie05qAw"}],"key":"hFoKy6XVC8"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"We welcome contributions to improve this portion of code !","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"eBF8qz39qT"}],"key":"MyFzWN8ExR"}],"key":"tSuurwS7eT"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:47.242909Z","iopub.status.busy":"2024-09-08T06:22:47.242504Z","iopub.status.idle":"2024-09-08T06:22:48.302678Z","shell.execute_reply":"2024-09-08T06:22:48.302072Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"da_z_c = ds_sr.gpm.retrieve(\"c_band_tan\", bb_ratio=None, precip_type=None)\nda_z_x = ds_sr.gpm.retrieve(\"x_band_tan\", bb_ratio=None, precip_type=None)\n\nda_z_c.isel(cross_track=24).gpm.plot_cross_section()\nda_z_x.isel(cross_track=24).gpm.plot_cross_section()","key":"zGt54esKj1"},{"type":"output","id":"5m5_yGV2WgP9Mxz_5aJXm","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"199dbdd0223cc5193876ffe287158ac8","path":"/erad2024/_preview/111/build/199dbdd0223cc5193876ffe287158ac8.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c9010b480be4da13fa5113cef49e412d","path":"/erad2024/_preview/111/build/c9010b480be4da13fa5113cef49e412d.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"CfM9KE6Vn6"}],"key":"OtXrxfx4Aw"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Convert GR S-band to Ku-band","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"A1lWDFAvDF"}],"identifier":"convert-gr-s-band-to-ku-band","label":"Convert GR S-band to Ku-band","html_id":"convert-gr-s-band-to-ku-band","implicit":true,"key":"iqWhnta9T3"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here we provide some code to convert GR S-band reflectivities to Ku-band.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"t2QjwLXDnO"}],"key":"onqqxKtZM1"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"However, the resulting reflectivities are not used in the rest of the tutorial.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"SiM3eHJKN6"}],"key":"nzci3o01xi"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The methodology we adopt currently use only an average bright band height to discern between liquid and solid phase precipitation, and it does not account for mixed-phase precipitation and the phase transition.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"a5Pg3GdHB1"}],"key":"NlrUlQbONb"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"We welcome contributions to improve this portion of code ;)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"QZYYKg3fyv"}],"key":"lTmXw3mpKk"}],"key":"bBGE1mrkBd"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:48.304746Z","iopub.status.busy":"2024-09-08T06:22:48.304566Z","iopub.status.idle":"2024-09-08T06:22:51.304676Z","shell.execute_reply":"2024-09-08T06:22:51.304122Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Estimate bright band height\nbright_band_height = np.nanmean(ds_sr[\"heightBB\"])\n# Retrieve Ku-band reflectivities from GR S-band reflectivities\nda_gr_ku = convert_s_to_ku_band(ds_gr=ds_gr, bright_band_height=bright_band_height)\n\nda_gr_s = ds_gr[\"DBZH\"]\nda_gr_s.xradar_dev.plot_map(vmin=0, vmax=50)\nplt.show()\n\nda_gr_ku.xradar_dev.plot_map(vmin=0, vmax=50)\nplt.show()\n\ndiff = da_gr_ku - da_gr_s\ndiff.rename(\"diff\").xradar_dev.plot_map()\nplt.show()","key":"Lr2iOnKdD9"},{"type":"output","id":"9MmbT9KE_VXSvPTLdgPlg","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c3b1c5721a2b676a4f812973869cb079","path":"/erad2024/_preview/111/build/c3b1c5721a2b676a4f812973869cb079.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2b4af4942d76b8bf5b905435aef5cdcc","path":"/erad2024/_preview/111/build/2b4af4942d76b8bf5b905435aef5cdcc.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0f574e30080bec40355e027e893267ea","path":"/erad2024/_preview/111/build/0f574e30080bec40355e027e893267ea.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"KRLcQaWwVW"}],"key":"t5hfSsJAbf"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Identify SR gates intersecting GR sweep","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ixnCJL5MTF"}],"identifier":"identify-sr-gates-intersecting-gr-sweep","label":"Identify SR gates intersecting GR sweep","html_id":"identify-sr-gates-intersecting-gr-sweep","implicit":true,"key":"jPbAZGkapv"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Here we define the mask used to select SR footprints intersecting the GR sweep gates.\nUsing other terms, we can describe this task as finding SR gates that, once aggregated, “match” with the GR sweep plane-position-indicator (PPI) display.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jvGX8eodUg"}],"key":"p3zZiSwVoN"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"To this end, we need to filter SR gates by GR ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"DsS1Csqn1x"},{"type":"inlineCode","value":"range","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"pz3NFXzgRD"},{"type":"text","value":" distance and ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"v3H0B11o6Y"},{"type":"inlineCode","value":"elevation","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"kUSN75gPJc"},{"type":"text","value":" angle.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"aW1Kz5Q469"}],"key":"FPXGeTvrDi"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Since the GR CRS is centered on the GR radar location, we can define the SR range mask using the “GR” ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"NdNeNEZGbt"},{"type":"inlineCode","value":"range","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"XEYqD9PeD2"},{"type":"text","value":" coordinate.\nSo here below, we define the SR range mask with GR ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"vORpKCQneT"},{"type":"inlineCode","value":"range","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"YSqIQBfWmk"},{"type":"text","value":" between ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"kJXykAs9gj"},{"type":"inlineCode","value":"min_gr_range_lb","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"kpUTuRRiMW"},{"type":"text","value":" and ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"YTEJmpOsu2"},{"type":"inlineCode","value":"max_gr_range_ub","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"kBPNBCM34p"},{"type":"text","value":".\nWe suggest to specify ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"bDqGXRaOp0"},{"type":"inlineCode","value":"min_gr_range_lb","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"rvzEeQQA0G"},{"type":"text","value":" and ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"gVhNmUiLeV"},{"type":"inlineCode","value":"max_gr_range_ub","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"NGLeNkVMNJ"},{"type":"text","value":" not to restrictively, and rather perform more aggressive filtering once the SR/GR matched database is obtained.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"lT2sF0Rgf2"}],"key":"MOOpAMUq2n"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"The SR elevation mask is obtained by selecting SR gates with ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"PevOXA6EDO"},{"type":"inlineCode","value":"elevation","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"h4qBPYj5KL"},{"type":"text","value":" angle between the GR sweep elevation angle minus/plus its half beamwidth.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"JmK4ZbG4vv"}],"key":"kzxer8Tiic"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Important note:","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"IA3TCP635f"}],"key":"ghmrt7RPhy"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":16,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Here we currently use the GR ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"DtKYMksn5h"},{"type":"inlineCode","value":"range","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"GFjSJj2Kyx"},{"type":"text","value":" computed at the SR gate centroids (instead of at the SR gate lower and upper bound)","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"sJTmCzTo2W"}],"key":"b136ukQveN"},{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Here we currently use the GR ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"JCbkSrvgX8"},{"type":"inlineCode","value":"elevation","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"S7PB2OZE2x"},{"type":"text","value":" computed at the SR gate centroids (instead of at the SR gate lower and upper bound)","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"SZBZGeANid"}],"key":"JgrqhNEZBZ"}],"key":"ciVXO4zz9j"}],"key":"r3G7U2OjFR"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:51.306898Z","iopub.status.busy":"2024-09-08T06:22:51.306703Z","iopub.status.idle":"2024-09-08T06:22:51.704860Z","shell.execute_reply":"2024-09-08T06:22:51.704314Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Define mask of SR footprints within GR range\nr = np.sqrt(x_sr**2 + y_sr**2)\nmask_sr_within_gr_range = r \u003c ds_gr[\"range\"].max().item()\nmask_sr_within_gr_range.isel(range=-1).gpm.plot_map()\n\nmask_sr_within_gr_range_interval = (r \u003e= min_gr_range_lb) \u0026 (r \u003c= max_gr_range_ub)","key":"z5mY4wPs0f"},{"type":"output","id":"jG4USBLvLwWgXxU2UWUw6","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3efec8ad8f7da20084696d11d9468da4","path":"/erad2024/_preview/111/build/3efec8ad8f7da20084696d11d9468da4.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"ZaQaLXGhkn"}],"key":"kOi2jebKqs"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:51.706892Z","iopub.status.busy":"2024-09-08T06:22:51.706694Z","iopub.status.idle":"2024-09-08T06:22:52.169824Z","shell.execute_reply":"2024-09-08T06:22:52.169290Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Show how elevation angle (of GR) varies along SR scan angles\nelevation_sr.isel(cross_track=0).gpm.plot_cross_section(vmin=0, y=\"range\")\nelevation_sr.isel(cross_track=24).gpm.plot_cross_section(vmin=0, y=\"range\")\nelevation_sr.isel(cross_track=-1).gpm.plot_cross_section(vmin=0, y=\"range\")","key":"sSuXtUxYvt"},{"type":"output","id":"NKQKfKbKl3155WjWVbZTJ","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3f2e567ebf6e011e93a52f9aa5b85224","path":"/erad2024/_preview/111/build/3f2e567ebf6e011e93a52f9aa5b85224.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"50031cdea01706313adeb289aa76f07f","path":"/erad2024/_preview/111/build/50031cdea01706313adeb289aa76f07f.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"eba81135d3fceaaea3676a12f4f29c42","path":"/erad2024/_preview/111/build/eba81135d3fceaaea3676a12f4f29c42.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"JpGUTODzlQ"}],"key":"ebBo3GoJ4b"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:52.172108Z","iopub.status.busy":"2024-09-08T06:22:52.171736Z","iopub.status.idle":"2024-09-08T06:22:52.710343Z","shell.execute_reply":"2024-09-08T06:22:52.709719Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Show SR/GR matched elevation\nmask_sr_matched_elevation = (elevation_sr \u003e= (ds_gr[\"sweep_fixed_angle\"] - elevation_beamwidth_gr / 2.0)) \u0026 (\n    elevation_sr \u003c= (ds_gr[\"sweep_fixed_angle\"] + elevation_beamwidth_gr / 2.0)\n)\nmask_sr_matched_elevation.isel(cross_track=0).gpm.plot_cross_section()\nmask_sr_matched_elevation.isel(cross_track=24).gpm.plot_cross_section()\nmask_sr_matched_elevation.isel(cross_track=-1).gpm.plot_cross_section()","key":"XsEvnLQ7g2"},{"type":"output","id":"FFdCBUoryCMZABpArntCL","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9e5fbf993168652d27be6b4c42a097c1","path":"/erad2024/_preview/111/build/9e5fbf993168652d27be6b4c42a097c1.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"1c03ac0311ffb011f25803c3908a2b7d","path":"/erad2024/_preview/111/build/1c03ac0311ffb011f25803c3908a2b7d.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"98ac89f72d54f4e525eb87284baf4ccd","path":"/erad2024/_preview/111/build/98ac89f72d54f4e525eb87284baf4ccd.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"eybMPEb8l1"}],"key":"LP8a3QMGMO"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:52.712691Z","iopub.status.busy":"2024-09-08T06:22:52.712283Z","iopub.status.idle":"2024-09-08T06:22:52.717811Z","shell.execute_reply":"2024-09-08T06:22:52.717360Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Define mask of SR footprints matching GR gates\nmask_ppi = mask_sr_matched_elevation \u0026 mask_sr_within_gr_range_interval","key":"JU1IRYY5ag"},{"type":"output","id":"KIeibntri81oJ512D1LlW","data":[],"key":"owYYNGNRL9"}],"key":"nDuAhFlbm4"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:52.719984Z","iopub.status.busy":"2024-09-08T06:22:52.719581Z","iopub.status.idle":"2024-09-08T06:22:54.040247Z","shell.execute_reply":"2024-09-08T06:22:54.039543Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Show mask (as SR map)\nmask_ppi.any(dim=\"range\").gpm.plot_map(vmin=0)\nmask_ppi.isel(range=-10).gpm.plot_map(vmin=0)\nmask_ppi.isel(range=-30).gpm.plot_map(vmin=0)","key":"URvguL8eHB"},{"type":"output","id":"Hc_rK7kLhF3L6N-0yl29i","data":[{"output_type":"execute_result","execution_count":55,"metadata":{},"data":{"text/plain":{"content":"\u003ccartopy.mpl.geocollection.GeoQuadMesh at 0x7f2f38a27b10\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c69b5a7311232f45fdfae7450436dbfa","path":"/erad2024/_preview/111/build/c69b5a7311232f45fdfae7450436dbfa.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a587ed30b2905b1d7d9ab8dd30e17be5","path":"/erad2024/_preview/111/build/a587ed30b2905b1d7d9ab8dd30e17be5.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"99d5295ddad191837d6225785ec85f62","path":"/erad2024/_preview/111/build/99d5295ddad191837d6225785ec85f62.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"nedHKXJ2x6"}],"key":"bmKaTgbsJ8"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:54.049022Z","iopub.status.busy":"2024-09-08T06:22:54.048705Z","iopub.status.idle":"2024-09-08T06:22:55.068942Z","shell.execute_reply":"2024-09-08T06:22:55.068414Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Show mask (as SR cross-section)\nmask_ppi.isel(cross_track=24).gpm.plot_cross_section()\nmask_ppi.isel(cross_track=-1).gpm.plot_cross_section()\nmask_ppi.isel(cross_track=-1, along_track=slice(10, 60), range=slice(-40, None)).gpm.plot_cross_section()","key":"raxil4drl4"},{"type":"output","id":"2cG_E14tM-qTCNJWzKHIM","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f10dcb7302dc35e411c8d02e4395efe4","path":"/erad2024/_preview/111/build/f10dcb7302dc35e411c8d02e4395efe4.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4d6ef5f24ce8f52ef2f94416b45d09bd","path":"/erad2024/_preview/111/build/4d6ef5f24ce8f52ef2f94416b45d09bd.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f29000cd6dff037a1bfa22ebb2695b29","path":"/erad2024/_preview/111/build/f29000cd6dff037a1bfa22ebb2695b29.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"JdDXVc2CPO"}],"key":"Q8psZ8P3kE"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define SR Masks","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zaZnwjluJE"}],"identifier":"define-sr-masks","label":"Define SR Masks","html_id":"define-sr-masks","implicit":true,"key":"uoOYMyJPQd"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here we start by defining and analysing various SR masks that can be used to subset SR footprints to be matched with the GR sweep.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"N0zRY9QBMM"}],"key":"nfjBTmG6t2"}],"key":"wOfZAMJW4R"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:55.072370Z","iopub.status.busy":"2024-09-08T06:22:55.071721Z","iopub.status.idle":"2024-09-08T06:22:55.077569Z","shell.execute_reply":"2024-09-08T06:22:55.076528Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Select scan with \"normal\" dataQuality (for entire cross-track scan)\nmask_sr_quality = ds_sr[\"dataQuality\"] == 0","key":"DvNgbqAotC"},{"type":"output","id":"uo0XD5JD4o9mNvi3Bp7Rd","data":[],"key":"ir08R0Cs2M"}],"key":"s5sCvl2GkJ"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:55.080436Z","iopub.status.busy":"2024-09-08T06:22:55.079854Z","iopub.status.idle":"2024-09-08T06:22:56.278511Z","shell.execute_reply":"2024-09-08T06:22:56.278085Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Select beams with detected precipitation\nds_sr[\"flagPrecip\"].gpm.plot_map()\nmask_sr_precip = ds_sr[\"flagPrecip\"] \u003e 0\nmask_sr_precip.name = \"mask_precip\"\nmask_sr_precip.gpm.plot_map()\nds_sr[\"flagPrecip\"].attrs","key":"d4q25Mql7X"},{"type":"output","id":"2ysc3FFdln42uEj2FIjaS","data":[{"output_type":"execute_result","execution_count":58,"metadata":{},"data":{"text/plain":{"content":"{'description': 'Flag for precipitation detection',\n 'flag_meanings': ['not detected by both Ku and Ka',\n  'detected by Ka only',\n  'detected by Ka only',\n  'detected by Ku only',\n  'detected by both Ku and Ka',\n  'detected by both Ku and Ka',\n  'detected by both Ku and Ka',\n  'detected by both Ku and Ka',\n  'detected by both Ku and Ka'],\n 'flag_values': [0, 1, 2, 10, 11, 12, 20, 21, 22],\n 'gpm_api_decoded': 'yes',\n 'gpm_api_product': '2A-DPR',\n 'grid_mapping': 'crsWGS84'}","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d3e34621f0f5b74bb1eabc917866490a","path":"/erad2024/_preview/111/build/d3e34621f0f5b74bb1eabc917866490a.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7b67558771ebad7894472e4697a95310","path":"/erad2024/_preview/111/build/7b67558771ebad7894472e4697a95310.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"sqxYD3ZUKy"}],"key":"ism5M3vgJu"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:56.281012Z","iopub.status.busy":"2024-09-08T06:22:56.280809Z","iopub.status.idle":"2024-09-08T06:22:56.820681Z","shell.execute_reply":"2024-09-08T06:22:56.820141Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Select above minimum SR reflectivity\nmask_sr_minimum_z = ds_sr[\"zFactorFinal\"] \u003e z_min_threshold_sr\nmask_sr_minimum_z.name = \"Minimum_Reflectitvity\"\nmask_sr_minimum_z.any(dim=\"range\").gpm.plot_map()","key":"oHY79t15gI"},{"type":"output","id":"4xhlp4QrXgDiOGkaXjONu","data":[{"output_type":"execute_result","execution_count":59,"metadata":{},"data":{"text/plain":{"content":"\u003ccartopy.mpl.geocollection.GeoQuadMesh at 0x7f2f44ca8590\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ca934a427dd00737796ae460a7f5b3dc","path":"/erad2024/_preview/111/build/ca934a427dd00737796ae460a7f5b3dc.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"UeDBo28FCF"}],"key":"wUcYk4Xppg"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:56.822729Z","iopub.status.busy":"2024-09-08T06:22:56.822566Z","iopub.status.idle":"2024-09-08T06:22:56.824962Z","shell.execute_reply":"2024-09-08T06:22:56.824494Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Select only 'normal' data\n# mask_sr_quality_data = ds_sr[\"qualityData\"] == 0\n# mask_sr_quality_data.gpm.plot_map()","key":"Ex6TYYKpi5"},{"type":"output","id":"wWehCdn4_3md58XZagYJ3","data":[],"key":"hHCk5ySv0R"}],"key":"sosYuU2NcR"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:56.826957Z","iopub.status.busy":"2024-09-08T06:22:56.826619Z","iopub.status.idle":"2024-09-08T06:22:56.829443Z","shell.execute_reply":"2024-09-08T06:22:56.828937Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Select only 'high quality' data\n# - qualityFlag derived from qualityData.\n# - qualityFlag == 1 indicates low quality retrievals\n# - qualityFlag == 2 indicates bad/missing retrievals\nmask_sr_quality_data = ds_sr[\"qualityFlag\"] == 0","key":"EFZXfLAONR"},{"type":"output","id":"ecgrFOIqBURCi6EZsDs1Z","data":[],"key":"tR7yfE7FX2"}],"key":"mM6p1D2YrX"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:56.831860Z","iopub.status.busy":"2024-09-08T06:22:56.831364Z","iopub.status.idle":"2024-09-08T06:22:57.619958Z","shell.execute_reply":"2024-09-08T06:22:57.619418Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Select only beams with detected bright band\nds_sr[\"qualityBB\"].gpm.plot_map()\nmask_sr_quality_bb = ds_sr[\"qualityBB\"] == 1\nmask_sr_quality_bb.name = \"mask_bb\"\nmask_sr_quality_bb.gpm.plot_map()","key":"jU3rcmIJ88"},{"type":"output","id":"Nnei2bW6GP9XDA1U1dpgY","data":[{"output_type":"execute_result","execution_count":62,"metadata":{},"data":{"text/plain":{"content":"\u003ccartopy.mpl.geocollection.GeoQuadMesh at 0x7f2f29492ed0\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c521eda0d3f37fc04859a14d39abd2bc","path":"/erad2024/_preview/111/build/c521eda0d3f37fc04859a14d39abd2bc.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"5c6c35f82d40a4afb2df6eb3907c3f89","path":"/erad2024/_preview/111/build/5c6c35f82d40a4afb2df6eb3907c3f89.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"BlPkRZN6qy"}],"key":"h2A82FDnrn"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:57.621947Z","iopub.status.busy":"2024-09-08T06:22:57.621767Z","iopub.status.idle":"2024-09-08T06:22:58.456191Z","shell.execute_reply":"2024-09-08T06:22:58.455609Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Select only beams with confident precipitation type\nds_sr[\"qualityTypePrecip\"].gpm.plot_map()\nmask_sr_quality_precip = ds_sr[\"qualityTypePrecip\"] == 1\nmask_sr_quality_precip.name = \"mask_precip_type\"\nmask_sr_quality_precip.gpm.plot_map()","key":"jg4zrEH4H6"},{"type":"output","id":"OU7rXHQbPX40PG1Jhw41Z","data":[{"output_type":"execute_result","execution_count":63,"metadata":{},"data":{"text/plain":{"content":"\u003ccartopy.mpl.geocollection.GeoQuadMesh at 0x7f2f44be56d0\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2630329c3b7b34505b353b8e876770e6","path":"/erad2024/_preview/111/build/2630329c3b7b34505b353b8e876770e6.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9e53ea554b1444bf96e8e4d6fdf3b8e2","path":"/erad2024/_preview/111/build/9e53ea554b1444bf96e8e4d6fdf3b8e2.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"NGrNovjcTe"}],"key":"syEXkkmDU1"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:58.458601Z","iopub.status.busy":"2024-09-08T06:22:58.458076Z","iopub.status.idle":"2024-09-08T06:22:59.244324Z","shell.execute_reply":"2024-09-08T06:22:59.243787Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Select only stratiform precipitation\nds_sr[\"flagPrecipitationType\"].gpm.plot_map()\nmask_sr_stratiform = ds_sr[\"flagPrecipitationType\"] == 1\nmask_sr_stratiform.name = \"mask_stratiform\"\nmask_sr_stratiform.gpm.plot_map()","key":"qcCW47W1m3"},{"type":"output","id":"w0zVTQGDD9nAGaJ3oJ1-D","data":[{"output_type":"execute_result","execution_count":64,"metadata":{},"data":{"text/plain":{"content":"\u003ccartopy.mpl.geocollection.GeoQuadMesh at 0x7f2f44769210\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7a4549d4fb32d6d2c1829cacd09d25ce","path":"/erad2024/_preview/111/build/7a4549d4fb32d6d2c1829cacd09d25ce.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"73989bb5181d63cfbe539c223b28db7d","path":"/erad2024/_preview/111/build/73989bb5181d63cfbe539c223b28db7d.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"xaUMSXqKB9"}],"key":"Nqg2RHlhdv"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:22:59.246398Z","iopub.status.busy":"2024-09-08T06:22:59.246126Z","iopub.status.idle":"2024-09-08T06:23:00.467174Z","shell.execute_reply":"2024-09-08T06:23:00.466615Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Select only beams with reduced path attenuation\n# ...\nds_sr[\"piaFinal\"].gpm.plot_map()  # PIA from DSD module\nds_sr[\"pathAtten\"].gpm.plot_map()  # PIAeff\nds_sr[\"reliabFlag\"].gpm.plot_map()  # reliability of PIAeff","key":"a2jlIe0BFh"},{"type":"output","id":"7ivZeQ-oBL7u2NTQ1_Pzp","data":[{"output_type":"execute_result","execution_count":65,"metadata":{},"data":{"text/plain":{"content":"\u003ccartopy.mpl.geocollection.GeoQuadMesh at 0x7f2f4438a6d0\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9cbb4b74d2a5c8d0d25d85ed1b61529a","path":"/erad2024/_preview/111/build/9cbb4b74d2a5c8d0d25d85ed1b61529a.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"47e6d2e7852df9b0ffd8f8be80f1e508","path":"/erad2024/_preview/111/build/47e6d2e7852df9b0ffd8f8be80f1e508.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b044e51bafd601e3033b9369da278876","path":"/erad2024/_preview/111/build/b044e51bafd601e3033b9369da278876.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"JUplyImuzK"}],"key":"QySv4tXegL"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:00.469390Z","iopub.status.busy":"2024-09-08T06:23:00.469066Z","iopub.status.idle":"2024-09-08T06:23:01.057979Z","shell.execute_reply":"2024-09-08T06:23:01.057463Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Select only beams with limited attenuation correction\n# ...\nds_sr[\"zFactorCorrection\"].isel(cross_track=24).gpm.plot_cross_section(vmin=0, vmax=3, zoom=False)\nds_sr[\"zFactorCorrection\"].isel(range=-20).gpm.plot_map(vmin=0, vmax=6)","key":"yLfcp8uvVA"},{"type":"output","id":"MlbuKy9iho8Ggm7c-GKvE","data":[{"output_type":"execute_result","execution_count":66,"metadata":{},"data":{"text/plain":{"content":"\u003ccartopy.mpl.geocollection.GeoQuadMesh at 0x7f2f388745d0\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f6260996327fb352405b01be1fe80d16","path":"/erad2024/_preview/111/build/f6260996327fb352405b01be1fe80d16.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4fbb7207ed8259c7b862bbe1ea9ef8ee","path":"/erad2024/_preview/111/build/4fbb7207ed8259c7b862bbe1ea9ef8ee.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"NwX6vjKeGp"}],"key":"yGL6KktAFf"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Here we define the actual SR mask used to select the SR footprints on which the SR/GR matching will be performed.\nOnce again, we suggest to avoid, at this stage, being too restrictive in the selection of SR footprints.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"trhNYGpj1j"}],"key":"g1lkYWgdxO"}],"key":"uvyE7oIdFM"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:01.060355Z","iopub.status.busy":"2024-09-08T06:23:01.060190Z","iopub.status.idle":"2024-09-08T06:23:01.838565Z","shell.execute_reply":"2024-09-08T06:23:01.838031Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Define 3D mask of SR gates matching GR PPI gates\n# - TIP: do not mask eccessively here ... but rather at final stage\nmask_matched_ppi_3d = mask_ppi \u0026 mask_sr_precip \u0026 mask_sr_quality\n\n# Define 2D mask of SR beams matching the GR PPI\nmask_matched_ppi_2d = mask_matched_ppi_3d.any(dim=\"range\")\nmask_matched_ppi_2d.gpm.plot_map()\n\n# Number of matching SR gates per beam\nn_matching_sr_gates = mask_matched_ppi_3d.sum(dim=\"range\")\nn_matching_sr_gates.where(n_matching_sr_gates \u003e 0).gpm.plot_map()\n\n# Beam indices with at least one matching bin\ncross_track_indices, along_track_indices = np.where(mask_matched_ppi_3d.sum(dim=\"range\"))\n\n# Number of beams with at least one valid bin\nlen(along_track_indices)","key":"betNS1EDvk"},{"type":"output","id":"qYTvdMfhpX266SulvhjQC","data":[{"output_type":"execute_result","execution_count":67,"metadata":{},"data":{"text/plain":{"content":"1305","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"eb314d3fc766b437610d55056b854e4a","path":"/erad2024/_preview/111/build/eb314d3fc766b437610d55056b854e4a.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"cf566fa026860a35f5c4616e7c72777b","path":"/erad2024/_preview/111/build/cf566fa026860a35f5c4616e7c72777b.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"iVwXm98Ir6"}],"key":"kpb2hW1Pjs"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Aggregate SR radar gates","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ia2zLKg5no"}],"identifier":"aggregate-sr-radar-gates","label":"Aggregate SR radar gates","html_id":"aggregate-sr-radar-gates","implicit":true,"key":"eCTIvGB8qv"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In this subsection, we aggregate SR radar gates intersecting the GR sweep.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jPlZakhEpi"}],"key":"ah4ccxq3G3"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"SR reflectivities are averaged along the SR beam (approximately vertically) between the half-power points of the GR sweep.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"nInhLZoA3M"}],"key":"D8QRXteaQa"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"To select SR radar gates for aggregation, the following criteria must be met:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"cUwa8Q0kUv"}],"key":"MgGOIG4Jwj"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"The SR footprints must contain precipitation.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"ok2nrSVT1a"}],"key":"aLzcNaFqBk"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"The SR radar gates must overlap with GR gates.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"HGh6ouYHiJ"}],"key":"GgBb73FtxB"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"The SR radar gates must fall within a specified GR range distance, defined by ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"GWyWQMA4Vu"},{"type":"inlineCode","value":"min_gr_range","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"gPFSK6mJG6"},{"type":"text","value":" and ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"o2q5mPxM1h"},{"type":"inlineCode","value":"max_gr_range","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"zh4Dc695JU"},{"type":"text","value":".","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"rvuQufXnVR"}],"key":"EHtUIPzqvo"}],"key":"jfNKJ2TGJE"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"JFvWN3mma6"},{"type":"inlineCode","value":"min_gr_range","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"aeoN8kuSA0"},{"type":"text","value":" ensures that the GR beamwidth is not smaller than the SR gate spacing.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"vJvjta4SDU"}],"key":"JJn94qrVrS"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Important Notes:","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"hFw60joIcy"}],"key":"nZA9rs1dsn"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Reflectivity must not be aggregated in dBZ, but rather in mm6 m−3","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"VNEs8r2IHR"}],"key":"UL9Vatwu2I"}],"key":"IeIRxFwGcn"}],"key":"K4lTbMKYEs"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:01.840546Z","iopub.status.busy":"2024-09-08T06:23:01.840381Z","iopub.status.idle":"2024-09-08T06:23:02.559097Z","shell.execute_reply":"2024-09-08T06:23:02.558563Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Add variables to SR dataset\nds_sr[\"zFactorMeasured_Ku\"] = ds_sr[\"zFactorMeasured\"]\nds_sr[\"zFactorFinal_Ku\"] = ds_sr[\"zFactorFinal\"]\nds_sr[\"zFactorFinal_S\"] = da_z_s_final\nds_sr[\"zFactorMeasured_S\"] = da_z_s_measured\nds_sr[\"zFactorCorrection_Ku\"] = ds_sr[\"zFactorCorrection\"]\nds_sr[\"zFactorCorrection_S\"] = da_z_s_correction\nds_sr[\"hres\"] = h_res_sr\nds_sr[\"vres\"] = v_res_sr\nds_sr[\"gate_volume\"] = vol_sr\nds_sr[\"x\"] = x_sr\nds_sr[\"y\"] = y_sr\nds_sr[\"z\"] = z_sr\n\n# Compute path-integrated reflectivities\nds_sr[\"zFactorFinal_Ku_cumsum\"] = ds_sr[\"zFactorFinal\"].gpm.idecibel.cumsum(\"range\").gpm.decibel\nds_sr[\"zFactorFinal_Ku_cumsum\"] = ds_sr[\"zFactorFinal_Ku_cumsum\"].where(np.isfinite(ds_sr[\"zFactorFinal_Ku_cumsum\"]))\nds_sr[\"zFactorMeasured_Ku_cumsum\"] = ds_sr[\"zFactorMeasured\"].gpm.idecibel.cumsum(\"range\").gpm.decibel\nds_sr[\"zFactorMeasured_Ku_cumsum\"] = ds_sr[\"zFactorMeasured_Ku_cumsum\"].where(\n    np.isfinite(ds_sr[\"zFactorMeasured_Ku_cumsum\"]),\n)\nds_sr[\"zFactorFinal_S_cumsum\"] = ds_sr[\"zFactorFinal_S\"].gpm.idecibel.cumsum(\"range\").gpm.decibel\nds_sr[\"zFactorFinal_S_cumsum\"] = ds_sr[\"zFactorFinal_S_cumsum\"].where(np.isfinite(ds_sr[\"zFactorFinal_S_cumsum\"]))\nds_sr[\"zFactorMeasured_S_cumsum\"] = ds_sr[\"zFactorMeasured_S\"].gpm.idecibel.cumsum(\"range\").gpm.decibel\nds_sr[\"zFactorMeasured_S_cumsum\"] = ds_sr[\"zFactorMeasured_S_cumsum\"].where(\n    np.isfinite(ds_sr[\"zFactorMeasured_S_cumsum\"]),\n)\n\n# Add variables to the spaceborne dataset\nz_variables = [\"zFactorFinal_Ku\", \"zFactorFinal_S\", \"zFactorMeasured_Ku\", \"zFactorMeasured_S\"]\nsr_variables = [\n    *z_variables,\n    \"zFactorCorrection_Ku\",\n    \"zFactorCorrection_S\",\n    \"precipRate\",\n    \"airTemperature\",\n    \"zFactorFinal_Ku_cumsum\",\n    \"zFactorMeasured_Ku_cumsum\",\n    \"zFactorFinal_S_cumsum\",\n    \"zFactorMeasured_S_cumsum\",\n    \"hres\",\n    \"vres\",\n    \"gate_volume\",\n    \"x\",\n    \"y\",\n    \"z\",\n]\n\n# Initialize Dataset where to add aggregated SR gates\nds_sr_match_ppi = xr.Dataset()\n\n# Mask SR gates not matching the GR PPI\nds_sr_ppi = ds_sr[sr_variables].where(mask_matched_ppi_3d)\n\n# Compute aggregation statistics\nds_sr_ppi_min = ds_sr_ppi.min(\"range\")\nds_sr_ppi_max = ds_sr_ppi.max(\"range\")\nds_sr_ppi_sum = ds_sr_ppi.sum(dim=\"range\", skipna=True)\nds_sr_ppi_mean = ds_sr_ppi.mean(\"range\")\nds_sr_ppi_std = ds_sr_ppi.std(\"range\")\n\n# Aggregate reflectivities (in mm6/mm3)\nfor var in z_variables:\n    ds_sr_ppi_mean[var] = ds_sr_ppi[var].gpm.idecibel.mean(\"range\").gpm.decibel\n    ds_sr_ppi_std[var] = ds_sr_ppi[var].gpm.idecibel.std(\"range\").gpm.decibel\n    # If only 1 value, std=0, log transform become -inf --\u003e Set to 0\n    is_inf = np.isinf(ds_sr_ppi_std[var])\n    ds_sr_ppi_std[var] = ds_sr_ppi_std[var].where(~is_inf, 0)\n\n# Compute counts and fractions above sensitivity thresholds\nsr_sensitivity_thresholds = [10, 12, 14, 16, 18]\nds_sr_match_ppi[\"SR_counts\"] = mask_matched_ppi_3d.sum(dim=\"range\")\nds_sr_match_ppi[\"SR_counts_valid\"] = (~np.isnan(ds_sr_ppi[\"zFactorFinal_Ku\"])).sum(dim=\"range\")\nfor var in z_variables:\n    for thr in sr_sensitivity_thresholds:\n        fraction = (ds_sr_ppi[var] \u003e= thr).sum(dim=\"range\") / ds_sr_match_ppi[\"SR_counts\"]\n        ds_sr_match_ppi[f\"SR_{var}_fraction_above_{thr}dBZ\"] = fraction\n\n# Compute fraction of hydrometeor types\nda_hydro_class = ds_sr[\"flagHydroClass\"].where(mask_matched_ppi_3d)\nds_sr_match_ppi[\"SR_fraction_no_precip\"] = (da_hydro_class == 0).sum(dim=\"range\") / ds_sr_match_ppi[\"SR_counts\"]\nds_sr_match_ppi[\"SR_fraction_rain\"] = (da_hydro_class == 1).sum(dim=\"range\") / ds_sr_match_ppi[\"SR_counts\"]\nds_sr_match_ppi[\"SR_fraction_snow\"] = (da_hydro_class == 2).sum(dim=\"range\") / ds_sr_match_ppi[\"SR_counts\"]\nds_sr_match_ppi[\"SR_fraction_hail\"] = (da_hydro_class == 3).sum(dim=\"range\") / ds_sr_match_ppi[\"SR_counts\"]\nds_sr_match_ppi[\"SR_fraction_melting_layer\"] = (da_hydro_class == 4).sum(dim=\"range\") / ds_sr_match_ppi[\"SR_counts\"]\nds_sr_match_ppi[\"SR_fraction_clutter\"] = (da_hydro_class == 5).sum(dim=\"range\") / ds_sr_match_ppi[\"SR_counts\"]\nds_sr_match_ppi[\"SR_fraction_below_isotherm\"] = (ds_sr_ppi[\"airTemperature\"] \u003e= 273.15).sum(\n    dim=\"range\",\n) / ds_sr_match_ppi[\"SR_counts\"]\nds_sr_match_ppi[\"SR_fraction_above_isotherm\"] = (ds_sr_ppi[\"airTemperature\"] \u003c 273.15).sum(\n    dim=\"range\",\n) / ds_sr_match_ppi[\"SR_counts\"]\n\n# Add aggregation statistics\nfor var in ds_sr_ppi_mean.data_vars:\n    ds_sr_match_ppi[f\"SR_{var}_mean\"] = ds_sr_ppi_mean[var]\nfor var in ds_sr_ppi_std.data_vars:\n    ds_sr_match_ppi[f\"SR_{var}_std\"] = ds_sr_ppi_std[var]\nfor var in ds_sr_ppi_sum.data_vars:\n    ds_sr_match_ppi[f\"SR_{var}_sum\"] = ds_sr_ppi_sum[var]\nfor var in ds_sr_ppi_max.data_vars:\n    ds_sr_match_ppi[f\"SR_{var}_max\"] = ds_sr_ppi_max[var]\nfor var in ds_sr_ppi_min.data_vars:\n    ds_sr_match_ppi[f\"SR_{var}_min\"] = ds_sr_ppi_min[var]\nfor var in ds_sr_ppi_min.data_vars:\n    ds_sr_match_ppi[f\"SR_{var}_range\"] = ds_sr_ppi_max[var] - ds_sr_ppi_min[var]\n\n# Compute coefficient of variation\nfor var in z_variables:\n    ds_sr_match_ppi[f\"SR_{var}_cov\"] = ds_sr_match_ppi[f\"SR_{var}_std\"] / ds_sr_match_ppi[f\"SR_{var}_mean\"]\n\n# Add SR L2 variables (useful for final filtering and analysis)\nvar_l2 = [\n    \"flagPrecip\",\n    \"flagPrecipitationType\",\n    \"dataQuality\",\n    \"sunLocalTime\",\n    \"SCorientation\",\n    \"qualityFlag\",\n    \"qualityTypePrecip\",\n    \"qualityBB\",\n    \"pathAtten\",\n    \"piaFinal\",\n    \"reliabFlag\",\n]\nfor var in var_l2:\n    ds_sr_match_ppi[f\"SR_{var}\"] = ds_sr[var]\n\n# Add SR time\nds_sr_match_ppi[\"SR_time\"] = ds_sr_match_ppi[\"time\"]\nds_sr_match_ppi = ds_sr_match_ppi.drop(\"time\")\n\n# Mask SR beams not matching the GR PPI\nds_sr_match_ppi = ds_sr_match_ppi.where(mask_matched_ppi_2d)\n\n# Remove unecessary coordinates\nunecessary_coords = [\n    \"radar_frequency\",\n    \"sweep_mode\",\n    \"prt_mode\",\n    \"follow_mode\",\n    \"latitude\",\n    \"longitude\",\n    \"altitude\",\n    \"crs_wkt\",\n    \"time\",\n    \"crsWGS84\",\n    \"dataQuality\",\n    \"sunLocalTime\",\n    \"SCorientation\",\n]\nfor coord in unecessary_coords:\n    if coord in ds_sr_match_ppi:\n        ds_sr_match_ppi = ds_sr_match_ppi.drop(coord)\n    if coord in mask_matched_ppi_2d.coords:\n        mask_matched_ppi_2d = mask_matched_ppi_2d.drop(coord)\n\n# Stack aggregated dataset to beam dimension index\nds_sr_stack = ds_sr_match_ppi.stack(sr_beam_index=(\"along_track\", \"cross_track\"))\nda_mask_matched_ppi_stack = mask_matched_ppi_2d.stack(sr_beam_index=(\"along_track\", \"cross_track\"))\n\n# Drop beams not matching the GR PPI\nds_sr_match = ds_sr_stack.isel(sr_beam_index=da_mask_matched_ppi_stack)","key":"afEQ5ktoLd"},{"type":"output","id":"t73ZeleL4d82N51Fte_Kh","data":[],"key":"zsatBrpI6m"}],"key":"Umz0xSdn7G"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Display aggregated SR variables","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bJRIOy7Y1Y"}],"identifier":"display-aggregated-sr-variables","label":"Display aggregated SR variables","html_id":"display-aggregated-sr-variables","implicit":true,"key":"RK8SkvgOpJ"}],"key":"AFiMbquPsn"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:02.561729Z","iopub.status.busy":"2024-09-08T06:23:02.561330Z","iopub.status.idle":"2024-09-08T06:23:04.646976Z","shell.execute_reply":"2024-09-08T06:23:04.646406Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Original SR near surface reflectivity\np = ds_sr[\"zFactorFinalNearSurface\"].gpm.plot_map(vmin=10, vmax=40)\np.axes.set_extent(ds_gr.xradar_dev.extent(max_distance=max_gr_range))\n\n# Original GR reflectivities\np = ds_gr[\"DBZH\"].where(mask_gr).xradar_dev.plot_map(vmin=10, vmax=40)\np.axes.set_extent(ds_gr.xradar_dev.extent(max_distance=max_gr_range))\nds_sr.gpm.plot_swath_lines(ax=p.axes)","key":"xiA7VMTLAr"},{"type":"output","id":"yfyTQvEGaE3tFbytYUR0R","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c2766a43f535d05101f3289f94db4a00","path":"/erad2024/_preview/111/build/c2766a43f535d05101f3289f94db4a00.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d076f7252591cf06141f6ef46093e014","path":"/erad2024/_preview/111/build/d076f7252591cf06141f6ef46093e014.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"TYkGUzPVsH"}],"key":"fLFvZZw4Bt"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:04.650888Z","iopub.status.busy":"2024-09-08T06:23:04.650664Z","iopub.status.idle":"2024-09-08T06:23:06.084406Z","shell.execute_reply":"2024-09-08T06:23:06.083875Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# SR reflectivity statistics matching the GR PPI (using xr.Dataset)\np = ds_sr_ppi_max[\"zFactorFinal_Ku\"].gpm.plot_map(cmap=cmap, vmin=10, vmax=40)\np.axes.set_extent(ds_gr.xradar_dev.extent(max_distance=max_gr_range))\n\np = ds_sr_ppi_mean[\"zFactorFinal_Ku\"].gpm.plot_map(cmap=cmap, vmin=10, vmax=40)\np.axes.set_extent(ds_gr.xradar_dev.extent(max_distance=max_gr_range))\n\np = ds_sr_ppi_mean[\"zFactorMeasured_Ku\"].gpm.plot_map(cmap=cmap, vmin=10, vmax=40)\np.axes.set_extent(ds_gr.xradar_dev.extent(max_distance=max_gr_range))","key":"vzYyWdVXrz"},{"type":"output","id":"EXFs1x9jpJSpHvCTGoqd4","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e1c90b02c46d9af45042e987eca90e4e","path":"/erad2024/_preview/111/build/e1c90b02c46d9af45042e987eca90e4e.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"15aa2b9c8e13b3d92d7198bf73ab5a33","path":"/erad2024/_preview/111/build/15aa2b9c8e13b3d92d7198bf73ab5a33.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"90e0c027ae94265637d64e51e7b718a0","path":"/erad2024/_preview/111/build/90e0c027ae94265637d64e51e7b718a0.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"YabQ9lAKHc"}],"key":"HgoAKLxc7S"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:06.086644Z","iopub.status.busy":"2024-09-08T06:23:06.086477Z","iopub.status.idle":"2024-09-08T06:23:06.489804Z","shell.execute_reply":"2024-09-08T06:23:06.489214Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Show difference between using Ku mean and max !\ndiff = ds_sr_ppi_max[\"zFactorFinal_Ku\"] - ds_sr_ppi_mean[\"zFactorFinal_Ku\"]\ndiff.name = \"Difference between Z max and Z mean\"\np = diff.gpm.plot_map(cmap=\"Spectral_r\")\np.axes.set_extent(ds_gr.xradar_dev.extent(max_distance=max_gr_range))","key":"cb3nWHPw22"},{"type":"output","id":"-_bAfLgqVDaKt-VNW_r5u","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"1c8e87af25575734b5fa67a09289a015","path":"/erad2024/_preview/111/build/1c8e87af25575734b5fa67a09289a015.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"DuzLrLkf3z"}],"key":"jR1GIyDTfs"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:06.491676Z","iopub.status.busy":"2024-09-08T06:23:06.491511Z","iopub.status.idle":"2024-09-08T06:23:06.926941Z","shell.execute_reply":"2024-09-08T06:23:06.926368Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Show SR mean precip rate\np = ds_sr_ppi_mean[\"precipRate\"].gpm.plot_map()\np.axes.set_extent(ds_gr.xradar_dev.extent(max_distance=max_gr_range))","key":"uZR4Idexuh"},{"type":"output","id":"2N59L-dHXu9ABm3F5xCZW","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e871c51c3acaa31bbe54f81eecbe87ab","path":"/erad2024/_preview/111/build/e871c51c3acaa31bbe54f81eecbe87ab.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"ORTxrMoTPJ"}],"key":"w5c4Mnxumd"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:06.928962Z","iopub.status.busy":"2024-09-08T06:23:06.928795Z","iopub.status.idle":"2024-09-08T06:23:07.065369Z","shell.execute_reply":"2024-09-08T06:23:07.064759Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Display reflectivity in 3D\n\nfig = plt.figure()\nax = fig.add_subplot(111, projection=\"3d\")\nax.scatter(\n    ds_sr_match[\"SR_x_mean\"].values,\n    ds_sr_match[\"SR_y_mean\"].values,\n    ds_sr_match[\"SR_z_mean\"].values,\n    c=ds_sr_match[\"SR_zFactorFinal_Ku_mean\"].values,\n    cmap=\"turbo\",\n    vmin=10,\n    vmax=40,\n    s=5,\n)","key":"f9ryuz5VVT"},{"type":"output","id":"qokk8Ovsgl5_jRoZ0MUek","data":[{"output_type":"execute_result","execution_count":73,"metadata":{},"data":{"text/plain":{"content":"\u003cmpl_toolkits.mplot3d.art3d.Path3DCollection at 0x7f2f4dc28e50\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f2a4fcb2c49a4f0397f7fd8a9952e51a","path":"/erad2024/_preview/111/build/f2a4fcb2c49a4f0397f7fd8a9952e51a.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 1 Axes\u003e","content_type":"text/plain"}}}],"key":"lwFXpWmBfB"}],"key":"USdZ8BakG2"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:07.067707Z","iopub.status.busy":"2024-09-08T06:23:07.067312Z","iopub.status.idle":"2024-09-08T06:23:07.362318Z","shell.execute_reply":"2024-09-08T06:23:07.361788Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Disply SR footprint horizontal resolution\np = ds_sr_ppi_max[\"hres\"].gpm.plot_map(cmap=\"turbo\")\np.axes.set_extent(ds_gr.xradar_dev.extent(max_distance=max_gr_range))\nplt.show()","key":"A4VcEDKgBG"},{"type":"output","id":"N7bMJigsS-6inxnYKVPSo","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a7d44dc3ceffc4bed95932e7c3e0aeaf","path":"/erad2024/_preview/111/build/a7d44dc3ceffc4bed95932e7c3e0aeaf.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"XwJiMfnTBr"}],"key":"XRLTVwIkES"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:07.364331Z","iopub.status.busy":"2024-09-08T06:23:07.364038Z","iopub.status.idle":"2024-09-08T06:23:07.644898Z","shell.execute_reply":"2024-09-08T06:23:07.644368Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Display SR depth over which data are integrated\np = ds_sr_ppi_sum[\"vres\"].gpm.plot_map(cmap=\"turbo\")\np.axes.set_extent(ds_gr.xradar_dev.extent(max_distance=max_gr_range))\nplt.show()","key":"j8VPg9itpj"},{"type":"output","id":"PZiU7a9H-X5Jn30r_ZlTj","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d6c837a0b457b5dc48c8b0e48a4b5632","path":"/erad2024/_preview/111/build/d6c837a0b457b5dc48c8b0e48a4b5632.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"w1cVWHSxH1"}],"key":"I4LzrMSOWI"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:07.646892Z","iopub.status.busy":"2024-09-08T06:23:07.646560Z","iopub.status.idle":"2024-09-08T06:23:07.933186Z","shell.execute_reply":"2024-09-08T06:23:07.932689Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Display SR volume over which data are integrated\np = ds_sr_ppi_sum[\"gate_volume\"].gpm.plot_map(cmap=\"turbo\")\np.axes.set_extent(ds_gr.xradar_dev.extent(max_distance=max_gr_range))\nplt.show()","key":"tu9JwbfpdD"},{"type":"output","id":"l8jqRjWs7MSetrchas943","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c5cccec469d9fe1be6e574d142440a3b","path":"/erad2024/_preview/111/build/c5cccec469d9fe1be6e574d142440a3b.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"Z6QeScaE3D"}],"key":"RGhJNBpthS"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:07.935384Z","iopub.status.busy":"2024-09-08T06:23:07.935026Z","iopub.status.idle":"2024-09-08T06:23:08.794356Z","shell.execute_reply":"2024-09-08T06:23:08.793892Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Display GR radar volume\np = vol_gr.xradar_dev.plot_map()\np.axes.set_extent(ds_gr.xradar_dev.extent(max_distance=max_gr_range))\nplt.show()","key":"wYZ6Z5iLF1"},{"type":"output","id":"7s6v2tupyBHK-X_Ycg3j4","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"5f3883a8a2badc6fa8728e5c59483a89","path":"/erad2024/_preview/111/build/5f3883a8a2badc6fa8728e5c59483a89.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"a61zQKjsl8"}],"key":"MhBJTJ0Uq3"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Retrieve the SR footprints polygons","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"l1Utls6SYC"}],"identifier":"retrieve-the-sr-footprints-polygons","label":"Retrieve the SR footprints polygons","html_id":"retrieve-the-sr-footprints-polygons","implicit":true,"key":"y8rvB4RdVn"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here we retrieve SR footprints polygons and then we construct a ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ouYPUblXR2"},{"type":"inlineCode","value":"geopandas.DataFrame","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ddDN516kBz"},{"type":"text","value":" with the aggregated SR reflectivities.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"tineRhVxOE"}],"key":"niSi8eMl6K"}],"key":"pC9MbMQ8uK"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:08.796557Z","iopub.status.busy":"2024-09-08T06:23:08.796193Z","iopub.status.idle":"2024-09-08T06:23:08.859982Z","shell.execute_reply":"2024-09-08T06:23:08.859405Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Retrieve SR footprint polygons (using the footprint radius in AEQD x,y coordinates)\nxy_mean_sr = np.stack([ds_sr_match[\"SR_x_mean\"], ds_sr_match[\"SR_y_mean\"]], axis=-1)\nfootprint_radius = ds_sr_match[\"SR_hres_max\"].to_numpy() / 2\nsr_poly = [Point(x, y).buffer(footprint_radius[i]) for i, (x, y) in enumerate(xy_mean_sr)]","key":"E6AnDvMKi0"},{"type":"output","id":"o2cmaivRCfQABeJCsZYb5","data":[],"key":"eNDSDqsZaR"}],"key":"nMkvTKsve3"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:08.862255Z","iopub.status.busy":"2024-09-08T06:23:08.862057Z","iopub.status.idle":"2024-09-08T06:23:08.874404Z","shell.execute_reply":"2024-09-08T06:23:08.873999Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Create geopandas DataFrame\ndf_sr_match = ds_sr_match.to_dataframe()\ngdf_sr = gpd.GeoDataFrame(df_sr_match, crs=crs_gr, geometry=sr_poly)\ngdf_sr.columns","key":"jBN37d1iDx"},{"type":"output","id":"g9ynSWwtX-1IBrI3-Ryk8","data":[{"output_type":"execute_result","execution_count":79,"metadata":{},"data":{"text/plain":{"content":"Index(['SR_counts', 'SR_counts_valid',\n       'SR_zFactorFinal_Ku_fraction_above_10dBZ',\n       'SR_zFactorFinal_Ku_fraction_above_12dBZ',\n       'SR_zFactorFinal_Ku_fraction_above_14dBZ',\n       'SR_zFactorFinal_Ku_fraction_above_16dBZ',\n       'SR_zFactorFinal_Ku_fraction_above_18dBZ',\n       'SR_zFactorFinal_S_fraction_above_10dBZ',\n       'SR_zFactorFinal_S_fraction_above_12dBZ',\n       'SR_zFactorFinal_S_fraction_above_14dBZ',\n       ...\n       'gpm_cross_track_id', 'gpm_granule_id', 'gpm_id', 'lat', 'lon',\n       'sweep_fixed_angle', 'sweep_number', 'along_track', 'cross_track',\n       'geometry'],\n      dtype='object', length=165)","content_type":"text/plain"}}}],"key":"IyxGLtegM8"}],"key":"onxBaCH0f2"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:08.876267Z","iopub.status.busy":"2024-09-08T06:23:08.876109Z","iopub.status.idle":"2024-09-08T06:23:08.878530Z","shell.execute_reply":"2024-09-08T06:23:08.878118Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Extract radar gate polygon on the range-azimuth axis\nsr_poly = np.array(gdf_sr.geometry)","key":"KBiVZvnnJR"},{"type":"output","id":"NZdjHqHuLmBONH751GmBq","data":[],"key":"TFxxd4PlFy"}],"key":"Cqiqjg5zlg"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Retrieve the GR gates polygons","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fNn5ti8eQO"}],"identifier":"retrieve-the-gr-gates-polygons","label":"Retrieve the GR gates polygons","html_id":"retrieve-the-gr-gates-polygons","implicit":true,"key":"KtIa9FABFF"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here we retrieve GR gates polygons and then we construct a ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"rYa6SfuMGL"},{"type":"inlineCode","value":"geopandas.DataFrame","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"C3g0xUkzaC"},{"type":"text","value":" containing the GR measurements.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XbeMEJ3PKv"}],"key":"cROTVHxPYM"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Currently the GR gates polygons are derived inferring the quadmesh around the GR gate centroids (using the x and y GR CRS coordinates).","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"JotohGJIcF"}],"key":"KM5PTY8x0x"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"More accurate GR gates polygons could be derived using the GR beamwidth. We welcome contributions addressing this point !","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"SZ6VtK0Ja5"}],"key":"eBgSOFJ6lY"}],"key":"hyv2W7iInv"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:08.880346Z","iopub.status.busy":"2024-09-08T06:23:08.880192Z","iopub.status.idle":"2024-09-08T06:23:10.697559Z","shell.execute_reply":"2024-09-08T06:23:10.697023Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Add variables to GR dataset\nds_gr[\"gate_volume\"] = vol_gr\nds_gr[\"vres\"] = v_res_gr\nds_gr[\"hres\"] = h_res_gr\n\n# Add path_integrated_reflectivities\nds_gr[\"Z_cumsum\"] = ds_gr[\"DBZH\"].gpm.idecibel.cumsum(\"range\").gpm.decibel\nds_gr[\"Z_cumsum\"] = ds_gr[\"Z_cumsum\"].where(np.isfinite(ds_gr[\"Z_cumsum\"]))\n\n# Mask reflectivites above minimum GR Z threshold\nmask_gr = ds_gr[\"DBZH\"] \u003e z_min_threshold_gr  # important !\n\n# Subset gates in range distance interval\nds_gr_subset = ds_gr.sel(range=slice(min_gr_range_lb, max_gr_range_ub)).where(mask_gr)\n\n# Retrieve geopandas dataframe\ngdf_gr = ds_gr_subset.xradar_dev.to_geopandas()  # here we currently infer the quadmesh using the x,y coordinates\ndisplay(gdf_gr)","key":"DNJrdE2AV6"},{"type":"output","id":"YuJT06T_G7dfZhfR4gYIY","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"\u003cdiv\u003e\n\u003cstyle scoped\u003e\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n\u003c/style\u003e\n\u003ctable border=\"1\" class=\"dataframe\"\u003e\n  \u003cthead\u003e\n    \u003ctr style=\"text-align: right;\"\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003eCCORH\u003c/th\u003e\n      \u003cth\u003eDBZH\u003c/th\u003e\n      \u003cth\u003ePHIDP\u003c/th\u003e\n      \u003cth\u003eRHOHV\u003c/th\u003e\n      \u003cth\u003eZDR\u003c/th\u003e\n      \u003cth\u003egate_volume\u003c/th\u003e\n      \u003cth\u003evres\u003c/th\u003e\n      \u003cth\u003ehres\u003c/th\u003e\n      \u003cth\u003eZ_cumsum\u003c/th\u003e\n      \u003cth\u003efollow_mode\u003c/th\u003e\n      \u003cth\u003e...\u003c/th\u003e\n      \u003cth\u003etime\u003c/th\u003e\n      \u003cth\u003ecrs_wkt\u003c/th\u003e\n      \u003cth\u003ex\u003c/th\u003e\n      \u003cth\u003ey\u003c/th\u003e\n      \u003cth\u003ez\u003c/th\u003e\n      \u003cth\u003elon\u003c/th\u003e\n      \u003cth\u003elat\u003c/th\u003e\n      \u003cth\u003erange\u003c/th\u003e\n      \u003cth\u003eazimuth\u003c/th\u003e\n      \u003cth\u003egeometry\u003c/th\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003eazimuth\u003c/th\u003e\n      \u003cth\u003erange\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003cth rowspan=\"5\" valign=\"top\"\u003e0.249939\u003c/th\u003e\n      \u003cth\u003e2125.0\u003c/th\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003enot_set\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e2023-08-20 22:13:50.577999872\u003c/td\u003e\n      \u003ctd\u003e0\u003c/td\u003e\n      \u003ctd\u003e9.269070\u003c/td\u003e\n      \u003ctd\u003e2124.819592\u003c/td\u003e\n      \u003ctd\u003e338.193914\u003c/td\u003e\n      \u003ctd\u003e-117.041702\u003c/td\u003e\n      \u003ctd\u003e32.938177\u003c/td\u003e\n      \u003ctd\u003e2125.0\u003c/td\u003e\n      \u003ctd\u003e0.249939\u003c/td\u003e\n      \u003ctd\u003ePOLYGON ((0.048 1999.906, 17.399 1999.755, 19....\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e2375.0\u003c/th\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003enot_set\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e2023-08-20 22:13:50.577999872\u003c/td\u003e\n      \u003ctd\u003e0\u003c/td\u003e\n      \u003ctd\u003e10.359546\u003c/td\u003e\n      \u003ctd\u003e2374.797765\u003c/td\u003e\n      \u003ctd\u003e340.369314\u003c/td\u003e\n      \u003ctd\u003e-117.041691\u003c/td\u003e\n      \u003ctd\u003e32.940431\u003c/td\u003e\n      \u003ctd\u003e2375.0\u003c/td\u003e\n      \u003ctd\u003e0.249939\u003c/td\u003e\n      \u003ctd\u003ePOLYGON ((0.054 2249.894, 19.574 2249.724, 21....\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e2625.0\u003c/th\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003enot_set\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e2023-08-20 22:13:50.577999872\u003c/td\u003e\n      \u003ctd\u003e0\u003c/td\u003e\n      \u003ctd\u003e11.450022\u003c/td\u003e\n      \u003ctd\u003e2624.775811\u003c/td\u003e\n      \u003ctd\u003e342.552070\u003c/td\u003e\n      \u003ctd\u003e-117.041679\u003c/td\u003e\n      \u003ctd\u003e32.942685\u003c/td\u003e\n      \u003ctd\u003e2625.0\u003c/td\u003e\n      \u003ctd\u003e0.249939\u003c/td\u003e\n      \u003ctd\u003ePOLYGON ((0.06 2499.881, 21.749 2499.692, 23.9...\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e2875.0\u003c/th\u003e\n      \u003ctd\u003e34.0\u003c/td\u003e\n      \u003ctd\u003e0.5\u003c/td\u003e\n      \u003ctd\u003e-0.352597\u003c/td\u003e\n      \u003ctd\u003e0.681667\u003c/td\u003e\n      \u003ctd\u003e-12.9375\u003c/td\u003e\n      \u003ctd\u003e4.944045e+05\u003c/td\u003e\n      \u003ctd\u003e50.179489\u003c/td\u003e\n      \u003ctd\u003e50.179489\u003c/td\u003e\n      \u003ctd\u003e3.267492\u003c/td\u003e\n      \u003ctd\u003enot_set\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e2023-08-20 22:13:50.577999872\u003c/td\u003e\n      \u003ctd\u003e0\u003c/td\u003e\n      \u003ctd\u003e12.540497\u003c/td\u003e\n      \u003ctd\u003e2874.753727\u003c/td\u003e\n      \u003ctd\u003e344.742182\u003c/td\u003e\n      \u003ctd\u003e-117.041667\u003c/td\u003e\n      \u003ctd\u003e32.944939\u003c/td\u003e\n      \u003ctd\u003e2875.0\u003c/td\u003e\n      \u003ctd\u003e0.249939\u003c/td\u003e\n      \u003ctd\u003ePOLYGON ((0.066 2749.869, 23.924 2749.661, 26....\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e3125.0\u003c/th\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003enot_set\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e2023-08-20 22:13:50.577999872\u003c/td\u003e\n      \u003ctd\u003e0\u003c/td\u003e\n      \u003ctd\u003e13.630971\u003c/td\u003e\n      \u003ctd\u003e3124.731515\u003c/td\u003e\n      \u003ctd\u003e346.939649\u003c/td\u003e\n      \u003ctd\u003e-117.041656\u003c/td\u003e\n      \u003ctd\u003e32.947193\u003c/td\u003e\n      \u003ctd\u003e3125.0\u003c/td\u003e\n      \u003ctd\u003e0.249939\u003c/td\u003e\n      \u003ctd\u003ePOLYGON ((0.072 2999.856, 26.099 2999.629, 28....\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e...\u003c/th\u003e\n      \u003cth\u003e...\u003c/th\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth rowspan=\"5\" valign=\"top\"\u003e359.758301\u003c/th\u003e\n      \u003cth\u003e148875.0\u003c/th\u003e\n      \u003ctd\u003e-8.0\u003c/td\u003e\n      \u003ctd\u003e30.5\u003c/td\u003e\n      \u003ctd\u003e0.352597\u003c/td\u003e\n      \u003ctd\u003e1.051667\u003c/td\u003e\n      \u003ctd\u003e-12.9375\u003c/td\u003e\n      \u003ctd\u003e1.325715e+09\u003c/td\u003e\n      \u003ctd\u003e2598.424805\u003c/td\u003e\n      \u003ctd\u003e2598.424805\u003c/td\u003e\n      \u003ctd\u003e53.491735\u003c/td\u003e\n      \u003ctd\u003enot_set\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e2023-08-20 22:13:50.552999936\u003c/td\u003e\n      \u003ctd\u003e0\u003c/td\u003e\n      \u003ctd\u003e-627.816405\u003c/td\u003e\n      \u003ctd\u003e148825.540792\u003c/td\u003e\n      \u003ctd\u003e2879.986614\u003c/td\u003e\n      \u003ctd\u003e-117.048617\u003c/td\u003e\n      \u003ctd\u003e34.260815\u003c/td\u003e\n      \u003ctd\u003e148875.0\u003c/td\u003e\n      \u003ctd\u003e359.758301\u003c/td\u003e\n      \u003ctd\u003ePOLYGON ((-1297.323 148694.78, 42.744 148706.4...\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e149125.0\u003c/th\u003e\n      \u003ctd\u003e-8.0\u003c/td\u003e\n      \u003ctd\u003e28.5\u003c/td\u003e\n      \u003ctd\u003e179.824400\u003c/td\u003e\n      \u003ctd\u003e1.051667\u003c/td\u003e\n      \u003ctd\u003e-12.9375\u003c/td\u003e\n      \u003ctd\u003e1.330171e+09\u003c/td\u003e\n      \u003ctd\u003e2602.788330\u003c/td\u003e\n      \u003ctd\u003e2602.788330\u003c/td\u003e\n      \u003ctd\u003e53.505473\u003c/td\u003e\n      \u003ctd\u003enot_set\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e2023-08-20 22:13:50.552999936\u003c/td\u003e\n      \u003ctd\u003e0\u003c/td\u003e\n      \u003ctd\u003e-628.870300\u003c/td\u003e\n      \u003ctd\u003e149075.369488\u003c/td\u003e\n      \u003ctd\u003e2886.478208\u003c/td\u003e\n      \u003ctd\u003e-117.048629\u003c/td\u003e\n      \u003ctd\u003e34.263068\u003c/td\u003e\n      \u003ctd\u003e149125.0\u003c/td\u003e\n      \u003ctd\u003e359.758301\u003c/td\u003e\n      \u003ctd\u003ePOLYGON ((-1299.502 148944.599, 42.816 148956....\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e149375.0\u003c/th\u003e\n      \u003ctd\u003e-8.0\u003c/td\u003e\n      \u003ctd\u003e29.0\u003c/td\u003e\n      \u003ctd\u003e-0.705194\u003c/td\u003e\n      \u003ctd\u003e0.201667\u003c/td\u003e\n      \u003ctd\u003e-13.0625\u003c/td\u003e\n      \u003ctd\u003e1.334635e+09\u003c/td\u003e\n      \u003ctd\u003e2607.151855\u003c/td\u003e\n      \u003ctd\u003e2607.151855\u003c/td\u003e\n      \u003ctd\u003e53.520836\u003c/td\u003e\n      \u003ctd\u003enot_set\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e2023-08-20 22:13:50.552999936\u003c/td\u003e\n      \u003ctd\u003e0\u003c/td\u003e\n      \u003ctd\u003e-629.924194\u003c/td\u003e\n      \u003ctd\u003e149325.197802\u003c/td\u003e\n      \u003ctd\u003e2892.977147\u003c/td\u003e\n      \u003ctd\u003e-117.048641\u003c/td\u003e\n      \u003ctd\u003e34.265320\u003c/td\u003e\n      \u003ctd\u003e149375.0\u003c/td\u003e\n      \u003ctd\u003e359.758301\u003c/td\u003e\n      \u003ctd\u003ePOLYGON ((-1301.682 149194.418, 42.888 149206....\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e149625.0\u003c/th\u003e\n      \u003ctd\u003e-8.0\u003c/td\u003e\n      \u003ctd\u003e30.5\u003c/td\u003e\n      \u003ctd\u003e-0.705194\u003c/td\u003e\n      \u003ctd\u003e0.201667\u003c/td\u003e\n      \u003ctd\u003e-13.0625\u003c/td\u003e\n      \u003ctd\u003e1.339106e+09\u003c/td\u003e\n      \u003ctd\u003e2611.515137\u003c/td\u003e\n      \u003ctd\u003e2611.515137\u003c/td\u003e\n      \u003ctd\u003e53.542444\u003c/td\u003e\n      \u003ctd\u003enot_set\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e2023-08-20 22:13:50.552999936\u003c/td\u003e\n      \u003ctd\u003e0\u003c/td\u003e\n      \u003ctd\u003e-630.978086\u003c/td\u003e\n      \u003ctd\u003e149575.025734\u003c/td\u003e\n      \u003ctd\u003e2899.483431\u003c/td\u003e\n      \u003ctd\u003e-117.048652\u003c/td\u003e\n      \u003ctd\u003e34.267572\u003c/td\u003e\n      \u003ctd\u003e149625.0\u003c/td\u003e\n      \u003ctd\u003e359.758301\u003c/td\u003e\n      \u003ctd\u003ePOLYGON ((-1303.862 149444.236, 42.959 149455....\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e149875.0\u003c/th\u003e\n      \u003ctd\u003e-8.0\u003c/td\u003e\n      \u003ctd\u003e28.0\u003c/td\u003e\n      \u003ctd\u003e-0.705194\u003c/td\u003e\n      \u003ctd\u003e0.201667\u003c/td\u003e\n      \u003ctd\u003e-13.0625\u003c/td\u003e\n      \u003ctd\u003e1.343585e+09\u003c/td\u003e\n      \u003ctd\u003e2615.878662\u003c/td\u003e\n      \u003ctd\u003e2615.878662\u003c/td\u003e\n      \u003ctd\u003e53.554548\u003c/td\u003e\n      \u003ctd\u003enot_set\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e2023-08-20 22:13:50.552999936\u003c/td\u003e\n      \u003ctd\u003e0\u003c/td\u003e\n      \u003ctd\u003e-632.031977\u003c/td\u003e\n      \u003ctd\u003e149824.853283\u003c/td\u003e\n      \u003ctd\u003e2905.997060\u003c/td\u003e\n      \u003ctd\u003e-117.048664\u003c/td\u003e\n      \u003ctd\u003e34.269824\u003c/td\u003e\n      \u003ctd\u003e149875.0\u003c/td\u003e\n      \u003ctd\u003e359.758301\u003c/td\u003e\n      \u003ctd\u003ePOLYGON ((-1306.041 149694.054, 43.031 149705....\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e426240 rows × 28 columns\u003c/p\u003e\n\u003c/div\u003e","content_type":"text/html"},"text/plain":{"content":"                     CCORH  DBZH       PHIDP     RHOHV      ZDR   gate_volume  \\\nazimuth    range                                                                \n0.249939   2125.0      NaN   NaN         NaN       NaN      NaN           NaN   \n           2375.0      NaN   NaN         NaN       NaN      NaN           NaN   \n           2625.0      NaN   NaN         NaN       NaN      NaN           NaN   \n           2875.0     34.0   0.5   -0.352597  0.681667 -12.9375  4.944045e+05   \n           3125.0      NaN   NaN         NaN       NaN      NaN           NaN   \n...                    ...   ...         ...       ...      ...           ...   \n359.758301 148875.0   -8.0  30.5    0.352597  1.051667 -12.9375  1.325715e+09   \n           149125.0   -8.0  28.5  179.824400  1.051667 -12.9375  1.330171e+09   \n           149375.0   -8.0  29.0   -0.705194  0.201667 -13.0625  1.334635e+09   \n           149625.0   -8.0  30.5   -0.705194  0.201667 -13.0625  1.339106e+09   \n           149875.0   -8.0  28.0   -0.705194  0.201667 -13.0625  1.343585e+09   \n\n                            vres         hres   Z_cumsum follow_mode  ...  \\\nazimuth    range                                                      ...   \n0.249939   2125.0            NaN          NaN        NaN     not_set  ...   \n           2375.0            NaN          NaN        NaN     not_set  ...   \n           2625.0            NaN          NaN        NaN     not_set  ...   \n           2875.0      50.179489    50.179489   3.267492     not_set  ...   \n           3125.0            NaN          NaN        NaN     not_set  ...   \n...                          ...          ...        ...         ...  ...   \n359.758301 148875.0  2598.424805  2598.424805  53.491735     not_set  ...   \n           149125.0  2602.788330  2602.788330  53.505473     not_set  ...   \n           149375.0  2607.151855  2607.151855  53.520836     not_set  ...   \n           149625.0  2611.515137  2611.515137  53.542444     not_set  ...   \n           149875.0  2615.878662  2615.878662  53.554548     not_set  ...   \n\n                                             time  crs_wkt           x  \\\nazimuth    range                                                         \n0.249939   2125.0   2023-08-20 22:13:50.577999872        0    9.269070   \n           2375.0   2023-08-20 22:13:50.577999872        0   10.359546   \n           2625.0   2023-08-20 22:13:50.577999872        0   11.450022   \n           2875.0   2023-08-20 22:13:50.577999872        0   12.540497   \n           3125.0   2023-08-20 22:13:50.577999872        0   13.630971   \n...                                           ...      ...         ...   \n359.758301 148875.0 2023-08-20 22:13:50.552999936        0 -627.816405   \n           149125.0 2023-08-20 22:13:50.552999936        0 -628.870300   \n           149375.0 2023-08-20 22:13:50.552999936        0 -629.924194   \n           149625.0 2023-08-20 22:13:50.552999936        0 -630.978086   \n           149875.0 2023-08-20 22:13:50.552999936        0 -632.031977   \n\n                                 y            z         lon        lat  \\\nazimuth    range                                                         \n0.249939   2125.0      2124.819592   338.193914 -117.041702  32.938177   \n           2375.0      2374.797765   340.369314 -117.041691  32.940431   \n           2625.0      2624.775811   342.552070 -117.041679  32.942685   \n           2875.0      2874.753727   344.742182 -117.041667  32.944939   \n           3125.0      3124.731515   346.939649 -117.041656  32.947193   \n...                            ...          ...         ...        ...   \n359.758301 148875.0  148825.540792  2879.986614 -117.048617  34.260815   \n           149125.0  149075.369488  2886.478208 -117.048629  34.263068   \n           149375.0  149325.197802  2892.977147 -117.048641  34.265320   \n           149625.0  149575.025734  2899.483431 -117.048652  34.267572   \n           149875.0  149824.853283  2905.997060 -117.048664  34.269824   \n\n                        range     azimuth  \\\nazimuth    range                            \n0.249939   2125.0      2125.0    0.249939   \n           2375.0      2375.0    0.249939   \n           2625.0      2625.0    0.249939   \n           2875.0      2875.0    0.249939   \n           3125.0      3125.0    0.249939   \n...                       ...         ...   \n359.758301 148875.0  148875.0  359.758301   \n           149125.0  149125.0  359.758301   \n           149375.0  149375.0  359.758301   \n           149625.0  149625.0  359.758301   \n           149875.0  149875.0  359.758301   \n\n                                                              geometry  \nazimuth    range                                                        \n0.249939   2125.0    POLYGON ((0.048 1999.906, 17.399 1999.755, 19....  \n           2375.0    POLYGON ((0.054 2249.894, 19.574 2249.724, 21....  \n           2625.0    POLYGON ((0.06 2499.881, 21.749 2499.692, 23.9...  \n           2875.0    POLYGON ((0.066 2749.869, 23.924 2749.661, 26....  \n           3125.0    POLYGON ((0.072 2999.856, 26.099 2999.629, 28....  \n...                                                                ...  \n359.758301 148875.0  POLYGON ((-1297.323 148694.78, 42.744 148706.4...  \n           149125.0  POLYGON ((-1299.502 148944.599, 42.816 148956....  \n           149375.0  POLYGON ((-1301.682 149194.418, 42.888 149206....  \n           149625.0  POLYGON ((-1303.862 149444.236, 42.959 149455....  \n           149875.0  POLYGON ((-1306.041 149694.054, 43.031 149705....  \n\n[426240 rows x 28 columns]","content_type":"text/plain"}}}],"key":"tBAmpPqFQ8"}],"key":"bVAvdvCNlx"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:10.699800Z","iopub.status.busy":"2024-09-08T06:23:10.699498Z","iopub.status.idle":"2024-09-08T06:23:10.705412Z","shell.execute_reply":"2024-09-08T06:23:10.704889Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Extract radar gate polygon on the range-azimuth axis\ngr_poly = np.array(gdf_gr.geometry)","key":"IDCVy5ZZ3i"},{"type":"output","id":"Y23vCy_kRj2olpz8aOSS0","data":[],"key":"ykDoQJFXF0"}],"key":"PePA0jXOiQ"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Aggregate GR data on SR footprints","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"puvHOb8HyB"}],"identifier":"aggregate-gr-data-on-sr-footprints","label":"Aggregate GR data on SR footprints","html_id":"aggregate-gr-data-on-sr-footprints","implicit":true,"key":"pCrndSKbKV"}],"key":"jwM0Zwgenr"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"To aggregate GR radar gates onto SR beam polygon footprints, we will use the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"r9x4zDF6hT"},{"type":"inlineCode","value":"PolyAggregator","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mN6BAbX2xw"},{"type":"text","value":".\nThe ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"z6i4jne9Lu"},{"type":"inlineCode","value":"PolyAggregator","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PkKw2vVLe1"},{"type":"text","value":" enable custom aggregation of source (GR) polygons data intesecting the target (SR) polygons.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MSDXDOdkXi"}],"key":"LRp9JpZshv"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"When aggregating the data, you can use a combination of weighting schemes\nBy default, ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"kX176h4A8x"},{"type":"inlineCode","value":"PolyAggregator","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"bfckrm7niN"},{"type":"text","value":" applies ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"mvv68T7MO4"},{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"area_weighting","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Nqwhu1goB4"}],"key":"nwmEIxsQRB"},{"type":"text","value":", which assigns weights based on the proportion of\nsource polygon area that intersects the target polygon.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"UQUg4Gh1cE"}],"key":"vXIJQuIlqf"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Custom Weighting Schemes","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"Vl9j69sXrV"}],"key":"SfaTw6qVt9"}],"key":"Nmb7SE7qk3"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Several additional weighting schemes can be utilized, typically derived as a function of the horizontal distance between the centroids of the source and target polygons. Examples include:","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"S4IAcdYzNr"}],"key":"M8rkDlZcYC"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"strong","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Inverse Distance Weighting","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"PthU5ndEo7"}],"key":"BGtuec3AGD"},{"type":"text","value":": ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"aWrT6jEUsv"},{"type":"inlineMath","value":"\\text{weights} = \\frac{1}{\\text{dist}^{\\text{order}}}","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmtext\u003eweights\u003c/mtext\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmfrac\u003e\u003cmn\u003e1\u003c/mn\u003e\u003cmsup\u003e\u003cmtext\u003edist\u003c/mtext\u003e\u003cmtext\u003eorder\u003c/mtext\u003e\u003c/msup\u003e\u003c/mfrac\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\text{weights} = \\frac{1}{\\text{dist}^{\\text{order}}}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eweights\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.2414em;vertical-align:-0.3963em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8451em;\"\u003e\u003cspan style=\"top:-2.6037em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord text mtight\"\u003e\u003cspan class=\"mord mtight\"\u003edist\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8376em;\"\u003e\u003cspan style=\"top:-2.8416em;margin-right:0.0714em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.5em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size3 size1 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord text mtight\"\u003e\u003cspan class=\"mord mtight\"\u003eorder\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.394em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3963em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"p825laaq9O"}],"key":"ImixDsJlje"}],"key":"Tw6YwFosty"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"strong","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Barnes Gaussian Weighting","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"XH46jkeNjK"}],"key":"RrPV5w3qoz"},{"type":"text","value":": ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"GtADEWYiXE"},{"type":"inlineMath","value":"\\text{weights} = \\exp\\left(-\\frac{\\text{dist}^2}{\\kappa^2}\\right)","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmtext\u003eweights\u003c/mtext\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmi\u003eexp\u003c/mi\u003e\u003cmo\u003e⁡\u003c/mo\u003e\u003cmrow\u003e\u003cmo fence=\"true\"\u003e(\u003c/mo\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmfrac\u003e\u003cmsup\u003e\u003cmtext\u003edist\u003c/mtext\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msup\u003e\u003cmsup\u003e\u003cmi\u003eκ\u003c/mi\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msup\u003e\u003c/mfrac\u003e\u003cmo fence=\"true\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\text{weights} = \\exp\\left(-\\frac{\\text{dist}^2}{\\kappa^2}\\right)\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eweights\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.8em;vertical-align:-0.65em;\"\u003e\u003c/span\u003e\u003cspan class=\"mop\"\u003eexp\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"minner\"\u003e\u003cspan class=\"mopen delimcenter\" style=\"top:0em;\"\u003e\u003cspan class=\"delimsizing size2\"\u003e(\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e−\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.0179em;\"\u003e\u003cspan style=\"top:-2.655em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003eκ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7463em;\"\u003e\u003cspan style=\"top:-2.786em;margin-right:0.0714em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.5em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size3 size1 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.394em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord text mtight\"\u003e\u003cspan class=\"mord mtight\"\u003edist\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8913em;\"\u003e\u003cspan style=\"top:-2.931em;margin-right:0.0714em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.5em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size3 size1 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.345em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose delimcenter\" style=\"top:0em;\"\u003e\u003cspan class=\"delimsizing size2\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"EBuiYmrBQD"}],"key":"LkzI9M4ExT"}],"key":"GPG00W4Eo5"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"strong","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Cressman Weighting","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"nrNweis4C4"}],"key":"YSu4755ygs"},{"type":"text","value":": ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"lr23GRLNT1"},{"type":"inlineMath","value":"\\text{weights} = \\frac{\\text{max\\_distance}^2 - \\text{dist}^2}{\\text{max\\_distance}^2 + \\text{dist}^2}","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmtext\u003eweights\u003c/mtext\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmfrac\u003e\u003cmrow\u003e\u003cmsup\u003e\u003cmtext\u003emax_distance\u003c/mtext\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msup\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmsup\u003e\u003cmtext\u003edist\u003c/mtext\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msup\u003e\u003c/mrow\u003e\u003cmrow\u003e\u003cmsup\u003e\u003cmtext\u003emax_distance\u003c/mtext\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msup\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmsup\u003e\u003cmtext\u003edist\u003c/mtext\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msup\u003e\u003c/mrow\u003e\u003c/mfrac\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\text{weights} = \\frac{\\text{max\\_distance}^2 - \\text{dist}^2}{\\text{max\\_distance}^2 + \\text{dist}^2}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eweights\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.7392em;vertical-align:-0.5883em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.1509em;\"\u003e\u003cspan style=\"top:-2.6287em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord text mtight\"\u003e\u003cspan class=\"mord mtight\"\u003emax_distance\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8019em;\"\u003e\u003cspan style=\"top:-2.8416em;margin-right:0.0714em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.5em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size3 size1 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mbin mtight\"\u003e+\u003c/span\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord text mtight\"\u003e\u003cspan class=\"mord mtight\"\u003edist\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8019em;\"\u003e\u003cspan style=\"top:-2.8416em;margin-right:0.0714em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.5em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size3 size1 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.527em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord text mtight\"\u003e\u003cspan class=\"mord mtight\"\u003emax_distance\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8913em;\"\u003e\u003cspan style=\"top:-2.931em;margin-right:0.0714em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.5em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size3 size1 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mbin mtight\"\u003e−\u003c/span\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord text mtight\"\u003e\u003cspan class=\"mord mtight\"\u003edist\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8913em;\"\u003e\u003cspan style=\"top:-2.931em;margin-right:0.0714em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.5em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size3 size1 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.5883em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"IFIb0hS9CR"}],"key":"pImD8wox03"}],"key":"bUSq9TyhNo"}],"key":"deOOV45Hp5"},{"type":"paragraph","position":{"start":{"line":18,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"For example, the Barnes Gaussian Distance Weighting Scheme weights values proportionally to the distance measured from the center of the SR footprint to the center of the GR radar gate. This approach can partially account  for the nonuniform distribution of\npower within the SR beam.","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"SYt6qwJnuB"}],"key":"erckA00IPV"},{"type":"paragraph","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Custom weights can however also be passed to ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"EQonOUCN4s"},{"type":"inlineCode","value":"PolyAggregator","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"OVAyeQ3NzU"},{"type":"text","value":", which will automatically handle normalization.","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"ojCytoTSAU"}],"key":"hlwe75Jmdr"},{"type":"paragraph","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"In the context of SR/GR matching, it may be beneficial to adopt a ","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"geeHV4OMaB"},{"type":"strong","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"Volume Weighting Scheme","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"Wwaw696VI7"}],"key":"Cmt3xihRkZ"},{"type":"text","value":", using the volumes of GR radar gates as weights so that larger volumes are weighted more heavily.","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"rIaAcNlKMr"}],"key":"ybrUBmDYiK"}],"key":"rRUQVevjwC"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In the code here below, we currently apply only the Area Weighting Scheme:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"v9uU0M6NSA"}],"key":"ucuOxSVIio"}],"key":"n6KUslNEra"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:10.707708Z","iopub.status.busy":"2024-09-08T06:23:10.707418Z","iopub.status.idle":"2024-09-08T06:23:10.955864Z","shell.execute_reply":"2024-09-08T06:23:10.955389Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Define PolyAggregator\naggregator = PolyAggregator(source_polygons=gr_poly, target_polygons=sr_poly)","key":"MJJ5fsU7Iz"},{"type":"output","id":"xzD3NbV0cBicLSAlVvWfA","data":[],"key":"T8tQyAeZwS"}],"key":"tXc1FDaCx9"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:10.958170Z","iopub.status.busy":"2024-09-08T06:23:10.957840Z","iopub.status.idle":"2024-09-08T06:23:15.176629Z","shell.execute_reply":"2024-09-08T06:23:15.176083Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Aggregate GR reflecitvities and compute statistics\n# - Timestep of acquisition\ntime_gr = aggregator.first(values=gdf_gr[\"time\"])\n\n# - Total number of gates aggregated\ncounts = aggregator.counts()\ncounts_valid = aggregator.apply(lambda x, weights: np.sum(~np.isnan(x)), values=gdf_gr[\"DBZH\"])  # noqa\n\n# - Total gate volume\nsum_vol = aggregator.sum(values=gdf_gr[\"gate_volume\"])\n\n# - Fraction of SR area covered\nfraction_covered_area = aggregator.fraction_covered_area()\n\n# - Reflectivity statistics\nz_mean = wrl.trafo.decibel(aggregator.average(values=wrl.trafo.idecibel(gdf_gr[\"DBZH\"])))\nz_std = wrl.trafo.decibel(aggregator.std(values=wrl.trafo.idecibel(gdf_gr[\"DBZH\"])))\nz_std[np.isinf(z_std)] = 0  # If only 1 value, std=0, log transform become -inf --\u003e Set to 0\nz_max = aggregator.max(values=gdf_gr[\"DBZH\"])\nz_min = aggregator.min(values=gdf_gr[\"DBZH\"])\nz_range = z_max - z_min\nz_cov = z_std / z_mean  # coefficient of variation","key":"abpaM5uNCG"},{"type":"output","id":"4UK4PXMyGUjKdaO4akuJ0","data":[],"key":"HZxilyk8Nl"}],"key":"hXwBWzWfCh"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we create a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dLVKivjYIb"},{"type":"inlineCode","value":"geopandas.DataFrame","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"g0EpdEM8KA"},{"type":"text","value":" with aggregated GR statistics:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dKYdOPcaCA"}],"key":"EK0OpGEAbO"}],"key":"Ldb6mbzak2"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:15.179166Z","iopub.status.busy":"2024-09-08T06:23:15.178750Z","iopub.status.idle":"2024-09-08T06:23:18.266216Z","shell.execute_reply":"2024-09-08T06:23:18.265642Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Create DataFrame with GR matched statistics\ndf = pd.DataFrame(\n    {\n        \"GR_Z_mean\": z_mean,\n        \"GR_Z_std\": z_std,\n        \"GR_Z_max\": z_max,\n        \"GR_Z_min\": z_min,\n        \"GR_Z_range\": z_range,\n        \"GR_Z_cov\": z_cov,\n        \"GR_time\": time_gr,\n        \"GR_gate_volume_sum\": sum_vol,\n        \"GR_fraction_covered_area\": fraction_covered_area,\n        \"GR_counts\": counts,\n        \"GR_counts_valid\": counts_valid,\n    },\n    index=gdf_sr.index,\n)\ngdf_gr_match = gpd.GeoDataFrame(df, crs=crs_gr, geometry=aggregator.target_polygons)\ngdf_gr_match.head()\n\n# Add GR range statistics\ngdf_gr_match[\"GR_range_max\"] = aggregator.max(values=gdf_gr[\"range\"])\ngdf_gr_match[\"GR_range_mean\"] = aggregator.mean(values=gdf_gr[\"range\"])\ngdf_gr_match[\"GR_range_min\"] = aggregator.min(values=gdf_gr[\"range\"])\n\n# Fraction above sensitivity thresholds\ngr_sensitivity_thresholds = [8, 10, 12, 14, 16, 18]\nfor thr in sr_sensitivity_thresholds:\n    fraction = aggregator.apply(lambda x, weights: np.sum(x \u003e thr), values=gdf_gr[\"DBZH\"]) / counts  # noqa\n    gdf_gr_match[f\"GR_Z_fraction_above_{thr}dBZ\"] = fraction\n\n# Compute further aggregation statistics\nstats_var = [\"vres\", \"hres\", \"x\", \"y\", \"z\", \"Z_cumsum\"]\nfor var in stats_var:\n    gdf_gr_match[f\"GR_{var}_mean\"] = aggregator.average(values=gdf_gr[var])\n    gdf_gr_match[f\"GR_{var}_min\"] = aggregator.min(values=gdf_gr[var])\n    gdf_gr_match[f\"GR_{var}_max\"] = aggregator.max(values=gdf_gr[var])\n    gdf_gr_match[f\"GR_{var}_std\"] = aggregator.std(values=gdf_gr[var])\n    gdf_gr_match[f\"GR_{var}_range\"] = gdf_gr_match[f\"GR_{var}_max\"] - gdf_gr_match[f\"GR_{var}_min\"]\n\n# Compute horizontal distance between centroids\nfunc_dict = {\"min\": np.min, \"mean\": np.mean, \"max\": np.max}\nfor suffix, func in func_dict.items():\n    arr = np.zeros(aggregator.n_target_polygons) * np.nan\n    arr[aggregator.target_intersecting_indices] = np.array(\n        [func(dist) for i, dist in aggregator.dict_distances.items()],\n    )\n    gdf_gr_match[f\"distance_horizontal_{suffix}\"] = arr","key":"OKw2lBjvJF"},{"type":"output","id":"R11jNprlZX9iBkPNiogvl","data":[],"key":"aLSR3m1pXL"}],"key":"t6fYEa2cdt"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TD01YFgBER"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"To compute custom statistics, you can use the following approaches. Remember that the function must have the ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"nasA4xqUk6"},{"type":"inlineCode","value":"values","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"x9VYYPYRxx"},{"type":"text","value":" and ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"rvfYnjpLpT"},{"type":"inlineCode","value":"weights","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"KeuAtFveT9"},{"type":"text","value":" arguments. Add the ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"BuLe9H90rz"},{"type":"inlineCode","value":"weights","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"er59fAe3Dg"},{"type":"text","value":" argument also if they are not used in your function !","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"R0eyFZbupD"}],"key":"zmXIv4eAmN"}],"key":"ojLWsYSlMS"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:18.268571Z","iopub.status.busy":"2024-09-08T06:23:18.268409Z","iopub.status.idle":"2024-09-08T06:23:18.429142Z","shell.execute_reply":"2024-09-08T06:23:18.428686Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"def weighted_mean(values, weights):\n    return np.average(values, weights=weights)\n\n\naggregated_values = aggregator.apply(weighted_mean, values=gdf_gr[\"DBZH\"], area_weighting=True)\naggregated_values = aggregator.apply(\n    lambda x, weights: np.average(x, weights=weights),\n    values=gdf_gr[\"DBZH\"],\n    area_weighting=True,\n)","key":"DFdN8L2gVw"},{"type":"output","id":"J2sZfLds9YMjFaO7oO2Wm","data":[],"key":"mqxmrMr2yN"}],"key":"yfDQJcT7zD"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here below we compare the usage of Inverse Distance Weighting, Barnes Gaussian Distance Weighting, Cressman Weighting, and Volume Weighting.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pR46XZZY4W"}],"key":"JoYGPyalmz"}],"key":"rdNUJHzfyk"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:18.431262Z","iopub.status.busy":"2024-09-08T06:23:18.431095Z","iopub.status.idle":"2024-09-08T06:23:18.935421Z","shell.execute_reply":"2024-09-08T06:23:18.934861Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"from gpm.utils.zonal_stats import BarnesGaussianWeights, CressmanWeights, InverseDistanceWeights, PolyAggregator\n\ngdf_gr_match1 = gdf_gr_match.copy()\n\n# Weighted by intersection area\ngdf_gr_match1[\"GR_Z_area\"] = aggregator.mean(values=gdf_gr[\"DBZH\"], area_weighting=True)\n\n# Weighted by ntersection area and Inverse Distance Weighting\ngdf_gr_match1[\"GR_Z_idw\"] = aggregator.mean(\n    values=gdf_gr[\"DBZH\"],\n    area_weighting=True,\n    distance_weighting=InverseDistanceWeights(order=1),\n)\n# Weighted by intersection area and Cressman Weighting\ngdf_gr_match1[\"GR_Z_cressman\"] = aggregator.mean(\n    values=gdf_gr[\"DBZH\"],\n    area_weighting=True,\n    distance_weighting=CressmanWeights(max_distance=2000),\n)\n# Weighted by intersection area and Barnes Gaussian Weighting (kappa=SR_hres_mean)\ngdf_gr_match1[\"GR_Z_barnes\"] = aggregator.mean(\n    values=gdf_gr[\"DBZH\"],\n    area_weighting=True,\n    distance_weighting=BarnesGaussianWeights(kappa=gdf_sr[\"SR_hres_mean\"]),\n)\n# Weighted Barnes Gaussian Weighting (kappa=SR_radius_mean)\ngdf_gr_match1[\"GR_Z_barnes_without_area\"] = aggregator.mean(\n    values=gdf_gr[\"DBZH\"],\n    area_weighting=False,\n    distance_weighting=BarnesGaussianWeights(kappa=gdf_sr[\"SR_hres_mean\"]),\n)\n# Weighted by intersection area and by GR volume\ngdf_gr_match1[\"GR_Z_volume\"] = aggregator.mean(\n    values=gdf_gr[\"DBZH\"],\n    weights=gdf_gr[\"gate_volume\"],\n    area_weighting=True,\n)","key":"dBE03n0ePd"},{"type":"output","id":"BBW7JSvt32hbROY_Iydoz","data":[],"key":"v2y0iaqBOo"}],"key":"c77DICZ38I"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:18.937779Z","iopub.status.busy":"2024-09-08T06:23:18.937375Z","iopub.status.idle":"2024-09-08T06:23:20.264896Z","shell.execute_reply":"2024-09-08T06:23:20.264382Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"gdf_gr_match1.plot(column=\"GR_Z_area\", legend=True, cmap=\"Spectral_r\", vmin=0, vmax=40)\ngdf_gr_match1.plot(column=\"GR_Z_idw\", legend=True, cmap=\"Spectral_r\", vmin=0, vmax=40)\ngdf_gr_match1.plot(column=\"GR_Z_cressman\", legend=True, cmap=\"Spectral_r\", vmin=0, vmax=40)\ngdf_gr_match1.plot(column=\"GR_Z_barnes\", legend=True, cmap=\"Spectral_r\", vmin=0, vmax=40)\ngdf_gr_match1.plot(column=\"GR_Z_volume\", legend=True, cmap=\"Spectral_r\", vmin=0, vmax=40)","key":"stWctp5a96"},{"type":"output","id":"R0-jw224UTk41s2FLpZMP","data":[{"output_type":"execute_result","execution_count":88,"metadata":{},"data":{"text/plain":{"content":"\u003cAxes: \u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"1883f4ede0d060971383474643d71d98","path":"/erad2024/_preview/111/build/1883f4ede0d060971383474643d71d98.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3e9b32d83862aebb6578a43169a00a5e","path":"/erad2024/_preview/111/build/3e9b32d83862aebb6578a43169a00a5e.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7c544faa42541fe30440c5f76273a08d","path":"/erad2024/_preview/111/build/7c544faa42541fe30440c5f76273a08d.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d85724d9afe65ad1b4f44716bc7adba3","path":"/erad2024/_preview/111/build/d85724d9afe65ad1b4f44716bc7adba3.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"fac5ecd8c38e23441a8f088baf59fabb","path":"/erad2024/_preview/111/build/fac5ecd8c38e23441a8f088baf59fabb.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"qwidtNdktk"}],"key":"wsdDqTbpEu"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:20.267117Z","iopub.status.busy":"2024-09-08T06:23:20.266656Z","iopub.status.idle":"2024-09-08T06:23:20.533614Z","shell.execute_reply":"2024-09-08T06:23:20.533109Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Impact of Barnes with and without area-weighting\ngdf_gr_match1[\"DIFF_Barnes_Without_Area\"] = gdf_gr_match1[\"GR_Z_barnes\"] - gdf_gr_match1[\"GR_Z_barnes_without_area\"]\ngdf_gr_match1.plot(column=\"DIFF_Barnes_Without_Area\", legend=True, cmap=\"Spectral_r\", vmin=-0.25, vmax=0.25)","key":"aza7ub1od6"},{"type":"output","id":"COMYNxNYemv9rj_ak1EHc","data":[{"output_type":"execute_result","execution_count":89,"metadata":{},"data":{"text/plain":{"content":"\u003cAxes: \u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"175dbd9f3e5a20a35f93368e91530e23","path":"/erad2024/_preview/111/build/175dbd9f3e5a20a35f93368e91530e23.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"Nw3NbdKlyH"}],"key":"qFXUcGvf9M"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:20.536858Z","iopub.status.busy":"2024-09-08T06:23:20.535948Z","iopub.status.idle":"2024-09-08T06:23:20.864255Z","shell.execute_reply":"2024-09-08T06:23:20.863783Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Impact of Barnes with area-weighting and default area weighting\ngdf_gr_match1[\"DIFF_Barnes_Naive\"] = gdf_gr_match1[\"GR_Z_area\"] - gdf_gr_match1[\"GR_Z_barnes\"]\ngdf_gr_match1.plot(column=\"DIFF_Barnes_Naive\", legend=True, cmap=\"Spectral_r\", vmin=-0.25, vmax=0.25)","key":"eSZedN3P4U"},{"type":"output","id":"JF4kRqm5Taj6m4PmborPm","data":[{"output_type":"execute_result","execution_count":90,"metadata":{},"data":{"text/plain":{"content":"\u003cAxes: \u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c8336c86f68570368f8ff4314d7c2602","path":"/erad2024/_preview/111/build/c8336c86f68570368f8ff4314d7c2602.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"MWgkoc8fRv"}],"key":"LN0Cntf0no"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Create the SR/GR Database","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yveptbHCPM"}],"identifier":"create-the-sr-gr-database","label":"Create the SR/GR Database","html_id":"create-the-sr-gr-database","implicit":true,"key":"Oy7dw4ybc5"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Let’s back to our main task and merge SR/GR aggregated variables into an unique database:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TCmtN8EkAY"}],"key":"QXUIhztrog"}],"key":"atEDZxqIXt"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:20.867487Z","iopub.status.busy":"2024-09-08T06:23:20.866680Z","iopub.status.idle":"2024-09-08T06:23:20.911324Z","shell.execute_reply":"2024-09-08T06:23:20.910842Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Create DataFrame with matched variables\ngdf_match = gdf_gr_match.merge(gdf_sr, on=\"geometry\")\n\n# Compute ratio SR/GR volume\ngdf_match[\"VolumeRatio\"] = gdf_match[\"SR_gate_volume_sum\"] / gdf_match[\"GR_gate_volume_sum\"]\n\n# Compute difference in SR/GR gate volume\ngdf_match[\"VolumeDiff\"] = gdf_match[\"SR_gate_volume_sum\"] - gdf_match[\"GR_gate_volume_sum\"]\n\n# Compute time difference [in seconds]\ngdf_match[\"time_difference\"] = gdf_match[\"GR_time\"] - gdf_match[\"SR_time\"]\ngdf_match[\"time_difference\"] = gdf_match[\"time_difference\"].dt.total_seconds().astype(int)\n\n# Compute lower bound and upper bound height\ngdf_match[\"GR_z_lower_bound\"] = gdf_match[\"GR_z_min\"] - gdf_match[\"GR_vres_mean\"] / 2\ngdf_match[\"GR_z_upper_bound\"] = gdf_match[\"GR_z_max\"] + gdf_match[\"GR_vres_mean\"] / 2\n\ngdf_match[\"SR_z_lower_bound\"] = gdf_match[\"SR_z_min\"] - gdf_match[\"SR_vres_mean\"] / 2\ngdf_match[\"SR_z_upper_bound\"] = gdf_match[\"SR_z_max\"] + gdf_match[\"SR_vres_mean\"] / 2","key":"wF6G5aI6n7"},{"type":"output","id":"u1Hihyu-ROEFoOUZxd780","data":[],"key":"cQ9tDW8PBF"}],"key":"psRQNVrD89"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Analyse the SR/GR Database","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mZFzIE2Dx3"}],"identifier":"analyse-the-sr-gr-database","label":"Analyse the SR/GR Database","html_id":"analyse-the-sr-gr-database","implicit":true,"key":"BQmMgZwMpY"}],"key":"R4ojm9JB9F"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:20.914780Z","iopub.status.busy":"2024-09-08T06:23:20.913986Z","iopub.status.idle":"2024-09-08T06:23:21.835344Z","shell.execute_reply":"2024-09-08T06:23:21.834837Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Show fraction SR footprint horizontal area covered by GR\ngdf_match.plot(column=\"GR_fraction_covered_area\", legend=True, cmap=\"Spectral_r\")\n\n# Show ratio SR/GR volume\ngdf_match.plot(column=\"VolumeRatio\", legend=True, cmap=\"Spectral_r\")\n\n# Show difference in total gate volume\ngdf_match.plot(column=\"VolumeDiff\", legend=True, cmap=\"Spectral_r\")","key":"K3hnMv3kr8"},{"type":"output","id":"H7raC87MYmDHfw9BXD1T_","data":[{"output_type":"execute_result","execution_count":92,"metadata":{},"data":{"text/plain":{"content":"\u003cAxes: \u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"bb168e7d2a7efebc53d9b853f46f01a6","path":"/erad2024/_preview/111/build/bb168e7d2a7efebc53d9b853f46f01a6.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2ac7ef42d53a9e6e51c9f9d4b1da597c","path":"/erad2024/_preview/111/build/2ac7ef42d53a9e6e51c9f9d4b1da597c.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6ba21816ec767d08cb16be4842c1fd11","path":"/erad2024/_preview/111/build/6ba21816ec767d08cb16be4842c1fd11.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"pA2ephLfbA"}],"key":"ZhpLOtruny"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:21.838566Z","iopub.status.busy":"2024-09-08T06:23:21.837773Z","iopub.status.idle":"2024-09-08T06:23:22.852657Z","shell.execute_reply":"2024-09-08T06:23:22.852134Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"gdf_gr_match.plot(column=\"distance_horizontal_max\", legend=True, cmap=\"Spectral_r\")\ngdf_gr_match.plot(column=\"distance_horizontal_mean\", legend=True, cmap=\"Spectral_r\")\ngdf_gr_match.plot(column=\"distance_horizontal_min\", legend=True, cmap=\"Spectral_r\")","key":"Lvobztrs8h"},{"type":"output","id":"mpbHiVh82hPxW9yAMOsDh","data":[{"output_type":"execute_result","execution_count":93,"metadata":{},"data":{"text/plain":{"content":"\u003cAxes: \u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0cd31e3f1436ff9e49e5e88873a39f08","path":"/erad2024/_preview/111/build/0cd31e3f1436ff9e49e5e88873a39f08.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3efce0b832df24c69faa2f1114d8d64c","path":"/erad2024/_preview/111/build/3efce0b832df24c69faa2f1114d8d64c.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ace3c0a92113565c7debca9753c22b54","path":"/erad2024/_preview/111/build/ace3c0a92113565c7debca9753c22b54.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"fkuPA0tjcs"}],"key":"FOZq2zkEpo"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:22.855933Z","iopub.status.busy":"2024-09-08T06:23:22.855122Z","iopub.status.idle":"2024-09-08T06:23:23.883317Z","shell.execute_reply":"2024-09-08T06:23:23.882837Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Analyse variations in gate resolution\ngdf_match.plot(column=\"GR_vres_mean\", legend=True, cmap=\"Spectral_r\")\ngdf_match.plot(column=\"SR_vres_mean\", legend=True, cmap=\"Spectral_r\")","key":"dlAAJ2LJu2"},{"type":"output","id":"1I9leRnzgZeU57wuiEAR4","data":[{"output_type":"execute_result","execution_count":94,"metadata":{},"data":{"text/plain":{"content":"\u003cAxes: \u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"327b2a0530263a19910b2aa40f88b860","path":"/erad2024/_preview/111/build/327b2a0530263a19910b2aa40f88b860.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e12bd9a3955ccb92183fcb44b1903ba3","path":"/erad2024/_preview/111/build/e12bd9a3955ccb92183fcb44b1903ba3.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"xZGrzwMdUh"}],"key":"g79oljPxpi"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:23.886492Z","iopub.status.busy":"2024-09-08T06:23:23.885705Z","iopub.status.idle":"2024-09-08T06:23:25.225089Z","shell.execute_reply":"2024-09-08T06:23:25.224586Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Analyse variations in minimum and maximum gate elevation\ngdf_match.plot(column=\"GR_z_upper_bound\", legend=True, cmap=\"Spectral_r\")\ngdf_match.plot(column=\"SR_z_upper_bound\", legend=True, cmap=\"Spectral_r\")\n\ngdf_match.plot(column=\"GR_z_lower_bound\", legend=True, cmap=\"Spectral_r\")\ngdf_match.plot(column=\"SR_z_lower_bound\", legend=True, cmap=\"Spectral_r\")","key":"KwDGBH67Vk"},{"type":"output","id":"hFpXWnttdpzVblK7I4Vq7","data":[{"output_type":"execute_result","execution_count":95,"metadata":{},"data":{"text/plain":{"content":"\u003cAxes: \u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"415c70b7a0b9b2d0a9b34e27daf8b00e","path":"/erad2024/_preview/111/build/415c70b7a0b9b2d0a9b34e27daf8b00e.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a9dea70b131486ed4e9795a5f4c095dc","path":"/erad2024/_preview/111/build/a9dea70b131486ed4e9795a5f4c095dc.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"05f35dd5178b6218aaf52e8de6f78811","path":"/erad2024/_preview/111/build/05f35dd5178b6218aaf52e8de6f78811.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d711440018d61fb4960113467391458a","path":"/erad2024/_preview/111/build/d711440018d61fb4960113467391458a.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"iLIngScgCi"}],"key":"QrKKr71JlT"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:25.227671Z","iopub.status.busy":"2024-09-08T06:23:25.227189Z","iopub.status.idle":"2024-09-08T06:23:26.225738Z","shell.execute_reply":"2024-09-08T06:23:26.225236Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Analyse fraction hydrometeors and sensitivity\ngdf_match.plot(column=\"SR_counts\", legend=True, cmap=\"Spectral_r\", vmin=0)\ngdf_match.plot(column=\"SR_counts_valid\", legend=True, cmap=\"Spectral_r\", vmin=0)\n\ngdf_match.plot(column=\"SR_fraction_clutter\", legend=True, cmap=\"Spectral_r\", vmin=0, vmax=1)\n\n# gdf_match.plot(column=\"SR_fraction_melting_layer\", legend=True, cmap=\"Spectral_r\", vmin=0, vmax=1)\n# gdf_match.plot(column=\"SR_fraction_hail\", legend=True, cmap=\"Spectral_r\", vmin=0, vmax=1)\n# gdf_match.plot(column=\"SR_fraction_snow\", legend=True, cmap=\"Spectral_r\", vmin=0, vmax=1)\n# gdf_match.plot(column=\"SR_fraction_rain\", legend=True, cmap=\"Spectral_r\", vmin=0, vmax=1)\n# gdf_match.plot(column=\"SR_fraction_no_precip\", legend=True, cmap=\"Spectral_r\", vmin=0, vmax=1)\n# gdf_match.plot(column=\"SR_fraction_below_isotherm\", legend=True, cmap=\"Spectral_r\", vmin=0, vmax=1)\n# gdf_match.plot(column=\"SR_fraction_above_isotherm\", legend=True, cmap=\"Spectral_r\", vmin=0, vmax=1)","key":"unwmnaJRte"},{"type":"output","id":"B6lCeW-_A5lRjz0xY93QY","data":[{"output_type":"execute_result","execution_count":96,"metadata":{},"data":{"text/plain":{"content":"\u003cAxes: \u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d545c86b3e1ddefca290299b8f726050","path":"/erad2024/_preview/111/build/d545c86b3e1ddefca290299b8f726050.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f71bd85658f47d39cef21106bec3c5ad","path":"/erad2024/_preview/111/build/f71bd85658f47d39cef21106bec3c5ad.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"fb2f033c35e193e7b51cd7a292d55ce8","path":"/erad2024/_preview/111/build/fb2f033c35e193e7b51cd7a292d55ce8.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"qSt3B3x297"}],"key":"Igtx5g3du8"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:26.228944Z","iopub.status.busy":"2024-09-08T06:23:26.228149Z","iopub.status.idle":"2024-09-08T06:23:26.945312Z","shell.execute_reply":"2024-09-08T06:23:26.944656Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Analyse sensitivity\ngdf_match.plot(column=\"GR_Z_fraction_above_10dBZ\", legend=True, cmap=\"Spectral_r\", vmin=0, vmax=1)\n# gdf_match.plot(column=\"GR_Z_fraction_above_12dBZ\", legend=True, cmap=\"Spectral_r\", vmin=0, vmax=1)\n# gdf_match.plot(column=\"GR_Z_fraction_above_14dBZ\", legend=True, cmap=\"Spectral_r\", vmin=0, vmax=1)\n\ngdf_match.plot(column=\"SR_zFactorFinal_Ku_fraction_above_12dBZ\", legend=True, cmap=\"Spectral_r\", vmin=0, vmax=1)\n# gdf_match.plot(column=\"SR_zFactorFinal_Ku_fraction_above_14dBZ\", legend=True, cmap=\"Spectral_r\", vmin=0, vmax=1)\n# gdf_match.plot(column=\"SR_zFactorFinal_Ku_fraction_above_16dBZ\", legend=True, cmap=\"Spectral_r\", vmin=0, vmax=1)","key":"iMQgbgDzhK"},{"type":"output","id":"OvMKDhF4-mWc2Q2lFZGou","data":[{"output_type":"execute_result","execution_count":97,"metadata":{},"data":{"text/plain":{"content":"\u003cAxes: \u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"33c322981df2f6d91bc788039f846918","path":"/erad2024/_preview/111/build/33c322981df2f6d91bc788039f846918.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"44e8074905457106edbb2ed7eaec3405","path":"/erad2024/_preview/111/build/44e8074905457106edbb2ed7eaec3405.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"rSeD06Y8N9"}],"key":"C3pUkuNsz7"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:26.947547Z","iopub.status.busy":"2024-09-08T06:23:26.947210Z","iopub.status.idle":"2024-09-08T06:23:28.111620Z","shell.execute_reply":"2024-09-08T06:23:28.111136Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Analyse SR attenuation statistics\ngdf_match.plot(column=\"SR_reliabFlag\", legend=True, cmap=\"Spectral_r\")\ngdf_match.plot(column=\"SR_pathAtten\", legend=True, cmap=\"Spectral_r\", vmin=0, vmax=5)\ngdf_match.plot(column=\"SR_piaFinal\", legend=True, cmap=\"Spectral_r\", vmin=0, vmax=5)\ngdf_match.plot(column=\"SR_zFactorCorrection_Ku_max\", legend=True, cmap=\"Spectral_r\", vmin=0, vmax=5)","key":"mrpyRNzZn3"},{"type":"output","id":"JB_PeGLE8E5EUHCTKgyLq","data":[{"output_type":"execute_result","execution_count":98,"metadata":{},"data":{"text/plain":{"content":"\u003cAxes: \u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7610bc3037426f231c576bbe41e717e1","path":"/erad2024/_preview/111/build/7610bc3037426f231c576bbe41e717e1.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"1d7fa4f4583bb3b7c9b116cb884a3b62","path":"/erad2024/_preview/111/build/1d7fa4f4583bb3b7c9b116cb884a3b62.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c283a38ad54dcdfed132fa97a6a4c69b","path":"/erad2024/_preview/111/build/c283a38ad54dcdfed132fa97a6a4c69b.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b79189c7b56c65defe96c161ed9d38db","path":"/erad2024/_preview/111/build/b79189c7b56c65defe96c161ed9d38db.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"PfYwDy6QJT"}],"key":"JhPFcBSHVS"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:28.122923Z","iopub.status.busy":"2024-09-08T06:23:28.113919Z","iopub.status.idle":"2024-09-08T06:23:28.846962Z","shell.execute_reply":"2024-09-08T06:23:28.846418Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Analyse SR NUBF\ngdf_match.plot(column=\"SR_zFactorFinal_Ku_std\", legend=True, cmap=\"Spectral_r\", vmin=0, vmax=8)\ngdf_match.plot(column=\"GR_Z_std\", legend=True, cmap=\"Spectral_r\", vmin=0, vmax=8)\n\n# gdf_match.plot(column=\"SR_zFactorFinal_Ku_range\", legend=True, cmap=\"Spectral_r\", vmin=0, vmax=8)\n# gdf_match.plot(column=\"GR_Z_range\", legend=True, cmap=\"Spectral_r\", vmin=0, vmax=20)\n\n# gdf_match.plot(column=\"SR_zFactorFinal_Ku_cov\", legend=True, cmap=\"Spectral_r\")\n# gdf_match.plot(column=\"GR_Z_cov\", legend=True, cmap=\"Spectral_r\")\n\n# gdf_match[\"SR_zFactorFinal_Ku_range_rel\"] = gdf_match[\"SR_zFactorFinal_Ku_range\"]/gdf_match[\"SR_zFactorFinal_Ku_mean\"]\n# gdf_match.plot(column=\"SR_zFactorFinal_Ku_range_rel\", legend=True, cmap=\"Spectral_r\", vmin=0, vmax=1)\n\n# gdf_match[\"GR_Z_range_rel\"] = gdf_match[\"GR_Z_range\"]/gdf_match[\"GR_Z_mean\"]\n# gdf_match.plot(column=\"GR_Z_range_rel\", legend=True, cmap=\"Spectral_r\")","key":"XgPyzaRQ1D"},{"type":"output","id":"uU2l6O-qyXE2sTUCv7zHw","data":[{"output_type":"execute_result","execution_count":99,"metadata":{},"data":{"text/plain":{"content":"\u003cAxes: \u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"50e6b97d411351dffe22b9f14a1dd4f6","path":"/erad2024/_preview/111/build/50e6b97d411351dffe22b9f14a1dd4f6.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b2c56d97bdbede8abecc8a3c46c91c62","path":"/erad2024/_preview/111/build/b2c56d97bdbede8abecc8a3c46c91c62.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"NTuQkEcXvZ"}],"key":"eXaJYl9BuL"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:28.849350Z","iopub.status.busy":"2024-09-08T06:23:28.849083Z","iopub.status.idle":"2024-09-08T06:23:29.667338Z","shell.execute_reply":"2024-09-08T06:23:29.666841Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Compare reflectivities\nextent_xy = gdf_sr.total_bounds[[0, 2, 1, 3]]\np = gdf_match.plot(\n    column=\"SR_zFactorFinal_Ku_mean\",\n    legend=True,\n    legend_kwds={\"label\": \"SR Reflectivity (dBz)\"},\n    cmap=\"Spectral_r\",\n    vmin=10,\n    vmax=40,\n)\np.axes.set_xlim(extent_xy[0:2])\np.axes.set_ylim(extent_xy[2:4])\np.axes.set_title(\"SR\")\nplt.xlabel(\"x (m)\", fontsize=12)\nplt.ylabel(\"y (m)\", fontsize=12)\nplt.grid(lw=0.25, color=\"grey\")\n\np = gdf_match.plot(\n    column=\"GR_Z_mean\",\n    legend=True,\n    legend_kwds={\"label\": \"GR Reflectivity (dBz)\"},\n    cmap=\"Spectral_r\",\n    vmin=10,\n    vmax=40,\n)\np.axes.set_xlim(extent_xy[0:2])\np.axes.set_ylim(extent_xy[2:4])\np.axes.set_title(\"GR\")\nplt.xlabel(\"x (m)\", fontsize=12)\nplt.ylabel(\"y (m)\", fontsize=12)\nplt.grid(lw=0.25, color=\"grey\")","key":"mHbkgk5rwW"},{"type":"output","id":"S1rR-M-_18Z-8BqZ2Psxn","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"85fb8b8eb49a8a3e21d05cc700c86373","path":"/erad2024/_preview/111/build/85fb8b8eb49a8a3e21d05cc700c86373.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ae48bb000571ff8d990e5f880a2dcb96","path":"/erad2024/_preview/111/build/ae48bb000571ff8d990e5f880a2dcb96.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"h58w2vhIGC"}],"key":"TWG278NA3I"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:29.669713Z","iopub.status.busy":"2024-09-08T06:23:29.669376Z","iopub.status.idle":"2024-09-08T06:23:30.479553Z","shell.execute_reply":"2024-09-08T06:23:30.478901Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Compute difference (also with bias removed)\ngdf_match[\"DIFF_Z_SR_GR\"] = gdf_match[\"SR_zFactorFinal_Ku_mean\"] - gdf_match[\"GR_Z_mean\"]\ngdf_match[\"DIFF_Z_GR_SR\"] = gdf_match[\"GR_Z_mean\"] - gdf_match[\"SR_zFactorFinal_Ku_mean\"]\nbias_gr_sr = np.nanmedian(gdf_match[\"DIFF_Z_GR_SR\"]).round(2)\nbias_sr_gr = np.nanmedian(gdf_match[\"DIFF_Z_SR_GR\"]).round(2)\np = gdf_match.plot(\n    column=\"DIFF_Z_SR_GR\",\n    legend_kwds={\"label\": \"SR-GR Reflectivity Difference (dBz)\"},\n    cmap=\"RdBu\",\n    legend=True,\n    vmax=10,\n)\np.axes.set_xlim(extent_xy[0:2])\np.axes.set_ylim(extent_xy[2:4])\np.axes.set_title(\"SR - GR\")\nplt.xlabel(\"x (m)\", fontsize=12)\nplt.ylabel(\"y (m)\", fontsize=12)\nplt.grid(lw=0.25, color=\"grey\")\n\ngdf_match[\"DIFF_Z_GR_SR_unbiased\"] = gdf_match[\"DIFF_Z_GR_SR\"] - bias_gr_sr\np = gdf_match.plot(\n    column=\"DIFF_Z_GR_SR_unbiased\",\n    legend_kwds={\"label\": \"SR-GR Reflectivity Difference (wihout bias) (dBz)\"},\n    cmap=\"RdBu\",\n    legend=True,\n    vmin=-4,\n    vmax=4,\n)\np.axes.set_xlim(extent_xy[0:2])\np.axes.set_ylim(extent_xy[2:4])\np.axes.set_title(\"SR - GR\")\nplt.xlabel(\"x (m)\", fontsize=12)\nplt.ylabel(\"y (m)\", fontsize=12)\nplt.grid(lw=0.25, color=\"grey\")","key":"lJgXAbq30Q"},{"type":"output","id":"UTssQVW2C6q5gASq3nwbH","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2995b088ad2b9cadda40c49d7f4de3be","path":"/erad2024/_preview/111/build/2995b088ad2b9cadda40c49d7f4de3be.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"07679d0b382f27a00809cd9e882f22fa","path":"/erad2024/_preview/111/build/07679d0b382f27a00809cd9e882f22fa.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"HsvnOHut2A"}],"key":"qOWF1FIXP4"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"obdQIyaFUj"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Here we show how to explore interactively the reflectivity fields using Folium:","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Ua8jeLG6q5"}],"key":"EO7bICG2Zk"}],"key":"ymvRO4ElvF"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:30.481656Z","iopub.status.busy":"2024-09-08T06:23:30.481473Z","iopub.status.idle":"2024-09-08T06:23:36.551576Z","shell.execute_reply":"2024-09-08T06:23:36.550877Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"gdf_match1 = gdf_match.copy()\ngdf_match1.explore(column=\"GR_Z_mean\", legend=True, cmap=\"Spectral_r\", vmin=0, vmax=40)","key":"l9EWZUPT8t"},{"type":"output","id":"r-hh3Km97Mv9iLoSgQXBK","data":[{"output_type":"execute_result","execution_count":102,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"0cacba75e834ecb052383da2bdfbc5cc","path":"/erad2024/_preview/111/build/0cacba75e834ecb052383da2bdfbc5cc.html"},"text/plain":{"content":"\u003cfolium.folium.Map at 0x7f2f44269e50\u003e","content_type":"text/plain"}}}],"key":"O7ZXcSQyGL"}],"key":"U9xyjQ432A"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yn4AksFmgM"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Here we show how to plot cartopy maps in WGS84 and GR CRS AEQD.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"DaUOEBvjj5"}],"key":"i6DTaNO2hB"}],"key":"cHcqADT1Vj"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:36.693728Z","iopub.status.busy":"2024-09-08T06:23:36.693056Z","iopub.status.idle":"2024-09-08T06:23:36.697540Z","shell.execute_reply":"2024-09-08T06:23:36.697097Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Define Cartopy AEQD CRS\nccrs_aeqd = ccrs.AzimuthalEquidistant(\n    central_longitude=ds_gr[\"longitude\"].item(),\n    central_latitude=ds_gr[\"latitude\"].item(),\n)","key":"bFhcIMaIS0"},{"type":"output","id":"KpUgfVJ7uNc3JdX1ulm4u","data":[],"key":"pUXYJZZ693"}],"key":"a4LUSmF5Mu"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:36.700008Z","iopub.status.busy":"2024-09-08T06:23:36.699696Z","iopub.status.idle":"2024-09-08T06:23:36.702334Z","shell.execute_reply":"2024-09-08T06:23:36.701901Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Define Cartopy WGS84 CRS\nccrs_wgs84 = ccrs.PlateCarree()","key":"vYCCZrI14Y"},{"type":"output","id":"qKyEvaQk_IJjFo0beNyqN","data":[],"key":"dDaRwxuzU0"}],"key":"oubyY2inAr"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:36.704884Z","iopub.status.busy":"2024-09-08T06:23:36.704578Z","iopub.status.idle":"2024-09-08T06:23:36.771330Z","shell.execute_reply":"2024-09-08T06:23:36.770840Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Print CRS of geopandas geometries\ngdf_match.crs","key":"qruimMjYZF"},{"type":"output","id":"wLzslwSWF4qYy7PIQhZML","data":[{"output_type":"execute_result","execution_count":105,"metadata":{},"data":{"text/plain":{"content":"\u003cProjected CRS: PROJCRS[\"unknown\",BASEGEOGCRS[\"unknown\",DATUM[\"Wor ...\u003e\nName: unknown\nAxis Info [cartesian]:\n- E[east]: Easting (metre)\n- N[north]: Northing (metre)\nArea of Use:\n- undefined\nCoordinate Operation:\n- name: unknown\n- method: Azimuthal Equidistant\nDatum: World Geodetic System 1984\n- Ellipsoid: WGS 84\n- Prime Meridian: Greenwich","content_type":"text/plain"}}}],"key":"xOmgnpz0Lm"}],"key":"hohXi7Z5Sm"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:36.774586Z","iopub.status.busy":"2024-09-08T06:23:36.773794Z","iopub.status.idle":"2024-09-08T06:23:37.067328Z","shell.execute_reply":"2024-09-08T06:23:37.066835Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Plot in AEQD CRS (same crs of geopandas geometries)\nfig, ax = plt.subplots(subplot_kw={\"projection\": ccrs_aeqd})\ngdf_match.plot(ax=ax, column=\"GR_Z_mean\", cmap=\"turbo\", legend=True)","key":"M5qIsPIdmQ"},{"type":"output","id":"FbKy39dDu5EmOX-fpL1JS","data":[{"output_type":"execute_result","execution_count":106,"metadata":{},"data":{"text/plain":{"content":"\u003cGeoAxes: \u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"bb2cc022a696556cfeb31b7b7cb220dd","path":"/erad2024/_preview/111/build/bb2cc022a696556cfeb31b7b7cb220dd.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"EMnhkeYexU"}],"key":"JE6dSpxYIm"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:37.070028Z","iopub.status.busy":"2024-09-08T06:23:37.069691Z","iopub.status.idle":"2024-09-08T06:23:37.441036Z","shell.execute_reply":"2024-09-08T06:23:37.440555Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Convert geopandas dataframe to another crs\ngdf_match_wgs84 = gdf_match.to_crs(crs_sr)\n# Plot in WGS84 CRS\nfig, ax = plt.subplots(subplot_kw={\"projection\": ccrs_wgs84})\n# plot_cartopy_background(ax)\ngdf_match_wgs84.plot(ax=ax, column=\"GR_Z_mean\", cmap=\"turbo\", legend=True)\nax.set_extent(ds_gr.xradar_dev.extent(max_distance=max_gr_range))","key":"gPBCClyN3e"},{"type":"output","id":"GkbY6hNaxXJxCfJg7hKPf","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"938cdae6cc54234730626037e3c65b45","path":"/erad2024/_preview/111/build/938cdae6cc54234730626037e3c65b45.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"pRDA9xsRIb"}],"key":"Pk2xQN0K0k"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Filter the SR/GR Database","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"j9rMiOrAJ2"}],"identifier":"filter-the-sr-gr-database","label":"Filter the SR/GR Database","html_id":"filter-the-sr-gr-database","implicit":true,"key":"HtTJLgCUvF"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"When calibrating or comparing SR and GR data, there is a necessary tradeoff between the strictness of filtering criteria filtering and the number of available samples. Here below we provide some general recommendations for effective filtering:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"nRJFO6T3wW"}],"key":"OagjqaLAVu"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Sensitivity Thresholds","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"zK6OWHK6pV"}],"key":"DJTYAKAzQ7"},{"type":"text","value":": Retain only those radar beams where the aggregated gate reflectivities exceed the instrument sensitivities.\nThe ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"AyoTdLxpaU"},{"type":"inlineCode","value":"GR_Z_fraction_above_\u003cthr\u003edBZ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"IXv5KauWBF"},{"type":"text","value":" and ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"BDfpYDiEbU"},{"type":"inlineCode","value":"SR_zFactorFinal_Ku_fraction_above_\u003cthr\u003edBZ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"QQafbW2SpJ"},{"type":"text","value":" variables can be used filter the samples.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"PWHHUVn4MP"}],"key":"YRFqfs2u14"}],"key":"LOuvE9qSZX"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Stratiform Precipitation","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"i56RBK87Lc"}],"key":"Spmk6laZCb"},{"type":"text","value":":  If the purpose of your analysis is to assess the calibration bias of GR data, it is suggested to focus on stratiform precipitation that ocurrs outside the melting layer (i.e. avoiding the bright band). Only stratiform samples above the melting layer are used in ground validation of the GPM DPR (W. Petersen 2017, personal communication).\nConvective SR footprints are typically excluded to avoid dealing with:","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"URsTm7h2NJ"}],"key":"kNuzccdffN"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":11,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"the high spatial variability in the precipitation field and issues with non-uniform beam filling (NUBF),","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"hFNwzUyIWN"}],"key":"ajZLQi597f"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"the potential biases introduced by the SR attenuation correction,","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"SfxOPgXQL8"}],"key":"rDjq12oADo"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"the potential biases in GR reflectivities, especially at C and X band, due to beam attenuation,","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"J1UczjW5FQ"}],"key":"ihxu1FnCB3"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"the multiple scattering signature caused by hail particles.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"Ph0vLdTIvj"}],"key":"ovUayHAjlG"}],"key":"vFJO63td9R"}],"key":"JpTej1Ds2J"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"strong","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Reflectivity Range","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"EaYDw36MUf"}],"key":"Ks2paAK4UR"},{"type":"text","value":": According to Warren et al. (2018), volume-averaged SR and GR reflectivity values should be selected within the range of 24 to 36 dBZ. This range minimizes the impact of low SR sensitivity,  SR beam attenuation and non-rayleigh scattering effects.","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"NZAm1xKfJ9"}],"key":"QeXFgc13l2"}],"key":"Myv8mujQ5L"},{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"strong","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Clutter Removal","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"Vc71m4PIMv"}],"key":"uIo9KR5tqN"},{"type":"text","value":": Exclude SR/GR samples that are contaminated by ground clutter, anomalous propagation, or beam blockage.","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"gqcLXlCc9u"}],"key":"ylVI4bpy8g"}],"key":"bfQ2690A4c"},{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"strong","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Volume matching","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"iPLG1mCpVR"}],"key":"YmLOYzadXk"},{"type":"text","value":": Exclude SR/GR samples where there are excessive differences in the total gate volume.","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"eKZUNnrxnT"}],"key":"oyDBOW0Q9l"}],"key":"FGryyB5qNk"}],"key":"vG6tHXdLsu"}],"key":"a62o5TC0gw"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:37.450929Z","iopub.status.busy":"2024-09-08T06:23:37.443448Z","iopub.status.idle":"2024-09-08T06:23:37.457713Z","shell.execute_reply":"2024-09-08T06:23:37.457251Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Define mask\nmasks = [\n    # Select SR scan with \"normal\" dataQuality (for entire cross-track scan)\n    gdf_match[\"SR_dataQuality\"] == 0,\n    # Select SR beams with detected precipitation\n    gdf_match[\"SR_flagPrecip\"] \u003e 0,\n    # Select only 'high quality' SR data\n    # - qualityFlag == 1 indicates low quality retrievals\n    # - qualityFlag == 2 indicates bad/missing retrievals\n    gdf_match[\"SR_qualityFlag\"] == 0,\n    # Select SR beams with SR above minimum reflectivity\n    gdf_match[\"SR_zFactorFinal_Ku_fraction_above_12dBZ\"] \u003e 0.95,\n    # Select SR beams with GR above minimum reflectivity\n    gdf_match[\"GR_Z_fraction_above_10dBZ\"] \u003e 0.95,\n    # Select only SR beams with detected bright band\n    gdf_match[\"SR_qualityBB\"] == 1,\n    # Select only beams with confident precipitation type\n    gdf_match[\"SR_qualityTypePrecip\"] == 1,\n    # Select only stratiform precipitation\n    # - SR_flagPrecipitationType == 2 indicates convective\n    gdf_match[\"SR_flagPrecipitationType\"] == 1,\n    # Select only SR beams with reliable attenuation correction\n    gdf_match[\"SR_reliabFlag\"].isin((1, 2)),  # or == 1\n    # Select only beams with reduced path attenuation\n    # gdf_match[\"SR_zFactorCorrection_Ku_max\"]\n    # gdf_match[\"SR_piaFinal\"]\n    # gdf_match[\"SR_pathAtten\"]\n    # Select only SR beams with matching SR gates with no clutter\n    gdf_match[\"SR_fraction_clutter\"] == 0,\n    # Select only SR beams with matching SR gates not in the melting layer\n    gdf_match[\"SR_fraction_melting_layer\"] == 0,\n    # Select only SR beams with matching SR gates with precipitation\n    gdf_match[\"SR_fraction_no_precip\"] == 0,\n    # Select only SR beams with matching SR gates with no hail\n    # gdf_match[\"SR_fraction_hail\"] == 0,\n    # Select only SR beams with matching SR gates with rain\n    # gdf_match[\"SR_fraction_hail\"] == 1,\n    # Select only SR beams with matching SR gates with snow\n    # gdf_match[\"SR_fraction_snow\"] == 1,\n    # Discard SR beams with high NUBF\n    # gdf_match[\"SR_zFactorFinal_Ku_range\"] \u003e 5,\n    # gdf_match[\"SR_zFactorFinal_Ku_cov\"] \u003c 0.5,\n    # gdf_match[\"GR_Z_cov\"] \u003c 0.5,\n    # gdf_match[\"GR_Z_range\"] \u003e 5,\n    # Select only interval of reflectivities\n    # - Warren et al., 2018:  between 24 and 36 dBZ\n    # (gdf_match[\"SR_zFactorFinal_Ku_mean\"] \u003e 24) \u0026 (gdf_match[\"SR_zFactorFinal_Ku_mean\"] \u003c 36),\n    # (gdf_match[\"GR_Z_mean\"] \u003e 24) \u0026 (gdf_match[\"GR_Z_mean\"] \u003c 36),\n    # Select SR beams only within given GR radius interval\n    # (gdf_match[\"GR_range_min\"] \u003e min_gr_range) \u0026 (gdf_match[\"GR_range_max\"] \u003c max_gr_range),\n    # Discard SR beams where scanning time difference (provided in seconds)\n    gdf_match[\"time_difference\"] \u003c 5 * 60,  # 5 min\n    # Discard SR beams where GR gates does not cover 80% of the horizontal area\n    # gdf_match[\"GR_fraction_covered_area\"] \u003e 0.8,\n    # Filter footprints where volume ratio exceeds 60\n    # gdf_match[\"VolumeRatio\"] \u003e 60,\n    # Filter footprints where GR affected by beam blockage\n    # TODO: Filtering by beam blockage\n]","key":"ovnsNtOUV6"},{"type":"output","id":"vMx7hH4UmDQsRjWC27ncd","data":[],"key":"yOXSKVHjtJ"}],"key":"whc6UtHIgW"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:37.459875Z","iopub.status.busy":"2024-09-08T06:23:37.459511Z","iopub.status.idle":"2024-09-08T06:23:37.464260Z","shell.execute_reply":"2024-09-08T06:23:37.463786Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Define final mask\nmask_final = reduce(np.logical_and, masks)","key":"wstmFp8Hky"},{"type":"output","id":"AuPEW_mr5qGe8jCemaAp2","data":[],"key":"MEHupKVNYL"}],"key":"UDeTMXLLwN"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:37.466045Z","iopub.status.busy":"2024-09-08T06:23:37.465858Z","iopub.status.idle":"2024-09-08T06:23:37.970238Z","shell.execute_reply":"2024-09-08T06:23:37.969661Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Dsplay final filtering mask\ngdf_match[\"filtering_mask\"] = mask_final\ngdf_match.plot(column=\"filtering_mask\", legend=True, cmap=\"Spectral\")\ngdf_match.plot(column=\"SR_zFactorFinal_Ku_mean\", legend=True, cmap=\"Spectral\")","key":"v7TdddayYU"},{"type":"output","id":"eyl3L8S3abwkEmw3q16in","data":[{"output_type":"execute_result","execution_count":110,"metadata":{},"data":{"text/plain":{"content":"\u003cAxes: \u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ec9413610a6a6d1b96da79c255b23203","path":"/erad2024/_preview/111/build/ec9413610a6a6d1b96da79c255b23203.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 1 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"042c6ba5e9415a0c224a9e578c10b360","path":"/erad2024/_preview/111/build/042c6ba5e9415a0c224a9e578c10b360.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"jjeonPgTgJ"}],"key":"ZdTaQEFOOt"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:37.972526Z","iopub.status.busy":"2024-09-08T06:23:37.972149Z","iopub.status.idle":"2024-09-08T06:23:37.977262Z","shell.execute_reply":"2024-09-08T06:23:37.976764Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Filter matching dataset\ngdf_final = gdf_match[mask_final]","key":"l5fghU6jWe"},{"type":"output","id":"sJnZko_qoV10shxFlugKx","data":[],"key":"h9ar74x1Ts"}],"key":"EY7pa2SjJ3"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:37.979150Z","iopub.status.busy":"2024-09-08T06:23:37.978995Z","iopub.status.idle":"2024-09-08T06:23:38.362719Z","shell.execute_reply":"2024-09-08T06:23:38.362242Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Plot results\ngdf_final.plot(column=\"SR_zFactorFinal_Ku_mean\", legend=True, cmap=\"Spectral_r\", vmin=0, vmax=40)\ngdf_final.plot(column=\"GR_Z_mean\", legend=True, cmap=\"Spectral_r\", vmin=0, vmax=40)","key":"Juf1G2ZdZW"},{"type":"output","id":"y9_W08cDBJI3lTDXejKek","data":[{"output_type":"execute_result","execution_count":112,"metadata":{},"data":{"text/plain":{"content":"\u003cAxes: \u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6a3ae1e79e2aaf2ad5a9e5e3440fb898","path":"/erad2024/_preview/111/build/6a3ae1e79e2aaf2ad5a9e5e3440fb898.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3231e6512d7ee90fd04eccce5be4dfc3","path":"/erad2024/_preview/111/build/3231e6512d7ee90fd04eccce5be4dfc3.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"dqGiD7ZPiN"}],"key":"W3L5smOk5R"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Determine the GR Calibration Bias","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LjjoOVWuuE"}],"identifier":"determine-the-gr-calibration-bias","label":"Determine the GR Calibration Bias","html_id":"determine-the-gr-calibration-bias","implicit":true,"key":"L2Aw7SfCvp"}],"key":"txb73J5Xow"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:38.365247Z","iopub.status.busy":"2024-09-08T06:23:38.365061Z","iopub.status.idle":"2024-09-08T06:23:38.370291Z","shell.execute_reply":"2024-09-08T06:23:38.369871Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Compute statistics\nbias = np.nanmean(gdf_match[\"DIFF_Z_GR_SR\"]).round(2)\nrobBias = np.nanmedian(gdf_match[\"DIFF_Z_GR_SR\"]).round(2)\n\n# R2 (pearson, spearman rank)\nprint(f\"Th ZH Calibration offset is (mean): {bias} dB\")\nprint(f\"Th ZH Calibration offset is (median): {robBias} dB\")","key":"smBB1ltWWs"},{"type":"output","id":"_WC5mC3iZtxWWBd3olyX3","data":[{"name":"stdout","output_type":"stream","text":"Th ZH Calibration offset is (mean): -5.53 dB\nTh ZH Calibration offset is (median): -4.58 dB\n"}],"key":"wa6mmFDKXd"}],"key":"zUY20THFId"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:38.373219Z","iopub.status.busy":"2024-09-08T06:23:38.372440Z","iopub.status.idle":"2024-09-08T06:23:38.375711Z","shell.execute_reply":"2024-09-08T06:23:38.375299Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Comparison of GR vs SR reflectivities\nhue_variable = \"VolumeDiff\"\nhue_title = \"Difference in volume between SR and GR [m³]\"","key":"SV4aot65Nm"},{"type":"output","id":"3qnvmTUSBnbqc75A_WqHv","data":[],"key":"itS5VBDpTR"}],"key":"l5Jat1H8SP"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-08T06:23:38.378657Z","iopub.status.busy":"2024-09-08T06:23:38.377887Z","iopub.status.idle":"2024-09-08T06:23:38.735471Z","shell.execute_reply":"2024-09-08T06:23:38.734993Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# - Histograms\nfig = plt.figure(figsize=(12, 5))\nax = fig.add_subplot(121, aspect=\"equal\")\nplt.scatter(\n    gdf_match[\"GR_Z_mean\"],\n    gdf_match[\"SR_zFactorFinal_Ku_mean\"],\n    marker=\"+\",\n    c=gdf_match[hue_variable],\n    cmap=\"turbo\",\n)\nplt.colorbar(label=hue_title)\nplt.plot([0, 60], [0, 60], linestyle=\"solid\", color=\"black\")\nplt.xlim(10, 50)\nplt.ylim(10, 50)\nplt.xlabel(\"GR reflectivity (dBZ)\")\nplt.ylabel(\"SR reflectivity (dBZ)\")\nplt.title(f\"Offset GR-SR: {bias} dBZ\")\nax = fig.add_subplot(122)\nplt.hist(\n    gdf_match[\"GR_Z_mean\"][gdf_match[\"GR_Z_mean\"] \u003e z_min_threshold_gr],\n    bins=np.arange(10, 60, 5),\n    edgecolor=\"None\",\n    label=\"GR\",\n)\nplt.hist(\n    gdf_match[\"SR_zFactorFinal_Ku_mean\"][gdf_match[\"SR_zFactorFinal_Ku_mean\"] \u003e z_min_threshold_sr],\n    bins=np.arange(10, 60, 5),\n    edgecolor=\"red\",\n    facecolor=\"None\",\n    label=\"SR\",\n)\nplt.xlabel(\"Reflectivity (dBZ)\")\nplt.legend()\nfig.suptitle(\"GR vs SR\")","key":"mxSMfw13Cz"},{"type":"output","id":"A33SYxrJHjbZLTEPoXBao","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"1b625a75f43cafe6c67701a9c8a2475b","path":"/erad2024/_preview/111/build/1b625a75f43cafe6c67701a9c8a2475b.png"},"text/plain":{"content":"\u003cFigure size 1200x500 with 3 Axes\u003e","content_type":"text/plain"}}}],"key":"WMXN0m99zp"}],"key":"m9LykM5F1n"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Next Steps","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SwE2qFeFuE"}],"identifier":"next-steps","label":"Next Steps","html_id":"next-steps","implicit":true,"key":"da5GFbkgTo"}],"key":"pudK5z5hr4"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Congratulations on reaching the end of this tutorial!\nIf you have suggestions for improving this tutorial or the SR/GR matching process, please feel free to open\na Pull Request or create a GitHub issue on the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SH6c1aRgrC"},{"type":"link","url":"https://github.com/ghiggi/gpm_api","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"GPM-API GitHub repository","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Fp96LeVSoR"}],"urlSource":"https://github.com/ghiggi/gpm_api","error":true,"key":"Lc4LGMNubw"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NOEAHEuK8I"}],"key":"p0sFkn9NwX"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The code for the SR/GR matching process is encapsulated in the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"QGNbeR6t9E"},{"type":"inlineCode","value":"volume_matching","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"C1Ge85igdo"},{"type":"text","value":" function contained in the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"EhX9IGvODI"},{"type":"link","url":"https://github.com/ghiggi/gpm_api/blob/main/gpm/gv/routines.py","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"gpm.gv module","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"lrWhn9CJ9D"}],"urlSource":"https://github.com/ghiggi/gpm_api/blob/main/gpm/gv/routines.py","data":{"kind":"file","org":"ghiggi","repo":"gpm_api","reference":"main","file":"gpm/gv/routines.py","raw":"https://raw.githubusercontent.com/ghiggi/gpm_api/main/gpm/gv/routines.py"},"internal":false,"protocol":"github","key":"VEfoVCsias"},{"type":"text","value":". User are free to use or adapt such function to accomplish their tasks.\nThe ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"oeoQi5d7bG"},{"type":"link","url":"https://gpm-api.readthedocs.io/en/latest/tutorials/tutorial_03_SR_GR_Calibration.html","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Spaceborne-Ground Radar Calibration Applied Tutorial","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"o0U3l8WUaI"}],"urlSource":"https://gpm-api.readthedocs.io/en/latest/tutorials/tutorial_03_SR_GR_Calibration.html","key":"POf7OiSRfS"},{"type":"text","value":" shows how to assess the GR calibration bias by abstracting away the complexities discussed in this tutorial.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ySFdyPSfSg"}],"key":"lAsqoCyRyM"}],"key":"L6gUOkuQiB"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"References","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uScarrpxpG"}],"identifier":"references","label":"References","html_id":"references","implicit":true,"key":"M5j03XXNUm"}],"key":"j2mxDS97GB"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"cite","url":"https://doi.org/10.1002/jgrd.50138","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Cao, Q., Y. Hong, Y. Qi, Y. Wen, J. Zhang, J. J. Gourley, and L. Liao, 2013: Empirical conversion of the vertical profile of reflectivity from Ku-band to S-band frequency. J. Geophys. Res. Atmos., 118, 1814–1825, https://doi.org/10.1002/jgrd.50138","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"owVFOJQsTz"}],"kind":"narrative","label":"Cao_2013","identifier":"https://doi.org/10.1002/jgrd.50138","enumerator":"3","key":"q7vAIgGXxS"}],"key":"TYN4UofzhK"},{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"cite","url":"https://doi.org/10.1175/2010JTECHA1403.1","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Schwaller, MR, and Morris, KR. 2011. A ground validation network for the Global Precipitation Measurement mission. J. Atmos. Oceanic Technol., 28, 301-319.28, https://doi.org/10.1175/2010JTECHA1403.1","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"qolLRDIqwe"}],"kind":"narrative","label":"Schwaller_2011","identifier":"https://doi.org/10.1175/2010JTECHA1403.1","enumerator":"1","key":"lfZTITnGPD"}],"key":"eNYoB3mq2R"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"cite","url":"https://doi.org/10.1175/JTECH-D-17-0128.1","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Warren, R.A., A. Protat, S.T. Siems, H.A. Ramsay, V. Louf, M.J. Manton, and T.A. Kane, 2018. Calibrating ground-based radars against TRMM and GPM. J. Atmos. Oceanic Technol., 35, 323–346, https://doi.org/10.1175/JTECH-D-17-0128.1","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Inbz4dgYL8"}],"kind":"narrative","label":"Warren_2018","identifier":"https://doi.org/10.1175/JTECH-D-17-0128.1","enumerator":"2","key":"LWsOboRKUE"}],"key":"XnsnrGgQbY"}],"key":"C9kXJ2W1Wb"}],"key":"YcD5D2swjD"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Citation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nADJESJdhS"}],"identifier":"citation","label":"Citation","html_id":"citation","implicit":true,"key":"DrU6KH7kz8"}],"key":"bDlTCi0RFL"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This notebook is part of the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"T4gbliDq4u"},{"type":"link","url":"https://gpm-api.readthedocs.io/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"GPM-API  documentation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Hti3Qg8aGi"}],"urlSource":"https://gpm-api.readthedocs.io/","key":"OPTUEcsvaB"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GEhGZLrrYD"}],"key":"LhJ8ZQgXZ3"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Large portions of this tutorials were adapted and derived from an old ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"I4iEEshUDE"},{"type":"inlineMath","value":"\\omega radlib","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eω\u003c/mi\u003e\u003cmi\u003er\u003c/mi\u003e\u003cmi\u003ea\u003c/mi\u003e\u003cmi\u003ed\u003c/mi\u003e\u003cmi\u003el\u003c/mi\u003e\u003cmi\u003ei\u003c/mi\u003e\u003cmi\u003eb\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\omega radlib\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eω\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\"\u003er\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ea\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ed\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.01968em;\"\u003el\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eib\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"AsqhJslIYP"},{"type":"text","value":"  tutorial.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"aIAUEDh0bj"}],"key":"Y82JzOEIcN"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Copyright: ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"gVapjdzCAL"},{"type":"inlineMath","value":"\\omega radlib","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eω\u003c/mi\u003e\u003cmi\u003er\u003c/mi\u003e\u003cmi\u003ea\u003c/mi\u003e\u003cmi\u003ed\u003c/mi\u003e\u003cmi\u003el\u003c/mi\u003e\u003cmi\u003ei\u003c/mi\u003e\u003cmi\u003eb\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\omega radlib\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eω\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\"\u003er\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ea\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ed\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.01968em;\"\u003el\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eib\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"Hfd4PJAkFp"},{"type":"text","value":"  and GPM-API developers.\nDistributed under the MIT License. See ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"d2AM6uSIUJ"},{"type":"link","url":"https://github.com/ghiggi/gpm_api/blob/main/LICENSE","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"GPM-API license","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"oQVuTHkVIq"}],"urlSource":"https://github.com/ghiggi/gpm_api/blob/main/LICENSE","data":{"kind":"file","org":"ghiggi","repo":"gpm_api","reference":"main","file":"LICENSE","raw":"https://raw.githubusercontent.com/ghiggi/gpm_api/main/LICENSE"},"internal":false,"protocol":"github","key":"JLpB22D0jf"},{"type":"text","value":" for more info.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ZeYWtSluj0"}],"key":"shWKdiaapj"}],"key":"I5wq9D1IsJ"}],"key":"RplZkbFRj3"},"references":{"cite":{"order":["Schwaller_2011","Warren_2018","Cao_2013"],"data":{"Schwaller_2011":{"label":"Schwaller_2011","enumerator":"1","doi":"10.1175/2010jtecha1403.1","html":"Schwaller, M. R., \u0026 Morris, K. R. (2011). A Ground Validation Network for the Global Precipitation Measurement Mission. \u003ci\u003eJournal of Atmospheric and Oceanic Technology\u003c/i\u003e, \u003ci\u003e28\u003c/i\u003e(3), 301–319. \u003ca target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1175/2010jtecha1403.1\"\u003e10.1175/2010jtecha1403.1\u003c/a\u003e","url":"https://doi.org/10.1175/2010jtecha1403.1"},"Warren_2018":{"label":"Warren_2018","enumerator":"2","doi":"10.1175/jtech-d-17-0128.1","html":"Warren, R. A., Protat, A., Siems, S. T., Ramsay, H. A., Louf, V., Manton, M. J., \u0026 Kane, T. A. (2018). Calibrating Ground-Based Radars against TRMM and GPM. \u003ci\u003eJournal of Atmospheric and Oceanic Technology\u003c/i\u003e, \u003ci\u003e35\u003c/i\u003e(2), 323–346. \u003ca target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1175/jtech-d-17-0128.1\"\u003e10.1175/jtech-d-17-0128.1\u003c/a\u003e","url":"https://doi.org/10.1175/jtech-d-17-0128.1"},"Cao_2013":{"label":"Cao_2013","enumerator":"3","doi":"10.1002/jgrd.50138","html":"Cao, Q., Hong, Y., Qi, Y., Wen, Y., Zhang, J., Gourley, J. J., \u0026 Liao, L. (2013). Empirical conversion of the vertical profile of reflectivity from Ku‐band to S‐band frequency. \u003ci\u003eJournal of Geophysical Research: Atmospheres\u003c/i\u003e, \u003ci\u003e118\u003c/i\u003e(4), 1814–1825. \u003ca target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1002/jgrd.50138\"\u003e10.1002/jgrd.50138\u003c/a\u003e","url":"https://doi.org/10.1002/jgrd.50138"}}}},"footer":{"navigation":{"prev":{"title":"Spaceborne-Ground Radar Calibration (Application)","url":"/sr-gr-calibration-applied","group":"Spaceborne - Ground Radar Matching and Calibration"},"next":{"title":"Pyrad QPE Exercise","url":"/description-pyrad-tutorial","group":"Spaceborne - Ground Radar Matching and Calibration"}}},"domain":"http://localhost:3000"},"project":{"open_access":true,"license":{"content":{"id":"Apache-2.0","name":"Apache License 2.0","osi":true,"free":true,"url":"https://opensource.org/licenses/Apache-2.0"},"code":{"id":"CC-BY-4.0","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true,"url":"https://creativecommons.org/licenses/by/4.0/"}},"abbreviations":{"ARM":"Atmospheric Radiation Measurement","NCAR":"National Center for Atmospheric Research"},"settings":{"output_matplotlib_strings":"remove"},"title":"ERAD 2024","authors":[{"nameParsed":{"literal":"Alfonso Ladino","given":"Alfonso","family":"Ladino"},"name":"Alfonso Ladino","orcid":"0000-0001-8081-7827","github":"aladinor","id":"contributors-myst-generated-uid-0"},{"nameParsed":{"literal":"Anna del Moral Méndez","given":"Anna","non_dropping_particle":"del","family":"Moral Méndez"},"name":"Anna del Moral Méndez","orcid":"0000-0002-5015-840X","id":"contributors-myst-generated-uid-1"},{"nameParsed":{"literal":"Brenda Javornik","given":"Brenda","family":"Javornik"},"name":"Brenda Javornik","orcid":"0009-0004-9266-9293","github":"leavesntwigs","id":"contributors-myst-generated-uid-2"},{"nameParsed":{"literal":"Daniel Michelson","given":"Daniel","family":"Michelson"},"name":"Daniel Michelson","orcid":"0000-0003-3222-9881","github":"DanielMichelson","id":"contributors-myst-generated-uid-3"},{"nameParsed":{"literal":"Daniel Wolfensberger","given":"Daniel","family":"Wolfensberger"},"name":"Daniel Wolfensberger","orcid":"0009-0006-1419-0556","github":"wolfidan","id":"contributors-myst-generated-uid-4"},{"nameParsed":{"literal":"Gionata Ghiggi","given":"Gionata","family":"Ghiggi"},"name":"Gionata Ghiggi","orcid":"0000-0002-0818-0865","github":"ghiggi","id":"contributors-myst-generated-uid-5"},{"nameParsed":{"literal":"Jen DeHart","given":"Jen","family":"DeHart"},"name":"Jen DeHart","orcid":"0000-0001-8536-4927","github":"jcdehart","id":"contributors-myst-generated-uid-6"},{"nameParsed":{"literal":"Jordi Figueras i Ventura","given":"Jordi Figueras","non_dropping_particle":"i","family":"Ventura"},"name":"Jordi Figueras i Ventura","orcid":"0000-0002-4949-422X","github":"jfigui","id":"contributors-myst-generated-uid-7"},{"nameParsed":{"literal":"Julian Giles","given":"Julian","family":"Giles"},"name":"Julian Giles","orcid":"0000-0001-8134-008X","github":"JulianGiles","id":"contributors-myst-generated-uid-8"},{"nameParsed":{"literal":"Kai Mühlbauer","given":"Kai","family":"Mühlbauer"},"name":"Kai Mühlbauer","orcid":"0000-0001-6599-1034","github":"kmuehlbauer","id":"contributors-myst-generated-uid-9"},{"nameParsed":{"literal":"Maxwell Grover","given":"Maxwell","family":"Grover"},"name":"Maxwell Grover","orcid":"0000-0002-0370-8974","github":"mgrover1","id":"contributors-myst-generated-uid-10"},{"nameParsed":{"literal":"Mike Dixon","given":"Mike","family":"Dixon"},"name":"Mike Dixon","orcid":"0000-0002-9597-9113","github":"mike-dixon","id":"contributors-myst-generated-uid-11"},{"nameParsed":{"literal":"Robert Jackson","given":"Robert","family":"Jackson"},"name":"Robert Jackson","orcid":"0000-0003-2518-1234","github":"rcjackson","id":"contributors-myst-generated-uid-12"},{"nameParsed":{"literal":"Scott Collis","given":"Scott","family":"Collis"},"name":"Scott Collis","orcid":"0000-0002-2303-687X","github":"scollis","id":"contributors-myst-generated-uid-13"},{"nameParsed":{"literal":"Ting-Yu Cha","given":"Ting-Yu","family":"Cha"},"name":"Ting-Yu Cha","orcid":"0000-0002-6292-8483","github":"tingyucha","id":"contributors-myst-generated-uid-14"}],"github":"https://github.com/openradar/erad2024","copyright":"2024","references":{"foundations":{"url":"https://projectpythia-mystmd.github.io/pythia-foundations"},"xarray":{"url":"https://docs.xarray.dev/en/stable"},"matplotlib":{"url":"https://matplotlib.org/stable"}},"thebe":{"binder":{"url":"https://binder.projectpythia.org/","provider":"github","repo":"openradar/erad2024","ref":"HEAD"}},"toc":[{"file":"README.md"},{"file":"notebooks/how-to-cite.md"},{"file":"schedule.md"},{"children":[{"file":"getting_started.md"},{"file":"notebooks/data-access/intro-data-access.ipynb"},{"file":"notebooks/environment.ipynb"}],"title":"Getting started"},{"children":[{"file":"presentations/intro-to-open-radar-science.ipynb"},{"file":"notebooks/xradar-pyart/xradar-basics.ipynb"},{"children":[{"file":"notebooks/xradar-pyart/pyart-basics.ipynb"},{"file":"notebooks/wradlib/wradlib_clutter_beamblockage.ipynb"}],"title":"Py-ART and wradlib"},{"file":"notebooks/gpm-api/gpm-api-intro.ipynb"},{"children":[{"pattern":"notebooks/baltrad/baltrad_short_course/*.ipynb"},{"pattern":"notebooks/baltrad/pyart2baltrad/*.ipynb"},{"file":"notebooks/baltrad/baltrad2wradlib/baltrad2wradlib.ipynb"}],"title":"BALTRAD"},{"children":[{"file":"notebooks/lrose/LROSE_Basics.ipynb"},{"file":"notebooks/lrose/testing/stress_testing.ipynb"}],"title":"LROSE"}],"title":"Radar Software Foundations"},{"children":[{"file":"projects.md"},{"children":[{"file":"notebooks/lrose/DD_Tornado_ERAD24.ipynb"},{"file":"notebooks/Retrieving_winds_with_pydda.ipynb"},{"file":"notebooks/lrose/LROSE_ERAD_fractl_samurai.ipynb"}],"title":"LROSE \u0026 PyDDA multi doppler analysis"},{"children":[{"file":"notebooks/Analysis-Ready/ARCO-Datasets.ipynb"},{"file":"notebooks/Analysis-Ready/QPE-QVPs.ipynb"}],"title":"ARCO Radar Datasets"},{"children":[{"file":"notebooks/gpm-api/SR_GR_Calibration_Applied.ipynb"},{"file":"notebooks/gpm-api/SR_GR_Matching_Procedure.ipynb"}],"title":"Spaceborne - Ground Radar Matching and Calibration"},{"file":"notebooks/pyrad/description-pyrad-tutorial.ipynb"}],"title":"Project Workflows"}],"thumbnail":"/erad2024/_preview/111/build/0885e6292c6be2fd643fbc952d479a01.jpeg","exports":[],"bibliography":[],"index":"readme","pages":[{"slug":"how-to-cite","title":"How to Cite","description":"","date":"","thumbnail":"/erad2024/_preview/111/build/77214e045b66b8893a77f4793a31b1ba.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"schedule","title":"Schedule","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"level":1,"title":"Getting started"},{"slug":"getting-started","title":"Notebook Execution","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"intro-data-access","title":"Data Access Instructions","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"environment","title":"Environment overview","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Radar Software Foundations"},{"slug":"intro-to-open-radar-science","title":"An Introduction to Open Radar Science","description":"","date":"","thumbnail":"/erad2024/_preview/111/build/31631960e5ad8808b3289c31e033c7bf.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"xradar-basics","title":"Xradar Basics","description":"","date":"","thumbnail":"/erad2024/_preview/111/build/xradar_logo-6afafa20f95d9ebdba6dd467bd5a8abe.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":2,"title":"Py-ART and wradlib"},{"slug":"pyart-basics","title":"Py-ART Basics with Xradar","description":"","date":"","thumbnail":"/erad2024/_preview/111/build/arm_logo-8eb24d0ca02979674c9b7a2c42be2174.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"wradlib-clutter-beamblockage","title":"wradlib - clutter and beamblockage","description":"","date":"","thumbnail":"/erad2024/_preview/111/build/wradlib_logo.svg-632a8c70c575dd5d977b843285747573.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"gpm-api-intro","title":"Introduction to GPM-API","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":2,"title":"BALTRAD"},{"slug":"baltrad-io","title":"I/O model","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad-qc","title":"Quality Control","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad-drqc","title":"Quality Control using DR","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad-parallel-processing","title":"Parallel processing","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad-compositing","title":"Compositing","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad-pyart-rain-rate-example","title":"Rain Rate retrieval with Py-ART","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"pyart-baltrad-dealias-example","title":"Doppler Velocity Dealiasing with Py-ART","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad2wradlib","title":"Attenuation correction comparison with wradlib","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"LROSE"},{"slug":"lrose-basics","title":"An Introduction to LROSE","description":"","date":"","thumbnail":"/erad2024/_preview/111/build/colette_rose-04fdd4955b27b7afb0698bf821eef6da.jpg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"stress-testing","title":"stress-testing","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"Project Workflows"},{"slug":"projects","title":"Projects Overview","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":2,"title":"LROSE \u0026 PyDDA multi doppler analysis"},{"slug":"dd-tornado-erad24","title":"Introduction to Multidoppler Analysis","description":"","date":"","thumbnail":"/erad2024/_preview/111/build/logo-2a51d2c5875a2157457c94a178e89f75.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"retrieving-winds-with-pydda","title":"PyDDA tutorial","description":"","date":"","thumbnail":"/erad2024/_preview/111/build/5e2d147096249dc3a37da495168a9e9e.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"lrose-erad-fractl-samurai","title":"LROSE Wind Tutorial","description":"","date":"","thumbnail":"/erad2024/_preview/111/build/samurai-e283b264c57ee13ee973d49bc345649c.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"ARCO Radar Datasets"},{"slug":"arco-datasets","title":"Analysis-Ready Cloud-Optimized Datasets","description":"","date":"","thumbnail":"/erad2024/_preview/111/build/ARCO-17657a5969d0d7dd7614cf3e9b93f6a4.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"qpe-qvps","title":"QPE \u0026 QVPs","description":"","date":"","thumbnail":"/erad2024/_preview/111/build/QVP-25b8e6200a6aa9817e77abdcc7e8fabc.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"Spaceborne - Ground Radar Matching and Calibration"},{"slug":"sr-gr-calibration-applied","title":"Spaceborne-Ground Radar Calibration (Application)","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"sr-gr-matching-procedure","title":"Spaceborne-Ground Radar Matching (Methodology)","description":"","date":"","thumbnail":"/erad2024/_preview/111/build/cc72069fb56e0a54f1123fbe9c2fcb76.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"description-pyrad-tutorial","title":"Pyrad QPE Exercise","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/erad2024/_preview/111/build/manifest-FD44876C.js";
import * as route0 from "/erad2024/_preview/111/build/root-5DLIE3NT.js";
import * as route1 from "/erad2024/_preview/111/build/routes/$-7SLCSLL3.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/erad2024/_preview/111/build/entry.client-QAC4OMCW.js");</script></body></html>