<!DOCTYPE html><html lang="en" class="light" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Spaceborne-Ground Radar Calibration (Application) - ERAD 2024</title><meta property="og:title" content="Spaceborne-Ground Radar Calibration (Application) - ERAD 2024"/><meta name="generator" content="mystmd"/><meta name="keywords" content=""/><meta name="image" content="/erad2024/_preview/104/build/0885e6292c6be2fd643fbc952d479a01.jpeg"/><meta property="og:image" content="/erad2024/_preview/104/build/0885e6292c6be2fd643fbc952d479a01.jpeg"/><link rel="icon" href="/favicon.ico"/><link rel="stylesheet" href="/erad2024/_preview/104/build/_assets/app-IVMJSATM.css"/><link rel="stylesheet" href="/erad2024/_preview/104/build/_assets/thebe-core-C4ZDKLDU.css"/><link rel="stylesheet" href="/myst-theme.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="block px-2 py-1 text-black underline">Skip to article content</a></div><div class="bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 fixed w-screen top-0 z-30 h-[60px]"><nav class="flex items-center justify-between flex-wrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center"><div class="block xl:hidden"><button class="flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="2rem" height="2rem" class="m-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 013.75 6h16.5a.75.75 0 010 1.5H3.75A.75.75 0 013 6.75zM3 12a.75.75 0 01.75-.75h16.5a.75.75 0 010 1.5H3.75A.75.75 0 013 12zm0 5.25a.75.75 0 01.75-.75h16.5a.75.75 0 010 1.5H3.75a.75.75 0 01-.75-.75z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/erad2024/_preview/104/"><div class="p-1 mr-3"><img src="/erad2024/_preview/104/build/erad_white_backgroun-d1050665aa4e0c394f2b12d18727bd98.png" class="h-9 dark:hidden" height="2.25rem"/><img src="/erad2024/_preview/104/build/erad_white_backgroun-d1050665aa4e0c394f2b12d18727bd98.png" class="hidden h-9 dark:block" height="2.25rem"/></div><span class="text-md sm:text-xl tracking-tight sm:mr-5 sr-only">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"><div class="relative inline-block mx-2 grow-0"><a href="https://www.erad2024.it" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center w-full mx-2 py-1 text-md font-medium dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75">Conference Home</a></div><div class="relative inline-block mx-2 grow-0"><a href="https://openradarscience.org" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center w-full mx-2 py-1 text-md font-medium dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75">Community</a></div><div class="relative inline-block mx-2 grow-0"><a href="https://openradar.discourse.group/" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center w-full mx-2 py-1 text-md font-medium dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75">Discourse</a></div></div><div class="flex-grow block"></div><button class="theme rounded-full border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-8 h-8 mx-3" title="Change theme to dark mode." aria-label="Change theme to dark mode."><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="h-full w-full p-0.5"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z"></path></svg></button><div class="block sm:hidden"><div class="relative" data-headlessui-state=""><div><button class="flex text-sm bg-transparent rounded-full focus:outline-none" id="headlessui-menu-button-:Rciop:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Open Menu</span><div class="flex items-center text-stone-200 hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="2rem" height="2rem" class="p-1"><path fill-rule="evenodd" d="M10.5 6a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zm0 6a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zm0 6a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0z" clip-rule="evenodd"></path></svg></div></button></div></div></div><div class="hidden sm:block"><a href="https://binder.projectpythia.org/v2/gh/openradar/erad2024/main?labpath=notebooks" target="_blank" rel="noopener noreferrer" class="inline-block px-4 py-2 mx-1 mt-0 leading-none border rounded text-md border-stone-700 dark:border-white text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 hover:bg-neutral-100">Launch Environment</a></div></div></nav></div><div class="fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden z-10" style="top:60px"><div class="pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><nav aria-label="Table of Contents" class="flex-grow overflow-y-auto transition-opacity mt-6 pb-3 ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="w-full px-1 dark:text-white"><a title="ERAD 2024" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="/erad2024/_preview/104/">ERAD 2024</a><a title="How to Cite" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/erad2024/_preview/104/how-to-cite">How to Cite</a><a title="Schedule" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/erad2024/_preview/104/schedule">Schedule</a><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Getting started" class="block break-words rounded py-2 grow cursor-pointer">Getting started</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R4d8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R4d8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Radar Software Foundations" class="block break-words rounded py-2 grow cursor-pointer">Radar Software Foundations</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R5d8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R5d8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Project Workflows" class="block break-words rounded py-2 grow cursor-pointer">Project Workflows</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R6d8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R6d8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div></div></nav><div class="flex-none py-4 transition-all duration-700 translate-y-6 opacity-0"><a class="flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><article class="article content article-grid grid-gap" style="margin-top:60px"><main class="article-grid subgrid-gap col-screen"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="pt-5 mb-8"><div class="flex items-center h-6 mt-3 mb-5 text-sm font-light"><div class="flex-grow"></div><a href="https://opensource.org/licenses/Apache-2.0" target="_blank" rel="noopener noreferrer" title="Content License: Apache License 2.0 (Apache-2.0)" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="mx-1 inline-block opacity-60 hover:opacity-100 hover:text-[#599F46]"><path d="M13.2 15.6c1.4-.5 2.1-1.6 2.1-3.3S13.8 8.9 12 8.9c-1.9 0-3.3 1.6-3.3 3.3 0 1.8.8 3 2.2 3.4l-2.3 5.9c-3.1-.8-6.3-4.6-6.3-9.3 0-5.5 4.3-10 9.7-10s9.8 4.5 9.8 10c0 4.7-3.1 8.5-6.3 9.3l-2.3-5.9z"></path></svg></a><a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="noopener noreferrer" class="opacity-50 hover:opacity-100 text-inherit hover:text-inherit" aria-label="Code License: Creative Commons Attribution 4.0 International (CC-BY-4.0)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mx-1"><title>Code License: Creative Commons Attribution 4.0 International (CC-BY-4.0)</title><path d="M12 2.2c2.7 0 5 1 7 2.9.9.9 1.6 2 2.1 3.1.5 1.2.7 2.4.7 3.8 0 1.3-.2 2.6-.7 3.8-.5 1.2-1.2 2.2-2.1 3.1-1 .9-2 1.7-3.2 2.2-1.2.5-2.5.7-3.7.7s-2.6-.3-3.8-.8c-1.2-.5-2.2-1.2-3.2-2.1s-1.6-2-2.1-3.2-.8-2.4-.8-3.7c0-1.3.2-2.5.7-3.7S4.2 6 5.1 5.1C7 3.2 9.3 2.2 12 2.2zM12 4c-2.2 0-4.1.8-5.6 2.3C5.6 7.1 5 8 4.6 9c-.4 1-.6 2-.6 3s.2 2.1.6 3c.4 1 1 1.8 1.8 2.6S8 19 9 19.4c1 .4 2 .6 3 .6s2.1-.2 3-.6c1-.4 1.9-1 2.7-1.8 1.5-1.5 2.3-3.3 2.3-5.6 0-1.1-.2-2.1-.6-3.1-.4-1-1-1.8-1.7-2.6C16.1 4.8 14.2 4 12 4zm-.1 6.4l-1.3.7c-.1-.3-.3-.5-.5-.6-.2-.1-.4-.2-.6-.2-.9 0-1.3.6-1.3 1.7 0 .5.1.9.3 1.3.2.3.5.5 1 .5.6 0 1-.3 1.2-.8l1.2.6c-.3.5-.6.9-1.1 1.1-.5.3-1 .4-1.5.4-.9 0-1.6-.3-2.1-.8-.5-.6-.8-1.3-.8-2.3 0-.9.3-1.7.8-2.2.6-.6 1.3-.8 2.1-.8 1.2 0 2.1.4 2.6 1.4zm5.6 0l-1.3.7c-.1-.3-.3-.5-.5-.6-.2-.1-.4-.2-.6-.2-.9 0-1.3.6-1.3 1.7 0 .5.1.9.3 1.3.2.3.5.5 1 .5.6 0 1-.3 1.2-.8l1.2.6c-.3.5-.6.9-1.1 1.1-.4.2-.9.3-1.4.3-.9 0-1.6-.3-2.1-.8s-.8-1.3-.8-2.2c0-.9.3-1.7.8-2.2.5-.5 1.2-.8 2-.8 1.2 0 2.1.4 2.6 1.4z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1"><title>Credit must be given to the creator</title><path d="M12 2.2c2.7 0 5 .9 6.9 2.8 1.9 1.9 2.8 4.2 2.8 6.9s-.9 5-2.8 6.8c-2 1.9-4.3 2.9-7 2.9-2.6 0-4.9-1-6.9-2.9-1.8-1.7-2.8-4-2.8-6.7s1-5 2.9-6.9C7 3.2 9.3 2.2 12 2.2zM12 4c-2.2 0-4.1.8-5.6 2.3C4.8 8 4 9.9 4 12c0 2.2.8 4 2.4 5.6C8 19.2 9.8 20 12 20c2.2 0 4.1-.8 5.7-2.4 1.5-1.5 2.3-3.3 2.3-5.6 0-2.2-.8-4.1-2.3-5.7C16.1 4.8 14.2 4 12 4zm2.6 5.6v4h-1.1v4.7h-3v-4.7H9.4v-4c0-.2.1-.3.2-.4.1-.2.2-.2.4-.2h4c.2 0 .3.1.4.2.2.1.2.2.2.4zm-4-2.5c0-.9.5-1.4 1.4-1.4s1.4.5 1.4 1.4c0 .9-.5 1.4-1.4 1.4s-1.4-.5-1.4-1.4z"></path></svg></a><a href="https://en.wikipedia.org/wiki/Open_access" target="_blank" rel="noopener noreferrer" title="Open Access" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="mr-1 inline-block opacity-60 hover:opacity-100 hover:text-[#E18435]"><path d="M17.1 12.6h-2V7.5c0-1.7-1.4-3.1-3-3.1-.8 0-1.6.3-2.2.9-.6.5-.9 1.3-.9 2.2v.7H7v-.7c0-1.4.5-2.7 1.5-3.7s2.2-1.5 3.6-1.5 2.6.5 3.6 1.5 1.5 2.3 1.5 3.7v5.1z"></path><path d="M12 21.8c-.8 0-1.6-.2-2.3-.5-.7-.3-1.4-.8-1.9-1.3-.6-.6-1-1.2-1.3-2-.3-.8-.5-1.6-.5-2.4s.2-1.6.5-2.4c.3-.7.7-1.4 1.3-2s1.2-1 1.9-1.3c.7-.3 1.5-.5 2.3-.5.8 0 1.6.2 2.3.5.7.3 1.4.8 1.9 1.3.6.6 1 1.2 1.3 2 .3.8.5 1.6.5 2.4s-.2 1.6-.5 2.4c-.3.7-.7 1.4-1.3 2-.6.6-1.2 1-1.9 1.3-.7.3-1.5.5-2.3.5zm0-10.3c-2.2 0-4 1.8-4 4.1s1.8 4.1 4 4.1 4-1.8 4-4.1-1.8-4.1-4-4.1z"></path><circle cx="12" cy="15.6" r="1.7"></circle></svg></a><a href="https://github.com/openradar/erad2024" title="GitHub Repository: openradar/erad2024" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a><div class="inline-block mr-1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block"><path d="M20.2 1.7c0 .8-.5 1.4-1.3 1.5-.8 0-1.4-.5-1.5-1.3 0-.8.5-1.4 1.3-1.5.8-.1 1.5.5 1.5 1.3zM12 17.9c-3.7 0-7-1.3-8.7-3.3 1.8 4.8 7.1 7.3 11.9 5.5 2.5-.9 4.5-2.9 5.5-5.5-1.7 2-4.9 3.3-8.7 3.3zM12 5.1c3.7 0 7 1.3 8.7 3.3-1.8-4.8-7.1-7.3-11.9-5.5-2.5.9-4.5 2.9-5.5 5.5 1.7-2 5-3.3 8.7-3.3zM6.9 21.8c.1 1-.7 1.8-1.7 1.9-1 .1-1.8-.7-1.9-1.7 0-1 .7-1.8 1.7-1.9 1-.1 1.8.7 1.9 1.7zM3.7 4.6c-.6 0-1-.4-1-1s.4-1 1-1 1 .4 1 1c0 .5-.4 1-1 1z"></path></svg></div><div class="relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="relative ml-2 -mr-1" id="headlessui-menu-button-:Rd4fop:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem"><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="mb-0">Spaceborne-Ground Radar Calibration (Application)</h1><header class="mt-4 not-prose"><div><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rhkfop:" data-state="closed">Alfonso Ladino</button><a class="ml-1" href="https://orcid.org/0000-0001-8081-7827" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rikfop:" data-state="closed">Anna del Moral Méndez</button><a class="ml-1" href="https://orcid.org/0000-0002-5015-840X" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rjkfop:" data-state="closed">Brenda Javornik</button><a class="ml-1" href="https://orcid.org/0009-0004-9266-9293" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rkkfop:" data-state="closed">Daniel Michelson</button><a class="ml-1" href="https://orcid.org/0000-0003-3222-9881" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rlkfop:" data-state="closed">Daniel Wolfensberger</button><a class="ml-1" href="https://orcid.org/0009-0006-1419-0556" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rmkfop:" data-state="closed">Gionata Ghiggi</button><a class="ml-1" href="https://orcid.org/0000-0002-0818-0865" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rnkfop:" data-state="closed">Jen DeHart</button><a class="ml-1" href="https://orcid.org/0000-0001-8536-4927" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rokfop:" data-state="closed">Jordi Figueras i Ventura</button><a class="ml-1" href="https://orcid.org/0000-0002-4949-422X" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rpkfop:" data-state="closed">Julian Giles</button><a class="ml-1" href="https://orcid.org/0000-0001-8134-008X" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rqkfop:" data-state="closed">Kai Mühlbauer</button><a class="ml-1" href="https://orcid.org/0000-0001-6599-1034" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rrkfop:" data-state="closed">Maxwell Grover</button><a class="ml-1" href="https://orcid.org/0000-0002-0370-8974" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rskfop:" data-state="closed">Mike Dixon</button><a class="ml-1" href="https://orcid.org/0000-0002-9597-9113" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rtkfop:" data-state="closed">Robert Jackson</button><a class="ml-1" href="https://orcid.org/0000-0003-2518-1234" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rukfop:" data-state="closed">Scott Collis</button><a class="ml-1" href="https://orcid.org/0000-0002-2303-687X" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span><span class="font-semibold text-sm inline-block"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rvkfop:" data-state="closed">Ting-Yu Cha</button><a class="ml-1" href="https://orcid.org/0000-0002-6292-8483" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span></div></header></div><div class="block my-10 lg:sticky lg:top-0 lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:93px"><nav></nav></div><div class="sticky top-[60px] flex justify-end w-full z-20 pointer-events-none"><div class="flex p-1 m-1 space-x-1 border rounded-full shadow pointer-events-auto border-stone-300 bg-white/80 dark:bg-stone-900/80 backdrop-blur"><div class="rounded"><button class="flex text-center rounded-full cursor-pointer text-stone-800 dark:text-white hover:opacity-100 opacity-60" aria-label="start compute environment"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="inline-block w-6 h-6 align-top"><title>enable compute</title><path stroke-linecap="round" stroke-linejoin="round" d="M5.636 5.636a9 9 0 1012.728 0M12 3v9"></path></svg></button></div></div></div><div id="skip-to-article"></div><div id="DdaSSllHcD" class="relative group/block article-grid subgrid-gap col-screen"><p>In this tutorial, we demonstrate how to exploit GPM-API along with other radar software such
<a target="_blank" href="https://docs.openradarscience.org/projects/xradar/en/stable/" rel="noreferrer">xradar</a> and
<a target="_blank" href="https://docs.wradlib.org/en/latest/" rel="noreferrer">wradlib</a> to match reflectivities measurements of spaceborne (SR) and ground (GR) radars and assess the GR calibration bias.</p><p>As example, we analyze a coincident GPM DPR and NEXRAD overpass over San Diego, USA, during the landfall of Tropical Storm Hilary in 2023. The NEXRAD KNKX radar data appears to be significantly miscalibrated and we will assess the calibration bias.</p><p>To facilitate your hands-on experience, we’ve preprocessed the native NEXRAD radar data using the xradar package and the coincident GPM DPR overpass using GPM-API. The resulting data has been uploaded in Zarr format to the Pythia Cloud Bucket, allowing you to start the tutorial directly in the Binder environment.</p><p>If you wish to adapt this tutorial to your own case study, you can use the xradar package to read your GR radar data into the expected xarray format. Similarly, you can retrieve the relevant GPM data using GPM-API.</p><p>Additionally, note that the GPM-API’s <code>volume_matching</code> routine can automatically download and open the coincident GPM overpass data if the SR dataset is not provided to the function.</p><p>Please read the <a target="_blank" href="https://gpm-api.readthedocs.io/en/latest/tutorials/tutorial_03_SR_GR_Matching.html" rel="noreferrer">Spaceborne-Ground Radar Matching Tutorial</a> for a step-by-step guide through the process of obtaining spatially and temporally coincident radar samples.</p></div><div id="UNLH17j2jb" class="relative group/block article-grid subgrid-gap col-screen"><p>Now let’s start the tutorial by importing the required packages:</p></div><div id="qWiwRXQWgu" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">import warnings

warnings.filterwarnings(&quot;ignore&quot;)

from functools import reduce

import cartopy.crs as ccrs
import fsspec
import numpy as np
import xradar as xd
import xarray as xr
from IPython.display import display
from xarray.backends.api import open_datatree
from gpm.gv import (
    calibration_summary,
    compare_maps,
    reflectivity_scatterplots,
    volume_matching,
)

np.set_printoptions(suppress=True)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="SL7A0QT6fZpnGALT2wPEs" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="VlACs10pE2" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="load-sr-and-gr-data" class="relative group"><span class="heading-text">Load SR and GR data</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#load-sr-and-gr-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="w5UsKWt5ZL" class="relative group/block article-grid subgrid-gap col-screen"><p>Now let’s open the NEXRAD GR data and the GPM granule with the coincident overpass.</p></div><div id="HzOoLVw9a0" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Open fsspec connection to the bucket
bucket_url = &quot;https://js2.jetstream-cloud.org:8001&quot;
fs = fsspec.filesystem(&quot;s3&quot;, anon=True, client_kwargs=dict(endpoint_url=bucket_url))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Um1w8UFlK6mNb9lN1kbEn" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="WN8I1khwQV" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Open the GR datatree
file = fs.get_mapper(f&quot;pythia/radar/erad2024/gpm_api/KNKX20230820_221341_V06.zarr&quot;)
dt_gr = open_datatree(file, engine=&quot;zarr&quot;, consolidated=True, chunks={})
display(dt_gr)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="ssyEjL7tkH8hKxJ0nH1x0" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="kdwHXcsNFT" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Open the SR dataset
file = fs.get_mapper(
    f&quot;pythia/radar/erad2024/gpm_api/2A.GPM.DPR.V9-20211125.20230820-S213941-E231213.053847.V07B.zarr&quot;
)
ds_sr = xr.open_zarr(file, consolidated=True, chunks={})</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="nbKqxCdbOsRFV924e1W9f" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="RIQI2HVYGK" class="relative group/block article-grid subgrid-gap col-screen"><p>Now, let’s select a GR sweep to match with GPM DPR:</p></div><div id="gWveOSoyzJ" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">print(&quot;Available sweeps:&quot;, list(dt_gr.groups))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="xbBgqDtQA6mg8TU0NsMQ6" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Available sweeps: [&#x27;/&#x27;, &#x27;/sweep_0&#x27;, &#x27;/sweep_1&#x27;, &#x27;/sweep_10&#x27;, &#x27;/sweep_11&#x27;, &#x27;/sweep_12&#x27;, &#x27;/sweep_13&#x27;, &#x27;/sweep_14&#x27;, &#x27;/sweep_15&#x27;, &#x27;/sweep_16&#x27;, &#x27;/sweep_17&#x27;, &#x27;/sweep_18&#x27;, &#x27;/sweep_19&#x27;, &#x27;/sweep_2&#x27;, &#x27;/sweep_3&#x27;, &#x27;/sweep_4&#x27;, &#x27;/sweep_5&#x27;, &#x27;/sweep_6&#x27;, &#x27;/sweep_7&#x27;, &#x27;/sweep_8&#x27;, &#x27;/sweep_9&#x27;]
</span></code></pre></div></div></div><div id="G7P3fmCd1u" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">sweep_idx = 0
sweep_group = f&quot;sweep_{sweep_idx}&quot;  # GR sweep (elevation to be used)
ds_gr = dt_gr[sweep_group].to_dataset().compute()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="AgLqOlUEFuKBqHO23o2DK" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="qyyx3kHKLm" class="relative group/block article-grid subgrid-gap col-screen"><p>and display the horizontally and vertically polarized reflectivity fields:</p></div><div id="KMJstT3Sa9" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">ds_gr[&quot;DBZH&quot;].where(ds_gr[&quot;DBZH&quot;] &gt; -10).xradar_dev.plot_map()
ds_gr[&quot;DBZV&quot;] = (ds_gr[&quot;DBZH&quot;].gpm.idecibel / ds_gr[&quot;ZDR&quot;].gpm.idecibel).gpm.decibel
ds_gr[&quot;DBZV&quot;].where(ds_gr[&quot;DBZV&quot;] &gt; -10).xradar_dev.plot_map()
# ds_gr[&quot;ZDR&quot;].xradar_dev.plot_map()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="msGAw0DCUxsZ9jdU5RXAo" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&lt;cartopy.mpl.geocollection.GeoQuadMesh at 0x7f345024fb90&gt;</span></code></div><img src="/erad2024/_preview/104/build/16dedf597daa0bf6263fe252b5aa490f.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/erad2024/_preview/104/build/57670c565a927d65915dd7ad3b3cb552.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="X0QKeyjQhg" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="run-sr-gr-volume-matching" class="relative group"><span class="heading-text">Run SR/GR volume matching</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#run-sr-gr-volume-matching" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="cvcTupz1Ep" class="relative group/block article-grid subgrid-gap col-screen"><p>Here we start defining the required settings for the SR/GR volume matching procedure:</p><ul><li>The GR <code>radar_band</code> controls to which frequency SR Ku-band reflectivities will be converted. Valid values are <code>X</code>, <code>C</code>, <code>S</code>, <code>Ku</code>.</li><li>The <code>beamwidth_gr</code> refers to the angular beam width of the GR.</li><li>The minimum reflectivity thresholds <code>z_min_threshold_sr</code> and <code>z_min_threshold_gr</code> are used to mask out SR and GR
gates belows such thresholds.</li></ul></div><div id="aQ2jv53go7" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">radar_band = &quot;S&quot;
beamwidth_gr = 1
z_min_threshold_gr = 0
z_min_threshold_sr = 10</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="p4KxDcvzZzZNfHE1iaY2O" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="QmX816JTq0" class="relative group/block article-grid subgrid-gap col-screen"><p>The SR/GR volume matching routine typically takes around 40-50 seconds to complete. It returns a <code>geopandas.DataFrame</code> with the matched aggregated reflectivities and the associated statistics.</p></div><div id="daeKuDffA8" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">gdf_match = volume_matching(
    ds_gr=ds_gr,
    ds_sr=ds_sr,
    z_variable_gr=&quot;DBZH&quot;,
    radar_band=radar_band,
    beamwidth_gr=beamwidth_gr,
    z_min_threshold_gr=z_min_threshold_gr,
    z_min_threshold_sr=z_min_threshold_sr,
    min_gr_range=0,
    max_gr_range=150_000,
    # gr_sensitivity_thresholds=None,
    # sr_sensitivity_thresholds=None,
    download_sr=False,  # require internet connection !
    display_quicklook=True,
)
# Note: The circle radius in the quicklook represents the min_gr_range, max_gr_range and 250_000 m range distances.</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="HhEDEFBw1J6D0e4Df9Xte" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/104/build/085ae29473c77fc2252377882a84b3c3.png" alt="&lt;Figure size 960x480 with 4 Axes&gt;"/><div><pre class="text-sm font-thin font-system"><code><span>SR/GR Matching Elapsed time: 0:00:22.642378 .
</span></code></pre></div></div></div><div id="i4wUR1uDMB" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">display(gdf_match)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="URFaDzWldafNkgUPp0sJr" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="kesO6cFIiZ" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="analyse-sr-gr-database" class="relative group"><span class="heading-text">Analyse SR/GR database</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#analyse-sr-gr-database" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="psxBx7thVp" class="relative group/block article-grid subgrid-gap col-screen"><p>Now let’s first define the variables names of the SR and GR reflectivities:</p></div><div id="tkwzHUjhIb" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">sr_z_column = f&quot;SR_zFactorFinal_{radar_band}_mean&quot;
gr_z_column = &quot;GR_Z_mean&quot;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="PhVgJj2I0Ik1l_uP7YoRc" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="VTNlxDbRHF" class="relative group/block article-grid subgrid-gap col-screen"><h3 id="compare-spatial-reflectivity-fields" class="relative group"><span class="heading-text">Compare spatial reflectivity fields</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#compare-spatial-reflectivity-fields" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="roT3hAZkLn" class="relative group/block article-grid subgrid-gap col-screen"><p>Here we start comparing the spatial reflectivity fields without applying restrictive filtering criteria:</p></div><div id="Rqb7dnesgx" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">fig = compare_maps(
    gdf_match,
    sr_column=sr_z_column,
    gr_column=gr_z_column,
    sr_label=&quot;SR Reflectivity (dBz)&quot;,
    gr_label=&quot;GR Reflectivity (dBz)&quot;,
    cmap=&quot;Spectral_r&quot;,
    unified_color_scale=True,
    vmin=15,
    # vmax=40
)
fig.tight_layout()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="oR10pb9vxqTgPxngccZo9" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/104/build/b5a257ddc3e7c513eed1394adfc8d493.png" alt="&lt;Figure size 1400x700 with 4 Axes&gt;"/></div></div><div id="T8jmvH8uBY" class="relative group/block article-grid subgrid-gap col-screen"><p>If you wish to create a cartopy map, specify the <code>&#x27;projection&#x27;</code> in the <code>subplot_kwargs</code> argument:</p></div><div id="ucyhhhdqs3" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">ccrs_gr_aeqd = ccrs.AzimuthalEquidistant(
    central_longitude=ds_gr[&quot;longitude&quot;].item(),
    central_latitude=ds_gr[&quot;latitude&quot;].item(),
)
subplot_kwargs = {}
subplot_kwargs[&quot;projection&quot;] = ccrs_gr_aeqd
fig = compare_maps(
    gdf_match,
    sr_column=sr_z_column,
    gr_column=gr_z_column,
    sr_label=&quot;SR Reflectivity (dBz)&quot;,
    gr_label=&quot;GR Reflectivity (dBz)&quot;,
    cmap=&quot;Spectral_r&quot;,
    unified_color_scale=True,
    vmin=15,
    # vmax=40
    subplot_kwargs=subplot_kwargs,
)
fig.tight_layout()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="v6Get0_2nFP84hB3aFPkR" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/104/build/309c54e0aa461eaed070317c44d6d81c.png" alt="&lt;Figure size 1400x700 with 4 Axes&gt;"/></div></div><div id="hH0ggpHXam" class="relative group/block article-grid subgrid-gap col-screen"><p>Here we show how to explore interactively the reflectivity fields using <a target="_blank" href="https://python-visualization.github.io/folium/latest/" rel="noreferrer">Folium</a>:</p></div><div id="MBa3HH9hHi" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">gdf_match.explore(column=&quot;GR_Z_mean&quot;, legend=True, cmap=&quot;Spectral_r&quot;, vmin=0, vmax=40)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="5Q9MAfEiZmOmfZA-L_OM1" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="pYeuS5QhLf" class="relative group/block article-grid subgrid-gap col-screen"><h3 id="generate-calibration-summary" class="relative group"><span class="heading-text">Generate calibration summary</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#generate-calibration-summary" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="lNiLd2rkuG" class="relative group/block article-grid subgrid-gap col-screen"><p>We now create a figure comparing SR/GR aggregated reflectivities volume-by-volume and displaying the overall distributions.</p></div><div id="J7E58QHrap" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">gr_z_column = &quot;GR_Z_mean&quot;
sr_z_column = f&quot;SR_zFactorFinal_{radar_band}_mean&quot;

fig = calibration_summary(
    df=gdf_match,
    gr_z_column=gr_z_column,
    sr_z_column=sr_z_column,
    # Histogram options
    bin_width=2,
    # Scatterplot options
    hue_column=&quot;SR_fraction_clutter&quot;,
    # gr_range=[15, 50]
    # sr_range=[15, 50]
    marker=&quot;+&quot;,
    cmap=&quot;Spectral&quot;,
)
fig.tight_layout()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="YtMZMSw7kZxS880ORHkLn" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/104/build/397f63b202f07522ea8b0f537a1c0380.png" alt="&lt;Figure size 1200x500 with 3 Axes&gt;"/></div></div><div id="iVgCcz5qir" class="relative group/block article-grid subgrid-gap col-screen"><h3 id="investigate-filtering-criteria" class="relative group"><span class="heading-text">Investigate filtering criteria</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#investigate-filtering-criteria" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="ZLVJ4nJJT6" class="relative group/block article-grid subgrid-gap col-screen"><p>When comparing SR and GR data or trying to determine an accurate GR calibration bias, it’s necessary to define a set of filtering criteria. In the figures below, we perform exploratory data analysis to investigate the relationships between the SR/GR reflectivity deviations and sets of variables characterizing radar measurements and SR/GR volume properties. The patterns and deviations observed in the scatterplots will be used to define a set of filtering critera in the next section of the tutorial.</p></div><div id="jTkfdQgraG" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Matching characteristics
hue_columns = [
    &quot;VolumeRatio&quot;,
    &quot;VolumeDiff&quot;,
    &quot;GR_vres_max&quot;,
    &quot;GR_range_max&quot;,
    &quot;GR_gate_volume_sum&quot;,
    &quot;SR_gate_volume_sum&quot;,
    &quot;SR_vres_sum&quot;,
    &quot;GR_fraction_covered_area&quot;,
]
fig = reflectivity_scatterplots(
    df=gdf_match,
    gr_z_column=gr_z_column,
    sr_z_column=sr_z_column,
    hue_columns=hue_columns,
    ncols=2,
)
fig.tight_layout()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="52RfVZ9KtSEhSvrraV5QV" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/104/build/f3bbd8aacd128c5b114f4deb64d97901.png" alt="&lt;Figure size 1200x2000 with 16 Axes&gt;"/></div></div><div id="eOICnTKSmi" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Value validity &amp; sensitivity
hue_columns = [
    &quot;GR_counts&quot;,
    &quot;GR_counts_valid&quot;,
    &quot;SR_counts&quot;,
    &quot;SR_counts_valid&quot;,
]
fig = reflectivity_scatterplots(
    df=gdf_match,
    gr_z_column=gr_z_column,
    sr_z_column=sr_z_column,
    hue_columns=hue_columns,
    ncols=2,
)
fig.tight_layout()

hue_columns = [
    &quot;SR_zFactorFinal_Ku_fraction_above_12dBZ&quot;,
    &quot;SR_zFactorFinal_Ku_fraction_above_14dBZ&quot;,
    &quot;GR_Z_fraction_above_10dBZ&quot;,
    &quot;GR_Z_fraction_above_12dBZ&quot;,
]
fig = reflectivity_scatterplots(
    df=gdf_match,
    gr_z_column=gr_z_column,
    sr_z_column=sr_z_column,
    hue_columns=hue_columns,
    ncols=2,
)
fig.tight_layout()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="s9wLsgkjlg3-jmPRx4-jN" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/104/build/4f0882eb2356018f2a2ae6e3813fbc28.png" alt="&lt;Figure size 1200x1000 with 8 Axes&gt;"/><img src="/erad2024/_preview/104/build/7842b72ad66dfbb7ce581685591b9229.png" alt="&lt;Figure size 1200x1000 with 8 Axes&gt;"/></div></div><div id="yVlnwg0nH7" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># NUBF &amp; Variability
hue_columns = [
    &quot;SR_zFactorFinal_Ku_range&quot;,
    &quot;GR_Z_range&quot;,
    &quot;SR_zFactorFinal_Ku_std&quot;,
    &quot;GR_Z_std&quot;,
    &quot;SR_zFactorFinal_Ku_cov&quot;,
    &quot;GR_Z_cov&quot;,
]
fig = reflectivity_scatterplots(
    df=gdf_match,
    gr_z_column=gr_z_column,
    sr_z_column=sr_z_column,
    hue_columns=hue_columns,
    ncols=2,
)
fig.tight_layout()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Qk7YXFziD7NyeqQXG1DM1" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/104/build/f6e4e8f37e2ad0b81d01aa63ad77b295.png" alt="&lt;Figure size 1200x1500 with 12 Axes&gt;"/></div></div><div id="UfiM35QDCI" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Attenuation
hue_columns = [
    &quot;SR_pathAtten&quot;,
    &quot;SR_piaFinal&quot;,
    &quot;SR_zFactorCorrection_Ku_max&quot;,
    &quot;SR_zFactorCorrection_Ku_mean&quot;,
    &quot;SR_reliabFlag&quot;,
    &quot;GR_Z_cumsum_max&quot;,
]
fig = reflectivity_scatterplots(
    df=gdf_match,
    gr_z_column=gr_z_column,
    sr_z_column=sr_z_column,
    hue_columns=hue_columns,
    ncols=2,
)
fig.tight_layout()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="RtgA6VLA8mdQ7e57EfeFZ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/104/build/332d8e08cde5d636b901748d0f95421b.png" alt="&lt;Figure size 1200x1500 with 12 Axes&gt;"/></div></div><div id="NRFVtFLlT3" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Hydrometeors
hue_columns = [
    &quot;SR_fraction_no_precip&quot;,
    &quot;SR_fraction_clutter&quot;,
    &quot;SR_fraction_rain&quot;,
    &quot;SR_fraction_snow&quot;,
    &quot;SR_fraction_hail&quot;,
    &quot;SR_fraction_below_isotherm&quot;,
    &quot;SR_fraction_above_isotherm&quot;,
    &quot;SR_fraction_melting_layer&quot;,
    # &#x27;SR_airTemperature_min&#x27;,
]
fig = reflectivity_scatterplots(
    df=gdf_match,
    gr_z_column=gr_z_column,
    sr_z_column=sr_z_column,
    hue_columns=hue_columns,
    ncols=2,
)
fig.tight_layout()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="jOOwc3flKYvVCxzdfG3dR" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/104/build/d91fe38c236c59e6991b237e64bd60d4.png" alt="&lt;Figure size 1200x2000 with 16 Axes&gt;"/></div></div><div id="d32xcYMOLy" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># SR Quality Flags
hue_columns = [
    &quot;SR_flagPrecipitationType&quot;,
    &quot;SR_qualityTypePrecip&quot;,
    &quot;SR_qualityBB&quot;,
    &quot;SR_flagPrecip&quot;,
    &quot;SR_qualityFlag&quot;,
    &quot;SR_dataQuality&quot;,
]
fig = reflectivity_scatterplots(
    df=gdf_match,
    gr_z_column=gr_z_column,
    sr_z_column=sr_z_column,
    hue_columns=hue_columns,
    ncols=2,
)
fig.tight_layout()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Mowqd4Qqk7vKqOM_lxcwa" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/104/build/b7b83268383103e1537daff73a801c46.png" alt="&lt;Figure size 1200x1500 with 12 Axes&gt;"/></div></div><div id="SdmzmoRLa7" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="define-sr-gr-filtering-criteria" class="relative group"><span class="heading-text">Define SR/GR filtering criteria</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#define-sr-gr-filtering-criteria" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>When calibrating or comparing SR and GR data, there is a necessary tradeoff between the strictness of filtering criteria filtering and the number of available samples. Here below we provide some general recommendations for effective filtering:</p><ol start="1"><li><p><strong>Sensitivity Thresholds</strong>: Retain only those radar beams where the aggregated gate reflectivities exceed the instrument sensitivities.
The <code>GR_Z_fraction_above_&lt;thr&gt;dBZ</code> and <code>SR_zFactorFinal_Ku_fraction_above_&lt;thr&gt;dBZ</code> variables can be used filter the samples.</p></li><li><p><strong>Stratiform Precipitation</strong>:  If the purpose of your analysis is to assess the calibration bias of GR data, it is suggested to focus on stratiform precipitation that ocurrs outside the melting layer (i.e. avoiding the bright band). Only stratiform samples above the melting layer are used in ground validation of the GPM DPR (W. Petersen 2017, personal communication).
Convective SR footprints are typically excluded to avoid dealing with:</p><ul><li>the high spatial variability in the precipitation field and issues with non-uniform beam filling (NUBF),</li><li>the potential biases introduced by the SR attenuation correction,</li><li>the potential biases in GR reflectivities, especially at C and X band, due to beam attenuation,</li><li>the multiple scattering signature caused by hail particles.</li></ul></li><li><p><strong>Reflectivity Range</strong>: According to Warren et al. (2018), volume-averaged SR and GR reflectivity values should be selected within the range of 24 to 36 dBZ. This range minimizes the impact of low SR sensitivity,  SR beam attenuation and non-rayleigh scattering effects.</p></li><li><p><strong>Clutter Removal</strong>: Exclude SR/GR samples that are contaminated by ground clutter, anomalous propagation, or beam blockage.</p></li><li><p><strong>Volume matching</strong>: Exclude SR/GR samples where there are excessive differences in the total gate volume.</p></li></ol></div><div id="xvnHDsQHgE" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Define masks
masks = [
    # Select SR scan with &quot;normal&quot; dataQuality (for entire cross-track scan)
    gdf_match[&quot;SR_dataQuality&quot;] == 0,
    # Select SR beams with detected precipitation
    gdf_match[&quot;SR_flagPrecip&quot;] &gt; 0,
    # Select only &#x27;high quality&#x27; SR data
    # - qualityFlag == 1 indicates low quality retrievals
    # - qualityFlag == 2 indicates bad/missing retrievals
    gdf_match[&quot;SR_qualityFlag&quot;] == 0,
    # Select SR beams with SR above minimum reflectivity
    gdf_match[&quot;SR_zFactorFinal_Ku_fraction_above_12dBZ&quot;] &gt; 0.95,
    # Select SR beams with GR above minimum reflectivity
    gdf_match[&quot;GR_Z_fraction_above_10dBZ&quot;] &gt; 0.95,
    # Select only SR beams with detected bright band
    gdf_match[&quot;SR_qualityBB&quot;] == 1,
    # Select only beams with confident precipitation type
    gdf_match[&quot;SR_qualityTypePrecip&quot;] == 1,
    # Select only stratiform precipitation
    # - SR_flagPrecipitationType == 2 indicates convective
    gdf_match[&quot;SR_flagPrecipitationType&quot;] == 1,
    # Select only SR beams with reliable attenuation correction
    gdf_match[&quot;SR_reliabFlag&quot;].isin((1, 2)),  # or == 1
    # Select only beams with reduced path attenuation
    # gdf_match[&quot;SR_zFactorCorrection_Ku_max&quot;]
    # gdf_match[&quot;SR_piaFinal&quot;]
    # gdf_match[&quot;SR_pathAtten&quot;]
    # Select only SR beams with matching SR gates with no clutter
    gdf_match[&quot;SR_fraction_clutter&quot;] == 0,
    # Select only SR beams with matching SR gates not in the melting layer
    gdf_match[&quot;SR_fraction_melting_layer&quot;] == 0,
    # Select only SR beams with matching SR gates with precipitation
    gdf_match[&quot;SR_fraction_no_precip&quot;] == 0,
    # Select only SR beams with matching SR gates with no hail
    gdf_match[&quot;SR_fraction_hail&quot;] == 0,
    # Select only SR beams with matching SR gates with rain
    # gdf_match[&quot;SR_fraction_rain&quot;] == 1,
    # Select only SR beams with matching SR gates with snow
    # gdf_match[&quot;SR_fraction_snow&quot;] == 1,
    # Discard SR beams with high NUBF
    # gdf_match[&quot;SR_zFactorFinal_Ku_range&quot;] &gt; 5,
    # gdf_match[&quot;SR_zFactorFinal_Ku_cov&quot;] &lt; 0.5,
    # gdf_match[&quot;GR_Z_cov&quot;] &lt; 0.5,
    gdf_match[&quot;GR_Z_range&quot;] &lt; 15,
    # Select only interval of reflectivities
    # - Warren et al., 2018:  between 24 and 36 dBZ
    # (gdf_match[&quot;SR_zFactorFinal_Ku_mean&quot;] &gt; 24) &amp; (gdf_match[&quot;SR_zFactorFinal_Ku_mean&quot;] &lt; 36),
    # (gdf_match[&quot;GR_Z_mean&quot;] &gt; 24) &amp; (gdf_match[&quot;GR_Z_mean&quot;] &lt; 36),
    # Select SR beams only within given GR radius interval
    # (gdf_match[&quot;GR_range_min&quot;] &gt; min_gr_range) &amp; (gdf_match[&quot;GR_range_max&quot;] &lt; max_gr_range),
    # Discard SR beams where scanning time difference &gt; 5 minutes
    # - time_difference is in seconds !
    gdf_match[&quot;time_difference&quot;] &lt; 60 * 5,
    # Discard SR beams where GR gates does not cover 80% of the horizontal area
    gdf_match[&quot;GR_fraction_covered_area&quot;] &gt; 0.8,
    # # Filter footprints where volume ratio exceeds 60
    # gdf_match[&quot;VolumeRatio&quot;] &gt; 60,
    # Filter footprints where GR affected by beam blockage
    # TODO: Filtering by beam blockage
]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="CCPDCmtCSHldljTeczYdD" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="aE0CF73paN" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Define final mask
mask_final = reduce(np.logical_and, masks)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="TM2n6btx5GuL8mQLg42oC" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="l4m1NUwnVk" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Dsplay final filtering mask
gdf_match[&quot;filtering_mask&quot;] = mask_final
reflectivity_scatterplots(
    df=gdf_match,
    gr_z_column=gr_z_column,
    sr_z_column=sr_z_column,
    hue_columns=&quot;filtering_mask&quot;,
    marker=&quot;o&quot;,
    s=1,
    cmap=&quot;viridis_r&quot;,
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="ej5cv2pK7Nd1F-f5XJWCS" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/104/build/cc3864cfe7b74ab12ad68532be8f3ec1.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="r5EkBTme2a" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="analyze-filtered-sr-gr-database" class="relative group"><span class="heading-text">Analyze filtered SR/GR database</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#analyze-filtered-sr-gr-database" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="rYoxpiWQ1A" class="relative group/block article-grid subgrid-gap col-screen"><p>We now filter the SR/GR Database, compare the reflectivity fields and display the new calibration summary:</p></div><div id="ysmrddV87V" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">gdf_final = gdf_match[mask_final]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="VrCBg7eU0BgH7FmbwksJv" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="CxZRjonHzk" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">fig = compare_maps(
    gdf_final,
    sr_column=sr_z_column,
    gr_column=gr_z_column,
    sr_label=&quot;SR Reflectivity (dBz)&quot;,
    gr_label=&quot;GR Reflectivity (dBz)&quot;,
    cmap=&quot;Spectral_r&quot;,
    unified_color_scale=True,
    vmin=15,
    # vmax=40
)
fig.tight_layout()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="FBovozW6V_QFmMwVKtXUc" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/104/build/fb8af9c1ac1fdc1c7609d66270ef185d.png" alt="&lt;Figure size 1400x700 with 4 Axes&gt;"/></div></div><div id="yWkzWYmvbW" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">fig = calibration_summary(
    df=gdf_final,
    sr_z_column=sr_z_column,
    gr_z_column=gr_z_column,
    # Histogram options
    bin_width=2,
    # Scatterplot options
    # hue_column=&quot;GR_gate_volume_sum&quot;,
    hue_column=&quot;GR_range_mean&quot;,
    # gr_range=[15, 50]
    # sr_range=[15, 50]
    marker=&quot;+&quot;,
    cmap=&quot;Spectral&quot;,
)
fig.tight_layout()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="K-XyEzpEca8NPgsfKNoYl" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/104/build/b5a640b014e9b78130abaf159fe1f625.png" alt="&lt;Figure size 1200x500 with 3 Axes&gt;"/></div></div><div id="btsrYi4iC6" class="relative group/block article-grid subgrid-gap col-screen"><p>Exploratory data analysis can again be performed to check if the filtering criteria were effective to discard the undesired SR/GR matched volumes and if the filtering criteria should be further expanded.</p></div><div id="Mgwds0g1Z1" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Attenuation
hue_columns = [
    &quot;SR_pathAtten&quot;,
    &quot;SR_piaFinal&quot;,
    &quot;SR_reliabFlag&quot;,
    &quot;SR_zFactorCorrection_Ku_max&quot;,
    &quot;SR_zFactorCorrection_Ku_mean&quot;,
    &quot;GR_Z_cumsum_max&quot;,
]
fig = reflectivity_scatterplots(
    df=gdf_final,
    gr_z_column=gr_z_column,
    sr_z_column=sr_z_column,
    hue_columns=hue_columns,
    ncols=2,
)
fig.tight_layout()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="mRZo6bFXxOkuUk7CzZu-B" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/104/build/7e4261e09d571daaee5bd69c0c689be5.png" alt="&lt;Figure size 1200x1500 with 12 Axes&gt;"/></div></div><div id="ebncKmZrCH" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="determine-gr-calibration-bias" class="relative group"><span class="heading-text">Determine GR calibration bias</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#determine-gr-calibration-bias" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="xzW82YHlVt" class="relative group/block article-grid subgrid-gap col-screen"><p>The GR calibration bias can be obtained by averaging the difference between the matched SR/GR reflectivity measurements:</p></div><div id="WonAq8FsFE" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Compute average offset
z_offset = np.nanmean(gdf_final[sr_z_column] - gdf_final[gr_z_column]).round(2)
z_offset_robust = np.nanmedian(gdf_final[sr_z_column] - gdf_final[gr_z_column]).round(2)

print(f&quot;Th ZH Calibration offset is (mean): {z_offset} dBZ&quot;)
print(f&quot;Th ZH Calibration offset is (median): {z_offset_robust} dBZ&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="MbRum86KVu5IiBl4DsSVO" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Th ZH Calibration offset is (mean): 3.94 dBZ
Th ZH Calibration offset is (median): 3.78 dBZ
</span></code></pre></div></div></div><div id="Q5ZcTFF1a4" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="volume-matching-with-calibrated-gr" class="relative group"><span class="heading-text">Volume matching with calibrated GR</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#volume-matching-with-calibrated-gr" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="M260cYISAc" class="relative group/block article-grid subgrid-gap col-screen"><p>Now, we remove the estimated GR calibration bias, we rerun the SR/GR volume matching procedure, we compare the matched reflectivities and we assess if we have effectively removed the bias by generating the calibration summary. Please note that here below we don’t filter out  undesired SR/GR volumes, but this is operation is recommended once you defined appropriate robust filtering criteria !</p></div><div id="WAvWhvgCe2" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Apply offset
ds_gr[&quot;DBZH_c&quot;] = ds_gr[&quot;DBZH&quot;] + z_offset</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="paE6f-86KSADRM34UAXac" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="MQVfS8oYZ9" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Apply matching
gdf_match_corrected = volume_matching(
    ds_gr=ds_gr,
    ds_sr=ds_sr,
    z_variable_gr=&quot;DBZH_c&quot;,
    radar_band=radar_band,
    beamwidth_gr=beamwidth_gr,
    z_min_threshold_gr=z_min_threshold_gr,
    z_min_threshold_sr=z_min_threshold_sr,
    min_gr_range=0,
    max_gr_range=150_000,
    # gr_sensitivity_thresholds=None,
    # sr_sensitivity_thresholds=None,
    download_sr=False,  # require internet connection !
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="zu8n4oSZVIOXl6izJdBV7" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/104/build/d76ef36fdfd860a124d9cac547308ea6.png" alt="&lt;Figure size 960x480 with 4 Axes&gt;"/><div><pre class="text-sm font-thin font-system"><code><span>SR/GR Matching Elapsed time: 0:00:21.649365 .
</span></code></pre></div></div></div><div id="YY7BXhgouJ" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Compare reflectivities
fig = compare_maps(
    gdf_match_corrected,
    sr_column=sr_z_column,
    gr_column=gr_z_column,
    sr_label=&quot;SR Reflectivity (dBz)&quot;,
    gr_label=&quot;GR Reflectivity (dBz)&quot;,
    cmap=&quot;Spectral_r&quot;,
    unified_color_scale=True,
    vmin=15,
    # vmax=40
)
fig.tight_layout()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="wZrdqOhk0JR1nAnXlL8EI" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/104/build/8476fbc120215e09c7bc5c17ff902c3d.png" alt="&lt;Figure size 1400x700 with 4 Axes&gt;"/></div></div><div id="ZbGbUoD3cl" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Display difference in reflectivity betweeen SR and GR
gdf_match_corrected[&quot;z_offset&quot;] = gdf_match_corrected[sr_z_column] - gdf_match_corrected[gr_z_column]
gdf_match_corrected.plot(column=&quot;z_offset&quot;, legend=True, cmap=&quot;RdBu&quot;, vmin=-1.5, vmax=1.5)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="f-WvnH9GoR5Ogz7COX_EO" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&lt;Axes: &gt;</span></code></div><img src="/erad2024/_preview/104/build/d9a234a3550a635210663126d2124f41.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="oA81Ay3U7R" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Display calibration summary
fig = calibration_summary(
    df=gdf_match_corrected,
    gr_z_column=gr_z_column,
    sr_z_column=sr_z_column,
    # Histogram options
    bin_width=2,
    # Scatterplot options
    hue_column=&quot;SR_fraction_clutter&quot;,
    marker=&quot;+&quot;,
    cmap=&quot;Spectral&quot;,
)
fig.tight_layout()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="wGvarWryFSjzZv955NNxv" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/erad2024/_preview/104/build/d6d45ae2e73e883cae9673e4411e36f7.png" alt="&lt;Figure size 1200x500 with 3 Axes&gt;"/></div></div><div id="rDTk0CSY6H" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="next-steps" class="relative group"><span class="heading-text">Next steps</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#next-steps" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="HroxzOvBsW" class="relative group/block article-grid subgrid-gap col-screen"><p>We encourage you to explore and adapt the code provided in this tutorial to infer calibration bias also
for the vertically polarized channel, iterate over GR sweeps, analyze multiple GPM overpasses, and assess the
long-term calibration bias of your GR network.</p><p>Please share any insights or suggestions for improving the matching procedure or filtering criteria with
the GPM-API community so we can collaboratively enhance the routines.</p><p>We hope you enjoyed the tutorial! 😊</p></div><div id="VQTCEpBkXS" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="references" class="relative group"><span class="heading-text">References</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#references" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="IGJoQvEbr9" class="relative group/block article-grid subgrid-gap col-screen"><ul><li><cite data-state="closed"><a href="https://doi.org/10.1002/jgrd.50138" target="_blank" rel="noreferrer" class="hover-link">Cao, Q., Y. Hong, Y. Qi, Y. Wen, J. Zhang, J. J. Gourley, and L. Liao, 2013: Empirical conversion of the vertical profile of reflectivity from Ku-band to S-band frequency. J. Geophys. Res. Atmos., 118, 1814–1825, https://doi.org/10.1002/jgrd.50138</a></cite></li><li><cite data-state="closed"><a href="https://doi.org/10.1175/2010jtecha1403.1" target="_blank" rel="noreferrer" class="hover-link">Schwaller, MR, and Morris, KR. 2011. A ground validation network for the Global Precipitation Measurement mission. J. Atmos. Oceanic Technol., 28, 301-319.28, https://doi.org/10.1175/2010JTECHA1403.1</a></cite></li><li><cite data-state="closed"><a href="https://doi.org/10.1175/jtech-d-17-0128.1" target="_blank" rel="noreferrer" class="hover-link">Warren, R.A., A. Protat, S.T. Siems, H.A. Ramsay, V. Louf, M.J. Manton, and T.A. Kane, 2018. Calibrating ground-based radars against TRMM and GPM. J. Atmos. Oceanic Technol., 35, 323–346, https://doi.org/10.1175/JTECH-D-17-0128.1</a></cite></li></ul></div><div id="LUkgEZNsfF" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="citation" class="relative group"><span class="heading-text">Citation</span><a class="no-underline text-inherit hover:text-inherit px-2 font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#citation" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="rQB5ZFjxBv" class="relative group/block article-grid subgrid-gap col-screen"><p>This notebook is part of the <a target="_blank" href="https://gpm-api.readthedocs.io/" rel="noreferrer">GPM-API  documentation</a>.</p><p>Large portions of this tutorials were adapted and derived from an old <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ω</mi><mi>r</mi><mi>a</mi><mi>d</mi><mi>l</mi><mi>i</mi><mi>b</mi></mrow><annotation encoding="application/x-tex">\omega radlib</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">a</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">ib</span></span></span></span></span>  tutorial.</p><p>Copyright: <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ω</mi><mi>r</mi><mi>a</mi><mi>d</mi><mi>l</mi><mi>i</mi><mi>b</mi></mrow><annotation encoding="application/x-tex">\omega radlib</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">a</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">ib</span></span></span></span></span>  and GPM-API developers.
Distributed under the MIT License. See <a href="https://github.com/ghiggi/gpm_api/blob/main/LICENSE" class="italic" target="_blank" rel="noreferrer" data-state="closed">GPM-API license</a> for more info.</p></div><div></div><section id="references" class="article-grid subgrid-gap col-screen"><div><header class="text-lg font-semibold text-stone-900 dark:text-white group">References<a class="no-underline text-inherit hover:text-inherit ml-2 select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#references" title="Link to References" aria-label="Link to References">¶</a></header></div><div class="pl-3 mb-8 text-xs text-stone-500 dark:text-stone-300"><ol><li class="break-words" id="cite-Cao_2013">Cao, Q., Hong, Y., Qi, Y., Wen, Y., Zhang, J., Gourley, J. J., & Liao, L. (2013). Empirical conversion of the vertical profile of reflectivity from Ku‐band to S‐band frequency. <i>Journal of Geophysical Research: Atmospheres</i>, <i>118</i>(4), 1814–1825. <a target="_blank" rel="noreferrer" href="https://doi.org/10.1002/jgrd.50138">10.1002/jgrd.50138</a></li><li class="break-words" id="cite-Schwaller_2011">Schwaller, M. R., & Morris, K. R. (2011). A Ground Validation Network for the Global Precipitation Measurement Mission. <i>Journal of Atmospheric and Oceanic Technology</i>, <i>28</i>(3), 301–319. <a target="_blank" rel="noreferrer" href="https://doi.org/10.1175/2010jtecha1403.1">10.1175/2010jtecha1403.1</a></li><li class="break-words" id="cite-Warren_2018">Warren, R. A., Protat, A., Siems, S. T., Ramsay, H. A., Louf, V., Manton, M. J., & Kane, T. A. (2018). Calibrating Ground-Based Radars against TRMM and GPM. <i>Journal of Atmospheric and Oceanic Technology</i>, <i>35</i>(2), 323–346. <a target="_blank" rel="noreferrer" href="https://doi.org/10.1175/jtech-d-17-0128.1">10.1175/jtech-d-17-0128.1</a></li></ol></div></section><div class="flex pt-10 mb-10 space-x-4"><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/erad2024/_preview/104/qpe-qvps"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="text-xs text-gray-500 dark:text-gray-400">ARCO Radar Datasets</div>QPE &amp; QVPs</div></div></a><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/erad2024/_preview/104/sr-gr-matching-procedure"><div class="flex h-full align-middle"><div class="flex-grow"><div class="text-xs text-gray-500 dark:text-gray-400">Spaceborne - Ground Radar Matching and Calibration</div>Spaceborne-Ground Radar Matching (Methodology)</div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3"></path></svg></div></a></div></main></article><script>((o,u)=>{if(!window.history.state||!window.history.state.key){let f=Math.random().toString(32).slice(2);window.history.replaceState({key:f},"")}try{let d=JSON.parse(sessionStorage.getItem(o)||"{}")[u||window.history.state.key];typeof d=="number"&&window.scrollTo(0,d)}catch(f){console.error(f),sessionStorage.removeItem(o)}})("positions", null)</script><link rel="modulepreload" href="/erad2024/_preview/104/build/entry.client-K6EYMIDZ.js"/><link rel="modulepreload" href="/erad2024/_preview/104/build/_shared/chunk-FBLNPC3V.js"/><link rel="modulepreload" href="/erad2024/_preview/104/build/_shared/chunk-XJN3BT5Q.js"/><link rel="modulepreload" href="/erad2024/_preview/104/build/_shared/chunk-2NH4LW52.js"/><link rel="modulepreload" href="/erad2024/_preview/104/build/_shared/chunk-RE6LVKIZ.js"/><link rel="modulepreload" href="/erad2024/_preview/104/build/_shared/chunk-YAIQ7LUU.js"/><link rel="modulepreload" href="/erad2024/_preview/104/build/_shared/chunk-HTHE5KDW.js"/><link rel="modulepreload" href="/erad2024/_preview/104/build/_shared/chunk-AAPZCWUN.js"/><link rel="modulepreload" href="/erad2024/_preview/104/build/_shared/chunk-QB27XQSF.js"/><link rel="modulepreload" href="/erad2024/_preview/104/build/_shared/chunk-JOLZ6LZB.js"/><link rel="modulepreload" href="/erad2024/_preview/104/build/_shared/chunk-MITWS4PZ.js"/><link rel="modulepreload" href="/erad2024/_preview/104/build/_shared/chunk-J6FHCSRC.js"/><link rel="modulepreload" href="/erad2024/_preview/104/build/_shared/chunk-EEG6LHX7.js"/><link rel="modulepreload" href="/erad2024/_preview/104/build/_shared/chunk-TEYZXLTV.js"/><link rel="modulepreload" href="/erad2024/_preview/104/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/erad2024/_preview/104/build/root-ZSMPVWLZ.js"/><link rel="modulepreload" href="/erad2024/_preview/104/build/_shared/chunk-OCW4QGPJ.js"/><link rel="modulepreload" href="/erad2024/_preview/104/build/routes/$-OW6NTZY2.js"/><script>window.__remixContext = {"url":"/sr-gr-calibration-applied","state":{"loaderData":{"root":{"theme":"light","config":{"options":{"favicon":"/erad2024/_preview/104/build/favicon-8ddc2809ed532ab8ae9cf79fda3d1326.ico","logo":"/erad2024/_preview/104/build/erad_white_backgroun-d1050665aa4e0c394f2b12d18727bd98.png","logo_dark":"/erad2024/_preview/104/build/erad_white_backgroun-d1050665aa4e0c394f2b12d18727bd98.png"},"myst":"1.3.7","nav":[{"title":"Conference Home","url":"https://www.erad2024.it"},{"title":"Community","url":"https://openradarscience.org"},{"title":"Discourse","url":"https://openradar.discourse.group/"}],"actions":[{"title":"Launch Environment","url":"https://binder.projectpythia.org/v2/gh/openradar/erad2024/main?labpath=notebooks","internal":false,"static":false}],"projects":[{"open_access":true,"license":{"content":{"id":"Apache-2.0","name":"Apache License 2.0","osi":true,"free":true,"url":"https://opensource.org/licenses/Apache-2.0"},"code":{"id":"CC-BY-4.0","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true,"url":"https://creativecommons.org/licenses/by/4.0/"}},"abbreviations":{"ARM":"Atmospheric Radiation Measurement","NCAR":"National Center for Atmospheric Research"},"settings":{"output_matplotlib_strings":"remove"},"title":"ERAD 2024","authors":[{"nameParsed":{"literal":"Alfonso Ladino","given":"Alfonso","family":"Ladino"},"name":"Alfonso Ladino","orcid":"0000-0001-8081-7827","github":"aladinor","id":"contributors-myst-generated-uid-0"},{"nameParsed":{"literal":"Anna del Moral Méndez","given":"Anna","non_dropping_particle":"del","family":"Moral Méndez"},"name":"Anna del Moral Méndez","orcid":"0000-0002-5015-840X","id":"contributors-myst-generated-uid-1"},{"nameParsed":{"literal":"Brenda Javornik","given":"Brenda","family":"Javornik"},"name":"Brenda Javornik","orcid":"0009-0004-9266-9293","github":"leavesntwigs","id":"contributors-myst-generated-uid-2"},{"nameParsed":{"literal":"Daniel Michelson","given":"Daniel","family":"Michelson"},"name":"Daniel Michelson","orcid":"0000-0003-3222-9881","github":"DanielMichelson","id":"contributors-myst-generated-uid-3"},{"nameParsed":{"literal":"Daniel Wolfensberger","given":"Daniel","family":"Wolfensberger"},"name":"Daniel Wolfensberger","orcid":"0009-0006-1419-0556","github":"wolfidan","id":"contributors-myst-generated-uid-4"},{"nameParsed":{"literal":"Gionata Ghiggi","given":"Gionata","family":"Ghiggi"},"name":"Gionata Ghiggi","orcid":"0000-0002-0818-0865","github":"ghiggi","id":"contributors-myst-generated-uid-5"},{"nameParsed":{"literal":"Jen DeHart","given":"Jen","family":"DeHart"},"name":"Jen DeHart","orcid":"0000-0001-8536-4927","github":"jcdehart","id":"contributors-myst-generated-uid-6"},{"nameParsed":{"literal":"Jordi Figueras i Ventura","given":"Jordi Figueras","non_dropping_particle":"i","family":"Ventura"},"name":"Jordi Figueras i Ventura","orcid":"0000-0002-4949-422X","github":"jfigui","id":"contributors-myst-generated-uid-7"},{"nameParsed":{"literal":"Julian Giles","given":"Julian","family":"Giles"},"name":"Julian Giles","orcid":"0000-0001-8134-008X","github":"JulianGiles","id":"contributors-myst-generated-uid-8"},{"nameParsed":{"literal":"Kai Mühlbauer","given":"Kai","family":"Mühlbauer"},"name":"Kai Mühlbauer","orcid":"0000-0001-6599-1034","github":"kmuehlbauer","id":"contributors-myst-generated-uid-9"},{"nameParsed":{"literal":"Maxwell Grover","given":"Maxwell","family":"Grover"},"name":"Maxwell Grover","orcid":"0000-0002-0370-8974","github":"mgrover1","id":"contributors-myst-generated-uid-10"},{"nameParsed":{"literal":"Mike Dixon","given":"Mike","family":"Dixon"},"name":"Mike Dixon","orcid":"0000-0002-9597-9113","github":"mike-dixon","id":"contributors-myst-generated-uid-11"},{"nameParsed":{"literal":"Robert Jackson","given":"Robert","family":"Jackson"},"name":"Robert Jackson","orcid":"0000-0003-2518-1234","github":"rcjackson","id":"contributors-myst-generated-uid-12"},{"nameParsed":{"literal":"Scott Collis","given":"Scott","family":"Collis"},"name":"Scott Collis","orcid":"0000-0002-2303-687X","github":"scollis","id":"contributors-myst-generated-uid-13"},{"nameParsed":{"literal":"Ting-Yu Cha","given":"Ting-Yu","family":"Cha"},"name":"Ting-Yu Cha","orcid":"0000-0002-6292-8483","github":"tingyucha","id":"contributors-myst-generated-uid-14"}],"github":"https://github.com/openradar/erad2024","copyright":"2024","references":{"foundations":{"url":"https://projectpythia-mystmd.github.io/pythia-foundations"},"xarray":{"url":"https://docs.xarray.dev/en/stable"},"matplotlib":{"url":"https://matplotlib.org/stable"}},"thebe":{"binder":{"url":"https://binder.projectpythia.org/","provider":"github","repo":"openradar/erad2024","ref":"HEAD"}},"toc":[{"file":"README.md"},{"file":"notebooks/how-to-cite.md"},{"file":"schedule.md"},{"children":[{"file":"getting_started.md"},{"file":"notebooks/data-access/intro-data-access.ipynb"},{"file":"notebooks/environment.ipynb"}],"title":"Getting started"},{"children":[{"file":"presentations/intro-to-open-radar-science.ipynb"},{"file":"notebooks/xradar-pyart/xradar-basics.ipynb"},{"children":[{"file":"notebooks/xradar-pyart/pyart-basics.ipynb"},{"file":"notebooks/wradlib/wradlib_clutter_beamblockage.ipynb"}],"title":"Py-ART and wradlib"},{"file":"notebooks/gpm-api/gpm-api-intro.ipynb"},{"children":[{"pattern":"notebooks/baltrad/baltrad_short_course/*.ipynb"},{"pattern":"notebooks/baltrad/pyart2baltrad/*.ipynb"},{"file":"notebooks/baltrad/baltrad2wradlib/baltrad2wradlib.ipynb"}],"title":"BALTRAD"},{"children":[{"file":"notebooks/lrose/LROSE_Basics.ipynb"},{"file":"notebooks/lrose/DD_Tornado_ERAD24.ipynb"},{"file":"notebooks/lrose/testing/stress_testing.ipynb"}],"title":"LROSE"}],"title":"Radar Software Foundations"},{"children":[{"children":[{"file":"notebooks/Retrieving_winds_with_pydda.ipynb"},{"file":"notebooks/lrose/LROSE_ERAD_fractl_samurai.ipynb"}],"title":"LROSE \u0026 PyDDA multi doppler analysis"},{"children":[{"file":"notebooks/Analysis-Ready/ARCO-Datasets.ipynb"},{"file":"notebooks/Analysis-Ready/QPE-QVPs.ipynb"}],"title":"ARCO Radar Datasets"},{"children":[{"file":"notebooks/gpm-api/SR_GR_Calibration_Applied.ipynb"},{"file":"notebooks/gpm-api/SR_GR_Matching_Procedure.ipynb"}],"title":"Spaceborne - Ground Radar Matching and Calibration"},{"file":"notebooks/pyrad/description-pyrad-tutorial.ipynb"}],"title":"Project Workflows"}],"thumbnail":"/erad2024/_preview/104/build/0885e6292c6be2fd643fbc952d479a01.jpeg","exports":[],"bibliography":[],"index":"readme","pages":[{"slug":"how-to-cite","title":"How to Cite","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"schedule","title":"Schedule","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"level":1,"title":"Getting started"},{"slug":"getting-started","title":"Notebook Execution","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"intro-data-access","title":"Data Access Instructions","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"environment","title":"Environment overview","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Radar Software Foundations"},{"slug":"intro-to-open-radar-science","title":"An Introduction to Open Radar Science","description":"","date":"","thumbnail":"/erad2024/_preview/104/build/31631960e5ad8808b3289c31e033c7bf.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"xradar-basics","title":"Xradar Basics","description":"","date":"","thumbnail":"/erad2024/_preview/104/build/xradar_logo-3b4383d54a0c27808b82e1d1b44fd46e.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":2,"title":"Py-ART and wradlib"},{"slug":"pyart-basics","title":"Py-ART Basics with Xradar","description":"","date":"","thumbnail":"/erad2024/_preview/104/build/arm_logo-a7094e5a09c5a3d27672fdaa8f5d97bb.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"wradlib-clutter-beamblockage","title":"wradlib - clutter and beamblockage","description":"","date":"","thumbnail":"/erad2024/_preview/104/build/wradlib_logo.svg-f0319c64d53a0677e1a2d1f5294395f1.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"gpm-api-intro","title":"Introduction to GPM-API","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":2,"title":"BALTRAD"},{"slug":"baltrad-io","title":"I/O model","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad-qc","title":"Quality Control","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad-drqc","title":"Quality Control using DR","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad-parallel-processing","title":"Parallel processing","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad-compositing","title":"Compositing","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad-pyart-rain-rate-example","title":"Rain Rate retrieval with Py-ART","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"pyart-baltrad-dealias-example","title":"Doppler Velocity Dealiasing with Py-ART","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad2wradlib","title":"Attenuation correction comparison with wradlib","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"LROSE"},{"slug":"lrose-basics","title":"An Introduction to LROSE","description":"","date":"","thumbnail":"/erad2024/_preview/104/build/colette_rose-b9c340e0a053d001878c103bf5cb1cbe.jpg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"dd-tornado-erad24","title":"MULTI DOPPLER ANALYSIS","description":"","date":"","thumbnail":"/erad2024/_preview/104/build/logo-2bfe4c7b718a0b157449f359153ca9d5.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"stress-testing","title":"stress-testing","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"Project Workflows"},{"level":2,"title":"LROSE \u0026 PyDDA multi doppler analysis"},{"slug":"retrieving-winds-with-pydda","title":"PyDDA tutorial","description":"","date":"","thumbnail":"/erad2024/_preview/104/build/5e2d147096249dc3a37da495168a9e9e.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"lrose-erad-fractl-samurai","title":"LROSE Wind Tutorial","description":"","date":"","thumbnail":"/erad2024/_preview/104/build/samurai-3cd519a5133f26b36609725ee157bdae.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"ARCO Radar Datasets"},{"slug":"arco-datasets","title":"Analysis-Ready Cloud-Optimized Datasets","description":"","date":"","thumbnail":"/erad2024/_preview/104/build/ARCO-d5273507419977e5af0df42c2e4fb75f.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"qpe-qvps","title":"QPE \u0026 QVPs","description":"","date":"","thumbnail":"/erad2024/_preview/104/build/QVP-07d23a262d5bcbde5a1921fa8f105724.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"Spaceborne - Ground Radar Matching and Calibration"},{"slug":"sr-gr-calibration-applied","title":"Spaceborne-Ground Radar Calibration (Application)","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"sr-gr-matching-procedure","title":"Spaceborne-Ground Radar Matching (Methodology)","description":"","date":"","thumbnail":"/erad2024/_preview/104/build/cc72069fb56e0a54f1123fbe9c2fcb76.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"description-pyrad-tutorial","title":"Pyrad QPE Exercise","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"/erad2024/_preview/104"},"routes/$":{"config":{"options":{"favicon":"/erad2024/_preview/104/build/favicon-8ddc2809ed532ab8ae9cf79fda3d1326.ico","logo":"/erad2024/_preview/104/build/erad_white_backgroun-d1050665aa4e0c394f2b12d18727bd98.png","logo_dark":"/erad2024/_preview/104/build/erad_white_backgroun-d1050665aa4e0c394f2b12d18727bd98.png"},"myst":"1.3.7","nav":[{"title":"Conference Home","url":"https://www.erad2024.it"},{"title":"Community","url":"https://openradarscience.org"},{"title":"Discourse","url":"https://openradar.discourse.group/"}],"actions":[{"title":"Launch Environment","url":"https://binder.projectpythia.org/v2/gh/openradar/erad2024/main?labpath=notebooks","internal":false,"static":false}],"projects":[{"open_access":true,"license":{"content":{"id":"Apache-2.0","name":"Apache License 2.0","osi":true,"free":true,"url":"https://opensource.org/licenses/Apache-2.0"},"code":{"id":"CC-BY-4.0","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true,"url":"https://creativecommons.org/licenses/by/4.0/"}},"abbreviations":{"ARM":"Atmospheric Radiation Measurement","NCAR":"National Center for Atmospheric Research"},"settings":{"output_matplotlib_strings":"remove"},"title":"ERAD 2024","authors":[{"nameParsed":{"literal":"Alfonso Ladino","given":"Alfonso","family":"Ladino"},"name":"Alfonso Ladino","orcid":"0000-0001-8081-7827","github":"aladinor","id":"contributors-myst-generated-uid-0"},{"nameParsed":{"literal":"Anna del Moral Méndez","given":"Anna","non_dropping_particle":"del","family":"Moral Méndez"},"name":"Anna del Moral Méndez","orcid":"0000-0002-5015-840X","id":"contributors-myst-generated-uid-1"},{"nameParsed":{"literal":"Brenda Javornik","given":"Brenda","family":"Javornik"},"name":"Brenda Javornik","orcid":"0009-0004-9266-9293","github":"leavesntwigs","id":"contributors-myst-generated-uid-2"},{"nameParsed":{"literal":"Daniel Michelson","given":"Daniel","family":"Michelson"},"name":"Daniel Michelson","orcid":"0000-0003-3222-9881","github":"DanielMichelson","id":"contributors-myst-generated-uid-3"},{"nameParsed":{"literal":"Daniel Wolfensberger","given":"Daniel","family":"Wolfensberger"},"name":"Daniel Wolfensberger","orcid":"0009-0006-1419-0556","github":"wolfidan","id":"contributors-myst-generated-uid-4"},{"nameParsed":{"literal":"Gionata Ghiggi","given":"Gionata","family":"Ghiggi"},"name":"Gionata Ghiggi","orcid":"0000-0002-0818-0865","github":"ghiggi","id":"contributors-myst-generated-uid-5"},{"nameParsed":{"literal":"Jen DeHart","given":"Jen","family":"DeHart"},"name":"Jen DeHart","orcid":"0000-0001-8536-4927","github":"jcdehart","id":"contributors-myst-generated-uid-6"},{"nameParsed":{"literal":"Jordi Figueras i Ventura","given":"Jordi Figueras","non_dropping_particle":"i","family":"Ventura"},"name":"Jordi Figueras i Ventura","orcid":"0000-0002-4949-422X","github":"jfigui","id":"contributors-myst-generated-uid-7"},{"nameParsed":{"literal":"Julian Giles","given":"Julian","family":"Giles"},"name":"Julian Giles","orcid":"0000-0001-8134-008X","github":"JulianGiles","id":"contributors-myst-generated-uid-8"},{"nameParsed":{"literal":"Kai Mühlbauer","given":"Kai","family":"Mühlbauer"},"name":"Kai Mühlbauer","orcid":"0000-0001-6599-1034","github":"kmuehlbauer","id":"contributors-myst-generated-uid-9"},{"nameParsed":{"literal":"Maxwell Grover","given":"Maxwell","family":"Grover"},"name":"Maxwell Grover","orcid":"0000-0002-0370-8974","github":"mgrover1","id":"contributors-myst-generated-uid-10"},{"nameParsed":{"literal":"Mike Dixon","given":"Mike","family":"Dixon"},"name":"Mike Dixon","orcid":"0000-0002-9597-9113","github":"mike-dixon","id":"contributors-myst-generated-uid-11"},{"nameParsed":{"literal":"Robert Jackson","given":"Robert","family":"Jackson"},"name":"Robert Jackson","orcid":"0000-0003-2518-1234","github":"rcjackson","id":"contributors-myst-generated-uid-12"},{"nameParsed":{"literal":"Scott Collis","given":"Scott","family":"Collis"},"name":"Scott Collis","orcid":"0000-0002-2303-687X","github":"scollis","id":"contributors-myst-generated-uid-13"},{"nameParsed":{"literal":"Ting-Yu Cha","given":"Ting-Yu","family":"Cha"},"name":"Ting-Yu Cha","orcid":"0000-0002-6292-8483","github":"tingyucha","id":"contributors-myst-generated-uid-14"}],"github":"https://github.com/openradar/erad2024","copyright":"2024","references":{"foundations":{"url":"https://projectpythia-mystmd.github.io/pythia-foundations"},"xarray":{"url":"https://docs.xarray.dev/en/stable"},"matplotlib":{"url":"https://matplotlib.org/stable"}},"thebe":{"binder":{"url":"https://binder.projectpythia.org/","provider":"github","repo":"openradar/erad2024","ref":"HEAD"}},"toc":[{"file":"README.md"},{"file":"notebooks/how-to-cite.md"},{"file":"schedule.md"},{"children":[{"file":"getting_started.md"},{"file":"notebooks/data-access/intro-data-access.ipynb"},{"file":"notebooks/environment.ipynb"}],"title":"Getting started"},{"children":[{"file":"presentations/intro-to-open-radar-science.ipynb"},{"file":"notebooks/xradar-pyart/xradar-basics.ipynb"},{"children":[{"file":"notebooks/xradar-pyart/pyart-basics.ipynb"},{"file":"notebooks/wradlib/wradlib_clutter_beamblockage.ipynb"}],"title":"Py-ART and wradlib"},{"file":"notebooks/gpm-api/gpm-api-intro.ipynb"},{"children":[{"pattern":"notebooks/baltrad/baltrad_short_course/*.ipynb"},{"pattern":"notebooks/baltrad/pyart2baltrad/*.ipynb"},{"file":"notebooks/baltrad/baltrad2wradlib/baltrad2wradlib.ipynb"}],"title":"BALTRAD"},{"children":[{"file":"notebooks/lrose/LROSE_Basics.ipynb"},{"file":"notebooks/lrose/DD_Tornado_ERAD24.ipynb"},{"file":"notebooks/lrose/testing/stress_testing.ipynb"}],"title":"LROSE"}],"title":"Radar Software Foundations"},{"children":[{"children":[{"file":"notebooks/Retrieving_winds_with_pydda.ipynb"},{"file":"notebooks/lrose/LROSE_ERAD_fractl_samurai.ipynb"}],"title":"LROSE \u0026 PyDDA multi doppler analysis"},{"children":[{"file":"notebooks/Analysis-Ready/ARCO-Datasets.ipynb"},{"file":"notebooks/Analysis-Ready/QPE-QVPs.ipynb"}],"title":"ARCO Radar Datasets"},{"children":[{"file":"notebooks/gpm-api/SR_GR_Calibration_Applied.ipynb"},{"file":"notebooks/gpm-api/SR_GR_Matching_Procedure.ipynb"}],"title":"Spaceborne - Ground Radar Matching and Calibration"},{"file":"notebooks/pyrad/description-pyrad-tutorial.ipynb"}],"title":"Project Workflows"}],"thumbnail":"/erad2024/_preview/104/build/0885e6292c6be2fd643fbc952d479a01.jpeg","exports":[],"bibliography":[],"index":"readme","pages":[{"slug":"how-to-cite","title":"How to Cite","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"schedule","title":"Schedule","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"level":1,"title":"Getting started"},{"slug":"getting-started","title":"Notebook Execution","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"intro-data-access","title":"Data Access Instructions","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"environment","title":"Environment overview","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Radar Software Foundations"},{"slug":"intro-to-open-radar-science","title":"An Introduction to Open Radar Science","description":"","date":"","thumbnail":"/erad2024/_preview/104/build/31631960e5ad8808b3289c31e033c7bf.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"xradar-basics","title":"Xradar Basics","description":"","date":"","thumbnail":"/erad2024/_preview/104/build/xradar_logo-3b4383d54a0c27808b82e1d1b44fd46e.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":2,"title":"Py-ART and wradlib"},{"slug":"pyart-basics","title":"Py-ART Basics with Xradar","description":"","date":"","thumbnail":"/erad2024/_preview/104/build/arm_logo-a7094e5a09c5a3d27672fdaa8f5d97bb.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"wradlib-clutter-beamblockage","title":"wradlib - clutter and beamblockage","description":"","date":"","thumbnail":"/erad2024/_preview/104/build/wradlib_logo.svg-f0319c64d53a0677e1a2d1f5294395f1.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"gpm-api-intro","title":"Introduction to GPM-API","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":2,"title":"BALTRAD"},{"slug":"baltrad-io","title":"I/O model","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad-qc","title":"Quality Control","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad-drqc","title":"Quality Control using DR","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad-parallel-processing","title":"Parallel processing","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad-compositing","title":"Compositing","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad-pyart-rain-rate-example","title":"Rain Rate retrieval with Py-ART","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"pyart-baltrad-dealias-example","title":"Doppler Velocity Dealiasing with Py-ART","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad2wradlib","title":"Attenuation correction comparison with wradlib","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"LROSE"},{"slug":"lrose-basics","title":"An Introduction to LROSE","description":"","date":"","thumbnail":"/erad2024/_preview/104/build/colette_rose-b9c340e0a053d001878c103bf5cb1cbe.jpg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"dd-tornado-erad24","title":"MULTI DOPPLER ANALYSIS","description":"","date":"","thumbnail":"/erad2024/_preview/104/build/logo-2bfe4c7b718a0b157449f359153ca9d5.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"stress-testing","title":"stress-testing","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"Project Workflows"},{"level":2,"title":"LROSE \u0026 PyDDA multi doppler analysis"},{"slug":"retrieving-winds-with-pydda","title":"PyDDA tutorial","description":"","date":"","thumbnail":"/erad2024/_preview/104/build/5e2d147096249dc3a37da495168a9e9e.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"lrose-erad-fractl-samurai","title":"LROSE Wind Tutorial","description":"","date":"","thumbnail":"/erad2024/_preview/104/build/samurai-3cd519a5133f26b36609725ee157bdae.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"ARCO Radar Datasets"},{"slug":"arco-datasets","title":"Analysis-Ready Cloud-Optimized Datasets","description":"","date":"","thumbnail":"/erad2024/_preview/104/build/ARCO-d5273507419977e5af0df42c2e4fb75f.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"qpe-qvps","title":"QPE \u0026 QVPs","description":"","date":"","thumbnail":"/erad2024/_preview/104/build/QVP-07d23a262d5bcbde5a1921fa8f105724.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"Spaceborne - Ground Radar Matching and Calibration"},{"slug":"sr-gr-calibration-applied","title":"Spaceborne-Ground Radar Calibration (Application)","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"sr-gr-matching-procedure","title":"Spaceborne-Ground Radar Matching (Methodology)","description":"","date":"","thumbnail":"/erad2024/_preview/104/build/cc72069fb56e0a54f1123fbe9c2fcb76.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"description-pyrad-tutorial","title":"Pyrad QPE Exercise","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"page":{"kind":"Notebook","sha256":"15340a2ff50863a660b253bad90adb959ca616154f577388a6efefff07a5b046","slug":"sr-gr-calibration-applied","location":"/notebooks/gpm-api/SR_GR_Calibration_Applied.ipynb","dependencies":[],"frontmatter":{"title":"Spaceborne-Ground Radar Calibration (Application)","content_includes_title":false,"kernelspec":{"name":"gpm-api-dev","display_name":"gpm-api-dev","language":"python"},"authors":[{"nameParsed":{"literal":"Alfonso Ladino","given":"Alfonso","family":"Ladino"},"name":"Alfonso Ladino","orcid":"0000-0001-8081-7827","github":"aladinor","id":"contributors-myst-generated-uid-0"},{"nameParsed":{"literal":"Anna del Moral Méndez","given":"Anna","non_dropping_particle":"del","family":"Moral Méndez"},"name":"Anna del Moral Méndez","orcid":"0000-0002-5015-840X","id":"contributors-myst-generated-uid-1"},{"nameParsed":{"literal":"Brenda Javornik","given":"Brenda","family":"Javornik"},"name":"Brenda Javornik","orcid":"0009-0004-9266-9293","github":"leavesntwigs","id":"contributors-myst-generated-uid-2"},{"nameParsed":{"literal":"Daniel Michelson","given":"Daniel","family":"Michelson"},"name":"Daniel Michelson","orcid":"0000-0003-3222-9881","github":"DanielMichelson","id":"contributors-myst-generated-uid-3"},{"nameParsed":{"literal":"Daniel Wolfensberger","given":"Daniel","family":"Wolfensberger"},"name":"Daniel Wolfensberger","orcid":"0009-0006-1419-0556","github":"wolfidan","id":"contributors-myst-generated-uid-4"},{"nameParsed":{"literal":"Gionata Ghiggi","given":"Gionata","family":"Ghiggi"},"name":"Gionata Ghiggi","orcid":"0000-0002-0818-0865","github":"ghiggi","id":"contributors-myst-generated-uid-5"},{"nameParsed":{"literal":"Jen DeHart","given":"Jen","family":"DeHart"},"name":"Jen DeHart","orcid":"0000-0001-8536-4927","github":"jcdehart","id":"contributors-myst-generated-uid-6"},{"nameParsed":{"literal":"Jordi Figueras i Ventura","given":"Jordi Figueras","non_dropping_particle":"i","family":"Ventura"},"name":"Jordi Figueras i Ventura","orcid":"0000-0002-4949-422X","github":"jfigui","id":"contributors-myst-generated-uid-7"},{"nameParsed":{"literal":"Julian Giles","given":"Julian","family":"Giles"},"name":"Julian Giles","orcid":"0000-0001-8134-008X","github":"JulianGiles","id":"contributors-myst-generated-uid-8"},{"nameParsed":{"literal":"Kai Mühlbauer","given":"Kai","family":"Mühlbauer"},"name":"Kai Mühlbauer","orcid":"0000-0001-6599-1034","github":"kmuehlbauer","id":"contributors-myst-generated-uid-9"},{"nameParsed":{"literal":"Maxwell Grover","given":"Maxwell","family":"Grover"},"name":"Maxwell Grover","orcid":"0000-0002-0370-8974","github":"mgrover1","id":"contributors-myst-generated-uid-10"},{"nameParsed":{"literal":"Mike Dixon","given":"Mike","family":"Dixon"},"name":"Mike Dixon","orcid":"0000-0002-9597-9113","github":"mike-dixon","id":"contributors-myst-generated-uid-11"},{"nameParsed":{"literal":"Robert Jackson","given":"Robert","family":"Jackson"},"name":"Robert Jackson","orcid":"0000-0003-2518-1234","github":"rcjackson","id":"contributors-myst-generated-uid-12"},{"nameParsed":{"literal":"Scott Collis","given":"Scott","family":"Collis"},"name":"Scott Collis","orcid":"0000-0002-2303-687X","github":"scollis","id":"contributors-myst-generated-uid-13"},{"nameParsed":{"literal":"Ting-Yu Cha","given":"Ting-Yu","family":"Cha"},"name":"Ting-Yu Cha","orcid":"0000-0002-6292-8483","github":"tingyucha","id":"contributors-myst-generated-uid-14"}],"open_access":true,"license":{"content":{"id":"Apache-2.0","name":"Apache License 2.0","osi":true,"free":true,"url":"https://opensource.org/licenses/Apache-2.0"},"code":{"id":"CC-BY-4.0","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true,"url":"https://creativecommons.org/licenses/by/4.0/"}},"github":"https://github.com/openradar/erad2024","copyright":"2024","abbreviations":{"ARM":"Atmospheric Radiation Measurement","NCAR":"National Center for Atmospheric Research"},"settings":{"output_matplotlib_strings":"remove"},"exports":[{"format":"ipynb","filename":"SR_GR_Calibration_Applied.ipynb","url":"/erad2024/_preview/104/build/SR_GR_Calibration_Ap-a551f95bc4e1f5df83ad941835ed5f1e.ipynb"}]},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In this tutorial, we demonstrate how to exploit GPM-API along with other radar software such\n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Bttt3kB3DU"},{"type":"link","url":"https://docs.openradarscience.org/projects/xradar/en/stable/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"xradar","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZIh9d3vwiG"}],"urlSource":"https://docs.openradarscience.org/projects/xradar/en/stable/","key":"fGhMd45kJX"},{"type":"text","value":" and\n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Pb4J0zR9O6"},{"type":"link","url":"https://docs.wradlib.org/en/latest/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"wradlib","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oYRuCHrct6"}],"urlSource":"https://docs.wradlib.org/en/latest/","key":"LuRPTKOGcs"},{"type":"text","value":" to match reflectivities measurements of spaceborne (SR) and ground (GR) radars and assess the GR calibration bias.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sNhKgebFNP"}],"key":"sjv4u502bR"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"As example, we analyze a coincident GPM DPR and NEXRAD overpass over San Diego, USA, during the landfall of Tropical Storm Hilary in 2023. The NEXRAD KNKX radar data appears to be significantly miscalibrated and we will assess the calibration bias.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"CfxfFTxWcu"}],"key":"zq7nMC39Ih"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"To facilitate your hands-on experience, we’ve preprocessed the native NEXRAD radar data using the xradar package and the coincident GPM DPR overpass using GPM-API. The resulting data has been uploaded in Zarr format to the Pythia Cloud Bucket, allowing you to start the tutorial directly in the Binder environment.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"E4q6e4O54j"}],"key":"EsFDtzbTI1"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"If you wish to adapt this tutorial to your own case study, you can use the xradar package to read your GR radar data into the expected xarray format. Similarly, you can retrieve the relevant GPM data using GPM-API.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"MGNSUDWc2i"}],"key":"i6YYxO9FM0"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Additionally, note that the GPM-API’s ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"om8mfd2XX0"},{"type":"inlineCode","value":"volume_matching","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"T6sq7ZQsUH"},{"type":"text","value":" routine can automatically download and open the coincident GPM overpass data if the SR dataset is not provided to the function.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"O8p5i9z2ex"}],"key":"hVhYlJgVzr"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Please read the ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"cit6NCgof9"},{"type":"link","url":"https://gpm-api.readthedocs.io/en/latest/tutorials/tutorial_03_SR_GR_Matching.html","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Spaceborne-Ground Radar Matching Tutorial","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"EyYAdh3Phb"}],"urlSource":"https://gpm-api.readthedocs.io/en/latest/tutorials/tutorial_03_SR_GR_Matching.html","key":"Tdhw0SfFby"},{"type":"text","value":" for a step-by-step guide through the process of obtaining spatially and temporally coincident radar samples.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"JWoP1lIDzN"}],"key":"mDm1p6jHyA"}],"key":"DdaSSllHcD"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now let’s start the tutorial by importing the required packages:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HUSNj0Qo4m"}],"key":"m9MSKswkcO"}],"key":"UNLH17j2jb"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-05T14:56:38.969783Z","iopub.status.busy":"2024-09-05T14:56:38.969221Z","iopub.status.idle":"2024-09-05T14:56:40.866771Z","shell.execute_reply":"2024-09-05T14:56:40.866060Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"import warnings\n\nwarnings.filterwarnings(\"ignore\")\n\nfrom functools import reduce\n\nimport cartopy.crs as ccrs\nimport fsspec\nimport numpy as np\nimport xradar as xd\nimport xarray as xr\nfrom IPython.display import display\nfrom xarray.backends.api import open_datatree\nfrom gpm.gv import (\n    calibration_summary,\n    compare_maps,\n    reflectivity_scatterplots,\n    volume_matching,\n)\n\nnp.set_printoptions(suppress=True)","key":"t7WcKOggKE"},{"type":"output","id":"SL7A0QT6fZpnGALT2wPEs","data":[],"key":"UjbyfzF8pC"}],"key":"qWiwRXQWgu"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Load SR and GR data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EGp973jxlO"}],"identifier":"load-sr-and-gr-data","label":"Load SR and GR data","html_id":"load-sr-and-gr-data","implicit":true,"key":"aoLBxIPVzn"}],"key":"VlACs10pE2"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now let’s open the NEXRAD GR data and the GPM granule with the coincident overpass.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sWHDIyhBfF"}],"key":"WPS7TtEUE5"}],"key":"w5UsKWt5ZL"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-05T14:56:40.869827Z","iopub.status.busy":"2024-09-05T14:56:40.869382Z","iopub.status.idle":"2024-09-05T14:56:41.046165Z","shell.execute_reply":"2024-09-05T14:56:41.045642Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Open fsspec connection to the bucket\nbucket_url = \"https://js2.jetstream-cloud.org:8001\"\nfs = fsspec.filesystem(\"s3\", anon=True, client_kwargs=dict(endpoint_url=bucket_url))","key":"MuflWRBgi7"},{"type":"output","id":"Um1w8UFlK6mNb9lN1kbEn","data":[],"key":"kx7SE80uTc"}],"key":"HzOoLVw9a0"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-05T14:56:41.048920Z","iopub.status.busy":"2024-09-05T14:56:41.048444Z","iopub.status.idle":"2024-09-05T14:56:49.416453Z","shell.execute_reply":"2024-09-05T14:56:49.415874Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Open the GR datatree\nfile = fs.get_mapper(f\"pythia/radar/erad2024/gpm_api/KNKX20230820_221341_V06.zarr\")\ndt_gr = open_datatree(file, engine=\"zarr\", consolidated=True, chunks={})\ndisplay(dt_gr)","key":"RhRTkiav72"},{"type":"output","id":"ssyEjL7tkH8hKxJ0nH1x0","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"bf133140402748acde025fed271ab7c6","path":"/erad2024/_preview/104/build/bf133140402748acde025fed271ab7c6.html"},"text/plain":{"content_type":"text/plain","hash":"a4ed0eb4ad3ad105da250c49d6296045","path":"/erad2024/_preview/104/build/a4ed0eb4ad3ad105da250c49d6296045.txt"}}}],"key":"hTP3Y95GMd"}],"key":"WN8I1khwQV"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-05T14:56:49.426511Z","iopub.status.busy":"2024-09-05T14:56:49.425670Z","iopub.status.idle":"2024-09-05T14:56:49.930857Z","shell.execute_reply":"2024-09-05T14:56:49.930341Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Open the SR dataset\nfile = fs.get_mapper(\n    f\"pythia/radar/erad2024/gpm_api/2A.GPM.DPR.V9-20211125.20230820-S213941-E231213.053847.V07B.zarr\"\n)\nds_sr = xr.open_zarr(file, consolidated=True, chunks={})","key":"exgX6ps2JZ"},{"type":"output","id":"nbKqxCdbOsRFV924e1W9f","data":[],"key":"OpOe676TmB"}],"key":"kdwHXcsNFT"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now, let’s select a GR sweep to match with GPM DPR:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xLRauucD4F"}],"key":"TZwNIPcxCH"}],"key":"RIQI2HVYGK"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-05T14:56:49.933335Z","iopub.status.busy":"2024-09-05T14:56:49.933145Z","iopub.status.idle":"2024-09-05T14:56:49.936465Z","shell.execute_reply":"2024-09-05T14:56:49.935933Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"print(\"Available sweeps:\", list(dt_gr.groups))","key":"rlMW9QTpcd"},{"type":"output","id":"xbBgqDtQA6mg8TU0NsMQ6","data":[{"name":"stdout","output_type":"stream","text":"Available sweeps: ['/', '/sweep_0', '/sweep_1', '/sweep_10', '/sweep_11', '/sweep_12', '/sweep_13', '/sweep_14', '/sweep_15', '/sweep_16', '/sweep_17', '/sweep_18', '/sweep_19', '/sweep_2', '/sweep_3', '/sweep_4', '/sweep_5', '/sweep_6', '/sweep_7', '/sweep_8', '/sweep_9']\n"}],"key":"BDmgKuMj6L"}],"key":"gWveOSoyzJ"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-05T14:56:49.938614Z","iopub.status.busy":"2024-09-05T14:56:49.938438Z","iopub.status.idle":"2024-09-05T14:56:51.386456Z","shell.execute_reply":"2024-09-05T14:56:51.385865Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"sweep_idx = 0\nsweep_group = f\"sweep_{sweep_idx}\"  # GR sweep (elevation to be used)\nds_gr = dt_gr[sweep_group].to_dataset().compute()","key":"puW0xTwgZL"},{"type":"output","id":"AgLqOlUEFuKBqHO23o2DK","data":[],"key":"d1PYqhezfr"}],"key":"G7P3fmCd1u"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"and display the horizontally and vertically polarized reflectivity fields:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"s78iS67H3p"}],"key":"MAFT4gxspc"}],"key":"qyyx3kHKLm"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-05T14:56:51.389352Z","iopub.status.busy":"2024-09-05T14:56:51.389123Z","iopub.status.idle":"2024-09-05T14:57:03.876047Z","shell.execute_reply":"2024-09-05T14:57:03.875452Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"ds_gr[\"DBZH\"].where(ds_gr[\"DBZH\"] \u003e -10).xradar_dev.plot_map()\nds_gr[\"DBZV\"] = (ds_gr[\"DBZH\"].gpm.idecibel / ds_gr[\"ZDR\"].gpm.idecibel).gpm.decibel\nds_gr[\"DBZV\"].where(ds_gr[\"DBZV\"] \u003e -10).xradar_dev.plot_map()\n# ds_gr[\"ZDR\"].xradar_dev.plot_map()","key":"Zbsvrv0caG"},{"type":"output","id":"msGAw0DCUxsZ9jdU5RXAo","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/plain":{"content":"\u003ccartopy.mpl.geocollection.GeoQuadMesh at 0x7f345024fb90\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"16dedf597daa0bf6263fe252b5aa490f","path":"/erad2024/_preview/104/build/16dedf597daa0bf6263fe252b5aa490f.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"57670c565a927d65915dd7ad3b3cb552","path":"/erad2024/_preview/104/build/57670c565a927d65915dd7ad3b3cb552.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"qgCf14E9Il"}],"key":"KMJstT3Sa9"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Run SR/GR volume matching","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AZqPv3JWyk"}],"identifier":"run-sr-gr-volume-matching","label":"Run SR/GR volume matching","html_id":"run-sr-gr-volume-matching","implicit":true,"key":"gG8sNMkEg3"}],"key":"X0QKeyjQhg"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here we start defining the required settings for the SR/GR volume matching procedure:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"x2qe4syzjg"}],"key":"wFAcEQHNqQ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The GR ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"iy90Vg4DPM"},{"type":"inlineCode","value":"radar_band","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LUQmCcsfOT"},{"type":"text","value":" controls to which frequency SR Ku-band reflectivities will be converted. Valid values are ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"L0GqPXdcHn"},{"type":"inlineCode","value":"X","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IncWItO8KW"},{"type":"text","value":", ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"RsJpwUkTxD"},{"type":"inlineCode","value":"C","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mvaUepag02"},{"type":"text","value":", ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sdPnAKCJrd"},{"type":"inlineCode","value":"S","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ndr1UeepPI"},{"type":"text","value":", ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kMF3dE9ebG"},{"type":"inlineCode","value":"Ku","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BdOu0YZseO"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Hqf1DCHksF"}],"key":"gE9ksdoVaQ"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"yJsIcDG5gg"},{"type":"inlineCode","value":"beamwidth_gr","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"wNUynTsEZt"},{"type":"text","value":" refers to the angular beam width of the GR.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"O7wq6bONQu"}],"key":"JI8eYhb0Bn"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"The minimum reflectivity thresholds ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"IshJzvnjs4"},{"type":"inlineCode","value":"z_min_threshold_sr","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"SJYEdwPl8V"},{"type":"text","value":" and ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"zgfd1fBRjK"},{"type":"inlineCode","value":"z_min_threshold_gr","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"PlnzPelDST"},{"type":"text","value":" are used to mask out SR and GR\ngates belows such thresholds.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"oy4qliQqOZ"}],"key":"Pwe0NrsgrU"}],"key":"vUufOsv7g8"}],"key":"cvcTupz1Ep"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-05T14:57:03.878451Z","iopub.status.busy":"2024-09-05T14:57:03.878249Z","iopub.status.idle":"2024-09-05T14:57:03.881296Z","shell.execute_reply":"2024-09-05T14:57:03.880744Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"radar_band = \"S\"\nbeamwidth_gr = 1\nz_min_threshold_gr = 0\nz_min_threshold_sr = 10","key":"RenCfpMhgm"},{"type":"output","id":"p4KxDcvzZzZNfHE1iaY2O","data":[],"key":"Wd9Xppb4Qx"}],"key":"aQ2jv53go7"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The SR/GR volume matching routine typically takes around 40-50 seconds to complete. It returns a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HY2Yz9xywX"},{"type":"inlineCode","value":"geopandas.DataFrame","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oMmqWzwweu"},{"type":"text","value":" with the matched aggregated reflectivities and the associated statistics.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MMYHEcGUtI"}],"key":"ptLv0yFixa"}],"key":"QmX816JTq0"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-05T14:57:03.883311Z","iopub.status.busy":"2024-09-05T14:57:03.883118Z","iopub.status.idle":"2024-09-05T14:57:26.529035Z","shell.execute_reply":"2024-09-05T14:57:26.528517Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"gdf_match = volume_matching(\n    ds_gr=ds_gr,\n    ds_sr=ds_sr,\n    z_variable_gr=\"DBZH\",\n    radar_band=radar_band,\n    beamwidth_gr=beamwidth_gr,\n    z_min_threshold_gr=z_min_threshold_gr,\n    z_min_threshold_sr=z_min_threshold_sr,\n    min_gr_range=0,\n    max_gr_range=150_000,\n    # gr_sensitivity_thresholds=None,\n    # sr_sensitivity_thresholds=None,\n    download_sr=False,  # require internet connection !\n    display_quicklook=True,\n)\n# Note: The circle radius in the quicklook represents the min_gr_range, max_gr_range and 250_000 m range distances.","key":"cZ7209W75y"},{"type":"output","id":"HhEDEFBw1J6D0e4Df9Xte","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"085ae29473c77fc2252377882a84b3c3","path":"/erad2024/_preview/104/build/085ae29473c77fc2252377882a84b3c3.png"},"text/plain":{"content":"\u003cFigure size 960x480 with 4 Axes\u003e","content_type":"text/plain"}}},{"name":"stdout","output_type":"stream","text":"SR/GR Matching Elapsed time: 0:00:22.642378 .\n"}],"key":"Tb1R7t2lWL"}],"key":"daeKuDffA8"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-05T14:57:26.531102Z","iopub.status.busy":"2024-09-05T14:57:26.530935Z","iopub.status.idle":"2024-09-05T14:57:26.551016Z","shell.execute_reply":"2024-09-05T14:57:26.550440Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"display(gdf_match)","key":"VEvd9V6rHy"},{"type":"output","id":"URFaDzWldafNkgUPp0sJr","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"\u003cdiv\u003e\n\u003cstyle scoped\u003e\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n\u003c/style\u003e\n\u003ctable border=\"1\" class=\"dataframe\"\u003e\n  \u003cthead\u003e\n    \u003ctr style=\"text-align: right;\"\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003eGR_Z_mean\u003c/th\u003e\n      \u003cth\u003eGR_Z_std\u003c/th\u003e\n      \u003cth\u003eGR_Z_max\u003c/th\u003e\n      \u003cth\u003eGR_Z_min\u003c/th\u003e\n      \u003cth\u003eGR_Z_range\u003c/th\u003e\n      \u003cth\u003eGR_Z_cov\u003c/th\u003e\n      \u003cth\u003eGR_time\u003c/th\u003e\n      \u003cth\u003eGR_gate_volume_sum\u003c/th\u003e\n      \u003cth\u003eGR_fraction_covered_area\u003c/th\u003e\n      \u003cth\u003eGR_counts\u003c/th\u003e\n      \u003cth\u003e...\u003c/th\u003e\n      \u003cth\u003esweep_number\u003c/th\u003e\n      \u003cth\u003ealong_track\u003c/th\u003e\n      \u003cth\u003ecross_track\u003c/th\u003e\n      \u003cth\u003eVolumeRatio\u003c/th\u003e\n      \u003cth\u003eVolumeDiff\u003c/th\u003e\n      \u003cth\u003etime_difference\u003c/th\u003e\n      \u003cth\u003eGR_z_lower_bound\u003c/th\u003e\n      \u003cth\u003eGR_z_upper_bound\u003c/th\u003e\n      \u003cth\u003eSR_z_lower_bound\u003c/th\u003e\n      \u003cth\u003eSR_z_upper_bound\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003cth\u003e0\u003c/th\u003e\n      \u003ctd\u003e15.221830\u003c/td\u003e\n      \u003ctd\u003e12.594024\u003c/td\u003e\n      \u003ctd\u003e19.5\u003c/td\u003e\n      \u003ctd\u003e10.5\u003c/td\u003e\n      \u003ctd\u003e9.0\u003c/td\u003e\n      \u003ctd\u003e0.827366\u003c/td\u003e\n      \u003ctd\u003e2023-08-20 22:13:43.619000064\u003c/td\u003e\n      \u003ctd\u003e1.325220e+09\u003c/td\u003e\n      \u003ctd\u003e0.523921\u003c/td\u003e\n      \u003ctd\u003e50.0\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e0\u003c/td\u003e\n      \u003ctd\u003e98\u003c/td\u003e\n      \u003ctd\u003e42\u003c/td\u003e\n      \u003ctd\u003e44.668064\u003c/td\u003e\n      \u003ctd\u003e5.786978e+10\u003c/td\u003e\n      \u003ctd\u003e97\u003c/td\u003e\n      \u003ctd\u003e1535.796701\u003c/td\u003e\n      \u003ctd\u003e4204.951593\u003c/td\u003e\n      \u003ctd\u003e1654.094116\u003c/td\u003e\n      \u003ctd\u003e4209.583984\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1\u003c/th\u003e\n      \u003ctd\u003e13.581805\u003c/td\u003e\n      \u003ctd\u003e10.557827\u003c/td\u003e\n      \u003ctd\u003e18.5\u003c/td\u003e\n      \u003ctd\u003e10.0\u003c/td\u003e\n      \u003ctd\u003e8.5\u003c/td\u003e\n      \u003ctd\u003e0.777351\u003c/td\u003e\n      \u003ctd\u003e2023-08-20 22:13:43.513999872\u003c/td\u003e\n      \u003ctd\u003e1.316104e+09\u003c/td\u003e\n      \u003ctd\u003e0.792108\u003c/td\u003e\n      \u003ctd\u003e73.0\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e0\u003c/td\u003e\n      \u003ctd\u003e98\u003c/td\u003e\n      \u003ctd\u003e43\u003c/td\u003e\n      \u003ctd\u003e47.688195\u003c/td\u003e\n      \u003ctd\u003e6.144654e+10\u003c/td\u003e\n      \u003ctd\u003e97\u003c/td\u003e\n      \u003ctd\u003e1514.601481\u003c/td\u003e\n      \u003ctd\u003e4200.459785\u003c/td\u003e\n      \u003ctd\u003e1558.925415\u003c/td\u003e\n      \u003ctd\u003e4227.430664\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e2\u003c/th\u003e\n      \u003ctd\u003e16.550807\u003c/td\u003e\n      \u003ctd\u003e15.714381\u003c/td\u003e\n      \u003ctd\u003e23.0\u003c/td\u003e\n      \u003ctd\u003e10.0\u003c/td\u003e\n      \u003ctd\u003e13.0\u003c/td\u003e\n      \u003ctd\u003e0.949463\u003c/td\u003e\n      \u003ctd\u003e2023-08-20 22:13:43.414000128\u003c/td\u003e\n      \u003ctd\u003e1.304555e+09\u003c/td\u003e\n      \u003ctd\u003e0.966467\u003c/td\u003e\n      \u003ctd\u003e92.0\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e0\u003c/td\u003e\n      \u003ctd\u003e98\u003c/td\u003e\n      \u003ctd\u003e44\u003c/td\u003e\n      \u003ctd\u003e46.511517\u003c/td\u003e\n      \u003ctd\u003e5.937226e+10\u003c/td\u003e\n      \u003ctd\u003e97\u003c/td\u003e\n      \u003ctd\u003e1494.739411\u003c/td\u003e\n      \u003ctd\u003e4194.752350\u003c/td\u003e\n      \u003ctd\u003e1605.041138\u003c/td\u003e\n      \u003ctd\u003e4143.421875\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e3\u003c/th\u003e\n      \u003ctd\u003e19.808129\u003c/td\u003e\n      \u003ctd\u003e18.675347\u003c/td\u003e\n      \u003ctd\u003e26.0\u003c/td\u003e\n      \u003ctd\u003e11.0\u003c/td\u003e\n      \u003ctd\u003e15.0\u003c/td\u003e\n      \u003ctd\u003e0.942812\u003c/td\u003e\n      \u003ctd\u003e2023-08-20 22:13:43.315000064\u003c/td\u003e\n      \u003ctd\u003e1.292233e+09\u003c/td\u003e\n      \u003ctd\u003e1.000000\u003c/td\u003e\n      \u003ctd\u003e98.0\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e0\u003c/td\u003e\n      \u003ctd\u003e98\u003c/td\u003e\n      \u003ctd\u003e45\u003c/td\u003e\n      \u003ctd\u003e47.599161\u003c/td\u003e\n      \u003ctd\u003e6.021699e+10\u003c/td\u003e\n      \u003ctd\u003e97\u003c/td\u003e\n      \u003ctd\u003e1475.392380\u003c/td\u003e\n      \u003ctd\u003e4182.133888\u003c/td\u003e\n      \u003ctd\u003e1527.083740\u003c/td\u003e\n      \u003ctd\u003e4056.250488\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e4\u003c/th\u003e\n      \u003ctd\u003e18.983302\u003c/td\u003e\n      \u003ctd\u003e18.326115\u003c/td\u003e\n      \u003ctd\u003e24.5\u003c/td\u003e\n      \u003ctd\u003e10.0\u003c/td\u003e\n      \u003ctd\u003e14.5\u003c/td\u003e\n      \u003ctd\u003e0.965381\u003c/td\u003e\n      \u003ctd\u003e2023-08-20 22:13:43.212000000\u003c/td\u003e\n      \u003ctd\u003e1.280453e+09\u003c/td\u003e\n      \u003ctd\u003e1.000000\u003c/td\u003e\n      \u003ctd\u003e98.0\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e0\u003c/td\u003e\n      \u003ctd\u003e98\u003c/td\u003e\n      \u003ctd\u003e46\u003c/td\u003e\n      \u003ctd\u003e48.697237\u003c/td\u003e\n      \u003ctd\u003e6.107406e+10\u003c/td\u003e\n      \u003ctd\u003e97\u003c/td\u003e\n      \u003ctd\u003e1468.574285\u003c/td\u003e\n      \u003ctd\u003e4156.773245\u003c/td\u003e\n      \u003ctd\u003e1571.319336\u003c/td\u003e\n      \u003ctd\u003e4090.862549\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e...\u003c/th\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1300\u003c/th\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e2023-08-20 22:13:51.476000000\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e0.994502\u003c/td\u003e\n      \u003ctd\u003e96.0\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e0\u003c/td\u003e\n      \u003ctd\u003e157\u003c/td\u003e\n      \u003ctd\u003e45\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e64\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e1537.145386\u003c/td\u003e\n      \u003ctd\u003e4186.728516\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1301\u003c/th\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e2023-08-20 22:13:51.652999936\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e1.000000\u003c/td\u003e\n      \u003ctd\u003e99.0\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e0\u003c/td\u003e\n      \u003ctd\u003e157\u003c/td\u003e\n      \u003ctd\u003e46\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e64\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e1580.786865\u003c/td\u003e\n      \u003ctd\u003e4100.309082\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1302\u003c/th\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e2023-08-20 22:13:51.756000000\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e1.000000\u003c/td\u003e\n      \u003ctd\u003e99.0\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e0\u003c/td\u003e\n      \u003ctd\u003e157\u003c/td\u003e\n      \u003ctd\u003e47\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e64\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e1527.273315\u003c/td\u003e\n      \u003ctd\u003e4036.591797\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1303\u003c/th\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e2023-08-20 22:13:51.886000128\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e1.000000\u003c/td\u003e\n      \u003ctd\u003e104.0\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e0\u003c/td\u003e\n      \u003ctd\u003e157\u003c/td\u003e\n      \u003ctd\u003e48\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e64\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e1469.200317\u003c/td\u003e\n      \u003ctd\u003e4086.919434\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1304\u003c/th\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e2023-08-20 22:13:51.857999872\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e0.606705\u003c/td\u003e\n      \u003ctd\u003e59.0\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e0\u003c/td\u003e\n      \u003ctd\u003e158\u003c/td\u003e\n      \u003ctd\u003e48\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e63\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e1598.747192\u003c/td\u003e\n      \u003ctd\u003e4216.467285\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e1305 rows × 229 columns\u003c/p\u003e\n\u003c/div\u003e","content_type":"text/html"},"text/plain":{"content":"      GR_Z_mean   GR_Z_std  GR_Z_max  GR_Z_min  GR_Z_range  GR_Z_cov  \\\n0     15.221830  12.594024      19.5      10.5         9.0  0.827366   \n1     13.581805  10.557827      18.5      10.0         8.5  0.777351   \n2     16.550807  15.714381      23.0      10.0        13.0  0.949463   \n3     19.808129  18.675347      26.0      11.0        15.0  0.942812   \n4     18.983302  18.326115      24.5      10.0        14.5  0.965381   \n...         ...        ...       ...       ...         ...       ...   \n1300        NaN        NaN       NaN       NaN         NaN       NaN   \n1301        NaN        NaN       NaN       NaN         NaN       NaN   \n1302        NaN        NaN       NaN       NaN         NaN       NaN   \n1303        NaN        NaN       NaN       NaN         NaN       NaN   \n1304        NaN        NaN       NaN       NaN         NaN       NaN   \n\n                           GR_time  GR_gate_volume_sum  \\\n0    2023-08-20 22:13:43.619000064        1.325220e+09   \n1    2023-08-20 22:13:43.513999872        1.316104e+09   \n2    2023-08-20 22:13:43.414000128        1.304555e+09   \n3    2023-08-20 22:13:43.315000064        1.292233e+09   \n4    2023-08-20 22:13:43.212000000        1.280453e+09   \n...                            ...                 ...   \n1300 2023-08-20 22:13:51.476000000                 NaN   \n1301 2023-08-20 22:13:51.652999936                 NaN   \n1302 2023-08-20 22:13:51.756000000                 NaN   \n1303 2023-08-20 22:13:51.886000128                 NaN   \n1304 2023-08-20 22:13:51.857999872                 NaN   \n\n      GR_fraction_covered_area  GR_counts  ...  sweep_number along_track  \\\n0                     0.523921       50.0  ...             0          98   \n1                     0.792108       73.0  ...             0          98   \n2                     0.966467       92.0  ...             0          98   \n3                     1.000000       98.0  ...             0          98   \n4                     1.000000       98.0  ...             0          98   \n...                        ...        ...  ...           ...         ...   \n1300                  0.994502       96.0  ...             0         157   \n1301                  1.000000       99.0  ...             0         157   \n1302                  1.000000       99.0  ...             0         157   \n1303                  1.000000      104.0  ...             0         157   \n1304                  0.606705       59.0  ...             0         158   \n\n      cross_track  VolumeRatio    VolumeDiff  time_difference  \\\n0              42    44.668064  5.786978e+10               97   \n1              43    47.688195  6.144654e+10               97   \n2              44    46.511517  5.937226e+10               97   \n3              45    47.599161  6.021699e+10               97   \n4              46    48.697237  6.107406e+10               97   \n...           ...          ...           ...              ...   \n1300           45          NaN           NaN               64   \n1301           46          NaN           NaN               64   \n1302           47          NaN           NaN               64   \n1303           48          NaN           NaN               64   \n1304           48          NaN           NaN               63   \n\n      GR_z_lower_bound  GR_z_upper_bound  SR_z_lower_bound  SR_z_upper_bound  \n0          1535.796701       4204.951593       1654.094116       4209.583984  \n1          1514.601481       4200.459785       1558.925415       4227.430664  \n2          1494.739411       4194.752350       1605.041138       4143.421875  \n3          1475.392380       4182.133888       1527.083740       4056.250488  \n4          1468.574285       4156.773245       1571.319336       4090.862549  \n...                ...               ...               ...               ...  \n1300               NaN               NaN       1537.145386       4186.728516  \n1301               NaN               NaN       1580.786865       4100.309082  \n1302               NaN               NaN       1527.273315       4036.591797  \n1303               NaN               NaN       1469.200317       4086.919434  \n1304               NaN               NaN       1598.747192       4216.467285  \n\n[1305 rows x 229 columns]","content_type":"text/plain"}}}],"key":"nZGETldkFl"}],"key":"i4wUR1uDMB"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Analyse SR/GR database","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"i3rwvPcGqa"}],"identifier":"analyse-sr-gr-database","label":"Analyse SR/GR database","html_id":"analyse-sr-gr-database","implicit":true,"key":"EgwQyi1wyR"}],"key":"kesO6cFIiZ"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now let’s first define the variables names of the SR and GR reflectivities:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Vfe4Imsrvp"}],"key":"m8DH2EU4QY"}],"key":"psxBx7thVp"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-05T14:57:26.553233Z","iopub.status.busy":"2024-09-05T14:57:26.552857Z","iopub.status.idle":"2024-09-05T14:57:26.555736Z","shell.execute_reply":"2024-09-05T14:57:26.555251Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"sr_z_column = f\"SR_zFactorFinal_{radar_band}_mean\"\ngr_z_column = \"GR_Z_mean\"","key":"fmx2l4ThHJ"},{"type":"output","id":"PhVgJj2I0Ik1l_uP7YoRc","data":[],"key":"U6xtMMshOX"}],"key":"tkwzHUjhIb"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Compare spatial reflectivity fields","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jwFFQbNBxj"}],"identifier":"compare-spatial-reflectivity-fields","label":"Compare spatial reflectivity fields","html_id":"compare-spatial-reflectivity-fields","implicit":true,"key":"VlF49AE3t4"}],"key":"VTNlxDbRHF"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here we start comparing the spatial reflectivity fields without applying restrictive filtering criteria:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CUkmvmdT6X"}],"key":"LEhBaqCj7z"}],"key":"roT3hAZkLn"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-05T14:57:26.557876Z","iopub.status.busy":"2024-09-05T14:57:26.557513Z","iopub.status.idle":"2024-09-05T14:57:27.342373Z","shell.execute_reply":"2024-09-05T14:57:27.341796Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"fig = compare_maps(\n    gdf_match,\n    sr_column=sr_z_column,\n    gr_column=gr_z_column,\n    sr_label=\"SR Reflectivity (dBz)\",\n    gr_label=\"GR Reflectivity (dBz)\",\n    cmap=\"Spectral_r\",\n    unified_color_scale=True,\n    vmin=15,\n    # vmax=40\n)\nfig.tight_layout()","key":"IkmyZFXl4C"},{"type":"output","id":"oR10pb9vxqTgPxngccZo9","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b5a257ddc3e7c513eed1394adfc8d493","path":"/erad2024/_preview/104/build/b5a257ddc3e7c513eed1394adfc8d493.png"},"text/plain":{"content":"\u003cFigure size 1400x700 with 4 Axes\u003e","content_type":"text/plain"}}}],"key":"oMna3cPZCB"}],"key":"Rqb7dnesgx"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"If you wish to create a cartopy map, specify the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eAm0rFGKkH"},{"type":"inlineCode","value":"'projection'","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hWvFXi1yzl"},{"type":"text","value":" in the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uU5aS6eEIN"},{"type":"inlineCode","value":"subplot_kwargs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qv1Gz5bEvS"},{"type":"text","value":" argument:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"r3BvexXSey"}],"key":"usxqgYSACn"}],"key":"T8jmvH8uBY"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-05T14:57:27.346368Z","iopub.status.busy":"2024-09-05T14:57:27.345814Z","iopub.status.idle":"2024-09-05T14:57:27.909250Z","shell.execute_reply":"2024-09-05T14:57:27.908607Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"ccrs_gr_aeqd = ccrs.AzimuthalEquidistant(\n    central_longitude=ds_gr[\"longitude\"].item(),\n    central_latitude=ds_gr[\"latitude\"].item(),\n)\nsubplot_kwargs = {}\nsubplot_kwargs[\"projection\"] = ccrs_gr_aeqd\nfig = compare_maps(\n    gdf_match,\n    sr_column=sr_z_column,\n    gr_column=gr_z_column,\n    sr_label=\"SR Reflectivity (dBz)\",\n    gr_label=\"GR Reflectivity (dBz)\",\n    cmap=\"Spectral_r\",\n    unified_color_scale=True,\n    vmin=15,\n    # vmax=40\n    subplot_kwargs=subplot_kwargs,\n)\nfig.tight_layout()","key":"H8LoaLCAM6"},{"type":"output","id":"v6Get0_2nFP84hB3aFPkR","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"309c54e0aa461eaed070317c44d6d81c","path":"/erad2024/_preview/104/build/309c54e0aa461eaed070317c44d6d81c.png"},"text/plain":{"content":"\u003cFigure size 1400x700 with 4 Axes\u003e","content_type":"text/plain"}}}],"key":"ycQsOLZfuz"}],"key":"ucyhhhdqs3"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here we show how to explore interactively the reflectivity fields using ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"guEFX5bDiK"},{"type":"link","url":"https://python-visualization.github.io/folium/latest/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Folium","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xgIHHf26L2"}],"urlSource":"https://python-visualization.github.io/folium/latest/","key":"baGijCqxcf"},{"type":"text","value":":","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CDlMDvnxNd"}],"key":"cO3SvtVstO"}],"key":"hH0ggpHXam"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-05T14:57:27.912212Z","iopub.status.busy":"2024-09-05T14:57:27.912003Z","iopub.status.idle":"2024-09-05T14:57:32.301089Z","shell.execute_reply":"2024-09-05T14:57:32.300312Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"gdf_match.explore(column=\"GR_Z_mean\", legend=True, cmap=\"Spectral_r\", vmin=0, vmax=40)","key":"KhkAClRRSz"},{"type":"output","id":"5Q9MAfEiZmOmfZA-L_OM1","data":[{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"5c6fd8cbed98d9c4cdca43e2faecdd14","path":"/erad2024/_preview/104/build/5c6fd8cbed98d9c4cdca43e2faecdd14.html"},"text/plain":{"content":"\u003cfolium.folium.Map at 0x7f3437e61f90\u003e","content_type":"text/plain"}}}],"key":"TE6kL2QoY0"}],"key":"MBa3HH9hHi"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Generate calibration summary","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wagq8182DB"}],"identifier":"generate-calibration-summary","label":"Generate calibration summary","html_id":"generate-calibration-summary","implicit":true,"key":"GQq68UDxPC"}],"key":"pYeuS5QhLf"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We now create a figure comparing SR/GR aggregated reflectivities volume-by-volume and displaying the overall distributions.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FfKpKTKMHp"}],"key":"a6SrLKmwBi"}],"key":"lNiLd2rkuG"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-05T14:57:32.430059Z","iopub.status.busy":"2024-09-05T14:57:32.429385Z","iopub.status.idle":"2024-09-05T14:57:32.812199Z","shell.execute_reply":"2024-09-05T14:57:32.811710Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"gr_z_column = \"GR_Z_mean\"\nsr_z_column = f\"SR_zFactorFinal_{radar_band}_mean\"\n\nfig = calibration_summary(\n    df=gdf_match,\n    gr_z_column=gr_z_column,\n    sr_z_column=sr_z_column,\n    # Histogram options\n    bin_width=2,\n    # Scatterplot options\n    hue_column=\"SR_fraction_clutter\",\n    # gr_range=[15, 50]\n    # sr_range=[15, 50]\n    marker=\"+\",\n    cmap=\"Spectral\",\n)\nfig.tight_layout()","key":"Bgd0256gYl"},{"type":"output","id":"YtMZMSw7kZxS880ORHkLn","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"397f63b202f07522ea8b0f537a1c0380","path":"/erad2024/_preview/104/build/397f63b202f07522ea8b0f537a1c0380.png"},"text/plain":{"content":"\u003cFigure size 1200x500 with 3 Axes\u003e","content_type":"text/plain"}}}],"key":"E19VwEZpC6"}],"key":"J7E58QHrap"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Investigate filtering criteria","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FDNChLJeMp"}],"identifier":"investigate-filtering-criteria","label":"Investigate filtering criteria","html_id":"investigate-filtering-criteria","implicit":true,"key":"orOqTXeoPi"}],"key":"iVgCcz5qir"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"When comparing SR and GR data or trying to determine an accurate GR calibration bias, it’s necessary to define a set of filtering criteria. In the figures below, we perform exploratory data analysis to investigate the relationships between the SR/GR reflectivity deviations and sets of variables characterizing radar measurements and SR/GR volume properties. The patterns and deviations observed in the scatterplots will be used to define a set of filtering critera in the next section of the tutorial.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fptll6SSpg"}],"key":"vQ83aYACjZ"}],"key":"ZLVJ4nJJT6"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-05T14:57:32.814445Z","iopub.status.busy":"2024-09-05T14:57:32.814078Z","iopub.status.idle":"2024-09-05T14:57:34.114652Z","shell.execute_reply":"2024-09-05T14:57:34.113707Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Matching characteristics\nhue_columns = [\n    \"VolumeRatio\",\n    \"VolumeDiff\",\n    \"GR_vres_max\",\n    \"GR_range_max\",\n    \"GR_gate_volume_sum\",\n    \"SR_gate_volume_sum\",\n    \"SR_vres_sum\",\n    \"GR_fraction_covered_area\",\n]\nfig = reflectivity_scatterplots(\n    df=gdf_match,\n    gr_z_column=gr_z_column,\n    sr_z_column=sr_z_column,\n    hue_columns=hue_columns,\n    ncols=2,\n)\nfig.tight_layout()","key":"eDhgKrmCrk"},{"type":"output","id":"52RfVZ9KtSEhSvrraV5QV","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f3bbd8aacd128c5b114f4deb64d97901","path":"/erad2024/_preview/104/build/f3bbd8aacd128c5b114f4deb64d97901.png"},"text/plain":{"content":"\u003cFigure size 1200x2000 with 16 Axes\u003e","content_type":"text/plain"}}}],"key":"kWugG6VjGn"}],"key":"jTkfdQgraG"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-05T14:57:34.118740Z","iopub.status.busy":"2024-09-05T14:57:34.118158Z","iopub.status.idle":"2024-09-05T14:57:35.298141Z","shell.execute_reply":"2024-09-05T14:57:35.297575Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Value validity \u0026 sensitivity\nhue_columns = [\n    \"GR_counts\",\n    \"GR_counts_valid\",\n    \"SR_counts\",\n    \"SR_counts_valid\",\n]\nfig = reflectivity_scatterplots(\n    df=gdf_match,\n    gr_z_column=gr_z_column,\n    sr_z_column=sr_z_column,\n    hue_columns=hue_columns,\n    ncols=2,\n)\nfig.tight_layout()\n\nhue_columns = [\n    \"SR_zFactorFinal_Ku_fraction_above_12dBZ\",\n    \"SR_zFactorFinal_Ku_fraction_above_14dBZ\",\n    \"GR_Z_fraction_above_10dBZ\",\n    \"GR_Z_fraction_above_12dBZ\",\n]\nfig = reflectivity_scatterplots(\n    df=gdf_match,\n    gr_z_column=gr_z_column,\n    sr_z_column=sr_z_column,\n    hue_columns=hue_columns,\n    ncols=2,\n)\nfig.tight_layout()","key":"j9Z0lSrjik"},{"type":"output","id":"s9wLsgkjlg3-jmPRx4-jN","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4f0882eb2356018f2a2ae6e3813fbc28","path":"/erad2024/_preview/104/build/4f0882eb2356018f2a2ae6e3813fbc28.png"},"text/plain":{"content":"\u003cFigure size 1200x1000 with 8 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7842b72ad66dfbb7ce581685591b9229","path":"/erad2024/_preview/104/build/7842b72ad66dfbb7ce581685591b9229.png"},"text/plain":{"content":"\u003cFigure size 1200x1000 with 8 Axes\u003e","content_type":"text/plain"}}}],"key":"anjXewRTFq"}],"key":"eOICnTKSmi"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-05T14:57:35.300881Z","iopub.status.busy":"2024-09-05T14:57:35.300516Z","iopub.status.idle":"2024-09-05T14:57:36.179803Z","shell.execute_reply":"2024-09-05T14:57:36.179215Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# NUBF \u0026 Variability\nhue_columns = [\n    \"SR_zFactorFinal_Ku_range\",\n    \"GR_Z_range\",\n    \"SR_zFactorFinal_Ku_std\",\n    \"GR_Z_std\",\n    \"SR_zFactorFinal_Ku_cov\",\n    \"GR_Z_cov\",\n]\nfig = reflectivity_scatterplots(\n    df=gdf_match,\n    gr_z_column=gr_z_column,\n    sr_z_column=sr_z_column,\n    hue_columns=hue_columns,\n    ncols=2,\n)\nfig.tight_layout()","key":"Q2IOMWvuEK"},{"type":"output","id":"Qk7YXFziD7NyeqQXG1DM1","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f6e4e8f37e2ad0b81d01aa63ad77b295","path":"/erad2024/_preview/104/build/f6e4e8f37e2ad0b81d01aa63ad77b295.png"},"text/plain":{"content":"\u003cFigure size 1200x1500 with 12 Axes\u003e","content_type":"text/plain"}}}],"key":"EBBS3KrS2d"}],"key":"yVlnwg0nH7"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-05T14:57:36.182995Z","iopub.status.busy":"2024-09-05T14:57:36.182817Z","iopub.status.idle":"2024-09-05T14:57:37.379733Z","shell.execute_reply":"2024-09-05T14:57:37.378892Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Attenuation\nhue_columns = [\n    \"SR_pathAtten\",\n    \"SR_piaFinal\",\n    \"SR_zFactorCorrection_Ku_max\",\n    \"SR_zFactorCorrection_Ku_mean\",\n    \"SR_reliabFlag\",\n    \"GR_Z_cumsum_max\",\n]\nfig = reflectivity_scatterplots(\n    df=gdf_match,\n    gr_z_column=gr_z_column,\n    sr_z_column=sr_z_column,\n    hue_columns=hue_columns,\n    ncols=2,\n)\nfig.tight_layout()","key":"I1LzE05N2S"},{"type":"output","id":"RtgA6VLA8mdQ7e57EfeFZ","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"332d8e08cde5d636b901748d0f95421b","path":"/erad2024/_preview/104/build/332d8e08cde5d636b901748d0f95421b.png"},"text/plain":{"content":"\u003cFigure size 1200x1500 with 12 Axes\u003e","content_type":"text/plain"}}}],"key":"STKRNOgW3S"}],"key":"UfiM35QDCI"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-05T14:57:37.382554Z","iopub.status.busy":"2024-09-05T14:57:37.382357Z","iopub.status.idle":"2024-09-05T14:57:38.438992Z","shell.execute_reply":"2024-09-05T14:57:38.438460Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Hydrometeors\nhue_columns = [\n    \"SR_fraction_no_precip\",\n    \"SR_fraction_clutter\",\n    \"SR_fraction_rain\",\n    \"SR_fraction_snow\",\n    \"SR_fraction_hail\",\n    \"SR_fraction_below_isotherm\",\n    \"SR_fraction_above_isotherm\",\n    \"SR_fraction_melting_layer\",\n    # 'SR_airTemperature_min',\n]\nfig = reflectivity_scatterplots(\n    df=gdf_match,\n    gr_z_column=gr_z_column,\n    sr_z_column=sr_z_column,\n    hue_columns=hue_columns,\n    ncols=2,\n)\nfig.tight_layout()","key":"fX5YjJeNvu"},{"type":"output","id":"jOOwc3flKYvVCxzdfG3dR","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d91fe38c236c59e6991b237e64bd60d4","path":"/erad2024/_preview/104/build/d91fe38c236c59e6991b237e64bd60d4.png"},"text/plain":{"content":"\u003cFigure size 1200x2000 with 16 Axes\u003e","content_type":"text/plain"}}}],"key":"i0UB0WPizo"}],"key":"NRFVtFLlT3"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-05T14:57:38.442156Z","iopub.status.busy":"2024-09-05T14:57:38.441780Z","iopub.status.idle":"2024-09-05T14:57:39.258593Z","shell.execute_reply":"2024-09-05T14:57:39.258035Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# SR Quality Flags\nhue_columns = [\n    \"SR_flagPrecipitationType\",\n    \"SR_qualityTypePrecip\",\n    \"SR_qualityBB\",\n    \"SR_flagPrecip\",\n    \"SR_qualityFlag\",\n    \"SR_dataQuality\",\n]\nfig = reflectivity_scatterplots(\n    df=gdf_match,\n    gr_z_column=gr_z_column,\n    sr_z_column=sr_z_column,\n    hue_columns=hue_columns,\n    ncols=2,\n)\nfig.tight_layout()","key":"CFLD4ByM4q"},{"type":"output","id":"Mowqd4Qqk7vKqOM_lxcwa","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b7b83268383103e1537daff73a801c46","path":"/erad2024/_preview/104/build/b7b83268383103e1537daff73a801c46.png"},"text/plain":{"content":"\u003cFigure size 1200x1500 with 12 Axes\u003e","content_type":"text/plain"}}}],"key":"RT6pdD4e3P"}],"key":"d32xcYMOLy"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define SR/GR filtering criteria","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XWMdGliTw1"}],"identifier":"define-sr-gr-filtering-criteria","label":"Define SR/GR filtering criteria","html_id":"define-sr-gr-filtering-criteria","implicit":true,"key":"r83MZLfCnE"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"When calibrating or comparing SR and GR data, there is a necessary tradeoff between the strictness of filtering criteria filtering and the number of available samples. Here below we provide some general recommendations for effective filtering:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"iAR0MNlZGd"}],"key":"GPCxerQqwy"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Sensitivity Thresholds","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"pZH867IRzj"}],"key":"nWCF70Oouv"},{"type":"text","value":": Retain only those radar beams where the aggregated gate reflectivities exceed the instrument sensitivities.\nThe ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"DRbGmucnVJ"},{"type":"inlineCode","value":"GR_Z_fraction_above_\u003cthr\u003edBZ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"N8wAr2srRK"},{"type":"text","value":" and ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"rKt4SF2LZ2"},{"type":"inlineCode","value":"SR_zFactorFinal_Ku_fraction_above_\u003cthr\u003edBZ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"exJCM9X3tY"},{"type":"text","value":" variables can be used filter the samples.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"VNjKeFvdd6"}],"key":"HvxU5ULUZR"}],"key":"yqoxZ2zNfH"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Stratiform Precipitation","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"LjMHHV2ed8"}],"key":"ByspblCuQL"},{"type":"text","value":":  If the purpose of your analysis is to assess the calibration bias of GR data, it is suggested to focus on stratiform precipitation that ocurrs outside the melting layer (i.e. avoiding the bright band). Only stratiform samples above the melting layer are used in ground validation of the GPM DPR (W. Petersen 2017, personal communication).\nConvective SR footprints are typically excluded to avoid dealing with:","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"tcCurIu3tU"}],"key":"wiIhhiZYZD"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":11,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"the high spatial variability in the precipitation field and issues with non-uniform beam filling (NUBF),","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"hFv4EWunBA"}],"key":"wOYa81MxZT"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"the potential biases introduced by the SR attenuation correction,","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"S2BYpqdRVg"}],"key":"Qq1GqGUMUb"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"the potential biases in GR reflectivities, especially at C and X band, due to beam attenuation,","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"NVfmRmzPyB"}],"key":"XEDdICnLRg"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"the multiple scattering signature caused by hail particles.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"OfJhIqgYEk"}],"key":"KWGsEWfjTj"}],"key":"skce4IjzUo"}],"key":"FZeGQgC2Bl"},{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"strong","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Reflectivity Range","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"G0Q7hlwu5j"}],"key":"WAjXz3jCxI"},{"type":"text","value":": According to Warren et al. (2018), volume-averaged SR and GR reflectivity values should be selected within the range of 24 to 36 dBZ. This range minimizes the impact of low SR sensitivity,  SR beam attenuation and non-rayleigh scattering effects.","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"UFTqUtDxjC"}],"key":"LF3KlU87HV"}],"key":"U2zbhjlpdX"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"strong","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Clutter Removal","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"OeJgw5KSLe"}],"key":"c9D46Pf2TX"},{"type":"text","value":": Exclude SR/GR samples that are contaminated by ground clutter, anomalous propagation, or beam blockage.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"uhgFmQGGs6"}],"key":"VRbzesEvQu"}],"key":"TfkFKtH6Ur"},{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"strong","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Volume matching","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"Rh24PC5jq1"}],"key":"o04YpHRTky"},{"type":"text","value":": Exclude SR/GR samples where there are excessive differences in the total gate volume.","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"VmYUY3lIG9"}],"key":"RGxFhmR7Mg"}],"key":"nfJ1FfSbdr"}],"key":"d1QBj11MBP"}],"key":"SdmzmoRLa7"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-05T14:57:39.261726Z","iopub.status.busy":"2024-09-05T14:57:39.261555Z","iopub.status.idle":"2024-09-05T14:57:39.267751Z","shell.execute_reply":"2024-09-05T14:57:39.267169Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Define masks\nmasks = [\n    # Select SR scan with \"normal\" dataQuality (for entire cross-track scan)\n    gdf_match[\"SR_dataQuality\"] == 0,\n    # Select SR beams with detected precipitation\n    gdf_match[\"SR_flagPrecip\"] \u003e 0,\n    # Select only 'high quality' SR data\n    # - qualityFlag == 1 indicates low quality retrievals\n    # - qualityFlag == 2 indicates bad/missing retrievals\n    gdf_match[\"SR_qualityFlag\"] == 0,\n    # Select SR beams with SR above minimum reflectivity\n    gdf_match[\"SR_zFactorFinal_Ku_fraction_above_12dBZ\"] \u003e 0.95,\n    # Select SR beams with GR above minimum reflectivity\n    gdf_match[\"GR_Z_fraction_above_10dBZ\"] \u003e 0.95,\n    # Select only SR beams with detected bright band\n    gdf_match[\"SR_qualityBB\"] == 1,\n    # Select only beams with confident precipitation type\n    gdf_match[\"SR_qualityTypePrecip\"] == 1,\n    # Select only stratiform precipitation\n    # - SR_flagPrecipitationType == 2 indicates convective\n    gdf_match[\"SR_flagPrecipitationType\"] == 1,\n    # Select only SR beams with reliable attenuation correction\n    gdf_match[\"SR_reliabFlag\"].isin((1, 2)),  # or == 1\n    # Select only beams with reduced path attenuation\n    # gdf_match[\"SR_zFactorCorrection_Ku_max\"]\n    # gdf_match[\"SR_piaFinal\"]\n    # gdf_match[\"SR_pathAtten\"]\n    # Select only SR beams with matching SR gates with no clutter\n    gdf_match[\"SR_fraction_clutter\"] == 0,\n    # Select only SR beams with matching SR gates not in the melting layer\n    gdf_match[\"SR_fraction_melting_layer\"] == 0,\n    # Select only SR beams with matching SR gates with precipitation\n    gdf_match[\"SR_fraction_no_precip\"] == 0,\n    # Select only SR beams with matching SR gates with no hail\n    gdf_match[\"SR_fraction_hail\"] == 0,\n    # Select only SR beams with matching SR gates with rain\n    # gdf_match[\"SR_fraction_rain\"] == 1,\n    # Select only SR beams with matching SR gates with snow\n    # gdf_match[\"SR_fraction_snow\"] == 1,\n    # Discard SR beams with high NUBF\n    # gdf_match[\"SR_zFactorFinal_Ku_range\"] \u003e 5,\n    # gdf_match[\"SR_zFactorFinal_Ku_cov\"] \u003c 0.5,\n    # gdf_match[\"GR_Z_cov\"] \u003c 0.5,\n    gdf_match[\"GR_Z_range\"] \u003c 15,\n    # Select only interval of reflectivities\n    # - Warren et al., 2018:  between 24 and 36 dBZ\n    # (gdf_match[\"SR_zFactorFinal_Ku_mean\"] \u003e 24) \u0026 (gdf_match[\"SR_zFactorFinal_Ku_mean\"] \u003c 36),\n    # (gdf_match[\"GR_Z_mean\"] \u003e 24) \u0026 (gdf_match[\"GR_Z_mean\"] \u003c 36),\n    # Select SR beams only within given GR radius interval\n    # (gdf_match[\"GR_range_min\"] \u003e min_gr_range) \u0026 (gdf_match[\"GR_range_max\"] \u003c max_gr_range),\n    # Discard SR beams where scanning time difference \u003e 5 minutes\n    # - time_difference is in seconds !\n    gdf_match[\"time_difference\"] \u003c 60 * 5,\n    # Discard SR beams where GR gates does not cover 80% of the horizontal area\n    gdf_match[\"GR_fraction_covered_area\"] \u003e 0.8,\n    # # Filter footprints where volume ratio exceeds 60\n    # gdf_match[\"VolumeRatio\"] \u003e 60,\n    # Filter footprints where GR affected by beam blockage\n    # TODO: Filtering by beam blockage\n]","key":"uKvZV3SK00"},{"type":"output","id":"CCPDCmtCSHldljTeczYdD","data":[],"key":"Y7FQ5xgePW"}],"key":"xvnHDsQHgE"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-05T14:57:39.269897Z","iopub.status.busy":"2024-09-05T14:57:39.269536Z","iopub.status.idle":"2024-09-05T14:57:39.274296Z","shell.execute_reply":"2024-09-05T14:57:39.273861Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Define final mask\nmask_final = reduce(np.logical_and, masks)","key":"pZ726pLTeK"},{"type":"output","id":"TM2n6btx5GuL8mQLg42oC","data":[],"key":"OwNotFS3Qb"}],"key":"aE0CF73paN"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-05T14:57:39.276233Z","iopub.status.busy":"2024-09-05T14:57:39.275885Z","iopub.status.idle":"2024-09-05T14:57:39.458202Z","shell.execute_reply":"2024-09-05T14:57:39.457711Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Dsplay final filtering mask\ngdf_match[\"filtering_mask\"] = mask_final\nreflectivity_scatterplots(\n    df=gdf_match,\n    gr_z_column=gr_z_column,\n    sr_z_column=sr_z_column,\n    hue_columns=\"filtering_mask\",\n    marker=\"o\",\n    s=1,\n    cmap=\"viridis_r\",\n)","key":"SYsrb6BoME"},{"type":"output","id":"ej5cv2pK7Nd1F-f5XJWCS","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"cc3864cfe7b74ab12ad68532be8f3ec1","path":"/erad2024/_preview/104/build/cc3864cfe7b74ab12ad68532be8f3ec1.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"edRDOgilRm"}],"key":"l4m1NUwnVk"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Analyze filtered SR/GR database","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MsPqiSecM2"}],"identifier":"analyze-filtered-sr-gr-database","label":"Analyze filtered SR/GR database","html_id":"analyze-filtered-sr-gr-database","implicit":true,"key":"Q3u1iV9nsN"}],"key":"r5EkBTme2a"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We now filter the SR/GR Database, compare the reflectivity fields and display the new calibration summary:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BrViXpMFOH"}],"key":"mpYJ2FPsZ5"}],"key":"rYoxpiWQ1A"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-05T14:57:39.460373Z","iopub.status.busy":"2024-09-05T14:57:39.460179Z","iopub.status.idle":"2024-09-05T14:57:39.464694Z","shell.execute_reply":"2024-09-05T14:57:39.464237Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"gdf_final = gdf_match[mask_final]","key":"lECUTYivwy"},{"type":"output","id":"VrCBg7eU0BgH7FmbwksJv","data":[],"key":"SVFdF2udCu"}],"key":"ysmrddV87V"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-05T14:57:39.466713Z","iopub.status.busy":"2024-09-05T14:57:39.466358Z","iopub.status.idle":"2024-09-05T14:57:39.924343Z","shell.execute_reply":"2024-09-05T14:57:39.923711Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"fig = compare_maps(\n    gdf_final,\n    sr_column=sr_z_column,\n    gr_column=gr_z_column,\n    sr_label=\"SR Reflectivity (dBz)\",\n    gr_label=\"GR Reflectivity (dBz)\",\n    cmap=\"Spectral_r\",\n    unified_color_scale=True,\n    vmin=15,\n    # vmax=40\n)\nfig.tight_layout()","key":"NcQDwWlhVI"},{"type":"output","id":"FBovozW6V_QFmMwVKtXUc","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"fb8af9c1ac1fdc1c7609d66270ef185d","path":"/erad2024/_preview/104/build/fb8af9c1ac1fdc1c7609d66270ef185d.png"},"text/plain":{"content":"\u003cFigure size 1400x700 with 4 Axes\u003e","content_type":"text/plain"}}}],"key":"f1jVjFOYGq"}],"key":"CxZRjonHzk"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-05T14:57:39.926357Z","iopub.status.busy":"2024-09-05T14:57:39.926143Z","iopub.status.idle":"2024-09-05T14:57:40.290693Z","shell.execute_reply":"2024-09-05T14:57:40.290151Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"fig = calibration_summary(\n    df=gdf_final,\n    sr_z_column=sr_z_column,\n    gr_z_column=gr_z_column,\n    # Histogram options\n    bin_width=2,\n    # Scatterplot options\n    # hue_column=\"GR_gate_volume_sum\",\n    hue_column=\"GR_range_mean\",\n    # gr_range=[15, 50]\n    # sr_range=[15, 50]\n    marker=\"+\",\n    cmap=\"Spectral\",\n)\nfig.tight_layout()","key":"CgvRwNeOGC"},{"type":"output","id":"K-XyEzpEca8NPgsfKNoYl","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b5a640b014e9b78130abaf159fe1f625","path":"/erad2024/_preview/104/build/b5a640b014e9b78130abaf159fe1f625.png"},"text/plain":{"content":"\u003cFigure size 1200x500 with 3 Axes\u003e","content_type":"text/plain"}}}],"key":"OngVn0s4Zi"}],"key":"yWkzWYmvbW"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Exploratory data analysis can again be performed to check if the filtering criteria were effective to discard the undesired SR/GR matched volumes and if the filtering criteria should be further expanded.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kFOUyrBCIa"}],"key":"hqQ5BtCSN3"}],"key":"btsrYi4iC6"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-05T14:57:40.293093Z","iopub.status.busy":"2024-09-05T14:57:40.292922Z","iopub.status.idle":"2024-09-05T14:57:41.132072Z","shell.execute_reply":"2024-09-05T14:57:41.131505Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Attenuation\nhue_columns = [\n    \"SR_pathAtten\",\n    \"SR_piaFinal\",\n    \"SR_reliabFlag\",\n    \"SR_zFactorCorrection_Ku_max\",\n    \"SR_zFactorCorrection_Ku_mean\",\n    \"GR_Z_cumsum_max\",\n]\nfig = reflectivity_scatterplots(\n    df=gdf_final,\n    gr_z_column=gr_z_column,\n    sr_z_column=sr_z_column,\n    hue_columns=hue_columns,\n    ncols=2,\n)\nfig.tight_layout()","key":"kDerRujiZ4"},{"type":"output","id":"mRZo6bFXxOkuUk7CzZu-B","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7e4261e09d571daaee5bd69c0c689be5","path":"/erad2024/_preview/104/build/7e4261e09d571daaee5bd69c0c689be5.png"},"text/plain":{"content":"\u003cFigure size 1200x1500 with 12 Axes\u003e","content_type":"text/plain"}}}],"key":"IYAii0RKfH"}],"key":"Mgwds0g1Z1"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Determine GR calibration bias","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SuiUw8rhEj"}],"identifier":"determine-gr-calibration-bias","label":"Determine GR calibration bias","html_id":"determine-gr-calibration-bias","implicit":true,"key":"fE57kkJtUz"}],"key":"ebncKmZrCH"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The GR calibration bias can be obtained by averaging the difference between the matched SR/GR reflectivity measurements:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ogq67eWELr"}],"key":"EyxhrMOHcP"}],"key":"xzW82YHlVt"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-05T14:57:41.134912Z","iopub.status.busy":"2024-09-05T14:57:41.134518Z","iopub.status.idle":"2024-09-05T14:57:41.138968Z","shell.execute_reply":"2024-09-05T14:57:41.138414Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Compute average offset\nz_offset = np.nanmean(gdf_final[sr_z_column] - gdf_final[gr_z_column]).round(2)\nz_offset_robust = np.nanmedian(gdf_final[sr_z_column] - gdf_final[gr_z_column]).round(2)\n\nprint(f\"Th ZH Calibration offset is (mean): {z_offset} dBZ\")\nprint(f\"Th ZH Calibration offset is (median): {z_offset_robust} dBZ\")","key":"PqqxBbUZvW"},{"type":"output","id":"MbRum86KVu5IiBl4DsSVO","data":[{"name":"stdout","output_type":"stream","text":"Th ZH Calibration offset is (mean): 3.94 dBZ\nTh ZH Calibration offset is (median): 3.78 dBZ\n"}],"key":"fjh7EEP9EQ"}],"key":"WonAq8FsFE"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Volume matching with calibrated GR","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"x8YSZCSlVu"}],"identifier":"volume-matching-with-calibrated-gr","label":"Volume matching with calibrated GR","html_id":"volume-matching-with-calibrated-gr","implicit":true,"key":"WcqAjvM1Fm"}],"key":"Q5ZcTFF1a4"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now, we remove the estimated GR calibration bias, we rerun the SR/GR volume matching procedure, we compare the matched reflectivities and we assess if we have effectively removed the bias by generating the calibration summary. Please note that here below we don’t filter out  undesired SR/GR volumes, but this is operation is recommended once you defined appropriate robust filtering criteria !","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"S2xcx58Qo2"}],"key":"EW6uVRUebB"}],"key":"M260cYISAc"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-05T14:57:41.141121Z","iopub.status.busy":"2024-09-05T14:57:41.140954Z","iopub.status.idle":"2024-09-05T14:57:41.145314Z","shell.execute_reply":"2024-09-05T14:57:41.144833Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Apply offset\nds_gr[\"DBZH_c\"] = ds_gr[\"DBZH\"] + z_offset","key":"PK6oQoh265"},{"type":"output","id":"paE6f-86KSADRM34UAXac","data":[],"key":"AKo29TaaA0"}],"key":"WAvWhvgCe2"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-05T14:57:41.147397Z","iopub.status.busy":"2024-09-05T14:57:41.146970Z","iopub.status.idle":"2024-09-05T14:58:02.800805Z","shell.execute_reply":"2024-09-05T14:58:02.800268Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Apply matching\ngdf_match_corrected = volume_matching(\n    ds_gr=ds_gr,\n    ds_sr=ds_sr,\n    z_variable_gr=\"DBZH_c\",\n    radar_band=radar_band,\n    beamwidth_gr=beamwidth_gr,\n    z_min_threshold_gr=z_min_threshold_gr,\n    z_min_threshold_sr=z_min_threshold_sr,\n    min_gr_range=0,\n    max_gr_range=150_000,\n    # gr_sensitivity_thresholds=None,\n    # sr_sensitivity_thresholds=None,\n    download_sr=False,  # require internet connection !\n)","key":"MY4YhNrOjX"},{"type":"output","id":"zu8n4oSZVIOXl6izJdBV7","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d76ef36fdfd860a124d9cac547308ea6","path":"/erad2024/_preview/104/build/d76ef36fdfd860a124d9cac547308ea6.png"},"text/plain":{"content":"\u003cFigure size 960x480 with 4 Axes\u003e","content_type":"text/plain"}}},{"name":"stdout","output_type":"stream","text":"SR/GR Matching Elapsed time: 0:00:21.649365 .\n"}],"key":"NP5v8djwaP"}],"key":"MQVfS8oYZ9"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-05T14:58:02.803650Z","iopub.status.busy":"2024-09-05T14:58:02.803162Z","iopub.status.idle":"2024-09-05T14:58:03.598925Z","shell.execute_reply":"2024-09-05T14:58:03.598353Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Compare reflectivities\nfig = compare_maps(\n    gdf_match_corrected,\n    sr_column=sr_z_column,\n    gr_column=gr_z_column,\n    sr_label=\"SR Reflectivity (dBz)\",\n    gr_label=\"GR Reflectivity (dBz)\",\n    cmap=\"Spectral_r\",\n    unified_color_scale=True,\n    vmin=15,\n    # vmax=40\n)\nfig.tight_layout()","key":"gPQJsmSvIr"},{"type":"output","id":"wZrdqOhk0JR1nAnXlL8EI","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"8476fbc120215e09c7bc5c17ff902c3d","path":"/erad2024/_preview/104/build/8476fbc120215e09c7bc5c17ff902c3d.png"},"text/plain":{"content":"\u003cFigure size 1400x700 with 4 Axes\u003e","content_type":"text/plain"}}}],"key":"HikS9sLVds"}],"key":"YY7BXhgouJ"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-05T14:58:03.602092Z","iopub.status.busy":"2024-09-05T14:58:03.601917Z","iopub.status.idle":"2024-09-05T14:58:03.866160Z","shell.execute_reply":"2024-09-05T14:58:03.865565Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Display difference in reflectivity betweeen SR and GR\ngdf_match_corrected[\"z_offset\"] = gdf_match_corrected[sr_z_column] - gdf_match_corrected[gr_z_column]\ngdf_match_corrected.plot(column=\"z_offset\", legend=True, cmap=\"RdBu\", vmin=-1.5, vmax=1.5)","key":"orje7rzoRk"},{"type":"output","id":"f-WvnH9GoR5Ogz7COX_EO","data":[{"output_type":"execute_result","execution_count":33,"metadata":{},"data":{"text/plain":{"content":"\u003cAxes: \u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d9a234a3550a635210663126d2124f41","path":"/erad2024/_preview/104/build/d9a234a3550a635210663126d2124f41.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"DR3o3ICeS6"}],"key":"ZbGbUoD3cl"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-09-05T14:58:03.869786Z","iopub.status.busy":"2024-09-05T14:58:03.869539Z","iopub.status.idle":"2024-09-05T14:58:04.254974Z","shell.execute_reply":"2024-09-05T14:58:04.254253Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Display calibration summary\nfig = calibration_summary(\n    df=gdf_match_corrected,\n    gr_z_column=gr_z_column,\n    sr_z_column=sr_z_column,\n    # Histogram options\n    bin_width=2,\n    # Scatterplot options\n    hue_column=\"SR_fraction_clutter\",\n    marker=\"+\",\n    cmap=\"Spectral\",\n)\nfig.tight_layout()","key":"zxiReudjcN"},{"type":"output","id":"wGvarWryFSjzZv955NNxv","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d6d45ae2e73e883cae9673e4411e36f7","path":"/erad2024/_preview/104/build/d6d45ae2e73e883cae9673e4411e36f7.png"},"text/plain":{"content":"\u003cFigure size 1200x500 with 3 Axes\u003e","content_type":"text/plain"}}}],"key":"GR2rk3rYo9"}],"key":"oA81Ay3U7R"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Next steps","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pgWskNv9bD"}],"identifier":"next-steps","label":"Next steps","html_id":"next-steps","implicit":true,"key":"ohzwyUgDuA"}],"key":"rDTk0CSY6H"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We encourage you to explore and adapt the code provided in this tutorial to infer calibration bias also\nfor the vertically polarized channel, iterate over GR sweeps, analyze multiple GPM overpasses, and assess the\nlong-term calibration bias of your GR network.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dncIHxOqHi"}],"key":"znExWfr7Zv"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Please share any insights or suggestions for improving the matching procedure or filtering criteria with\nthe GPM-API community so we can collaboratively enhance the routines.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"i68GK0HqXz"}],"key":"tVoiAslQu2"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"We hope you enjoyed the tutorial! 😊","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"yGH6BMjYPl"}],"key":"vXUdnCW6Bi"}],"key":"HroxzOvBsW"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"References","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bhqat8r00K"}],"identifier":"references","label":"References","html_id":"references","implicit":true,"key":"P57pIspkgQ"}],"key":"VQTCEpBkXS"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"cite","url":"https://doi.org/10.1002/jgrd.50138","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Cao, Q., Y. Hong, Y. Qi, Y. Wen, J. Zhang, J. J. Gourley, and L. Liao, 2013: Empirical conversion of the vertical profile of reflectivity from Ku-band to S-band frequency. J. Geophys. Res. Atmos., 118, 1814–1825, https://doi.org/10.1002/jgrd.50138","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dpd4iJl5Qg"}],"kind":"narrative","label":"Cao_2013","identifier":"https://doi.org/10.1002/jgrd.50138","enumerator":"1","key":"fe5Ib2KFFM"}],"key":"q2uaSdhVZe"},{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"cite","url":"https://doi.org/10.1175/2010JTECHA1403.1","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Schwaller, MR, and Morris, KR. 2011. A ground validation network for the Global Precipitation Measurement mission. J. Atmos. Oceanic Technol., 28, 301-319.28, https://doi.org/10.1175/2010JTECHA1403.1","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"uhe42Kw2bA"}],"kind":"narrative","label":"Schwaller_2011","identifier":"https://doi.org/10.1175/2010JTECHA1403.1","enumerator":"2","key":"yZYH3ifRJI"}],"key":"IZhw1nhLgZ"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"cite","url":"https://doi.org/10.1175/JTECH-D-17-0128.1","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Warren, R.A., A. Protat, S.T. Siems, H.A. Ramsay, V. Louf, M.J. Manton, and T.A. Kane, 2018. Calibrating ground-based radars against TRMM and GPM. J. Atmos. Oceanic Technol., 35, 323–346, https://doi.org/10.1175/JTECH-D-17-0128.1","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sBbvRWeNGg"}],"kind":"narrative","label":"Warren_2018","identifier":"https://doi.org/10.1175/JTECH-D-17-0128.1","enumerator":"3","key":"m0ZkxfleKf"}],"key":"EWB4oZoUSn"}],"key":"AMXZaGymWB"}],"key":"IGJoQvEbr9"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Citation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wnoRnRjr0C"}],"identifier":"citation","label":"Citation","html_id":"citation","implicit":true,"key":"YQ9oXAftp9"}],"key":"LUkgEZNsfF"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This notebook is part of the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pV4vKkqkKN"},{"type":"link","url":"https://gpm-api.readthedocs.io/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"GPM-API  documentation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Wz5LtqUZJz"}],"urlSource":"https://gpm-api.readthedocs.io/","key":"mKFgX1gpMJ"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WCI8JQH2Gc"}],"key":"CBhzZg3k1b"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Large portions of this tutorials were adapted and derived from an old ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VtFu7yea3O"},{"type":"inlineMath","value":"\\omega radlib","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eω\u003c/mi\u003e\u003cmi\u003er\u003c/mi\u003e\u003cmi\u003ea\u003c/mi\u003e\u003cmi\u003ed\u003c/mi\u003e\u003cmi\u003el\u003c/mi\u003e\u003cmi\u003ei\u003c/mi\u003e\u003cmi\u003eb\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\omega radlib\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eω\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\"\u003er\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ea\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ed\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.01968em;\"\u003el\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eib\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"wWKeuUpPhs"},{"type":"text","value":"  tutorial.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"tQ8Ntb8iYJ"}],"key":"S1tFs9WIqn"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Copyright: ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"jrUNiT98ee"},{"type":"inlineMath","value":"\\omega radlib","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eω\u003c/mi\u003e\u003cmi\u003er\u003c/mi\u003e\u003cmi\u003ea\u003c/mi\u003e\u003cmi\u003ed\u003c/mi\u003e\u003cmi\u003el\u003c/mi\u003e\u003cmi\u003ei\u003c/mi\u003e\u003cmi\u003eb\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\omega radlib\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eω\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\"\u003er\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ea\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ed\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.01968em;\"\u003el\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eib\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"DSatsRRzPb"},{"type":"text","value":"  and GPM-API developers.\nDistributed under the MIT License. See ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"JpRQwZPu5l"},{"type":"link","url":"https://github.com/ghiggi/gpm_api/blob/main/LICENSE","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"GPM-API license","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"J1CXIJ1G2c"}],"urlSource":"https://github.com/ghiggi/gpm_api/blob/main/LICENSE","data":{"kind":"file","org":"ghiggi","repo":"gpm_api","reference":"main","file":"LICENSE","raw":"https://raw.githubusercontent.com/ghiggi/gpm_api/main/LICENSE"},"internal":false,"protocol":"github","key":"J7NRLUawx6"},{"type":"text","value":" for more info.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Hg3DzsfLbf"}],"key":"U3NqzBubDG"}],"key":"rQB5ZFjxBv"}],"key":"TwOHTcleut"},"references":{"cite":{"order":["Cao_2013","Schwaller_2011","Warren_2018"],"data":{"Cao_2013":{"label":"Cao_2013","enumerator":"1","doi":"10.1002/jgrd.50138","html":"Cao, Q., Hong, Y., Qi, Y., Wen, Y., Zhang, J., Gourley, J. J., \u0026 Liao, L. (2013). Empirical conversion of the vertical profile of reflectivity from Ku‐band to S‐band frequency. \u003ci\u003eJournal of Geophysical Research: Atmospheres\u003c/i\u003e, \u003ci\u003e118\u003c/i\u003e(4), 1814–1825. \u003ca target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1002/jgrd.50138\"\u003e10.1002/jgrd.50138\u003c/a\u003e","url":"https://doi.org/10.1002/jgrd.50138"},"Schwaller_2011":{"label":"Schwaller_2011","enumerator":"2","doi":"10.1175/2010jtecha1403.1","html":"Schwaller, M. R., \u0026 Morris, K. R. (2011). A Ground Validation Network for the Global Precipitation Measurement Mission. \u003ci\u003eJournal of Atmospheric and Oceanic Technology\u003c/i\u003e, \u003ci\u003e28\u003c/i\u003e(3), 301–319. \u003ca target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1175/2010jtecha1403.1\"\u003e10.1175/2010jtecha1403.1\u003c/a\u003e","url":"https://doi.org/10.1175/2010jtecha1403.1"},"Warren_2018":{"label":"Warren_2018","enumerator":"3","doi":"10.1175/jtech-d-17-0128.1","html":"Warren, R. A., Protat, A., Siems, S. T., Ramsay, H. A., Louf, V., Manton, M. J., \u0026 Kane, T. A. (2018). Calibrating Ground-Based Radars against TRMM and GPM. \u003ci\u003eJournal of Atmospheric and Oceanic Technology\u003c/i\u003e, \u003ci\u003e35\u003c/i\u003e(2), 323–346. \u003ca target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1175/jtech-d-17-0128.1\"\u003e10.1175/jtech-d-17-0128.1\u003c/a\u003e","url":"https://doi.org/10.1175/jtech-d-17-0128.1"}}}},"footer":{"navigation":{"prev":{"title":"QPE \u0026 QVPs","url":"/qpe-qvps","group":"ARCO Radar Datasets"},"next":{"title":"Spaceborne-Ground Radar Matching (Methodology)","url":"/sr-gr-matching-procedure","group":"Spaceborne - Ground Radar Matching and Calibration"}}},"domain":"http://localhost:3000"},"project":{"open_access":true,"license":{"content":{"id":"Apache-2.0","name":"Apache License 2.0","osi":true,"free":true,"url":"https://opensource.org/licenses/Apache-2.0"},"code":{"id":"CC-BY-4.0","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true,"url":"https://creativecommons.org/licenses/by/4.0/"}},"abbreviations":{"ARM":"Atmospheric Radiation Measurement","NCAR":"National Center for Atmospheric Research"},"settings":{"output_matplotlib_strings":"remove"},"title":"ERAD 2024","authors":[{"nameParsed":{"literal":"Alfonso Ladino","given":"Alfonso","family":"Ladino"},"name":"Alfonso Ladino","orcid":"0000-0001-8081-7827","github":"aladinor","id":"contributors-myst-generated-uid-0"},{"nameParsed":{"literal":"Anna del Moral Méndez","given":"Anna","non_dropping_particle":"del","family":"Moral Méndez"},"name":"Anna del Moral Méndez","orcid":"0000-0002-5015-840X","id":"contributors-myst-generated-uid-1"},{"nameParsed":{"literal":"Brenda Javornik","given":"Brenda","family":"Javornik"},"name":"Brenda Javornik","orcid":"0009-0004-9266-9293","github":"leavesntwigs","id":"contributors-myst-generated-uid-2"},{"nameParsed":{"literal":"Daniel Michelson","given":"Daniel","family":"Michelson"},"name":"Daniel Michelson","orcid":"0000-0003-3222-9881","github":"DanielMichelson","id":"contributors-myst-generated-uid-3"},{"nameParsed":{"literal":"Daniel Wolfensberger","given":"Daniel","family":"Wolfensberger"},"name":"Daniel Wolfensberger","orcid":"0009-0006-1419-0556","github":"wolfidan","id":"contributors-myst-generated-uid-4"},{"nameParsed":{"literal":"Gionata Ghiggi","given":"Gionata","family":"Ghiggi"},"name":"Gionata Ghiggi","orcid":"0000-0002-0818-0865","github":"ghiggi","id":"contributors-myst-generated-uid-5"},{"nameParsed":{"literal":"Jen DeHart","given":"Jen","family":"DeHart"},"name":"Jen DeHart","orcid":"0000-0001-8536-4927","github":"jcdehart","id":"contributors-myst-generated-uid-6"},{"nameParsed":{"literal":"Jordi Figueras i Ventura","given":"Jordi Figueras","non_dropping_particle":"i","family":"Ventura"},"name":"Jordi Figueras i Ventura","orcid":"0000-0002-4949-422X","github":"jfigui","id":"contributors-myst-generated-uid-7"},{"nameParsed":{"literal":"Julian Giles","given":"Julian","family":"Giles"},"name":"Julian Giles","orcid":"0000-0001-8134-008X","github":"JulianGiles","id":"contributors-myst-generated-uid-8"},{"nameParsed":{"literal":"Kai Mühlbauer","given":"Kai","family":"Mühlbauer"},"name":"Kai Mühlbauer","orcid":"0000-0001-6599-1034","github":"kmuehlbauer","id":"contributors-myst-generated-uid-9"},{"nameParsed":{"literal":"Maxwell Grover","given":"Maxwell","family":"Grover"},"name":"Maxwell Grover","orcid":"0000-0002-0370-8974","github":"mgrover1","id":"contributors-myst-generated-uid-10"},{"nameParsed":{"literal":"Mike Dixon","given":"Mike","family":"Dixon"},"name":"Mike Dixon","orcid":"0000-0002-9597-9113","github":"mike-dixon","id":"contributors-myst-generated-uid-11"},{"nameParsed":{"literal":"Robert Jackson","given":"Robert","family":"Jackson"},"name":"Robert Jackson","orcid":"0000-0003-2518-1234","github":"rcjackson","id":"contributors-myst-generated-uid-12"},{"nameParsed":{"literal":"Scott Collis","given":"Scott","family":"Collis"},"name":"Scott Collis","orcid":"0000-0002-2303-687X","github":"scollis","id":"contributors-myst-generated-uid-13"},{"nameParsed":{"literal":"Ting-Yu Cha","given":"Ting-Yu","family":"Cha"},"name":"Ting-Yu Cha","orcid":"0000-0002-6292-8483","github":"tingyucha","id":"contributors-myst-generated-uid-14"}],"github":"https://github.com/openradar/erad2024","copyright":"2024","references":{"foundations":{"url":"https://projectpythia-mystmd.github.io/pythia-foundations"},"xarray":{"url":"https://docs.xarray.dev/en/stable"},"matplotlib":{"url":"https://matplotlib.org/stable"}},"thebe":{"binder":{"url":"https://binder.projectpythia.org/","provider":"github","repo":"openradar/erad2024","ref":"HEAD"}},"toc":[{"file":"README.md"},{"file":"notebooks/how-to-cite.md"},{"file":"schedule.md"},{"children":[{"file":"getting_started.md"},{"file":"notebooks/data-access/intro-data-access.ipynb"},{"file":"notebooks/environment.ipynb"}],"title":"Getting started"},{"children":[{"file":"presentations/intro-to-open-radar-science.ipynb"},{"file":"notebooks/xradar-pyart/xradar-basics.ipynb"},{"children":[{"file":"notebooks/xradar-pyart/pyart-basics.ipynb"},{"file":"notebooks/wradlib/wradlib_clutter_beamblockage.ipynb"}],"title":"Py-ART and wradlib"},{"file":"notebooks/gpm-api/gpm-api-intro.ipynb"},{"children":[{"pattern":"notebooks/baltrad/baltrad_short_course/*.ipynb"},{"pattern":"notebooks/baltrad/pyart2baltrad/*.ipynb"},{"file":"notebooks/baltrad/baltrad2wradlib/baltrad2wradlib.ipynb"}],"title":"BALTRAD"},{"children":[{"file":"notebooks/lrose/LROSE_Basics.ipynb"},{"file":"notebooks/lrose/DD_Tornado_ERAD24.ipynb"},{"file":"notebooks/lrose/testing/stress_testing.ipynb"}],"title":"LROSE"}],"title":"Radar Software Foundations"},{"children":[{"children":[{"file":"notebooks/Retrieving_winds_with_pydda.ipynb"},{"file":"notebooks/lrose/LROSE_ERAD_fractl_samurai.ipynb"}],"title":"LROSE \u0026 PyDDA multi doppler analysis"},{"children":[{"file":"notebooks/Analysis-Ready/ARCO-Datasets.ipynb"},{"file":"notebooks/Analysis-Ready/QPE-QVPs.ipynb"}],"title":"ARCO Radar Datasets"},{"children":[{"file":"notebooks/gpm-api/SR_GR_Calibration_Applied.ipynb"},{"file":"notebooks/gpm-api/SR_GR_Matching_Procedure.ipynb"}],"title":"Spaceborne - Ground Radar Matching and Calibration"},{"file":"notebooks/pyrad/description-pyrad-tutorial.ipynb"}],"title":"Project Workflows"}],"thumbnail":"/erad2024/_preview/104/build/0885e6292c6be2fd643fbc952d479a01.jpeg","exports":[],"bibliography":[],"index":"readme","pages":[{"slug":"how-to-cite","title":"How to Cite","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"schedule","title":"Schedule","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"level":1,"title":"Getting started"},{"slug":"getting-started","title":"Notebook Execution","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"intro-data-access","title":"Data Access Instructions","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"environment","title":"Environment overview","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Radar Software Foundations"},{"slug":"intro-to-open-radar-science","title":"An Introduction to Open Radar Science","description":"","date":"","thumbnail":"/erad2024/_preview/104/build/31631960e5ad8808b3289c31e033c7bf.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"xradar-basics","title":"Xradar Basics","description":"","date":"","thumbnail":"/erad2024/_preview/104/build/xradar_logo-3b4383d54a0c27808b82e1d1b44fd46e.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":2,"title":"Py-ART and wradlib"},{"slug":"pyart-basics","title":"Py-ART Basics with Xradar","description":"","date":"","thumbnail":"/erad2024/_preview/104/build/arm_logo-a7094e5a09c5a3d27672fdaa8f5d97bb.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"wradlib-clutter-beamblockage","title":"wradlib - clutter and beamblockage","description":"","date":"","thumbnail":"/erad2024/_preview/104/build/wradlib_logo.svg-f0319c64d53a0677e1a2d1f5294395f1.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"gpm-api-intro","title":"Introduction to GPM-API","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":2,"title":"BALTRAD"},{"slug":"baltrad-io","title":"I/O model","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad-qc","title":"Quality Control","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad-drqc","title":"Quality Control using DR","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad-parallel-processing","title":"Parallel processing","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad-compositing","title":"Compositing","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad-pyart-rain-rate-example","title":"Rain Rate retrieval with Py-ART","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"pyart-baltrad-dealias-example","title":"Doppler Velocity Dealiasing with Py-ART","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"baltrad2wradlib","title":"Attenuation correction comparison with wradlib","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"LROSE"},{"slug":"lrose-basics","title":"An Introduction to LROSE","description":"","date":"","thumbnail":"/erad2024/_preview/104/build/colette_rose-b9c340e0a053d001878c103bf5cb1cbe.jpg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"dd-tornado-erad24","title":"MULTI DOPPLER ANALYSIS","description":"","date":"","thumbnail":"/erad2024/_preview/104/build/logo-2bfe4c7b718a0b157449f359153ca9d5.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"stress-testing","title":"stress-testing","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"Project Workflows"},{"level":2,"title":"LROSE \u0026 PyDDA multi doppler analysis"},{"slug":"retrieving-winds-with-pydda","title":"PyDDA tutorial","description":"","date":"","thumbnail":"/erad2024/_preview/104/build/5e2d147096249dc3a37da495168a9e9e.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"lrose-erad-fractl-samurai","title":"LROSE Wind Tutorial","description":"","date":"","thumbnail":"/erad2024/_preview/104/build/samurai-3cd519a5133f26b36609725ee157bdae.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"ARCO Radar Datasets"},{"slug":"arco-datasets","title":"Analysis-Ready Cloud-Optimized Datasets","description":"","date":"","thumbnail":"/erad2024/_preview/104/build/ARCO-d5273507419977e5af0df42c2e4fb75f.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"qpe-qvps","title":"QPE \u0026 QVPs","description":"","date":"","thumbnail":"/erad2024/_preview/104/build/QVP-07d23a262d5bcbde5a1921fa8f105724.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"Spaceborne - Ground Radar Matching and Calibration"},{"slug":"sr-gr-calibration-applied","title":"Spaceborne-Ground Radar Calibration (Application)","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"sr-gr-matching-procedure","title":"Spaceborne-Ground Radar Matching (Methodology)","description":"","date":"","thumbnail":"/erad2024/_preview/104/build/cc72069fb56e0a54f1123fbe9c2fcb76.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"description-pyrad-tutorial","title":"Pyrad QPE Exercise","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":false,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/erad2024/_preview/104/build/manifest-4C03D258.js";
import * as route0 from "/erad2024/_preview/104/build/root-ZSMPVWLZ.js";
import * as route1 from "/erad2024/_preview/104/build/routes/$-OW6NTZY2.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/erad2024/_preview/104/build/entry.client-K6EYMIDZ.js");</script></body></html>